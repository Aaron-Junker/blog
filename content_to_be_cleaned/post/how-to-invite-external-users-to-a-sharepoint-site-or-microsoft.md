::: {#848-007-5 .ServiceNodeInfoHeader}
:::

::: lia-page
::: MinimumWidthContainer
::: min-width-wrapper
::: min-width
::: lia-content
::: {.lia-quilt .lia-quilt-blog-article-page .lia-quilt-layout-two-column-main-side-18-6 .lia-top-quilt}
::: {.lia-quilt-row .lia-quilt-row-header}
::: {.lia-quilt-column .lia-quilt-column-24 .lia-quilt-column-single .lia-quilt-column-common-header}
::: {.lia-quilt-column-alley .lia-quilt-column-alley-single}
::: {.lia-quilt .lia-quilt-header .lia-quilt-layout-header .lia-component-quilt-header}
::: {.lia-quilt-row .lia-quilt-row-main-header}
::: {.lia-quilt-column .lia-quilt-column-24 .lia-quilt-column-single .lia-quilt-column-header}
::: {.lia-quilt-column-alley .lia-quilt-column-alley-single}
::: {#cookie-banner .cookie-markup}
:::

::: {#readerAssistMessages .section .live-region aria-live="assertive" role="alert"}
:::

::: community-header-blank
:::

::: community-header-component
::: community-header-wrapper
::: container
::: {#community-menu-wrapper-menu .menu-link}
[](javascript:void(0)){#community-menu-wrapper-menu-link}

::: {#community-menu-wrapper-menu-icon .menu-icon title=""}
:::
:::

[![](https://techcommunity.microsoft.com/html/@6005EEFEC6E5ECADBBFC249DFA7D38A8/assets/Content/Images/GlobalHeader/MicrosoftLogo.png){.c-image
itemprop="logo" role="presentation" aria-hidden="true"}
[Microsoft]{role="presentation"
aria-hidden="true"}](https://www.microsoft.com){#uhfLogo .c-logo
.c-sgl-stk-uhfLogo}

::: {.c-show-pipe aria-hidden="true"}
:::

[Tech Community](/){#uhfCatLogo .c-logo .c-cat-logo}

::: container-inner
::: {#community-menu-wrapper .community-menu-wrapper .community-menu-hidden-init}
::: {#community-menu-wrapper-header-bar .community-header-bar}
[](#){.community-header-button}

::: community-menu-item-icon
:::
:::

::: {#community-menu-wrapper-list .community-menu-list}
::: {.community-menu-item .tab-homepage}
[](/)

::: {.mdl2-glyph .community-menu-item-icon}

:::

::: community-menu-item-title
Home
:::
:::

::: {.community-menu-item .community-menu-dropdown}
[](#){.community-menu-item-desktop-view}

::: {.c-glyph .community-menu-item-icon}

:::

::: community-menu-item-title-with-dropdownicon
Community Hubs
:::

[](/t5/communities/ct-p/communities#category-filter-button-all){.community-menu-item-mobile-view
.community-menu-item-allow-link}

::: {.c-glyph .community-menu-item-icon}

:::

::: community-menu-item-title-with-dropdownicon
Community Hubs
:::

::: {.dropdown .dropdown-communities .dropdown-events .dropdown-primary-nav}
-   [Community Hubs
    Home](/t5/communities/ct-p/communities#category-filter-button-all){#communities_home}
-   [Products](/t5/communities/ct-p/communities#category-filter-button-products-services){#communities_products}
-   [Special
    Topics](/t5/communities/ct-p/communities#category-filter-button-solutions){#communities_special}
-   [Video Hub](/t5/video-hub/ct-p/VideoHub){#communities_videohub}

::: custom-community-hubs-menu-wrapper
::: custom-community-hubs-menu-close
Close
:::

::: custom-community-hubs-menu-content
::: menu
## [ Products]{#menu-link-prod title="Products"} [(72)]{.small} {#menu-products .active}

## [ Special Topics ]{#menu-link-serv title="Special Topics"} [(41)]{.small} {#menu-services}

## [ Video Hub ]{#menu-link-videohub title="VideoHub"} [(834)]{.small} {#menu-videohub}
:::

::: {#products-data .dataBlock .visible key="products"}
::: {.hubs style="width: 600px"}
### Most Active Hubs

::: {.data style="flex-direction: column; height:310px"}
<div>

[Microsoft
Teams](/t5/microsoft-teams/ct-p/MicrosoftTeams "Microsoft Teams")

</div>

<div>

[Excel](/t5/excel/ct-p/Excel_Cat "Excel")

</div>

<div>

[Exchange](/t5/exchange/ct-p/Exchange "Exchange")

</div>

<div>

[SharePoint](/t5/sharepoint/ct-p/SharePoint "SharePoint")

</div>

<div>

[Windows](/t5/windows-10/ct-p/Windows10 "Windows")

</div>

<div>

[Office 365](/t5/office-365/ct-p/Office365 "Office 365")

</div>

<div>

[Security, Compliance and
Identity](/t5/security-compliance-and-identity/ct-p/MicrosoftSecurityandCompliance "Security, Compliance and Identity")

</div>

<div>

[Windows
Server](/t5/windows-server/ct-p/Windows-Server "Windows Server")

</div>

<div>

[Microsoft Edge
Insider](/t5/microsoft-edge-insider/ct-p/MicrosoftEdgeInsider "Microsoft Edge Insider")

</div>

<div>

[Azure](/t5/azure-community/ct-p/Azure "Azure")

</div>

<div>

[Microsoft 365](/t5/microsoft-365/ct-p/microsoft365 "Microsoft 365")

</div>
:::
:::

::: boxes
[](/t5/azure-databases/ct-p/AzureDatabases "Azure Databases")

::: {.box style="background-image: url('https://techcommunity.microsoft.com/html/@D05C7AA27EF9EB31779410FCB608734A/assets/bg-pink.png')"}
::: title
Azure Databases
:::

::: description
Fully managed intelligent database services.
:::
:::

[](/t5/project-bonsai/ct-p/ProjectBonsai "Autonomous Systems")

::: {.box style="background-image: url('https://techcommunity.microsoft.com/html/@FC8AD6AC9A7EBDA58D7E6304E799EA40/assets/bg-orange.png')"}
::: title
Autonomous Systems
:::

::: description
Create and optimise intelligence for industrial control systems.
:::
:::

[](/t5/yammer/ct-p/Yammer "Yammer")

::: {.box style="background-image: url('https://techcommunity.microsoft.com/html/@CF0293463F27444B05A952A3C4B6BF88/assets/bg-light-blue.png')"}
::: title
Yammer
:::

::: description
Connect and engage across your organization.
:::
:::
:::
:::

::: {#services-data .dataBlock key="services"}
::: {.hubs style="width: 600px"}
### Most Active Hubs

::: {.data style="flex-direction: column; height:310px"}
<div>

[ITOps Talk](/t5/itops-talk/ct-p/ITOpsTalk "ITOps Talk")

</div>

<div>

[Education
Sector](/t5/education-sector/ct-p/EducationSector "Education Sector")

</div>

<div>

[Microsoft
Learn](/t5/microsoft-learn/ct-p/MicrosoftLearn "Microsoft Learn")

</div>

<div>

[Microsoft
Localization](/t5/microsoft-localization/ct-p/MicrosoftTranslation "Microsoft Localization")

</div>

<div>

[Microsoft 365
PnP](/t5/microsoft-365-pnp/ct-p/Microsoft365PnP "Microsoft 365 PnP")

</div>

<div>

[Healthcare and Life
Sciences](/t5/healthcare-and-life-sciences/ct-p/HealthcareAndLifeSciences "Healthcare and Life Sciences")

</div>

<div>

[Public Sector](/t5/public-sector/ct-p/PublicSector "Public Sector")

</div>

<div>

[Internet of Things
(IoT)](/t5/internet-of-things-iot/ct-p/IoT "Internet of Things (IoT)")

</div>

<div>

[Mixed
Reality](/t5/mixed-reality/ct-p/MicrosoftMixedReality "Mixed Reality")

</div>

<div>

[Enabling Remote
Work](/t5/enabling-remote-work/ct-p/RemoteWork "Enabling Remote Work")

</div>

<div>

[Small and Medium
Business](/t5/small-and-medium-businesses/ct-p/SMB "Small and Medium Business")

</div>
:::
:::

::: boxes
[](/t5/humans-of-it/ct-p/HumansofIT "Humans of IT")

::: {.box style="background-image: url('https://techcommunity.microsoft.com/html/@A5C0BDB1059C6D1F73B8097424B50ED0/assets/bg-purple.png')"}
::: title
Humans of IT
:::

::: description
Empowering technologists to achieve more by humanizing tech.
:::
:::

[](/t5/green-tech/ct-p/GreenTech "Green Tech")

::: {.box style="background-image: url('https://cdn.techcommunity.microsoft.com/lithium/MicrosoftLearn/Learn-Blue.png')"}
::: title
Green Tech
:::

::: description
Raise awareness about sustainability in the tech sector
:::
:::

[](/t5/mvp-award-program/ct-p/MVPAwardProgram "MVP Award Program")

::: {.box style="background-image: url('https://techcommunity.microsoft.com/html/@02C247197A08F2DB06040AC786E1BF01/assets/bg-green.png')"}
::: title
MVP Award Program
:::

::: description
Find out more about the Microsoft MVP Award Program.
:::
:::
:::
:::

::: {#VideoHub-Data .dataBlock key="VideoHub"}
::: {.hubs style="width: 838px"}
### Video Hub

::: {.data style="flex-direction: row; height:fit-content"}
<div>

[Azure](https://aka.ms/VideoHub/Azure "Azure")

</div>

<div>

[Exchange](https://aka.ms/VideoHub/Exchange "Exchange")

</div>

<div>

[Microsoft 365](https://aka.ms/VideoHub/Microsoft365 "Microsoft 365")

</div>

<div>

[Microsoft 365
Business](https://aka.ms/VideoHub/Microsoft365Business "Microsoft 365 Business")

</div>

<div>

[Microsoft 365
Enterprise](https://aka.ms/VideoHub/Microsoft365Business "Microsoft 365 Enterprise")

</div>

<div>

[Microsoft Edge](https://aka.ms/VideoHub/MicrosoftEdge "Microsoft Edge")

</div>

<div>

[Microsoft Outlook](https://aka.ms/VideoHub/Outlook "Microsoft Outlook")

</div>

<div>

[Microsoft
Teams](https://aka.ms/VideoHub/MicrosoftTeams "Microsoft Teams")

</div>

<div>

[Security](https://aka.ms/VideoHub/Security "Security")

</div>

<div>

[SharePoint](https://aka.ms/VideoHub/SharePoint "SharePoint")

</div>

<div>

[Windows](https://aka.ms/VideoHub/Windows "Windows")

</div>
:::
:::
:::
:::

::: custom-community-hubs-menu-footer
[Browse All Community
Hubs](/t5/Communities/ct-p/communities){#browse-all-communities}
:::
:::
:::
:::

::: {.community-menu-item .my-favorites}
[](/t5/custom/page/page-id/Blogs){.community-menu-item-desktop-view}

::: {.mdl2-glyph .community-menu-item-icon}

:::

::: community-menu-item-title
Blogs
:::

[](/t5/custom/page/page-id/Blogs){.community-menu-item-mobile-view}

::: {.mdl2-glyph .community-menu-item-icon}

:::

::: community-menu-item-title
Blogs
:::
:::

::: {.community-menu-item .tab-events .community-menu-dropdown}
[](#){.community-menu-item-desktop-view}

::: {.c-glyph .community-menu-item-icon}

:::

::: community-menu-item-title-with-dropdownicon
Events
:::

[](#){.community-menu-item-mobile-view}

::: {.c-glyph .community-menu-item-icon}

:::

::: community-menu-item-title-with-dropdownicon
Events
:::

::: {.dropdown .dropdown-events .dropdown-primary-nav}
-   [Events Home](/t5/Events/ct-p/Events)
-   [Microsoft Ignite](https://myignite.microsoft.com/)
-   [Microsoft Build](https://mybuild.microsoft.com/)
-   [Community Events](/t5/Community-Events/ct-p/CommunityEvents)
:::
:::

::: {.community-menu-item .tab-microsoft-learning .community-menu-dropdown}
[](#){.community-menu-item-desktop-view}

::: {.grad .community-menu-item-icon}
:::

::: community-menu-item-title-with-dropdownicon
Microsoft Learn
:::

[](#){.community-menu-item-mobile-view}

::: {.grad .community-menu-item-icon}
:::

::: community-menu-item-title-with-dropdownicon
Microsoft Learn
:::

::: {.dropdown .dropdown-events .dropdown-primary-nav}
-   [Home](%20https://docs.microsoft.com/learn/){.ms-learning-home-link
    .community-menu-item-title}
-   [Community](/t5/microsoft-learn/bd-p/MicrosoftLearn)
-   [Blog](/t5/microsoft-learn-blog/bg-p/MicrosoftLearnBlog)
-   [Azure](https://docs.microsoft.com/learn/azure/?WT.mc_id=techcom_header-webpage-m365)
-   [Dynamics
    365](https://docs.microsoft.com/learn/dynamics365/?WT.mc_id=techcom_header-webpage-m365)
-   [Microsoft
    365](https://docs.microsoft.com/learn/m365/?wt.mc_id=techcom_header-webpage-m365)
-   [Security, Compliance &
    Identity](https://docs.microsoft.com/learn/topics/sci/?wt.mc_id=techcom_header-webpage-m365)
-   [Power
    Platform](https://docs.microsoft.com/learn/powerplatform/?wt.mc_id=techcom_header-webpage-powerplatform)
-   [Github](https://docs.microsoft.com/learn/github/?wt.mc_id=techcom_header-webpage-github)
-   [Teams](https://docs.microsoft.com/learn/teams/?wt.mc_id=techcom_header-webpage-teams)
-   [.NET](https://docs.microsoft.com/learn/dotnet/?wt.mc_id=techcom_header-webpage-dotnet)
:::
:::

::: {.community-menu-item .tab-info-center}
[](/t5/Community-Info-Center/ct-p/Community-Info-Center){.community-menu-item-desktop-view}

::: {.c-glyph .community-menu-item-icon}

:::

::: community-menu-item-title
Lounge
:::

[](/t5/Community-Info-Center/ct-p/Community-Info-Center){.community-menu-item-mobile-view}

::: {.c-glyph .community-menu-item-icon}

:::

::: community-menu-item-title
Lounge
:::
:::
:::

-   [[776K]{#community-menu-wrapper-vitality-stat-count-1
    .community-menu-vitality-stat-count} [
    Members]{#community-menu-wrapper-vitality-stat-title-1
    .community-menu-vitality-stat-title}]{#community-menu-wrapper-vitality-stat-item-1}
-   [[7,457]{#community-menu-wrapper-vitality-stat-count-2
    .community-menu-vitality-stat-count} [
    Online]{#community-menu-wrapper-vitality-stat-title-2
    .community-menu-vitality-stat-title}]{#community-menu-wrapper-vitality-stat-item-2}
-   [[2M]{#community-menu-wrapper-vitality-stat-count-3
    .community-menu-vitality-stat-count} [
    Discussions]{#community-menu-wrapper-vitality-stat-title-3
    .community-menu-vitality-stat-title}]{#community-menu-wrapper-vitality-stat-item-3}
:::

::: nav-right
::: {#search_container}
::: {#search_btn}
Search []{.btn-search}
:::

::: {#search_slider .hidden}
::: custom-lia-search
::: {#lia-searchformV32_20eda2d830676c .SearchForm .lia-search-form-wrapper .lia-mode-default .lia-component-common-widget-search-form}
::: lia-inline-ajax-feedback
::: {#ajaxfeedback_20eda2d830676c .AjaxFeedback}
:::
:::

::: {#searchautocompletetoggle_20eda2d830676c}
::: lia-inline-ajax-feedback
::: {#ajaxfeedback_20eda2d830676c_0 .AjaxFeedback}
:::
:::

::: t-invisible
:::

::: lia-inline-ajax-feedback
::: {#feedback_20eda2d830676c .AjaxFeedback}
:::
:::

[ [ []{.lia-button-wrapper .lia-button-wrapper-secondary
.lia-button-wrapper-searchForm-action} ]{.lia-search-input-field}
]{.lia-search-input-wrapper} [cancel]{.lia-cancel-search}

::: {.search-autocomplete-toggle-link .lia-js-hidden}
[Turn on
suggestions](https://techcommunity.microsoft.com/t5/blogs/v2/blogarticlepage.enableautocomplete:enableautocomplete?t:ac=blog-id/Microsoft365PnPBlog/article-id/299&t:cp=action/contributions/searchactions){#enableAutoComplete_20eda2d830676c
.lia-link-navigation .auto-complete-toggle-on
.lia-link-ticket-post-action
.lia-component-search-action-enable-auto-complete} [
[[]{#display_20eda2d830676c .lia-img-icon-help .lia-fa-icon .lia-fa-help
.lia-fa
alt="Auto-suggest helps you quickly narrow down your search results by suggesting possible matches as you type."
aria-label="Help Icon" role="img"}](#){#link_20eda2d830676c
.lia-link-navigation .help-icon .lia-tooltip-trigger}]{.HelpIcon}

::: {#link_20eda2d830676c_0-tooltip-element .lia-content .lia-tooltip-pos-bottom-left .lia-panel-tooltip-wrapper role="alertdialog"}
::: lia-tooltip-arrow
:::

::: lia-panel-tooltip
::: content
Auto-suggest helps you quickly narrow down your search results by
suggesting possible matches as you type.
:::
:::
:::
:::
:::

::: spell-check-showing-result
Showing results for []{#showingResult_20eda2d830676c
.lia-link-navigation .show-results-for-link .lia-link-disabled}
[](#){#showingMoreResult_20eda2d830676c .lia-link-navigation
.more-synonym-search-results-for-link} [
]{.all-results-for-synonym-search}
:::

<div>

[ Show [](#){#synonymSearchInstead_20eda2d830676c .lia-link-navigation
.synonym-search-instead-for-link} only  ]{.synonym-search-instead
.lia-js-hidden} [ \| ]{.spell-check-and-synonym-search-instead
.lia-js-hidden} [ Search instead for [](#){#searchInstead_20eda2d830676c
.lia-link-navigation .search-instead-for-link}
]{.spell-check-search-instead}

</div>

::: {.spell-check-do-you-mean .lia-component-search-widget-spellcheck}
Did you mean: [](#){#doYouMean_20eda2d830676c .lia-link-navigation
.do-you-mean-link}
:::
:::
:::
:::
:::

::: sign-in-wrapper
[Sign
In](/plugins/common/feature/oauth2sso/sso_login_redirect?lang=en&referer=https%3A%2F%2Ftechcommunity.microsoft.com%2Ft5%2Fmicrosoft-365-pnp-blog%2Fhow-to-invite-external-users-to-a-sharepoint-site-or-microsoft%2Fba-p%2F2385603)
:::

::: notifications
::: notify-icon
[](/t5/notificationfeed/page)

::: lia-notifications-messages-aggregate
:::
:::

::: email-icon
[](/t5/notes/privatenotespage)

::: lia-notifications-messages-aggregate
:::
:::
:::

::: lia-component-common-widget-slide-out-user-menu
::: {.lia-user-navigation-sign-in .lia-component-users-action-login-with-avatar}
::: user-navigation-user-profile
[Sign
In](/plugins/common/feature/oauth2sso/sso_login_redirect?lang=en&referer=https%3A%2F%2Ftechcommunity.microsoft.com%2Ft5%2Fmicrosoft-365-pnp-blog%2Fhow-to-invite-external-users-to-a-sharepoint-site-or-microsoft%2Fba-p%2F2385603){#link_1_20eda2d97dc3e2
.lia-link-navigation .login-link .lia-authentication-link}
:::

::: {.UserAvatar .lia-user-avatar}
[](/plugins/common/feature/oauth2sso/sso_login_redirect?lang=en&referer=https%3A%2F%2Ftechcommunity.microsoft.com%2Ft5%2Fmicrosoft-365-pnp-blog%2Fhow-to-invite-external-users-to-a-sharepoint-site-or-microsoft%2Fba-p%2F2385603){#link_2_20eda2d97dc3e2
.lia-link-navigation .login-link .lia-authentication-link}

::: lia-anonymous-profile-icon
:::
:::
:::
:::
:::
:::
:::
:::
:::

::: notifications-overlay-notif
:::

::: notifications-overlay-mail
:::

::: notifications-overlay-favorites
:::
:::
:::
:::

::: {.lia-quilt-row .lia-quilt-row-sub-header}
::: {.lia-quilt-column .lia-quilt-column-18 .lia-quilt-column-left .lia-quilt-column-breadcrumb .lia-mark-empty}
:::

::: {.lia-quilt-column .lia-quilt-column-06 .lia-quilt-column-right .lia-quilt-column-search-content}
::: {.lia-quilt-column-alley .lia-quilt-column-alley-right}
::: custom-lia-search
::: {#lia-searchformV32 .SearchForm .lia-search-form-wrapper .lia-mode-default .lia-component-common-widget-search-form}
::: lia-inline-ajax-feedback
::: {#ajaxfeedback .AjaxFeedback}
:::
:::

::: {#searchautocompletetoggle}
::: lia-inline-ajax-feedback
::: {#ajaxfeedback_0 .AjaxFeedback}
:::
:::

::: t-invisible
:::

::: lia-inline-ajax-feedback
::: {#feedback .AjaxFeedback}
:::
:::

[ [ []{.lia-button-wrapper .lia-button-wrapper-secondary
.lia-button-wrapper-searchForm-action} ]{.lia-search-input-field}
]{.lia-search-input-wrapper} [cancel]{.lia-cancel-search}

::: {.search-autocomplete-toggle-link .lia-js-hidden}
[Turn on
suggestions](https://techcommunity.microsoft.com/t5/blogs/v2/blogarticlepage.enableautocomplete:enableautocomplete?t:ac=blog-id/Microsoft365PnPBlog/article-id/299&t:cp=action/contributions/searchactions){#enableAutoComplete
.lia-link-navigation .auto-complete-toggle-on
.lia-link-ticket-post-action
.lia-component-search-action-enable-auto-complete} [ [[]{#display
.lia-img-icon-help .lia-fa-icon .lia-fa-help .lia-fa
alt="Auto-suggest helps you quickly narrow down your search results by suggesting possible matches as you type."
aria-label="Help Icon" role="img"}](#){#link_0 .lia-link-navigation
.help-icon .lia-tooltip-trigger}]{.HelpIcon}

::: {#link_1-tooltip-element .lia-content .lia-tooltip-pos-bottom-left .lia-panel-tooltip-wrapper role="alertdialog"}
::: lia-tooltip-arrow
:::

::: lia-panel-tooltip
::: content
Auto-suggest helps you quickly narrow down your search results by
suggesting possible matches as you type.
:::
:::
:::
:::
:::

::: spell-check-showing-result
Showing results for []{#showingResult .lia-link-navigation
.show-results-for-link .lia-link-disabled} [](#){#showingMoreResult
.lia-link-navigation .more-synonym-search-results-for-link} [
]{.all-results-for-synonym-search}
:::

<div>

[ Show [](#){#synonymSearchInstead .lia-link-navigation
.synonym-search-instead-for-link} only  ]{.synonym-search-instead
.lia-js-hidden} [ \| ]{.spell-check-and-synonym-search-instead
.lia-js-hidden} [ Search instead for [](#){#searchInstead
.lia-link-navigation .search-instead-for-link}
]{.spell-check-search-instead}

</div>

::: {.spell-check-do-you-mean .lia-component-search-widget-spellcheck}
Did you mean: [](#){#doYouMean .lia-link-navigation .do-you-mean-link}
:::
:::
:::
:::
:::
:::

::: {.lia-quilt-row .lia-quilt-row-feedback}
::: {.lia-quilt-column .lia-quilt-column-24 .lia-quilt-column-single .lia-quilt-column-feedback}
::: {.lia-quilt-column-alley .lia-quilt-column-alley-single}
:::
:::
:::
:::

::: {.custom-nda-blog-article-page-header-banner .lia-mark-empty}
:::

::: {.community-live-events-banner-blog-article-page-wrapper .lia-mark-empty}
:::

::: custom-blog-article-page-header-wrapper
::: custom-common-widget-breadcrumb
::: {.custom-common-widget-breadcrumb-wrapper .hidden}
[Home](/){.BreadCrumb .home-nav-link}

::: {.BreadCrumb .crumb-line .lia-breadcrumb .lia-component-common-widget-breadcrumb aria-label="breadcrumbs" role="navigation"}
-   [Home](/){#link_20eda2dc2506fa .lia-link-navigation .crumb-community
    .lia-breadcrumb-community .lia-breadcrumb-forum}
-    []{#display_20eda2dc2506fa .lia-img-icon-list-separator-breadcrumb
    .lia-fa-icon .lia-fa-list .lia-fa-separator .lia-fa-breadcrumb
    .lia-fa alt="" aria-label="" role="img"}
-   [Microsoft 365
    PnP](/t5/microsoft-365-pnp/ct-p/Microsoft365PnP){#link_20eda2dc2506fa_0
    .lia-link-navigation .crumb-category .lia-breadcrumb-category
    .lia-breadcrumb-forum}
-    []{#display_20eda2dc2506fa_0
    .lia-img-icon-list-separator-breadcrumb .lia-fa-icon .lia-fa-list
    .lia-fa-separator .lia-fa-breadcrumb .lia-fa alt="" aria-label=""
    role="img"}
-   [Microsoft 365 PnP
    Blog](/t5/microsoft-365-pnp-blog/bg-p/Microsoft365PnPBlog){#link_20eda2dc2506fa_1
    .lia-link-navigation .crumb-board .lia-breadcrumb-board
    .lia-breadcrumb-forum}
-    []{#display_20eda2dc2506fa_1
    .lia-img-icon-list-separator-breadcrumb .lia-fa-icon .lia-fa-list
    .lia-fa-separator .lia-fa-breadcrumb .lia-fa alt="" aria-label=""
    role="img"}
-   [How to invite external users to a SharePoint site or Microsoft Team
    using Power Automate & Graph API]{#link_20eda2dc2506fa_2
    .lia-link-navigation .child-thread .lia-link-disabled
    aria-disabled="true" disabled="true" role="link"
    aria-label="How to invite external users to a SharePoint site or Microsoft Team using Power Automate &amp; Graph API"}
:::
:::
:::

::: {.lia-menu-bar .lia-discussion-page-discussion-navigator .lia-component-article-navigator}
::: lia-decoration-border-menu-bar
::: lia-decoration-border-menu-bar-top
<div>

</div>
:::

::: lia-decoration-border-menu-bar-content
<div>

::: lia-menu-bar-buttons
:::

::: {#threadnavigator .lia-paging-full-wrapper}
-   [[]{.lia-paging-page-arrow} [Back to
    Blog]{.lia-paging-page-link}](/t5/microsoft-365-pnp-blog/bg-p/Microsoft365PnPBlog "Microsoft 365 PnP Blog"){#link_2
    .lia-link-navigation}
-   [[]{.lia-paging-page-arrow} [Newer
    Article]{.lia-paging-page-link}](/t5/microsoft-365-pnp-blog/microsoft-365-developer-community-call-recording-27th-of-may/ba-p/2392027 "Microsoft 365 Developer Community Call recording – 27th of May, 2021"){#link_3
    .lia-link-navigation}
-   [[Older Article]{.lia-paging-page-link}
    []{.lia-paging-page-arrow}](/t5/microsoft-365-pnp-blog/spfx-webpart-form-validation-using-react-formik/ba-p/2386945 "SPFx webpart form validation using React Formik"){#link_4
    .lia-link-navigation}
:::

</div>
:::

::: lia-decoration-border-menu-bar-bottom
<div>

</div>
:::
:::
:::
:::
:::
:::
:::

::: {.lia-quilt-row .lia-quilt-row-main}
::: {.lia-quilt-column .lia-quilt-column-18 .lia-quilt-column-left .lia-quilt-column-main-content}
::: {.lia-quilt-column-alley .lia-quilt-column-alley-left}
::: ba-subject-header-wrapper
::: ba-subject-wrapper
::: ba-title
# How to invite external users to a SharePoint site or Microsoft Team using Power Automate & Graph API
:::

::: ba-option-wrapper
::: {.lia-menu-bar .top-block .lia-component-menu-bar-without-options}
::: lia-decoration-border-menu-bar
::: lia-decoration-border-menu-bar-top
<div>

</div>
:::

::: lia-decoration-border-menu-bar-content
<div>

::: lia-menu-bar-buttons
:::

</div>
:::

::: lia-decoration-border-menu-bar-bottom
<div>

</div>
:::
:::
:::
:::
:::

::: ba-author-and-metrics-wrapper
::: ba-author-wrapper
By

::: ba-author-info
[ ]{.UserName .lia-user-name}

::: UserAvatarWrapper
::: {.UserAvatar .lia-user-avatar .lia-component-common-widget-user-avatar .New .Contributor}
[![AshiqFaleel](https://techcommunity.microsoft.com/t5/image/serverpage/image-id/280812i7FC0F56A05729378/image-dimensions/150x150/image-coordinates/0%2C0%2C800%2C800?v=v2 "AshiqFaleel"){.lia-user-avatar-message
.user-rank-ring style=""
onerror="replaceBrokenAvatars(this, '/html/assets/default-avatar.png')"}](/t5/user/viewprofilepage/user-id/435366){.UserAvatar
.lia-link-navigation}
:::

::: {.user-profile-card user-id="435366"}
::: contents
::: spinner
:::
:::
:::
:::

::: user-login
[Mohamed Ashiq Faleel](/t5/user/viewprofilepage/user-id/435366)
:::
:::
:::

::: ba-metrics-info
[Published]{.ba-published-title} [May 26 2021 08:25
AM]{.ba-published-date} [ 7,090 Views ]{.ba-view-count}
:::
:::
:::

::: custom-blog-article-wrapper
::: {#messageview .lia-panel-message .message-uid-2385603 .lia-component-article lia-message-uid="2385603"}
::: {#messageView2_1 .lia-message-view-wrapper .lia-js-data-messageUid-2385603 .lia-component-forums-widget-message-view-two lia-message-uid="2385603"}
[ ]{#U2385603} [ ]{#M299}

::: lia-inline-ajax-feedback
::: {#ajaxfeedback_1 .AjaxFeedback}
:::
:::

::: {.MessageView .lia-message-view-blog-topic-message .lia-message-view-display .lia-row-standard-unread .lia-thread-topic}
[]{.lia-message-state-indicator}

::: {.lia-quilt .lia-quilt-blog-topic-message .lia-quilt-layout-one-column-message}
::: {.lia-quilt-row .lia-quilt-row-header}
::: {.lia-quilt-column .lia-quilt-column-16 .lia-quilt-column-left .lia-quilt-column-header-left}
::: {.lia-quilt-column-alley .lia-quilt-column-alley-left}
::: {.lia-message-author-avatar .lia-component-author-avatar .lia-component-message-view-widget-author-avatar}
::: UserAvatarWrapper
::: {.UserAvatar .lia-user-avatar .lia-component-common-widget-user-avatar .New .Contributor}
[![AshiqFaleel](https://techcommunity.microsoft.com/t5/image/serverpage/image-id/280812i7FC0F56A05729378/image-dimensions/40x40?v=v2 "AshiqFaleel"){.lia-user-avatar-message
.user-rank-ring style=""
onerror="replaceBrokenAvatars(this, '/html/assets/default-avatar.png')"}](/t5/user/viewprofilepage/user-id/435366){.UserAvatar
.lia-link-navigation}
:::

::: {.user-profile-card user-id="435366"}
::: contents
::: spinner
:::
:::
:::
:::
:::

::: lia-message-author-with-avatar
[
[AshiqFaleel](https://techcommunity.microsoft.com/t5/user/viewprofilepage/user-id/435366){#link_5
.lia-link-navigation .lia-page-link .lia-user-name-link} ]{.UserName
.lia-user-name .lia-user-rank-New-Contributor
.lia-component-message-view-widget-author-username}
:::

::: {.lia-message-author-rank .lia-component-author-rank .lia-component-message-view-widget-author-rank}
New Contributor
:::
:::
:::

::: {.lia-quilt-column .lia-quilt-column-08 .lia-quilt-column-right .lia-quilt-column-header-right}
::: {.lia-quilt-column-alley .lia-quilt-column-alley-right}
::: {.lia-message-post-date .lia-component-post-date .lia-component-message-view-widget-post-date title="Posted on"}
[ [‎May 26 2021]{.local-date} [08:25 AM]{.local-time} ]{.DateTime}
:::

::: {#actionMenuDropDown .lia-menu-navigation-wrapper .lia-js-hidden .lia-menu-action .lia-component-message-view-widget-action-menu}
::: lia-menu-navigation
::: dropdown-default-item
[](# "Show option menu"){#dropDownLink .lia-js-menu-opener
.default-menu-option .lia-js-mouseover-menu .lia-link-navigation}

::: dropdown-positioning
::: dropdown-positioning-static
-   [Subscribe to RSS
    Feed](/gxcuf89792/rss/message?board.id=Microsoft365PnPBlog&message.id=299){#rssThread
    .lia-link-navigation .rss-thread-link
    .lia-component-rss-action-thread}
-   [ []{.lia-separator-post} []{.lia-separator-pre} ]{.lia-separator
    .lia-component-common-widget-link-separator}
-   [Mark as New]{#markThreadUnread .lia-link-navigation
    .mark-thread-unread .lia-link-disabled
    .lia-component-forums-action-mark-thread-unread}
-   [Mark as Read]{#markThreadRead .lia-link-navigation
    .mark-thread-read .lia-link-disabled
    .lia-component-forums-action-mark-thread-read}
-   [ []{.lia-separator-post} []{.lia-separator-pre} ]{.lia-separator
    .lia-component-common-widget-link-separator}
-   [Bookmark]{#addThreadUserBookmark .lia-link-navigation
    .addThreadUserBookmark .lia-link-disabled
    .lia-component-subscriptions-action-add-thread-user-bookmark}
-   [Subscribe]{#addThreadUserEmailSubscription .lia-link-navigation
    .addThreadUserEmailSubscription .lia-link-disabled
    .lia-component-subscriptions-action-add-thread-user-email}
-   [ []{.lia-separator-post} []{.lia-separator-pre} ]{.lia-separator
    .lia-component-common-widget-link-separator}
-   [Email to a Friend]{#emailMessageToFriend .lia-link-navigation
    .email_friend .lia-link-disabled
    .lia-component-forums-action-email-message-to-friend}
-   [ []{.lia-separator-post} []{.lia-separator-pre} ]{.lia-separator
    .lia-component-common-widget-link-separator}
-   [Printer Friendly
    Page](/t5/blogs/blogarticleprintpage/blog-id/Microsoft365PnPBlog/article-id/299){#printThread
    .lia-link-navigation .print-article
    .lia-component-forums-action-print-thread}
-   [Report Inappropriate
    Content](/t5/notifications/notifymoderatorpage/message-uid/2385603){#reportAbuse
    .lia-link-navigation .report-abuse-link
    .lia-component-forums-action-report-abuse}
:::
:::
:::
:::
:::
:::
:::
:::

::: {.lia-quilt-row .lia-quilt-row-main}
::: {.lia-quilt-column .lia-quilt-column-24 .lia-quilt-column-single .lia-quilt-column-main}
::: {.lia-quilt-column-alley .lia-quilt-column-alley-single}
::: {.lia-message-subject-wrapper .lia-component-subject .lia-component-message-view-widget-subject-with-options}
::: MessageSubject
::: MessageSubjectIcons
# [ [How to invite external users to a SharePoint site or Microsoft Team using Power Automate & Graph API](/t5/microsoft-365-pnp-blog/how-to-invite-external-users-to-a-sharepoint-site-or-microsoft/ba-p/2385603){#link_6 .page-link .lia-link-navigation .lia-custom-event} ]{.lia-message-unread} {#how-to-invite-external-users-to-a-sharepoint-site-or-microsoft-team-using-power-automate-graph-api-1 .message-subject itemprop="name"}

[]{#display_2 .lia-img-message-has-url .lia-fa-message .lia-fa-has
.lia-fa-url .lia-fa title="Contains a hyperlink"
alt="Message contains a hyperlink" aria-label="Contains a hyperlink"
role="img"} []{#display_3 .lia-img-message-has-image .lia-fa-message
.lia-fa-has .lia-fa-image .lia-fa title="Contains an image"
alt="Message contains an image" aria-label="Contains an image"
role="img"}
:::
:::
:::

::: {.lia-message-post-date .lia-component-post-date .lia-component-message-view-widget-post-date title="Posted on"}
[ [‎May 26 2021]{.local-date} [08:25 AM]{.local-time} ]{.DateTime}
:::

::: {.lia-message-body-wrapper .lia-component-message-view-widget-body}
::: {#bodyDisplay .lia-message-body itemprop="text"}
::: lia-message-body-content
SharePoint and Microsoft teams services in Microsoft 365 makes it easier
to share content and collaborate with external users who is outside your
organization. A guest or external user is someone who do not have a
school or work account with your organization, they can be your partner,
vendor, customer etc. In this article let us see how to build a
self-registration experience for external users with the help of
Microsoft Forms & Power Automate to onboard them to a

-   SharePoint online site
-   Microsoft Team

## Microsoft Form to collect details from External User: {#toc-hId--464161509}

To start building this experience, create a Microsoft form with the
setting **Anyone can respond** and with fields (Name, Email address etc)
to collect information from the external user to send invitation.

## [![MSForm-ExternalUserdetails.png](https://techcommunity.microsoft.com/t5/image/serverpage/image-id/283744i5EE743018235BE28/image-size/large?v=v2&px=999 "MSForm-ExternalUserdetails.png"){.lia-media-image role="button" li-image-url="https://techcommunity.microsoft.com/t5/image/serverpage/image-id/283744i5EE743018235BE28?v=v2" li-image-display-id="'283744i5EE743018235BE28'" li-message-uid="'2385603'" li-messages-message-image="true" li-bindable="" tabindex="0" li-bypass-lightbox-when-linked="true" li-use-hover-links="false"}]{.lia-inline-image-display-wrapper .lia-image-align-inline image-alt="MSForm-ExternalUserdetails.png" style="width: 605px;"} {#toc-hId-2023351324}

## Azure Active Directory Application registration: {#toc-hId-215896861}

The next step after creating the form is to register an [application in
Azure
AD](https://docs.microsoft.com/en-us/azure/active-directory/develop/quickstart-register-app)
with Microsoft graph API permission to send invitation to external user.
After the app is registered obtain the client id, client secret & tenant
id to be used in the Power Automate flow further down this article to
generate the JSON webtoken to access Microsoft Graph API for sending
invitation. Find below screenshot with the permission User.Invite.All
added to the app. Keep in mind the permission requires Admin consent.

[![AdApp-GraphPermissiontoInviteGuestUser.png](https://techcommunity.microsoft.com/t5/image/serverpage/image-id/283747iBFCAE7000FA85663/image-size/large?v=v2&px=999 "AdApp-GraphPermissiontoInviteGuestUser.png"){.lia-media-image
role="button"
li-image-url="https://techcommunity.microsoft.com/t5/image/serverpage/image-id/283747iBFCAE7000FA85663?v=v2"
li-image-display-id="'283747iBFCAE7000FA85663'"
li-message-uid="'2385603'" li-messages-message-image="true"
li-bindable="" tabindex="0" li-bypass-lightbox-when-linked="true"
li-use-hover-links="false"}]{.lia-inline-image-display-wrapper
.lia-image-align-inline
image-alt="AdApp-GraphPermissiontoInviteGuestUser.png"
style="width: 605px;"}

There is also delegated permission available for User.Invite.All.

# Onboard External users to a SharePoint online site: {#toc-hId-205393757}

Once the Microsoft form is ready, we can start building the Power
Automate flow which can send the email invitation to the external user
and for granting access to the SharePoint site. The [external
sharing](https://docs.microsoft.com/en-us/sharepoint/external-sharing-overview)
features of SharePoint Online enables users in your organization share
content with people outside the organization. There is no limit to the
number of guests you can invite to SharePoint sites as per this
[SharePoint online
limits](https://docs.microsoft.com/en-us/office365/servicedescriptions/sharepoint-online-service-description/sharepoint-online-limits#users)
documentation. Find below steps to create the Power Automate flow with a
custom approval on a Microsoft Team

## Power Automate Flow: {#toc-hId-895955231}

Create an Automated flow with the trigger **When a new response is
submitted** with the above form name selected on the dropdown and then
add the action **Get response details** with the **Response Id**
selected from the dynamic content for the trigger to get the form
details submitted in the Microsoft form by the external user. Find
screenshot below

[![MSFormTrigger-ExternalUser.png](https://techcommunity.microsoft.com/t5/image/serverpage/image-id/283749iE72C51E732F69B83/image-size/large?v=v2&px=999 "MSFormTrigger-ExternalUser.png"){.lia-media-image
role="button"
li-image-url="https://techcommunity.microsoft.com/t5/image/serverpage/image-id/283749iE72C51E732F69B83?v=v2"
li-image-display-id="'283749iE72C51E732F69B83'"
li-message-uid="'2385603'" li-messages-message-image="true"
li-bindable="" tabindex="0" li-bypass-lightbox-when-linked="true"
li-use-hover-links="false"}]{.lia-inline-image-display-wrapper
.lia-image-align-inline image-alt="MSFormTrigger-ExternalUser.png"
style="width: 605px;"}

## Adaptive card for Teams Approval: {#toc-hId--911499232}

For the Approval in Microsoft Teams, I have used a custom card created
from the [Adaptive card designer](https://adaptivecards.io/designer/)
with elements **ColumnSet, TextBlock** to display information submitted
in the form & **action button** Approve and Reject to take further
action by a Microsoft teams user to proceed with Invitation for the
Guest account creation. Find screenshot below from the adaptive card
designer

[![AdaptiveCard-DesignforApproval.png](https://techcommunity.microsoft.com/t5/image/serverpage/image-id/283751i05981D49C0025718/image-size/large?v=v2&px=999 "AdaptiveCard-DesignforApproval.png"){.lia-media-image
role="button"
li-image-url="https://techcommunity.microsoft.com/t5/image/serverpage/image-id/283751i05981D49C0025718?v=v2"
li-image-display-id="'283751i05981D49C0025718'"
li-message-uid="'2385603'" li-messages-message-image="true"
li-bindable="" tabindex="0" li-bypass-lightbox-when-linked="true"
li-use-hover-links="false"}]{.lia-inline-image-display-wrapper
.lia-image-align-inline image-alt="AdaptiveCard-DesignforApproval.png"
style="width: 605px;"}

 

1.  After the card is designed, copy the card payload from the designer
    and go to the flow and then add the action **Post adaptive card and
    wait for a response** and make appropriate selection on the
    available fields as shown below
    -   **Post as**: Flow bot
    -   **Post in**: Channel
    -   **Message**: Payload copied from designer. Replace the fields
        for usrName & userEmail selected from the dynamic content from
        the outputs of the action **Get response details**. The created
        on textBlock element has the flow expression
        formatDateTime(utcNow(),\'g\') to display the current datetime
        information on the card.

[![AdaptiveCard-PAFlow-POSTAdatptivecardandwaitforresponse1.png](https://techcommunity.microsoft.com/t5/image/serverpage/image-id/283832iE97C226E1847A51C/image-size/large?v=v2&px=999 "AdaptiveCard-PAFlow-POSTAdatptivecardandwaitforresponse1.png"){.lia-media-image
role="button"
li-image-url="https://techcommunity.microsoft.com/t5/image/serverpage/image-id/283832iE97C226E1847A51C?v=v2"
li-image-display-id="'283832iE97C226E1847A51C'"
li-message-uid="'2385603'" li-messages-message-image="true"
li-bindable="" tabindex="0" li-bypass-lightbox-when-linked="true"
li-use-hover-links="false"}]{.lia-inline-image-display-wrapper
.lia-image-align-inline
image-alt="AdaptiveCard-PAFlow-POSTAdatptivecardandwaitforresponse1.png"
style="width: 605px;"}

[![AdaptiveCard-PAFlow-POSTAdatptivecardandwaitforresponse2.png](https://techcommunity.microsoft.com/t5/image/serverpage/image-id/283834i108906E5F5F321C1/image-size/large?v=v2&px=999 "AdaptiveCard-PAFlow-POSTAdatptivecardandwaitforresponse2.png"){.lia-media-image
role="button"
li-image-url="https://techcommunity.microsoft.com/t5/image/serverpage/image-id/283834i108906E5F5F321C1?v=v2"
li-image-display-id="'283834i108906E5F5F321C1'"
li-message-uid="'2385603'" li-messages-message-image="true"
li-bindable="" tabindex="0" li-bypass-lightbox-when-linked="true"
li-use-hover-links="false"}]{.lia-inline-image-display-wrapper
.lia-image-align-inline
image-alt="AdaptiveCard-PAFlow-POSTAdatptivecardandwaitforresponse2.png"
style="width: 601px;"}

-   **Update Message**: Custom message which appear after an action
    taken in Microsoft Teams
-   **Team**: Select the Team where you would like to post the card
-   **Channel**: Select the channel from the Microsoft Team where you
    would like to have the approval adaptive card posted

Card payload:

 

``` {.lia-code-sample .language-applescript}
{
    "type": "AdaptiveCard",
    "body": [
        {
            "type": "TextBlock",
            "weight": "Bolder",
            "text": "Approval for adding the External User",
            "wrap": true
        },
        {
            "type": "TextBlock",
            "spacing": "None",
            "text": "Created Add flow expression to get current date",
            "isSubtle": true,
            "wrap": true
        },
        {
            "type": "ColumnSet",
            "columns": [
                {
                    "type": "Column",
                    "items": [
                        {
                            "type": "TextBlock",
                            "text": "Name:",
                            "wrap": true,
                            "size": "Medium",
                            "weight": "Bolder"
                        },
                        {
                            "type": "TextBlock",
                            "text": "Email:",
                            "wrap": true,
                            "weight": "Bolder",
                            "size": "Medium"
                        }
                    ],
                    "width": "stretch"
                },
                {
                    "type": "Column",
                    "width": "stretch",
                    "items": [
                        {
                            "type": "TextBlock",
                            "text": "usrName-Replace it from Microsoft Form",
                            "wrap": true
                        },
                        {
                            "type": "TextBlock",
                            "text": "userEmail-Replace it from Microsoft Form ",
                            "wrap": true
                        }
                    ]
                }
            ]
        }
    ],
    "actions": [
        {
            "type": "Action.Submit",
            "title": "Approve",
            "id": "btnApprove"
        },
        {
            "type": "Action.Submit",
            "title": "Reject",
            "id": "btnReject"
        }
    ],
    "$schema": "http://adaptivecards.io/schemas/adaptive-card.json",
    "version": "1.0"
}
```

 

 

2.  The above adaptive card is used to get approval from the
    Organization teams user based on the information submitted by the
    external user in the Microsoft form to proceed with the next steps
    for sending the guest account invite. Now we will have to identify
    if the user has clicked the button Approve or Reject. This
    information can be easily obtained from the Outputs of the action.

**Note**: Adaptive card can also be sent using a Microsoft Graph API
with the card payload in Attachments field

<https://docs.microsoft.com/en-us/graph/api/channel-post-messages?view=graph-rest-beta&tabs=http>

### Adaptive card for Teams - Dynamic content Missing: {#toc-hId--220937758}

As of the time I am writing this article there is an issue in getting
the output as dynamic content for the **Post adaptive card and wait for
a response** action if there is dynamic content added on the JSON
Payload (Name, Email from Forms). The fix is to run the flow till the
post adaptive card action and take an action on Microsoft teams by
clicking either Approve or Reject and then go to the Flow run from the
history as shown below

[![AdaptiveCard-PAFlow-POSTAdatptivecardandwaitforresponseRunHistory.png](https://techcommunity.microsoft.com/t5/image/serverpage/image-id/283841i0F0F0D886B748997/image-size/large?v=v2&px=999 "AdaptiveCard-PAFlow-POSTAdatptivecardandwaitforresponseRunHistory.png"){.lia-media-image
role="button"
li-image-url="https://techcommunity.microsoft.com/t5/image/serverpage/image-id/283841i0F0F0D886B748997?v=v2"
li-image-display-id="'283841i0F0F0D886B748997'"
li-message-uid="'2385603'" li-messages-message-image="true"
li-bindable="" tabindex="0" li-bypass-lightbox-when-linked="true"
li-use-hover-links="false"}]{.lia-inline-image-display-wrapper
.lia-image-align-inline
image-alt="AdaptiveCard-PAFlow-POSTAdatptivecardandwaitforresponseRunHistory.png"
style="width: 605px;"}

From the above screenshot, we can see if the user has clicked the
Approve or Reject button from the field **submitActionId**. To get this
value in Flow, use the expression

 

``` {.lia-code-sample .language-applescript}
outputs('Post_adaptive_card_and_wait_for_a_response').body.submitActionId
```

 

or

 

``` {.lia-code-sample .language-applescript}
@outputs('Post_adaptive_card_and_wait_for_a_response')?['body/submitActionId']
```

 

Spaces in the name of the action is replaced with underscore.

To get the userPrincipalName, the expression is

 

``` {.lia-code-sample .language-applescript}
outputs('Post_adaptive_card_and_wait_for_a_response').body.responder.userPrincipalName
```

 

or

 

``` {.lia-code-sample .language-applescript}
@outputs('Post_adaptive_card_and_wait_for_a_response')?['body/responder/userPrincipalName']
```

 

To get the submitActionId, enter the expression
outputs(\'Post_adaptive_card_and_wait_for_a\_response\').body.submitActionId
in the compose action, then add a condition control to decide action
based on users approval

[![AdaptiveCard-cardactionoutput.png](https://techcommunity.microsoft.com/t5/image/serverpage/image-id/283843iEA966FE976A43528/image-size/large?v=v2&px=999 "AdaptiveCard-cardactionoutput.png"){.lia-media-image
role="button"
li-image-url="https://techcommunity.microsoft.com/t5/image/serverpage/image-id/283843iEA966FE976A43528?v=v2"
li-image-display-id="'283843iEA966FE976A43528'"
li-message-uid="'2385603'" li-messages-message-image="true"
li-bindable="" tabindex="0" li-bypass-lightbox-when-linked="true"
li-use-hover-links="false"}]{.lia-inline-image-display-wrapper
.lia-image-align-inline image-alt="AdaptiveCard-cardactionoutput.png"
style="width: 605px;"}

I have observed this issue occurs in other team's adaptive card actions
as well, the above fix should work. Now we can implement the logic to
send the Guest Invitation using Microsoft Graph API. To send the
invite, we will use the Azure AD application registered above.

## Generate JSON Web token to Access Graph API: {#toc-hId--231440862}

Be ready with the ClientId, Client Secret and Tenant Id collected from
the AD app registration you have done initially. The only authentication
flow to generate a access token for application permissions is [Client
credentials](https://docs.microsoft.com/en-us/azure/active-directory/develop/msal-authentication-flows#client-credentials).

To generate a token

1.  Store the Client Secret on a String variable or a compose action
2.  Make a HTTP request using the HTTP connector with the following
    details. Make sure to replace the string for tenantId,
    azureAdAppclientId and azureAdAppclientSecret

Add a HTTP connector action to the flow for making a POST request per
the following information

**HTTP Method**: POST

**URI**:
<https://login.microsoftonline.com/yourtenantId/oauth2/v2.0/token>

**Headers**:

[*Key*]{.underline}: Content-Type

[*Value*]{.underline}: application/x-www-form-urlencoded

**Body**:

 

 

``` {.lia-code-sample .language-applescript}
tenant=yourtenantId&client_id=azureAdAppclientId&client_secret=@{decodeUriComponent(variables('azureAdAppclientSecret'))}&grant_type=client_credentials&scope=https://graph.microsoft.com/.default
```

 

 

For the client secret make sure to URL encode using the expression
encodeUriComponent(variables('clientSecret')) else the request will fail
due to the presence of special characters.

[![MSGraph-GenerateJSONWebToken.png](https://techcommunity.microsoft.com/t5/image/serverpage/image-id/283871i7259E97855CDF538/image-size/large?v=v2&px=999 "MSGraph-GenerateJSONWebToken.png"){.lia-media-image
role="button"
li-image-url="https://techcommunity.microsoft.com/t5/image/serverpage/image-id/283871i7259E97855CDF538?v=v2"
li-image-display-id="'283871i7259E97855CDF538'"
li-message-uid="'2385603'" li-messages-message-image="true"
li-bindable="" tabindex="0" li-bypass-lightbox-when-linked="true"
li-use-hover-links="false"}]{.lia-inline-image-display-wrapper
.lia-image-align-inline image-alt="MSGraph-GenerateJSONWebToken.png"
style="width: 605px;"}

In the above screen, I have added a compose action to store the
SharePoint site address to be used for granting the external user access
to. To extract the token from the above request, add the parse JSON
action with Content from the **HTTP request body** and the following
schema

 

 

``` {.lia-code-sample .language-applescript}
{
    "type": "object",
    "properties": {
        "token_type": {
            "type": "string"
        },
        "scope": {
            "type": "string"
        },
        "expires_in": {
            "type": "integer"
        },
        "ext_expires_in": {
            "type": "integer"
        },
        "access_token": {
            "type": "string"
        },
        "refresh_token": {
            "type": "string"
        }
    }
}
```

 

 

[![MSGraph-ParseJSONWebToken.png](https://techcommunity.microsoft.com/t5/image/serverpage/image-id/283872i0847D6A0FE6B53E1/image-size/large?v=v2&px=999 "MSGraph-ParseJSONWebToken.png"){.lia-media-image
role="button"
li-image-url="https://techcommunity.microsoft.com/t5/image/serverpage/image-id/283872i0847D6A0FE6B53E1?v=v2"
li-image-display-id="'283872i0847D6A0FE6B53E1'"
li-message-uid="'2385603'" li-messages-message-image="true"
li-bindable="" tabindex="0" li-bypass-lightbox-when-linked="true"
li-use-hover-links="false"}]{.lia-inline-image-display-wrapper
.lia-image-align-inline image-alt="MSGraph-ParseJSONWebToken.png"
style="width: 605px;"}

Include the access token when calling the Microsoft Graph API on the
Headers section or raw as shown in the next section.

## Send Invitation using Microsoft Graph API: {#toc-hId--2038895325}

Before sending the invitation, validate if the user already exists in
your organization AD tenant by using the email address of the external
user with the help of the action **Search for users** as shown below

[![SearchforexternalUser.png](https://techcommunity.microsoft.com/t5/image/serverpage/image-id/283873i5D856C72A794F8F8/image-size/large?v=v2&px=999 "SearchforexternalUser.png"){.lia-media-image
role="button"
li-image-url="https://techcommunity.microsoft.com/t5/image/serverpage/image-id/283873i5D856C72A794F8F8?v=v2"
li-image-display-id="'283873i5D856C72A794F8F8'"
li-message-uid="'2385603'" li-messages-message-image="true"
li-bindable="" tabindex="0" li-bypass-lightbox-when-linked="true"
li-use-hover-links="false"}]{.lia-inline-image-display-wrapper
.lia-image-align-inline image-alt="SearchforexternalUser.png"
style="width: 605px;"}

 

If there is null response for the action **Search for users**, then the
user does not exist. This can be calculated using the expression length
and by passing the value as a parameter, if it is equals zero then the
external user does not exist. If the user already exists, we can
directly proceed to granting the external user access to SharePoint.

Graph API to check if a guest user already exists:

[https://graph.microsoft.com/v1.0/users?\$filter=UserType eq
\'Guest\'&\$filter=mail eq
exteruseremailadd\...](https://graph.microsoft.com/v1.0/users?$filter=UserType%20eq%20'Guest'&$filter=mail%20eq%20exteruseremailaddress@domain.com') 

or

[https://graph.microsoft.com/v1.0/users?\$filter=startswith(mail,\'[exteruseremailaddress\@domain.com]{.underline}\')](https://graph.microsoft.com/v1.0/users?$filter=startswith(mail,'fejom29487@troikos.com'))

Find below the Graph API endpoint http request details to [invite the
external
user](https://docs.microsoft.com/en-us/graph/api/invitation-post?view=graph-rest-1.0&tabs=http)

**Method**: POST

**URL**: <https://graph.microsoft.com/v1.0/invitations>

**Request Body**:

 

 

``` {.lia-code-sample .language-applescript}
{
  "invitedUserDisplayName": "External User Name",
  "invitedUserEmailAddress": "External User Email Address",
  "sendInvitationMessage": true,
  "inviteRedirectUrl": "SharePoint site URL or any URL",
  "invitedUserMessageInfo": {
    "messageLanguage": "en-US",
    "customizedMessageBody": "Welcome to the M365PAL SharePoint site! Click the link below and sign in."
  }
}
```

 

 

[![MSGraph-SendInvitationforExternaluser.png](https://techcommunity.microsoft.com/t5/image/serverpage/image-id/283874iB97155249F988658/image-size/large?v=v2&px=999 "MSGraph-SendInvitationforExternaluser.png"){.lia-media-image
role="button"
li-image-url="https://techcommunity.microsoft.com/t5/image/serverpage/image-id/283874iB97155249F988658?v=v2"
li-image-display-id="'283874iB97155249F988658'"
li-message-uid="'2385603'" li-messages-message-image="true"
li-bindable="" tabindex="0" li-bypass-lightbox-when-linked="true"
li-use-hover-links="false"}]{.lia-inline-image-display-wrapper
.lia-image-align-inline
image-alt="MSGraph-SendInvitationforExternaluser.png"
style="width: 605px;"}

In HTTP request body, use the dynamic content of the form to populate
the fields invitedUserDisplayName & Emailaddress. The invite redirectUri
is the output of the compose action which has the SharePoint site url. I
have added a delay of one minute before granting access to SharePoint
site for the external user, this step is to make sure there is an entry
in Azure AD for the external user/guest account.

Custom connector can be used for calling the Graph API for sending
invitations instead of using HTTP connector, you can refer to the post
[Call Microsoft Graph API in Power Apps and Power Automate using a
Custom
connector](https://ashiqf.com/2021/03/16/call-microsoft-graph-api-in-power-apps-and-power-automate-using-a-custom-connector/)
for detailed instructions.

## Grant Access to SharePoint site for the external user: {#toc-hId-448617508}

As soon as the guest account invite is sent from the above Microsoft
graph API request HTTP action, it is time to grant access to the
SharePoint site for the external user. There is a SharePoint REST API
endpoint to add a user to a SharePoint group (Owners, Member, Visitors),
find below the request details

**Request URL**: [https://tenantname.sharepoint.com/sites/siteName/
\_api/web/sitegroups/GetById(groupId)/users](https://tenantname.sharepoint.com/sites/siteName/%20_api/web/sitegroups/GetById(groupId)/users)

For the groupId to the corresponding SharePoint group, refer to the
following table

  ---------------------- -------------
  **SharePoint Group**   **GroupId**
  Owners                 3
  Members                5
  Visitors               4
  ---------------------- -------------

 

**Headers**:

[*Key*]{.underline}: accept [*value*]{.underline}:
application/json;odata.metadata=none

[*Key*]{.underline}: content-type [*value*]{.underline}:
application/json

**Body**:

 

``` {.lia-code-sample .language-applescript}
{'LoginName':'i:0#.f|membership|userPrinipalNameorEmailaddressofExternalUser'}
```

 

For the external user, the email address used to send the invite works.

Go back to the flow and add the action **Send an HTTP request to
SharePoint** to call the above REST api. Find below the screenshot of
the action

[![AddUsertoSharePointGroup.png](https://techcommunity.microsoft.com/t5/image/serverpage/image-id/283876i3A58AC17FEAE1E79/image-size/large?v=v2&px=999 "AddUsertoSharePointGroup.png"){.lia-media-image
role="button"
li-image-url="https://techcommunity.microsoft.com/t5/image/serverpage/image-id/283876i3A58AC17FEAE1E79?v=v2"
li-image-display-id="'283876i3A58AC17FEAE1E79'"
li-message-uid="'2385603'" li-messages-message-image="true"
li-bindable="" tabindex="0" li-bypass-lightbox-when-linked="true"
li-use-hover-links="false"}]{.lia-inline-image-display-wrapper
.lia-image-align-inline image-alt="AddUsertoSharePointGroup.png"
style="width: 605px;"}

The above action uses delegated permission, the user of the connection
should have access to the SharePoint site. As of now, there is no Graph
API for adding the user to a SharePoint group but you can register an
app in Active directory and add permission for SharePoint to call the
above REST API. Refer to the documentation [Granting access via Azure AD
App-Only](https://docs.microsoft.com/en-us/sharepoint/dev/solution-guidance/security-apponly-azuread)
for calling the REST API using the registered AD app.

## Testing the flow: {#toc-hId-314932784}

The whole flow can now be tested by submitting the form which sends the
adaptive card on Teams first as shown below

[![AdaptiveCard-InTeamsChannel.png](https://techcommunity.microsoft.com/t5/image/serverpage/image-id/283877i2CAE3F5DAFF07A49/image-size/large?v=v2&px=999 "AdaptiveCard-InTeamsChannel.png"){.lia-media-image
role="button"
li-image-url="https://techcommunity.microsoft.com/t5/image/serverpage/image-id/283877i2CAE3F5DAFF07A49?v=v2"
li-image-display-id="'283877i2CAE3F5DAFF07A49'"
li-message-uid="'2385603'" li-messages-message-image="true"
li-bindable="" tabindex="0" li-bypass-lightbox-when-linked="true"
li-use-hover-links="false"}]{.lia-inline-image-display-wrapper
.lia-image-align-inline image-alt="AdaptiveCard-InTeamsChannel.png"
style="width: 605px;"}

After the card is approved, the invite is sent to the external user.
After the external user accepts the invite, the user should be
automatically redirected to the SharePoint site with the appropriate
access. The access to the SharePoint site for the external user can be
validated by the checking the membership of the SharePoint group in the
site even before the user accepts the invitation. The site members can
also be validated by accessing the URL for All users list:

<https://tenantName.sharepoint.com/sites/siteName/_layouts/15/people.aspx?MembershipGroupId=0>

This approach of granting access to SharePoint site for external user
can be applied to internal users by [turning off the access
requests](https://support.microsoft.com/en-us/office/set-up-and-manage-access-requests-94b26e0b-2822-49d4-929a-8455698654b3).

## Limit External Sharing by domain: {#toc-hId--1492521679}

The external sharing on SharePoint can be restricted based on domain of
the external user. To enable the setting login into the SharePoint admin
center \> Policies \> Sharing \> Enable the checkbox Limit external
sharing by domain \> Add domain

[![ExternalSharing-RestrictDomain.png](https://techcommunity.microsoft.com/t5/image/serverpage/image-id/283878i2BCE04FF59AD8213/image-size/large?v=v2&px=999 "ExternalSharing-RestrictDomain.png"){.lia-media-image
role="button"
li-image-url="https://techcommunity.microsoft.com/t5/image/serverpage/image-id/283878i2BCE04FF59AD8213?v=v2"
li-image-display-id="'283878i2BCE04FF59AD8213'"
li-message-uid="'2385603'" li-messages-message-image="true"
li-bindable="" tabindex="0" li-bypass-lightbox-when-linked="true"
li-use-hover-links="false"}]{.lia-inline-image-display-wrapper
.lia-image-align-inline image-alt="ExternalSharing-RestrictDomain.png"
style="width: 605px;"}

# Onboard External users to a Microsoft Team: {#toc-hId-865908435}

To onboard the external user to a Microsoft Team, the only change to the
above flow is, instead of adding the user to the SharePoint group the
user must be added as a Member to the Microsoft 365 group connected to
the Microsoft Teams. The graph API to [add a
member](https://docs.microsoft.com/en-us/graph/api/team-post-members?view=graph-rest-1.0&tabs=http)
to a Microsoft Team is

**Request Type**: POST

**Request URL**:
[https://graph.microsoft.com/v1.0/teams/{team-id}/members](https://graph.microsoft.com/v1.0/teams/%7bteam-id%7d/members)

The team-id is the Microsoft 365 group object Id, as there is always a
Microsoft 365 group connected to a Microsoft Team.

**Body**:

 

``` {.lia-code-sample .language-applescript}
{
    "@odata.type": "#microsoft.graph.aadUserConversationMember",
    "roles": ["owner"],
    "user@odata.bind": "https://graph.microsoft.com/v1.0/users(userObjectIdofGuest')"
}
```

 

The expression to get the user object Id of the external user as per the
below screenshot is

 

``` {.lia-code-sample .language-applescript}
outputs('HTTP-SendGuestInvitation').body.invitedUser.Id
```

 

 

The expression can be used in a compose action to get the Object Id of
the external user which can be used in the Graph API request to add the
member to a Team. **HTTP-SendGuestInvitation** is the name of the HTTP
Action.

[![externalUserObjectId.png](https://techcommunity.microsoft.com/t5/image/serverpage/image-id/283882i30DB43DB52F61917/image-size/large?v=v2&px=999 "externalUserObjectId.png"){.lia-media-image
role="button"
li-image-url="https://techcommunity.microsoft.com/t5/image/serverpage/image-id/283882i30DB43DB52F61917?v=v2"
li-image-display-id="'283882i30DB43DB52F61917'"
li-message-uid="'2385603'" li-messages-message-image="true"
li-bindable="" tabindex="0" li-bypass-lightbox-when-linked="true"
li-use-hover-links="false"}]{.lia-inline-image-display-wrapper
.lia-image-align-inline image-alt="externalUserObjectId.png"
style="width: 605px;"}

## Permission for the Azure AD App to add a member to a Microsoft Team: {#toc-hId--812463309}

The application permission Group.ReadWrite.All has to be added on the
Azure AD app, if you are going to be using the same JSON webtoken
generated above. There is delegated permission as well for adding
members.

<https://graph.microsoft.com/Group.ReadWrite.All>

I recommend you read the following documentation from Microsoft for
External sharing

<https://docs.microsoft.com/en-us/microsoftteams/manage-external-access>

<https://docs.microsoft.com/en-us/microsoftteams/guest-access>

<https://docs.microsoft.com/en-us/microsoftteams/communicate-with-users-from-other-organizations>

## **Summary:** {#toc-hId-1675049524}

With this, the Power Automate flow should send the invitation as shown
below to the external user.

[![externalUserInvitationEmail.png](https://techcommunity.microsoft.com/t5/image/serverpage/image-id/283883i12B00828DE4DB125/image-size/large?v=v2&px=999 "externalUserInvitationEmail.png"){.lia-media-image
role="button"
li-image-url="https://techcommunity.microsoft.com/t5/image/serverpage/image-id/283883i12B00828DE4DB125?v=v2"
li-image-display-id="'283883i12B00828DE4DB125'"
li-message-uid="'2385603'" li-messages-message-image="true"
li-bindable="" tabindex="0" li-bypass-lightbox-when-linked="true"
li-use-hover-links="false"}]{.lia-inline-image-display-wrapper
.lia-image-align-inline image-alt="externalUserInvitationEmail.png"
style="width: 605px;"}

If it is for a Microsoft Team, the external user should be licensed for
teams service to open it on their teams client. The same flow can be
also configured for Microsoft 365 group.

This post was originally published in
[ashiqf.com](https://ashiqf.com/2021/05/26/how-to-invite-external-users-to-a-sharepoint-site-or-microsoft-team-using-power-automate-and-graph-api/)

 
:::
:::
:::

::: {#tagsList .TagList .lia-component-tags .lia-component-message-view-widget-tags-list}
-   Tags:
-   [Invite guest users to Azure
    AD](/t5/tag/Invite%20guest%20users%20to%20Azure%20AD/tg-p/board-id/Microsoft365PnPBlog){#link_7
    .lia-link-navigation .lia-tag .tag .tag-1127794
    .lia-js-data-tagUid-1127794}

    ::: {.tag-list-js-confirmation .hidden}
    :::
-   [Self registration experience for External
    users](/t5/tag/Self%20registration%20experience%20for%20External%20users/tg-p/board-id/Microsoft365PnPBlog){#link_8
    .lia-link-navigation .lia-tag .tag .tag-1127795
    .lia-js-data-tagUid-1127795}

    ::: {.tag-list-js-confirmation .hidden}
    :::
-   [SharePoint Online guest user
    invitation](/t5/tag/SharePoint%20Online%20guest%20user%20invitation/tg-p/board-id/Microsoft365PnPBlog){#link_9
    .lia-link-navigation .lia-tag .tag .tag-1127793
    .lia-js-data-tagUid-1127793}

    ::: {.tag-list-js-confirmation .hidden}
    :::

::: lia-inline-ajax-feedback
::: {#ajaxFeedback .AjaxFeedback}
:::
:::
:::
:::
:::
:::

::: {.lia-quilt-row .lia-quilt-row-footer}
::: {.lia-quilt-column .lia-quilt-column-12 .lia-quilt-column-left .lia-quilt-column-footer-left}
::: {.lia-quilt-column-alley .lia-quilt-column-alley-left}
::: {#kudosButtonV2 .KudosButton .lia-button-image-kudos-wrapper .lia-component-kudos-widget-button-version-3 .lia-component-kudos-widget-button-horizontal .lia-component-kudos-widget-button .lia-component-kudos-action .lia-component-message-view-widget-kudos-action lia-kudos-id="2385603"}
::: {.lia-button-image-kudos .lia-button-image-kudos-horizontal .lia-button-image-kudos-enabled .lia-button-image-kudos-not-kudoed .lia-button-image-kudos-has-kudoes .lia-button-image-kudos-has-kudos .lia-button aria-atomic="true" aria-live="assertive"}
::: lia-button-image-kudos-count
[[ 1 ]{#messageKudosCount_20eda2e3cefb3b .MessageKudosCount
.lia-component-kudos-widget-message-kudos-count itemprop="upvoteCount"}[
Like ]{.lia-button-image-kudos-label
.lia-component-kudos-widget-kudos-count-label}](/t5/kudos/messagepage/board-id/Microsoft365PnPBlog/message-id/299/tab/all-users "Click here to see who gave likes to this post."){#link_10
.lia-link-navigation .kudos-count-link}
:::

::: lia-button-image-kudos-give
[Like](https://techcommunity.microsoft.com/t5/blogs/v2/blogarticlepage.kudosbuttonv2.kudoentity:kudoentity/kudosable-gid/2385603?t:ac=blog-id/Microsoft365PnPBlog/article-id/299&t:cp=kudos/contributions/tapletcontributionspage "Click here to give likes to this post."){#kudoEntity
.lia-link-navigation .kudos-link .lia-link-ticket-post-action}
:::
:::
:::
:::
:::

::: {.lia-quilt-column .lia-quilt-column-12 .lia-quilt-column-right .lia-quilt-column-footer-right}
::: {.lia-quilt-column-alley .lia-quilt-column-alley-right}
::: {.lia-button-group .lia-component-comment-button .lia-component-message-view-widget-comment-button}
:::
:::
:::
:::

::: {.lia-quilt-row .lia-quilt-row-mod-controls}
::: {.lia-quilt-column .lia-quilt-column-24 .lia-quilt-column-single .lia-quilt-column-mod-controls-main}
::: {.lia-quilt-column-alley .lia-quilt-column-alley-single .lia-mark-empty}
:::
:::
:::

::: {.lia-quilt-row .lia-quilt-row-sub-footer}
::: {.lia-quilt-column .lia-quilt-column-24 .lia-quilt-column-single .lia-quilt-column-sub-footer .lia-mark-empty}
:::
:::
:::
:::
:::

::: {#progressBar .lia-progress .lia-js-hidden}
::: lia-progress-indeterminate
:::
:::
:::
:::

::: {.lia-text .lia-blog-article-page-comment-count .lia-discussion-page-sub-section-header .lia-component-comment-count-conditional}
2 Comments
:::

[]{#comments}

::: {#lazyload .lia-component-blogs-page-comment-list-loader .lia-component-lazy-loader .lia-lazy-load .lia-component-comment-list}
:::

[]{#comment-on-this} [ ]{#feedback-successinformationbox_7}

::: {#informationbox_7 .InfoMessage .lia-panel-feedback-banner-note .lia-component-comment-editor}
::: {.lia-text role="alert"}
You must be a registered user to add a comment. If you\'ve already
registered, sign in. Otherwise, register and sign in.

-   [Comment](/plugins/common/feature/oauth2sso/sso_login_redirect?lang=en&redirectreason=permissiondenied&referer=https%3A%2F%2Ftechcommunity.microsoft.com%2Ft5%2Fmicrosoft-365-pnp-blog%2Fhow-to-invite-external-users-to-a-sharepoint-site-or-microsoft%2Fba-p%2F2385603%23comment-on-this){#link_11
    .lia-link-navigation .blog-link .lia-message-comment-post}
:::
:::
:::
:::

::: {.lia-quilt-column .lia-quilt-column-06 .lia-quilt-column-right .lia-quilt-column-side-content}
::: {.lia-quilt-column-alley .lia-quilt-column-alley-right}
%3CLINGO-SUB%20id%3D%22lingo-sub-2385603%22%20slang%3D%22en-US%22%3EHow%20to%20invite%20external%20users%20to%20a%20SharePoint%20site%20or%20Microsoft%20Team%20using%20Power%20Automate%20%26amp%3B%20Graph%20API%3C%2FLINGO-SUB%3E%3CLINGO-BODY%20id%3D%22lingo-body-2385603%22%20slang%3D%22en-US%22%3E%3CP%3ESharePoint%20and%20Microsoft%20teams%20services%20in%20Microsoft%20365%20makes%20it%20easier%20to%20share%20content%20and%20collaborate%20with%20external%20users%20who%20is%20outside%20your%20organization.%20A%20guest%20or%20external%20user%20is%20someone%20who%20do%20not%20have%20a%20school%20or%20work%20account%20with%20your%20organization%2C%20they%20can%20be%20your%20partner%2C%20vendor%2C%20customer%20etc.%20In%20this%20article%20let%20us%20see%20how%20to%20build%20a%20self-registration%20experience%20for%20external%20users%20with%20the%20help%20of%20Microsoft%20Forms%20%26amp%3B%20Power%20Automate%20to%20onboard%20them%20to%20a%3C%2FP%3E%0A%3CUL%3E%0A%3CLI%3ESharePoint%20online%20site%3C%2FLI%3E%0A%3CLI%3EMicrosoft%20Team%3C%2FLI%3E%0A%3C%2FUL%3E%0A%3CH2%20id%3D%22toc-hId\--464098825%22%20id%3D%22toc-hId\--464098825%22%20id%3D%22toc-hId\--464098825%22%20id%3D%22toc-hId\--464098825%22%20id%3D%22toc-hId\--464098825%22%20id%3D%22toc-hId\--464098825%22%3EMicrosoft%20Form%20to%20collect%20details%20from%20External%20User%3A%3C%2FH2%3E%0A%3CP%3ETo%20start%20building%20this%20experience%2C%20create%20a%20Microsoft%20form%20with%20the%20setting%20%3CSTRONG%3EAnyone%20can%20respond%3C%2FSTRONG%3E%20and%20with%20fields%20(Name%2C%20Email%20address%20etc)%20to%20collect%20information%20from%20the%20external%20user%20to%20send%20invitation.%3C%2FP%3E%0A%3CH2%20id%3D%22toc-hId-2023414008%22%20id%3D%22toc-hId-2023414008%22%20id%3D%22toc-hId-2023414008%22%20id%3D%22toc-hId-2023414008%22%20id%3D%22toc-hId-2023414008%22%20id%3D%22toc-hId-2023414008%22%3E%3CSPAN%20class%3D%22lia-inline-image-display-wrapper%20lia-image-align-inline%22%20image-alt%3D%22MSForm-ExternalUserdetails.png%22%20style%3D%22width%3A%20605px%3B%22%3E%3CIMG%20src%3D%22https%3A%2F%2Ftechcommunity.microsoft.com%2Ft5%2Fimage%2Fserverpage%2Fimage-id%2F283744i5EE743018235BE28%2Fimage-size%2Flarge%3Fv%3Dv2%26amp%3Bpx%3D999%22%20role%3D%22button%22%20title%3D%22MSForm-ExternalUserdetails.png%22%20alt%3D%22MSForm-ExternalUserdetails.png%22%20%2F%3E%3C%2FSPAN%3E%3C%2FH2%3E%0A%3CH2%20id%3D%22toc-hId-215959545%22%20id%3D%22toc-hId-215959545%22%20id%3D%22toc-hId-215959545%22%20id%3D%22toc-hId-215959545%22%20id%3D%22toc-hId-215959545%22%20id%3D%22toc-hId-215959545%22%3EAzure%20Active%20Directory%20Application%20registration%3A%3C%2FH2%3E%0A%3CP%3EThe%20next%20step%20after%20creating%20the%20form%20is%20to%20register%20an%20%3CSPAN%3E%3CA%20href%3D%22https%3A%2F%2Fdocs.microsoft.com%2Fen-us%2Fazure%2Factive-directory%2Fdevelop%2Fquickstart-register-app%22%20target%3D%22_blank%22%20rel%3D%22noopener%20noreferrer%22%3Eapplication%20in%20Azure%20AD%3C%2FA%3E%3C%2FSPAN%3E%20with%20Microsoft%20graph%20API%20permission%20to%20send%20invitation%20to%20external%20user.%20After%20the%20app%20is%20registered%20obtain%20the%20client%20id%2C%20client%20secret%20%26amp%3B%20tenant%20id%20to%20be%20used%20in%20the%20Power%20Automate%20flow%20further%20down%20this%20article%20to%20generate%20the%20JSON%20webtoken%20to%20access%20Microsoft%20Graph%20API%20for%20sending%20invitation.%20Find%20below%20screenshot%20with%20the%20permission%20User.Invite.All%20added%20to%20the%20app.%20Keep%20in%20mind%20the%20permission%20requires%20Admin%20consent.%3C%2FP%3E%0A%3CP%3E%3CSPAN%20class%3D%22lia-inline-image-display-wrapper%20lia-image-align-inline%22%20image-alt%3D%22AdApp-GraphPermissiontoInviteGuestUser.png%22%20style%3D%22width%3A%20605px%3B%22%3E%3CIMG%20src%3D%22https%3A%2F%2Ftechcommunity.microsoft.com%2Ft5%2Fimage%2Fserverpage%2Fimage-id%2F283747iBFCAE7000FA85663%2Fimage-size%2Flarge%3Fv%3Dv2%26amp%3Bpx%3D999%22%20role%3D%22button%22%20title%3D%22AdApp-GraphPermissiontoInviteGuestUser.png%22%20alt%3D%22AdApp-GraphPermissiontoInviteGuestUser.png%22%20%2F%3E%3C%2FSPAN%3E%3C%2FP%3E%0A%3CP%3EThere%20is%20also%20delegated%20permission%20available%20for%20User.Invite.All.%3C%2FP%3E%0A%3CH1%20id%3D%22toc-hId-205456441%22%20id%3D%22toc-hId-205456441%22%20id%3D%22toc-hId-205456441%22%20id%3D%22toc-hId-205456441%22%20id%3D%22toc-hId-205456441%22%20id%3D%22toc-hId-205456441%22%3EOnboard%20External%20users%20to%20a%20SharePoint%20online%20site%3A%3C%2FH1%3E%0A%3CP%3EOnce%20the%20Microsoft%20form%20is%20ready%2C%20we%20can%20start%20building%20the%20Power%20Automate%20flow%20which%20can%20send%20the%20email%20invitation%20to%20the%20external%20user%20and%20for%20granting%20access%20to%20the%20SharePoint%20site.%20The%20%3CSPAN%3E%3CA%20href%3D%22https%3A%2F%2Fdocs.microsoft.com%2Fen-us%2Fsharepoint%2Fexternal-sharing-overview%22%20target%3D%22_blank%22%20rel%3D%22noopener%20noreferrer%22%3Eexternal%20sharing%3C%2FA%3E%3C%2FSPAN%3E%20features%20of%20SharePoint%20Online%20enables%20users%20in%20your%20organization%20share%20content%20with%20people%20outside%20the%20organization.%20There%20is%20no%20limit%20to%20the%20number%20of%20guests%20you%20can%20invite%20to%20SharePoint%20sites%20as%20per%20this%20%3CSPAN%3E%3CA%20href%3D%22https%3A%2F%2Fdocs.microsoft.com%2Fen-us%2Foffice365%2Fservicedescriptions%2Fsharepoint-online-service-description%2Fsharepoint-online-limits%23users%22%20target%3D%22_blank%22%20rel%3D%22noopener%20noreferrer%22%3ESharePoint%20online%20limits%3C%2FA%3E%3C%2FSPAN%3E%20documentation.%20Find%20below%20steps%20to%20create%20the%20Power%20Automate%20flow%20with%20a%20custom%20approval%20on%20a%20Microsoft%20Team%3C%2FP%3E%0A%3CH2%20id%3D%22toc-hId-896017915%22%20id%3D%22toc-hId-896017915%22%20id%3D%22toc-hId-896017915%22%20id%3D%22toc-hId-896017915%22%20id%3D%22toc-hId-896017915%22%20id%3D%22toc-hId-896017915%22%3EPower%20Automate%20Flow%3A%3C%2FH2%3E%0A%3CP%3ECreate%20an%20Automated%20flow%20with%20the%20trigger%20%3CSTRONG%3EWhen%20a%20new%20response%20is%20submitted%3C%2FSTRONG%3E%20with%20the%20above%20form%20name%20selected%20on%20the%20dropdown%20and%20then%20add%20the%20action%20%3CSTRONG%3EGet%20response%20details%3C%2FSTRONG%3E%20with%20the%20%3CSTRONG%3EResponse%20Id%3C%2FSTRONG%3E%20selected%20from%20the%20dynamic%20content%20for%20the%20trigger%20to%20get%20the%20form%20details%20submitted%20in%20the%20Microsoft%20form%20by%20the%20external%20user.%20Find%20screenshot%20below%3C%2FP%3E%0A%3CP%3E%3CSPAN%20class%3D%22lia-inline-image-display-wrapper%20lia-image-align-inline%22%20image-alt%3D%22MSFormTrigger-ExternalUser.png%22%20style%3D%22width%3A%20605px%3B%22%3E%3CIMG%20src%3D%22https%3A%2F%2Ftechcommunity.microsoft.com%2Ft5%2Fimage%2Fserverpage%2Fimage-id%2F283749iE72C51E732F69B83%2Fimage-size%2Flarge%3Fv%3Dv2%26amp%3Bpx%3D999%22%20role%3D%22button%22%20title%3D%22MSFormTrigger-ExternalUser.png%22%20alt%3D%22MSFormTrigger-ExternalUser.png%22%20%2F%3E%3C%2FSPAN%3E%3C%2FP%3E%0A%3CH2%20id%3D%22toc-hId\--911436548%22%20id%3D%22toc-hId\--911436548%22%20id%3D%22toc-hId\--911436548%22%20id%3D%22toc-hId\--911436548%22%20id%3D%22toc-hId\--911436548%22%20id%3D%22toc-hId\--911436548%22%3EAdaptive%20card%20for%20Teams%20Approval%3A%3C%2FH2%3E%0A%3CP%3EFor%20the%20Approval%20in%20Microsoft%20Teams%2C%20I%20have%20used%20a%20custom%20card%20created%20from%20the%20%3CSPAN%3E%3CA%20href%3D%22https%3A%2F%2Fadaptivecards.io%2Fdesigner%2F%22%20target%3D%22_blank%22%20rel%3D%22noopener%20nofollow%20noreferrer%22%3EAdaptive%20card%20designer%3C%2FA%3E%3C%2FSPAN%3E%20with%20elements%20%3CSTRONG%3EColumnSet%2C%20TextBlock%3C%2FSTRONG%3E%20to%20display%20information%20submitted%20in%20the%20form%20%26amp%3B%20%3CSTRONG%3Eaction%20button%3C%2FSTRONG%3E%20Approve%20and%20Reject%20to%20take%20further%20action%20by%20a%20Microsoft%20teams%20user%20to%20proceed%20with%20Invitation%20for%20the%20Guest%20account%20creation.%20Find%20screenshot%20below%20from%20the%20adaptive%20card%20designer%3C%2FP%3E%0A%3CP%3E%3CSPAN%20class%3D%22lia-inline-image-display-wrapper%20lia-image-align-inline%22%20image-alt%3D%22AdaptiveCard-DesignforApproval.png%22%20style%3D%22width%3A%20605px%3B%22%3E%3CIMG%20src%3D%22https%3A%2F%2Ftechcommunity.microsoft.com%2Ft5%2Fimage%2Fserverpage%2Fimage-id%2F283751i05981D49C0025718%2Fimage-size%2Flarge%3Fv%3Dv2%26amp%3Bpx%3D999%22%20role%3D%22button%22%20title%3D%22AdaptiveCard-DesignforApproval.png%22%20alt%3D%22AdaptiveCard-DesignforApproval.png%22%20%2F%3E%3C%2FSPAN%3E%3C%2FP%3E%0A%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3COL%3E%0A%3CLI%3EAfter%20the%20card%20is%20designed%2C%20copy%20the%20card%20payload%20from%20the%20designer%20and%20go%20to%20the%20flow%20and%20then%20add%20the%20action%20%3CSTRONG%3EPost%20adaptive%20card%20and%20wait%20for%20a%20response%3C%2FSTRONG%3E%20and%20make%20appropriate%20selection%20on%20the%20available%20fields%20as%20shown%20below%3CUL%20class%3D%22lia-list-style-type-disc%22%3E%0A%3CLI%3E%3CSTRONG%3EPost%20as%3C%2FSTRONG%3E%3A%20Flow%20bot%3C%2FLI%3E%0A%3CLI%3E%3CSTRONG%3EPost%20in%3C%2FSTRONG%3E%3A%20Channel%3C%2FLI%3E%0A%3CLI%3E%3CSTRONG%3EMessage%3C%2FSTRONG%3E%3A%20Payload%20copied%20from%20designer.%20Replace%20the%20fields%20for%20usrName%20%26amp%3B%20userEmail%20selected%20from%20the%20dynamic%20content%20from%20the%20outputs%20of%20the%20action%20%3CSTRONG%3EGet%20response%20details%3C%2FSTRONG%3E.%20The%20created%20on%20textBlock%20element%20has%20the%20flow%20expression%20formatDateTime(utcNow()%2C\'g\')%20to%20display%20the%20current%20datetime%20information%20on%20the%20card.%3C%2FLI%3E%0A%3C%2FUL%3E%0A%3C%2FLI%3E%0A%3C%2FOL%3E%0A%3CP%3E%3CSPAN%20class%3D%22lia-inline-image-display-wrapper%20lia-image-align-inline%22%20image-alt%3D%22AdaptiveCard-PAFlow-POSTAdatptivecardandwaitforresponse1.png%22%20style%3D%22width%3A%20605px%3B%22%3E%3CIMG%20src%3D%22https%3A%2F%2Ftechcommunity.microsoft.com%2Ft5%2Fimage%2Fserverpage%2Fimage-id%2F283832iE97C226E1847A51C%2Fimage-size%2Flarge%3Fv%3Dv2%26amp%3Bpx%3D999%22%20role%3D%22button%22%20title%3D%22AdaptiveCard-PAFlow-POSTAdatptivecardandwaitforresponse1.png%22%20alt%3D%22AdaptiveCard-PAFlow-POSTAdatptivecardandwaitforresponse1.png%22%20%2F%3E%3C%2FSPAN%3E%3C%2FP%3E%0A%3CP%3E%3CSPAN%20class%3D%22lia-inline-image-display-wrapper%20lia-image-align-inline%22%20image-alt%3D%22AdaptiveCard-PAFlow-POSTAdatptivecardandwaitforresponse2.png%22%20style%3D%22width%3A%20601px%3B%22%3E%3CIMG%20src%3D%22https%3A%2F%2Ftechcommunity.microsoft.com%2Ft5%2Fimage%2Fserverpage%2Fimage-id%2F283834i108906E5F5F321C1%2Fimage-size%2Flarge%3Fv%3Dv2%26amp%3Bpx%3D999%22%20role%3D%22button%22%20title%3D%22AdaptiveCard-PAFlow-POSTAdatptivecardandwaitforresponse2.png%22%20alt%3D%22AdaptiveCard-PAFlow-POSTAdatptivecardandwaitforresponse2.png%22%20%2F%3E%3C%2FSPAN%3E%3C%2FP%3E%0A%3CUL%3E%0A%3CLI%3E%3CSTRONG%3EUpdate%20Message%3C%2FSTRONG%3E%3A%20Custom%20message%20which%20appear%20after%20an%20action%20taken%20in%20Microsoft%20Teams%3C%2FLI%3E%0A%3CLI%3E%3CSTRONG%3ETeam%3C%2FSTRONG%3E%3A%20Select%20the%20Team%20where%20you%20would%20like%20to%20post%20the%20card%3C%2FLI%3E%0A%3CLI%3E%3CSTRONG%3EChannel%3C%2FSTRONG%3E%3A%20Select%20the%20channel%20from%20the%20Microsoft%20Team%20where%20you%20would%20like%20to%20have%20the%20approval%20adaptive%20card%20posted%3C%2FLI%3E%0A%3C%2FUL%3E%0A%3CP%3ECard%20payload%3A%3C%2FP%3E%0A%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3CPRE%20class%3D%22lia-code-sample%20language-applescript%22%3E%3CCODE%3E%7B%0A%20%20%20%20%22type%22%3A%20%22AdaptiveCard%22%2C%0A%20%20%20%20%22body%22%3A%20%5B%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%22type%22%3A%20%22TextBlock%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22weight%22%3A%20%22Bolder%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22text%22%3A%20%22Approval%20for%20adding%20the%20External%20User%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22wrap%22%3A%20true%0A%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%22type%22%3A%20%22TextBlock%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22spacing%22%3A%20%22None%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22text%22%3A%20%22Created%20Add%20flow%20expression%20to%20get%20current%20date%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22isSubtle%22%3A%20true%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22wrap%22%3A%20true%0A%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%22type%22%3A%20%22ColumnSet%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22columns%22%3A%20%5B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22type%22%3A%20%22Column%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22items%22%3A%20%5B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22type%22%3A%20%22TextBlock%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22text%22%3A%20%22Name%3A%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22wrap%22%3A%20true%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22size%22%3A%20%22Medium%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22weight%22%3A%20%22Bolder%22%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22type%22%3A%20%22TextBlock%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22text%22%3A%20%22Email%3A%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22wrap%22%3A%20true%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22weight%22%3A%20%22Bolder%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22size%22%3A%20%22Medium%22%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22width%22%3A%20%22stretch%22%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22type%22%3A%20%22Column%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22width%22%3A%20%22stretch%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22items%22%3A%20%5B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22type%22%3A%20%22TextBlock%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22text%22%3A%20%22usrName-Replace%20it%20from%20Microsoft%20Form%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22wrap%22%3A%20true%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22type%22%3A%20%22TextBlock%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22text%22%3A%20%22userEmail-Replace%20it%20from%20Microsoft%20Form%20%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22wrap%22%3A%20true%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%5D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%5D%2C%0A%20%20%20%20%22actions%22%3A%20%5B%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%22type%22%3A%20%22Action.Submit%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22title%22%3A%20%22Approve%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22id%22%3A%20%22btnApprove%22%0A%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%22type%22%3A%20%22Action.Submit%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22title%22%3A%20%22Reject%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22id%22%3A%20%22btnReject%22%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%5D%2C%0A%20%20%20%20%22%24schema%22%3A%20%22http%3A%2F%2Fadaptivecards.io%2Fschemas%2Fadaptive-card.json%22%2C%0A%20%20%20%20%22version%22%3A%20%221.0%22%0A%7D%0A%3C%2FCODE%3E%3C%2FPRE%3E%0A%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3COL%20start%3D%222%22%3E%0A%3CLI%3EThe%20above%20adaptive%20card%20is%20used%20to%20get%20approval%20from%20the%20Organization%20teams%20user%20based%20on%20the%20information%20submitted%20by%20the%20external%20user%20in%20the%20Microsoft%20form%20to%20proceed%20with%20the%20next%20steps%20for%20sending%20the%20guest%20account%20invite.%20Now%20we%20will%20have%20to%20identify%20if%20the%20user%20has%20clicked%20the%20button%20Approve%20or%20Reject.%20This%20information%20can%20be%20easily%20obtained%20from%20the%20Outputs%20of%20the%20action.%3C%2FLI%3E%0A%3C%2FOL%3E%0A%3CP%3E%3CSTRONG%3ENote%3C%2FSTRONG%3E%3A%20Adaptive%20card%20can%20also%20be%20sent%20using%20a%20Microsoft%20Graph%20API%20with%20the%20card%20payload%20in%20Attachments%20field%3C%2FP%3E%0A%3CP%3E%3CA%20href%3D%22https%3A%2F%2Fdocs.microsoft.com%2Fen-us%2Fgraph%2Fapi%2Fchannel-post-messages%3Fview%3Dgraph-rest-beta%26amp%3Btabs%3Dhttp%22%20target%3D%22_blank%22%20rel%3D%22noopener%20noreferrer%22%3Ehttps%3A%2F%2Fdocs.microsoft.com%2Fen-us%2Fgraph%2Fapi%2Fchannel-post-messages%3Fview%3Dgraph-rest-beta%26amp%3Btabs%3Dhttp%3C%2FA%3E%3C%2FP%3E%0A%3CH3%20id%3D%22toc-hId\--220875074%22%20id%3D%22toc-hId\--220875074%22%20id%3D%22toc-hId\--220875074%22%20id%3D%22toc-hId\--220875074%22%20id%3D%22toc-hId\--220875074%22%20id%3D%22toc-hId\--220875074%22%3EAdaptive%20card%20for%20Teams%20-%20Dynamic%20content%20Missing%3A%3C%2FH3%3E%0A%3CP%3EAs%20of%20the%20time%20I%20am%20writing%20this%20article%20there%20is%20an%20issue%20in%20getting%20the%20output%20as%20dynamic%20content%20for%20the%20%3CSTRONG%3EPost%20adaptive%20card%20and%20wait%20for%20a%20response%3C%2FSTRONG%3E%20action%20if%20there%20is%20dynamic%20content%20added%20on%20the%20JSON%20Payload%20(Name%2C%20Email%20from%20Forms).%20The%20fix%20is%20to%20run%20the%20flow%20till%20the%20post%20adaptive%20card%20action%20and%20take%20an%20action%20on%20Microsoft%20teams%20by%20clicking%20either%20Approve%20or%20Reject%20and%20then%20go%20to%20the%20Flow%20run%20from%20the%20history%20as%20shown%20below%3C%2FP%3E%0A%3CP%3E%3CSPAN%20class%3D%22lia-inline-image-display-wrapper%20lia-image-align-inline%22%20image-alt%3D%22AdaptiveCard-PAFlow-POSTAdatptivecardandwaitforresponseRunHistory.png%22%20style%3D%22width%3A%20605px%3B%22%3E%3CIMG%20src%3D%22https%3A%2F%2Ftechcommunity.microsoft.com%2Ft5%2Fimage%2Fserverpage%2Fimage-id%2F283841i0F0F0D886B748997%2Fimage-size%2Flarge%3Fv%3Dv2%26amp%3Bpx%3D999%22%20role%3D%22button%22%20title%3D%22AdaptiveCard-PAFlow-POSTAdatptivecardandwaitforresponseRunHistory.png%22%20alt%3D%22AdaptiveCard-PAFlow-POSTAdatptivecardandwaitforresponseRunHistory.png%22%20%2F%3E%3C%2FSPAN%3E%3C%2FP%3E%0A%3CP%3EFrom%20the%20above%20screenshot%2C%20we%20can%20see%20if%20the%20user%20has%20clicked%20the%20Approve%20or%20Reject%20button%20from%20the%20field%20%3CSTRONG%3EsubmitActionId%3C%2FSTRONG%3E.%20To%20get%20this%20value%20in%20Flow%2C%20use%20the%20expression%3C%2FP%3E%0A%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3CPRE%20class%3D%22lia-code-sample%20language-applescript%22%3E%3CCODE%3Eoutputs(\'Post_adaptive_card_and_wait_for_a\_response\').body.submitActionId%3C%2FCODE%3E%3C%2FPRE%3E%0A%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3CP%3Eor%3C%2FP%3E%0A%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3CPRE%20class%3D%22lia-code-sample%20language-applescript%22%3E%3CCODE%3E%40outputs(\'Post_adaptive_card_and_wait_for_a\_response\')%3F%5B\'body%2FsubmitActionId\'%5D%3C%2FCODE%3E%3C%2FPRE%3E%0A%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3CP%3ESpaces%20in%20the%20name%20of%20the%20action%20is%20replaced%20with%20underscore.%3C%2FP%3E%0A%3CP%3ETo%20get%20the%20userPrincipalName%2C%20the%20expression%20is%3C%2FP%3E%0A%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3CPRE%20class%3D%22lia-code-sample%20language-applescript%22%3E%3CCODE%3Eoutputs(\'Post_adaptive_card_and_wait_for_a\_response\').body.responder.userPrincipalName%3C%2FCODE%3E%3C%2FPRE%3E%0A%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3CP%3Eor%3C%2FP%3E%0A%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3CPRE%20class%3D%22lia-code-sample%20language-applescript%22%3E%3CCODE%3E%40outputs(\'Post_adaptive_card_and_wait_for_a\_response\')%3F%5B\'body%2Fresponder%2FuserPrincipalName\'%5D%3C%2FCODE%3E%3C%2FPRE%3E%0A%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3CP%3ETo%20get%20the%20submitActionId%2C%20enter%20the%20expression%20outputs(\'Post_adaptive_card_and_wait_for_a\_response\').body.submitActionId%20in%20the%20compose%20action%2C%20then%20add%20a%20condition%20control%20to%20decide%20action%20based%20on%20users%20approval%3C%2FP%3E%0A%3CP%3E%3CSPAN%20class%3D%22lia-inline-image-display-wrapper%20lia-image-align-inline%22%20image-alt%3D%22AdaptiveCard-cardactionoutput.png%22%20style%3D%22width%3A%20605px%3B%22%3E%3CIMG%20src%3D%22https%3A%2F%2Ftechcommunity.microsoft.com%2Ft5%2Fimage%2Fserverpage%2Fimage-id%2F283843iEA966FE976A43528%2Fimage-size%2Flarge%3Fv%3Dv2%26amp%3Bpx%3D999%22%20role%3D%22button%22%20title%3D%22AdaptiveCard-cardactionoutput.png%22%20alt%3D%22AdaptiveCard-cardactionoutput.png%22%20%2F%3E%3C%2FSPAN%3E%3C%2FP%3E%0A%3CP%3EI%20have%20observed%20this%20issue%20occurs%20in%20other%20team%E2%80%99s%20adaptive%20card%20actions%20as%20well%2C%20the%20above%20fix%20should%20work.%20Now%20we%20can%20implement%20the%20logic%20to%20send%20the%20Guest%20Invitation%20using%20Microsoft%20Graph%20API.%20To%20send%20the%20invite%2C%26nbsp%3Bwe%20will%20use%20the%20Azure%20AD%20application%20registered%20above.%3C%2FP%3E%0A%3CH2%20id%3D%22toc-hId\--231378178%22%20id%3D%22toc-hId\--231378178%22%20id%3D%22toc-hId\--231378178%22%20id%3D%22toc-hId\--231378178%22%20id%3D%22toc-hId\--231378178%22%20id%3D%22toc-hId\--231378178%22%3EGenerate%20JSON%20Web%20token%20to%20Access%20Graph%20API%3A%3C%2FH2%3E%0A%3CP%3EBe%20ready%20with%20the%20ClientId%2C%20Client%20Secret%20and%20Tenant%20Id%20collected%20from%20the%20AD%20app%20registration%20you%20have%20done%20initially.%20The%20only%20authentication%20flow%20to%20generate%20a%20access%20token%20for%20application%20permissions%20is%20%3CSPAN%3E%3CA%20href%3D%22https%3A%2F%2Fdocs.microsoft.com%2Fen-us%2Fazure%2Factive-directory%2Fdevelop%2Fmsal-authentication-flows%23client-credentials%22%20target%3D%22_blank%22%20rel%3D%22noopener%20noreferrer%22%3EClient%20credentials%3C%2FA%3E%3C%2FSPAN%3E.%3C%2FP%3E%0A%3CP%3ETo%20generate%20a%20token%3C%2FP%3E%0A%3COL%3E%0A%3CLI%3EStore%20the%20Client%20Secret%20on%20a%20String%20variable%20or%20a%20compose%20action%3C%2FLI%3E%0A%3CLI%3EMake%20a%20HTTP%20request%20using%20the%20HTTP%20connector%20with%20the%20following%20details.%20Make%20sure%20to%20replace%20the%20string%20for%20tenantId%2C%20azureAdAppclientId%20and%20azureAdAppclientSecret%3C%2FLI%3E%0A%3C%2FOL%3E%0A%3CP%3EAdd%20a%20HTTP%20connector%20action%20to%20the%20flow%20for%20making%20a%20POST%20request%20per%20the%20following%20information%3C%2FP%3E%0A%3CP%3E%3CSTRONG%3EHTTP%20Method%3C%2FSTRONG%3E%3A%20POST%3C%2FP%3E%0A%3CP%3E%3CSTRONG%3EURI%3C%2FSTRONG%3E%3A%20%3CSPAN%3E%3CA%20href%3D%22https%3A%2F%2Flogin.microsoftonline.com%2FyourtenantId%2Foauth2%2Fv2.0%2Ftoken%22%20target%3D%22_blank%22%20rel%3D%22noopener%20nofollow%20noreferrer%22%3Ehttps%3A%2F%2Flogin.microsoftonline.com%2FyourtenantId%2Foauth2%2Fv2.0%2Ftoken%3C%2FA%3E%3C%2FSPAN%3E%3C%2FP%3E%0A%3CP%3E%3CSTRONG%3EHeaders%3C%2FSTRONG%3E%3A%3C%2FP%3E%0A%3CP%3E%3CU%3E%3CEM%3EKey%3C%2FEM%3E%3C%2FU%3E%3A%20Content-Type%3C%2FP%3E%0A%3CP%3E%3CU%3E%3CEM%3EValue%3C%2FEM%3E%3C%2FU%3E%3A%20application%2Fx-www-form-urlencoded%3C%2FP%3E%0A%3CP%3E%3CSTRONG%3EBody%3C%2FSTRONG%3E%3A%3C%2FP%3E%0A%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3CPRE%20class%3D%22lia-code-sample%20language-applescript%22%3E%3CCODE%3Etenant%3DyourtenantId%26amp%3Bclient_id%3DazureAdAppclientId%26amp%3Bclient_secret%3D%40%7BdecodeUriComponent(variables(\'azureAdAppclientSecret\'))%7D%26amp%3Bgrant_type%3Dclient_credentials%26amp%3Bscope%3Dhttps%3A%2F%2Fgraph.microsoft.com%2F.default%3C%2FCODE%3E%3C%2FPRE%3E%0A%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3CP%3EFor%20the%20client%20secret%20make%20sure%20to%20URL%20encode%20using%20the%20expression%20encodeUriComponent(variables(%E2%80%98clientSecret%E2%80%99))%20else%20the%20request%20will%20fail%20due%20to%20the%20presence%20of%20special%20characters.%3C%2FP%3E%0A%3CP%3E%3CSPAN%20class%3D%22lia-inline-image-display-wrapper%20lia-image-align-inline%22%20image-alt%3D%22MSGraph-GenerateJSONWebToken.png%22%20style%3D%22width%3A%20605px%3B%22%3E%3CIMG%20src%3D%22https%3A%2F%2Ftechcommunity.microsoft.com%2Ft5%2Fimage%2Fserverpage%2Fimage-id%2F283871i7259E97855CDF538%2Fimage-size%2Flarge%3Fv%3Dv2%26amp%3Bpx%3D999%22%20role%3D%22button%22%20title%3D%22MSGraph-GenerateJSONWebToken.png%22%20alt%3D%22MSGraph-GenerateJSONWebToken.png%22%20%2F%3E%3C%2FSPAN%3E%3C%2FP%3E%0A%3CP%3EIn%20the%20above%20screen%2C%20I%20have%20added%20a%20compose%20action%20to%20store%20the%20SharePoint%20site%20address%20to%20be%20used%20for%20granting%20the%20external%20user%20access%20to.%20To%20extract%20the%20token%20from%20the%20above%20request%2C%20add%20the%20parse%20JSON%20action%20with%20Content%20from%20the%20%3CSTRONG%3EHTTP%20request%20body%3C%2FSTRONG%3E%20and%20the%20following%20schema%3C%2FP%3E%0A%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3CPRE%20class%3D%22lia-code-sample%20language-applescript%22%3E%3CCODE%3E%7B%0A%20%20%20%20%22type%22%3A%20%22object%22%2C%0A%20%20%20%20%22properties%22%3A%20%7B%0A%20%20%20%20%20%20%20%20%22token_type%22%3A%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%22type%22%3A%20%22string%22%0A%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20%22scope%22%3A%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%22type%22%3A%20%22string%22%0A%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20%22expires_in%22%3A%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%22type%22%3A%20%22integer%22%0A%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20%22ext_expires_in%22%3A%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%22type%22%3A%20%22integer%22%0A%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20%22access_token%22%3A%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%22type%22%3A%20%22string%22%0A%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20%22refresh_token%22%3A%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%22type%22%3A%20%22string%22%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%7D%0A%3C%2FCODE%3E%3C%2FPRE%3E%0A%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3CP%3E%3CSPAN%20class%3D%22lia-inline-image-display-wrapper%20lia-image-align-inline%22%20image-alt%3D%22MSGraph-ParseJSONWebToken.png%22%20style%3D%22width%3A%20605px%3B%22%3E%3CIMG%20src%3D%22https%3A%2F%2Ftechcommunity.microsoft.com%2Ft5%2Fimage%2Fserverpage%2Fimage-id%2F283872i0847D6A0FE6B53E1%2Fimage-size%2Flarge%3Fv%3Dv2%26amp%3Bpx%3D999%22%20role%3D%22button%22%20title%3D%22MSGraph-ParseJSONWebToken.png%22%20alt%3D%22MSGraph-ParseJSONWebToken.png%22%20%2F%3E%3C%2FSPAN%3E%3C%2FP%3E%0A%3CP%3EInclude%20the%20access%20token%20when%20calling%20the%20Microsoft%20Graph%20API%20on%20the%20Headers%20section%20or%20raw%20as%20shown%20in%20the%20next%20section.%3C%2FP%3E%0A%3CH2%20id%3D%22toc-hId\--2038832641%22%20id%3D%22toc-hId\--2038832641%22%20id%3D%22toc-hId\--2038832641%22%20id%3D%22toc-hId\--2038832641%22%20id%3D%22toc-hId\--2038832641%22%20id%3D%22toc-hId\--2038832641%22%3ESend%20Invitation%20using%20Microsoft%20Graph%20API%3A%3C%2FH2%3E%0A%3CP%3EBefore%20sending%20the%20invitation%2C%20validate%20if%20the%20user%20already%20exists%20in%20your%20organization%20AD%20tenant%20by%20using%20the%20email%20address%20of%20the%20external%20user%20with%20the%20help%20of%20the%20action%20%3CSTRONG%3ESearch%20for%20users%3C%2FSTRONG%3E%20as%20shown%20below%3C%2FP%3E%0A%3CP%3E%3CSPAN%20class%3D%22lia-inline-image-display-wrapper%20lia-image-align-inline%22%20image-alt%3D%22SearchforexternalUser.png%22%20style%3D%22width%3A%20605px%3B%22%3E%3CIMG%20src%3D%22https%3A%2F%2Ftechcommunity.microsoft.com%2Ft5%2Fimage%2Fserverpage%2Fimage-id%2F283873i5D856C72A794F8F8%2Fimage-size%2Flarge%3Fv%3Dv2%26amp%3Bpx%3D999%22%20role%3D%22button%22%20title%3D%22SearchforexternalUser.png%22%20alt%3D%22SearchforexternalUser.png%22%20%2F%3E%3C%2FSPAN%3E%3C%2FP%3E%0A%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3CP%3EIf%20there%20is%20null%20response%20for%20the%20action%20%3CSTRONG%3ESearch%20for%20users%3C%2FSTRONG%3E%2C%20then%20the%20user%20does%20not%20exist.%20This%20can%20be%20calculated%20using%20the%20expression%20length%20and%20by%20passing%20the%20value%20as%20a%20parameter%2C%20if%20it%20is%20equals%20zero%20then%20the%20external%20user%20does%20not%20exist.%20If%20the%20user%20already%20exists%2C%20we%20can%20directly%20proceed%20to%20granting%20the%20external%20user%20access%20to%20SharePoint.%3C%2FP%3E%0A%3CP%3EGraph%20API%20to%20check%20if%20a%20guest%20user%20already%20exists%3A%3C%2FP%3E%0A%3CP%3E%3CA%20href%3D%22https%3A%2F%2Fgraph.microsoft.com%2Fv1.0%2Fusers%3F%24filter%3DUserType%20eq%20\'Guest\'%26amp%3B%24filter%3Dmail%20eq%20exteruseremailaddress%40domain.com\'%22%20target%3D%22_self%22%20rel%3D%22noopener%20noreferrer%22%3Ehttps%3A%2F%2Fgraph.microsoft.com%2Fv1.0%2Fusers%3F%24filter%3DUserType%20eq%20\'Guest\'%26amp%3B%24filter%3Dmail%20eq%20exteruseremailaddress%40domain.com\'%3C%2FA%3E%26nbsp%3B%3C%2FP%3E%0A%3CP%3Eor%3C%2FP%3E%0A%3CP%3E%3CA%20href%3D%22https%3A%2F%2Fgraph.microsoft.com%2Fv1.0%2Fusers%3F%24filter%3Dstartswith(mail%2C\'fejom29487%40troikos.com\')%22%20target%3D%22_blank%22%20rel%3D%22noopener%20noreferrer%22%3Ehttps%3A%2F%2Fgraph.microsoft.com%2Fv1.0%2Fusers%3F%24filter%3Dstartswith(mail%2C\'%3CU%3Eexteruseremailaddress%40domain.com%3C%2FU%3E\')%3C%2FA%3E%3C%2FP%3E%0A%3CP%3EFind%20below%20the%20Graph%20API%20endpoint%20http%20request%20details%20to%20%3CSPAN%3E%3CA%20href%3D%22https%3A%2F%2Fdocs.microsoft.com%2Fen-us%2Fgraph%2Fapi%2Finvitation-post%3Fview%3Dgraph-rest-1.0%26amp%3Btabs%3Dhttp%22%20target%3D%22_blank%22%20rel%3D%22noopener%20noreferrer%22%3Einvite%20the%20external%20user%3C%2FA%3E%3C%2FSPAN%3E%3C%2FP%3E%0A%3CP%3E%3CSTRONG%3EMethod%3C%2FSTRONG%3E%3A%20POST%3C%2FP%3E%0A%3CP%3E%3CSTRONG%3EURL%3C%2FSTRONG%3E%3A%20%3CSPAN%3E%3CA%20href%3D%22https%3A%2F%2Fgraph.microsoft.com%2Fv1.0%2Finvitations%22%20target%3D%22_blank%22%20rel%3D%22noopener%20noreferrer%22%3Ehttps%3A%2F%2Fgraph.microsoft.com%2Fv1.0%2Finvitations%3C%2FA%3E%3C%2FSPAN%3E%3C%2FP%3E%0A%3CP%3E%3CSTRONG%3ERequest%20Body%3C%2FSTRONG%3E%3A%3C%2FP%3E%0A%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3CPRE%20class%3D%22lia-code-sample%20language-applescript%22%3E%3CCODE%3E%7B%0A%20%20%22invitedUserDisplayName%22%3A%20%22External%20User%20Name%22%2C%0A%20%20%22invitedUserEmailAddress%22%3A%20%22External%20User%20Email%20Address%22%2C%0A%20%20%22sendInvitationMessage%22%3A%20true%2C%0A%20%20%22inviteRedirectUrl%22%3A%20%22SharePoint%20site%20URL%20or%20any%20URL%22%2C%0A%20%20%22invitedUserMessageInfo%22%3A%20%7B%0A%20%20%20%20%22messageLanguage%22%3A%20%22en-US%22%2C%0A%20%20%20%20%22customizedMessageBody%22%3A%20%22Welcome%20to%20the%20M365PAL%20SharePoint%20site!%20Click%20the%20link%20below%20and%20sign%20in.%22%0A%20%20%7D%0A%7D%0A%3C%2FCODE%3E%3C%2FPRE%3E%0A%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3CP%3E%3CSPAN%20class%3D%22lia-inline-image-display-wrapper%20lia-image-align-inline%22%20image-alt%3D%22MSGraph-SendInvitationforExternaluser.png%22%20style%3D%22width%3A%20605px%3B%22%3E%3CIMG%20src%3D%22https%3A%2F%2Ftechcommunity.microsoft.com%2Ft5%2Fimage%2Fserverpage%2Fimage-id%2F283874iB97155249F988658%2Fimage-size%2Flarge%3Fv%3Dv2%26amp%3Bpx%3D999%22%20role%3D%22button%22%20title%3D%22MSGraph-SendInvitationforExternaluser.png%22%20alt%3D%22MSGraph-SendInvitationforExternaluser.png%22%20%2F%3E%3C%2FSPAN%3E%3C%2FP%3E%0A%3CP%3EIn%20HTTP%20request%20body%2C%20use%20the%20dynamic%20content%20of%20the%20form%20to%20populate%20the%20fields%20invitedUserDisplayName%20%26amp%3B%20Emailaddress.%20The%20invite%20redirectUri%20is%20the%20output%20of%20the%20compose%20action%20which%20has%20the%20SharePoint%20site%20url.%20I%20have%20added%20a%20delay%20of%20one%20minute%20before%20granting%20access%20to%20SharePoint%20site%20for%20the%20external%20user%2C%20this%20step%20is%20to%20make%20sure%20there%20is%20an%20entry%20in%20Azure%20AD%20for%20the%20external%20user%2Fguest%20account.%3C%2FP%3E%0A%3CP%3ECustom%20connector%20can%20be%20used%20for%20calling%20the%20Graph%20API%20for%20sending%20invitations%20instead%20of%20using%20HTTP%20connector%2C%20you%20can%20refer%20to%20the%20post%20%3CA%20href%3D%22https%3A%2F%2Fashiqf.com%2F2021%2F03%2F16%2Fcall-microsoft-graph-api-in-power-apps-and-power-automate-using-a-custom-connector%2F%22%20target%3D%22_blank%22%20rel%3D%22noopener%20nofollow%20noreferrer%22%3ECall%20Microsoft%20Graph%20API%20in%20Power%20Apps%20and%20Power%20Automate%20using%20a%20Custom%20connector%3C%2FA%3E%20for%20detailed%20instructions.%3C%2FP%3E%0A%3CH2%20id%3D%22toc-hId-448680192%22%20id%3D%22toc-hId-448680192%22%20id%3D%22toc-hId-448680192%22%20id%3D%22toc-hId-448680192%22%20id%3D%22toc-hId-448680192%22%20id%3D%22toc-hId-448680192%22%3EGrant%20Access%20to%20SharePoint%20site%20for%20the%20external%20user%3A%3C%2FH2%3E%0A%3CP%3EAs%20soon%20as%20the%20guest%20account%20invite%20is%20sent%20from%20the%20above%20Microsoft%20graph%20API%20request%20HTTP%20action%2C%20it%20is%20time%20to%20grant%20access%20to%20the%20SharePoint%20site%20for%20the%20external%20user.%20There%20is%20a%20SharePoint%20REST%20API%20endpoint%20to%20add%20a%20user%20to%20a%20SharePoint%20group%20(Owners%2C%20Member%2C%20Visitors)%2C%20find%20below%20the%20request%20details%3C%2FP%3E%0A%3CP%3E%3CSTRONG%3ERequest%20URL%3C%2FSTRONG%3E%3A%26nbsp%3B%3CA%20href%3D%22https%3A%2F%2Ftenantname.sharepoint.com%2Fsites%2FsiteName%2F%20_api%2Fweb%2Fsitegroups%2FGetById(groupId)%2Fusers%22%20target%3D%22_self%22%20rel%3D%22nofollow%20noopener%20noreferrer%22%3Ehttps%3A%2F%2Ftenantname.sharepoint.com%2Fsites%2FsiteName%2F%20_api%2Fweb%2Fsitegroups%2FGetById(groupId)%2Fusers%3C%2FA%3E%3C%2FP%3E%0A%3CP%3EFor%20the%20groupId%20to%20the%20corresponding%20SharePoint%20group%2C%20refer%20to%20the%20following%20table%3C%2FP%3E%0A%3CTABLE%20border%3D%222%22%3E%0A%3CTBODY%3E%0A%3CTR%3E%0A%3CTD%20width%3D%22302%22%3E%3CP%3E%3CSTRONG%3ESharePoint%20Group%3C%2FSTRONG%3E%3C%2FP%3E%0A%3C%2FTD%3E%0A%3CTD%20width%3D%22302%22%3E%3CP%3E%3CSTRONG%3EGroupId%3C%2FSTRONG%3E%3C%2FP%3E%0A%3C%2FTD%3E%0A%3C%2FTR%3E%0A%3CTR%3E%0A%3CTD%20width%3D%22302%22%3E%3CP%3EOwners%3C%2FP%3E%0A%3C%2FTD%3E%0A%3CTD%20width%3D%22302%22%3E%3CP%3E3%3C%2FP%3E%0A%3C%2FTD%3E%0A%3C%2FTR%3E%0A%3CTR%3E%0A%3CTD%20width%3D%22302%22%3E%3CP%3EMembers%3C%2FP%3E%0A%3C%2FTD%3E%0A%3CTD%20width%3D%22302%22%3E%3CP%3E5%3C%2FP%3E%0A%3C%2FTD%3E%0A%3C%2FTR%3E%0A%3CTR%3E%0A%3CTD%20width%3D%22302%22%3E%3CP%3EVisitors%3C%2FP%3E%0A%3C%2FTD%3E%0A%3CTD%20width%3D%22302%22%3E%3CP%3E4%3C%2FP%3E%0A%3C%2FTD%3E%0A%3C%2FTR%3E%0A%3C%2FTBODY%3E%0A%3C%2FTABLE%3E%0A%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3CP%3E%3CSTRONG%3EHeaders%3C%2FSTRONG%3E%3A%3C%2FP%3E%0A%3CP%3E%3CU%3E%3CEM%3EKey%3C%2FEM%3E%3C%2FU%3E%3A%20accept%20%3CU%3E%3CEM%3Evalue%3C%2FEM%3E%3C%2FU%3E%3A%20application%2Fjson%3Bodata.metadata%3Dnone%3C%2FP%3E%0A%3CP%3E%3CU%3E%3CEM%3EKey%3C%2FEM%3E%3C%2FU%3E%3A%20content-type%20%3CU%3E%3CEM%3Evalue%3C%2FEM%3E%3C%2FU%3E%3A%20application%2Fjson%3C%2FP%3E%0A%3CP%3E%3CSTRONG%3EBody%3C%2FSTRONG%3E%3A%3C%2FP%3E%0A%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3CPRE%20class%3D%22lia-code-sample%20language-applescript%22%3E%3CCODE%3E%7B\'LoginName\'%3A\'i%3A0%23.f%7Cmembership%7CuserPrinipalNameorEmailaddressofExternalUser\'%7D%3C%2FCODE%3E%3C%2FPRE%3E%0A%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3CP%3EFor%20the%20external%20user%2C%20the%20email%20address%20used%20to%20send%20the%20invite%20works.%3C%2FP%3E%0A%3CP%3EGo%20back%20to%20the%20flow%20and%20add%20the%20action%20%3CSTRONG%3ESend%20an%20HTTP%20request%20to%20SharePoint%3C%2FSTRONG%3E%20to%20call%20the%20above%20REST%20api.%20Find%20below%20the%20screenshot%20of%20the%20action%3C%2FP%3E%0A%3CP%3E%3CSPAN%20class%3D%22lia-inline-image-display-wrapper%20lia-image-align-inline%22%20image-alt%3D%22AddUsertoSharePointGroup.png%22%20style%3D%22width%3A%20605px%3B%22%3E%3CIMG%20src%3D%22https%3A%2F%2Ftechcommunity.microsoft.com%2Ft5%2Fimage%2Fserverpage%2Fimage-id%2F283876i3A58AC17FEAE1E79%2Fimage-size%2Flarge%3Fv%3Dv2%26amp%3Bpx%3D999%22%20role%3D%22button%22%20title%3D%22AddUsertoSharePointGroup.png%22%20alt%3D%22AddUsertoSharePointGroup.png%22%20%2F%3E%3C%2FSPAN%3E%3C%2FP%3E%0A%3CP%3EThe%20above%20action%20uses%20delegated%20permission%2C%20the%20user%20of%20the%20connection%20should%20have%20access%20to%20the%20SharePoint%20site.%20As%20of%20now%2C%20there%20is%20no%20Graph%20API%20for%20adding%20the%20user%20to%20a%20SharePoint%20group%20but%20you%20can%20register%20an%20app%20in%20Active%20directory%20and%20add%20permission%20for%20SharePoint%20to%20call%20the%20above%20REST%20API.%20Refer%20to%20the%20documentation%20%3CA%20href%3D%22https%3A%2F%2Fdocs.microsoft.com%2Fen-us%2Fsharepoint%2Fdev%2Fsolution-guidance%2Fsecurity-apponly-azuread%22%20target%3D%22_blank%22%20rel%3D%22noopener%20noreferrer%22%3EGranting%20access%20via%20Azure%20AD%20App-Only%3C%2FA%3E%20for%20calling%20the%20REST%20API%20using%20the%20registered%20AD%20app.%3C%2FP%3E%0A%3CH2%20id%3D%22toc-hId-314995468%22%20id%3D%22toc-hId-314995468%22%20id%3D%22toc-hId-314995468%22%20id%3D%22toc-hId-314995468%22%20id%3D%22toc-hId-314995468%22%20id%3D%22toc-hId-314995468%22%3ETesting%20the%20flow%3A%3C%2FH2%3E%0A%3CP%3EThe%20whole%20flow%20can%20now%20be%20tested%20by%20submitting%20the%20form%20which%20sends%20the%20adaptive%20card%20on%20Teams%20first%20as%20shown%20below%3C%2FP%3E%0A%3CP%3E%3CSPAN%20class%3D%22lia-inline-image-display-wrapper%20lia-image-align-inline%22%20image-alt%3D%22AdaptiveCard-InTeamsChannel.png%22%20style%3D%22width%3A%20605px%3B%22%3E%3CIMG%20src%3D%22https%3A%2F%2Ftechcommunity.microsoft.com%2Ft5%2Fimage%2Fserverpage%2Fimage-id%2F283877i2CAE3F5DAFF07A49%2Fimage-size%2Flarge%3Fv%3Dv2%26amp%3Bpx%3D999%22%20role%3D%22button%22%20title%3D%22AdaptiveCard-InTeamsChannel.png%22%20alt%3D%22AdaptiveCard-InTeamsChannel.png%22%20%2F%3E%3C%2FSPAN%3E%3C%2FP%3E%0A%3CP%3EAfter%20the%20card%20is%20approved%2C%20the%20invite%20is%20sent%20to%20the%20external%20user.%20After%20the%20external%20user%20accepts%20the%20invite%2C%20the%20user%20should%20be%20automatically%20redirected%20to%20the%20SharePoint%20site%20with%20the%20appropriate%20access.%20The%20access%20to%20the%20SharePoint%20site%20for%20the%20external%20user%20can%20be%20validated%20by%20the%20checking%20the%20membership%20of%20the%20SharePoint%20group%20in%20the%20site%20even%20before%20the%20user%20accepts%20the%20invitation.%20The%20site%20members%20can%20also%20be%20validated%20by%20accessing%20the%20URL%20for%20All%20users%20list%3A%3C%2FP%3E%0A%3CP%3E%3CA%20href%3D%22https%3A%2F%2FtenantName.sharepoint.com%2Fsites%2FsiteName%2F_layouts%2F15%2Fpeople.aspx%3FMembershipGroupId%3D0%22%20target%3D%22_blank%22%20rel%3D%22noopener%20nofollow%20noreferrer%22%3Ehttps%3A%2F%2FtenantName.sharepoint.com%2Fsites%2FsiteName%2F_layouts%2F15%2Fpeople.aspx%3FMembershipGroupId%3D0%3C%2FA%3E%3C%2FP%3E%0A%3CP%3EThis%20approach%20of%20granting%20access%20to%20SharePoint%20site%20for%20external%20user%20can%20be%20applied%20to%20internal%20users%20by%20%3CA%20href%3D%22https%3A%2F%2Fsupport.microsoft.com%2Fen-us%2Foffice%2Fset-up-and-manage-access-requests-94b26e0b-2822-49d4-929a-8455698654b3%22%20target%3D%22_blank%22%20rel%3D%22noopener%20noreferrer%22%3Eturning%20off%20the%20access%20requests%3C%2FA%3E.%3C%2FP%3E%0A%3CH2%20id%3D%22toc-hId\--1492458995%22%20id%3D%22toc-hId\--1492458995%22%20id%3D%22toc-hId\--1492458995%22%20id%3D%22toc-hId\--1492458995%22%20id%3D%22toc-hId\--1492458995%22%20id%3D%22toc-hId\--1492458995%22%3ELimit%20External%20Sharing%20by%20domain%3A%3C%2FH2%3E%0A%3CP%3EThe%20external%20sharing%20on%20SharePoint%20can%20be%20restricted%20based%20on%20domain%20of%20the%20external%20user.%20To%20enable%20the%20setting%20login%20into%20the%20SharePoint%20admin%20center%20%26gt%3B%20Policies%20%26gt%3B%20Sharing%20%26gt%3B%20Enable%20the%20checkbox%20Limit%20external%20sharing%20by%20domain%20%26gt%3B%20Add%20domain%3C%2FP%3E%0A%3CP%3E%3CSPAN%20class%3D%22lia-inline-image-display-wrapper%20lia-image-align-inline%22%20image-alt%3D%22ExternalSharing-RestrictDomain.png%22%20style%3D%22width%3A%20605px%3B%22%3E%3CIMG%20src%3D%22https%3A%2F%2Ftechcommunity.microsoft.com%2Ft5%2Fimage%2Fserverpage%2Fimage-id%2F283878i2BCE04FF59AD8213%2Fimage-size%2Flarge%3Fv%3Dv2%26amp%3Bpx%3D999%22%20role%3D%22button%22%20title%3D%22ExternalSharing-RestrictDomain.png%22%20alt%3D%22ExternalSharing-RestrictDomain.png%22%20%2F%3E%3C%2FSPAN%3E%3C%2FP%3E%0A%3CH1%20id%3D%22toc-hId-865971119%22%20id%3D%22toc-hId-865971119%22%20id%3D%22toc-hId-865971119%22%20id%3D%22toc-hId-865971119%22%20id%3D%22toc-hId-865971119%22%20id%3D%22toc-hId-865971119%22%3EOnboard%20External%20users%20to%20a%20Microsoft%20Team%3A%3C%2FH1%3E%0A%3CP%3ETo%20onboard%20the%20external%20user%20to%20a%20Microsoft%20Team%2C%20the%20only%20change%20to%20the%20above%20flow%20is%2C%20instead%20of%20adding%20the%20user%20to%20the%20SharePoint%20group%20the%20user%20must%20be%20added%20as%20a%20Member%20to%20the%20Microsoft%20365%20group%20connected%20to%20the%20Microsoft%20Teams.%20The%20graph%20API%20to%20%3CA%20href%3D%22https%3A%2F%2Fdocs.microsoft.com%2Fen-us%2Fgraph%2Fapi%2Fteam-post-members%3Fview%3Dgraph-rest-1.0%26amp%3Btabs%3Dhttp%22%20target%3D%22_blank%22%20rel%3D%22noopener%20noreferrer%22%3Eadd%20a%20member%3C%2FA%3E%20to%20a%20Microsoft%20Team%20is%3C%2FP%3E%0A%3CP%3E%3CSTRONG%3ERequest%20Type%3C%2FSTRONG%3E%3A%20POST%3C%2FP%3E%0A%3CP%3E%3CSTRONG%3ERequest%20URL%3C%2FSTRONG%3E%3A%20%3CA%20href%3D%22https%3A%2F%2Fgraph.microsoft.com%2Fv1.0%2Fteams%2F%257bteam-id%257d%2Fmembers%22%20target%3D%22_blank%22%20rel%3D%22noopener%20noreferrer%22%3Ehttps%3A%2F%2Fgraph.microsoft.com%2Fv1.0%2Fteams%2F%7Bteam-id%7D%2Fmembers%3C%2FA%3E%3C%2FP%3E%0A%3CP%3EThe%20team-id%20is%20the%20Microsoft%20365%20group%20object%20Id%2C%20as%20there%20is%20always%20a%20Microsoft%20365%20group%20connected%20to%20a%20Microsoft%20Team.%3C%2FP%3E%0A%3CP%3E%3CSTRONG%3EBody%3C%2FSTRONG%3E%3A%3C%2FP%3E%0A%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3CPRE%20class%3D%22lia-code-sample%20language-applescript%22%3E%3CCODE%3E%7B%0A%20%20%20%20%22%40odata.type%22%3A%20%22%23microsoft.graph.aadUserConversationMember%22%2C%0A%20%20%20%20%22roles%22%3A%20%5B%22owner%22%5D%2C%0A%20%20%20%20%22user%40odata.bind%22%3A%20%22https%3A%2F%2Fgraph.microsoft.com%2Fv1.0%2Fusers(userObjectIdofGuest\')%22%0A%7D%0A%3C%2FCODE%3E%3C%2FPRE%3E%0A%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3CP%3EThe%20expression%20to%20get%20the%20user%20object%20Id%20of%20the%20external%20user%20as%20per%20the%20below%20screenshot%20is%3C%2FP%3E%0A%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3CPRE%20class%3D%22lia-code-sample%20language-applescript%22%3E%3CCODE%3Eoutputs(\'HTTP-SendGuestInvitation\').body.invitedUser.Id%3C%2FCODE%3E%3C%2FPRE%3E%0A%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3CP%3EThe%20expression%20can%20be%20used%20in%20a%20compose%20action%20to%20get%20the%20Object%20Id%20of%20the%20external%20user%20which%20can%20be%20used%20in%20the%20Graph%20API%20request%20to%20add%20the%20member%20to%20a%20Team.%26nbsp%3B%3CSTRONG%3EHTTP-SendGuestInvitation%3C%2FSTRONG%3E%20is%20the%20name%20of%20the%20HTTP%20Action.%3C%2FP%3E%0A%3CP%3E%3CSPAN%20class%3D%22lia-inline-image-display-wrapper%20lia-image-align-inline%22%20image-alt%3D%22externalUserObjectId.png%22%20style%3D%22width%3A%20605px%3B%22%3E%3CIMG%20src%3D%22https%3A%2F%2Ftechcommunity.microsoft.com%2Ft5%2Fimage%2Fserverpage%2Fimage-id%2F283882i30DB43DB52F61917%2Fimage-size%2Flarge%3Fv%3Dv2%26amp%3Bpx%3D999%22%20role%3D%22button%22%20title%3D%22externalUserObjectId.png%22%20alt%3D%22externalUserObjectId.png%22%20%2F%3E%3C%2FSPAN%3E%3C%2FP%3E%0A%3CH2%20id%3D%22toc-hId\--812400625%22%20id%3D%22toc-hId\--812400625%22%20id%3D%22toc-hId\--812400625%22%20id%3D%22toc-hId\--812400625%22%20id%3D%22toc-hId\--812400625%22%20id%3D%22toc-hId\--812400625%22%3EPermission%20for%20the%20Azure%20AD%20App%20to%20add%20a%20member%20to%20a%20Microsoft%20Team%3A%3C%2FH2%3E%0A%3CP%3EThe%20application%20permission%20Group.ReadWrite.All%20has%20to%20be%20added%20on%20the%20Azure%20AD%20app%2C%20if%20you%20are%20going%20to%20be%20using%20the%20same%20JSON%20webtoken%20generated%20above.%20There%20is%20delegated%20permission%20as%20well%20for%20adding%20members.%3C%2FP%3E%0A%3CP%3E%3CA%20href%3D%22https%3A%2F%2Fgraph.microsoft.com%2FGroup.ReadWrite.All%22%20target%3D%22_blank%22%20rel%3D%22noopener%20noreferrer%22%3Ehttps%3A%2F%2Fgraph.microsoft.com%2FGroup.ReadWrite.All%3C%2FA%3E%3C%2FP%3E%0A%3CP%3EI%20recommend%20you%20read%20the%20following%20documentation%20from%20Microsoft%20for%20External%20sharing%3C%2FP%3E%0A%3CP%3E%3CA%20href%3D%22https%3A%2F%2Fdocs.microsoft.com%2Fen-us%2Fmicrosoftteams%2Fmanage-external-access%22%20target%3D%22_blank%22%20rel%3D%22noopener%20noreferrer%22%3Ehttps%3A%2F%2Fdocs.microsoft.com%2Fen-us%2Fmicrosoftteams%2Fmanage-external-access%3C%2FA%3E%3C%2FP%3E%0A%3CP%3E%3CA%20href%3D%22https%3A%2F%2Fdocs.microsoft.com%2Fen-us%2Fmicrosoftteams%2Fguest-access%22%20target%3D%22_blank%22%20rel%3D%22noopener%20noreferrer%22%3Ehttps%3A%2F%2Fdocs.microsoft.com%2Fen-us%2Fmicrosoftteams%2Fguest-access%3C%2FA%3E%3C%2FP%3E%0A%3CP%3E%3CA%20href%3D%22https%3A%2F%2Fdocs.microsoft.com%2Fen-us%2Fmicrosoftteams%2Fcommunicate-with-users-from-other-organizations%22%20target%3D%22_blank%22%20rel%3D%22noopener%20noreferrer%22%3Ehttps%3A%2F%2Fdocs.microsoft.com%2Fen-us%2Fmicrosoftteams%2Fcommunicate-with-users-from-other-organizations%3C%2FA%3E%3C%2FP%3E%0A%3CH2%20id%3D%22toc-hId-1675112208%22%20id%3D%22toc-hId-1675112208%22%20id%3D%22toc-hId-1675112208%22%20id%3D%22toc-hId-1675112208%22%20id%3D%22toc-hId-1675112208%22%20id%3D%22toc-hId-1675112208%22%3E%3CSTRONG%3ESummary%3A%3C%2FSTRONG%3E%3C%2FH2%3E%0A%3CP%3EWith%20this%2C%20the%20Power%20Automate%20flow%20should%20send%20the%20invitation%20as%20shown%20below%20to%20the%20external%20user.%3C%2FP%3E%0A%3CP%3E%3CSPAN%20class%3D%22lia-inline-image-display-wrapper%20lia-image-align-inline%22%20image-alt%3D%22externalUserInvitationEmail.png%22%20style%3D%22width%3A%20605px%3B%22%3E%3CIMG%20src%3D%22https%3A%2F%2Ftechcommunity.microsoft.com%2Ft5%2Fimage%2Fserverpage%2Fimage-id%2F283883i12B00828DE4DB125%2Fimage-size%2Flarge%3Fv%3Dv2%26amp%3Bpx%3D999%22%20role%3D%22button%22%20title%3D%22externalUserInvitationEmail.png%22%20alt%3D%22externalUserInvitationEmail.png%22%20%2F%3E%3C%2FSPAN%3E%3C%2FP%3E%0A%3CP%3EIf%20it%20is%20for%20a%20Microsoft%20Team%2C%20the%20external%20user%20should%20be%20licensed%20for%20teams%20service%20to%20open%20it%20on%20their%20teams%20client.%20The%20same%20flow%20can%20be%20also%20configured%20for%20Microsoft%20365%20group.%3C%2FP%3E%0A%3CP%3EThis%20post%20was%20originally%20published%20in%20%3CA%20href%3D%22https%3A%2F%2Fashiqf.com%2F2021%2F05%2F26%2Fhow-to-invite-external-users-to-a-sharepoint-site-or-microsoft-team-using-power-automate-and-graph-api%2F%22%20target%3D%22_self%22%20rel%3D%22nofollow%20noopener%20noreferrer%22%3Eashiqf.com%3C%2FA%3E%3C%2FP%3E%0A%3CP%3E%26nbsp%3B%3C%2FP%3E%3C%2FLINGO-BODY%3E%3CLINGO-TEASER%20id%3D%22lingo-teaser-2385603%22%20slang%3D%22en-US%22%3E%3CP%3EBuild%20a%20self-service%20registration%20for%20inviting%20guest%20or%20external%20user%20to%20a%20SharePoint%20site%20or%20Microsoft%20Teams%20using%20Power%20Automate%2C%20Microsoft%20form%20%26amp%3B%20Graph%20API%3C%2FP%3E%3C%2FLINGO-TEASER%3E%3CLINGO-LABS%20id%3D%22lingo-labs-2385603%22%20slang%3D%22en-US%22%3E%3CLINGO-LABEL%3EHow%20to%3C%2FLINGO-LABEL%3E%3C%2FLINGO-LABS%3E%3CLINGO-SUB%20id%3D%22lingo-sub-2394162%22%20slang%3D%22en-US%22%3ERe%3A%20How%20to%20invite%20external%20users%20to%20a%20SharePoint%20site%20or%20Microsoft%20Team%20using%20Power%20Automate%20%26amp%3B%20G%3C%2FLINGO-SUB%3E%3CLINGO-BODY%20id%3D%22lingo-body-2394162%22%20slang%3D%22en-US%22%3E%3CP%3EThis%20is%20a%20very%20useful%20blog%20post%20and%20a%20good%20piece%20of%20knowledge%20sharing%2C%20but%20let\'s%20keep%20in%20mind%20the%20big%20picture%20here.%3C%2FP%3E%3CP%3E%26nbsp%3B%3C%2FP%3E%3CP%3EYou%20need%20to%20do%20all%20of%20this%20complicated%20stuff%2C%20simply%20to%20enable%20the%20completely%20predictable%20and%20foreseeable%20outcome%20described%20in%20the%20first%20couple%20of%20words%20in%20the%20headline.%3C%2FP%3E%3C%2FLINGO-BODY%3E

::: {#threadTranslationDashboard .Thread_Translation_Dashboard ng-controller="lingotekThreadTranslationCtrl" li-bindable=""}
::: lingotek-admin-dashboard
:::
:::

::: {style="clear:both"}
:::

::: {#contributorsTaplet .ContributorsTaplet .lia-component-tkb-widget-contributors-taplet}
::: {.lia-panel .lia-panel-standard}
::: lia-decoration-border
::: lia-decoration-border-top
<div>

</div>
:::

::: lia-decoration-border-content
<div>

::: lia-panel-heading-bar-wrapper
::: lia-panel-heading-bar
[ Co-Authors ]{.lia-panel-heading-bar-title aria-level="3"
role="heading"}
:::
:::

::: lia-panel-content-wrapper
::: lia-panel-content
::: {.UserProfileSummary .lia-user-item .lia-js-data-userId-435366 .lia-user-info-group}
::: UserAvatarWrapper
::: {.UserAvatar .lia-user-avatar .lia-component-common-widget-user-avatar .New .Contributor}
[![AshiqFaleel](https://techcommunity.microsoft.com/t5/image/serverpage/image-id/280812i7FC0F56A05729378/image-dimensions/40x40?v=v2 "AshiqFaleel"){.lia-user-avatar-message
.user-rank-ring style=""
onerror="replaceBrokenAvatars(this, '/html/assets/default-avatar.png')"}](/t5/user/viewprofilepage/user-id/435366){.UserAvatar
.lia-link-navigation}
:::

::: {.user-profile-card user-id="435366"}
::: contents
::: spinner
:::
:::
:::
:::

::: lia-user-attributes
::: lia-user-name
[
[AshiqFaleel](https://techcommunity.microsoft.com/t5/user/viewprofilepage/user-id/435366){#link_12
.lia-link-navigation .lia-page-link .lia-user-name-link} ]{.UserName
.lia-user-name .lia-user-rank-New-Contributor}
:::
:::
:::
:::
:::

</div>
:::

::: lia-decoration-border-bottom
<div>

</div>
:::
:::
:::
:::

::: {.lia-panel .lia-panel-standard .ArticleRevisionInfoTaplet .Chrome .lia-component-tkb-widget-article-revision-info-taplet}
::: lia-decoration-border
::: lia-decoration-border-top
<div>

</div>
:::

::: lia-decoration-border-content
<div>

::: lia-panel-heading-bar-wrapper
::: lia-panel-heading-bar
[Version history]{.lia-panel-heading-bar-title aria-level="3"
role="heading"}
:::
:::

::: lia-panel-content-wrapper
::: lia-panel-content
::: lia-revision-info-wrapper
::: lia-revision-info-content
::: {.lia-revision-info-row .lia-revision-last-update-row}
::: lia-revision-info-title-cell
Last update:
:::

::: lia-revision-info-data-cell
[ [‎May 26 2021]{.local-date} [08:16 AM]{.local-time} ]{.DateTime}
:::
:::

::: {.lia-revision-info-row .lia-revision-author-row}
::: lia-revision-info-title-cell
Updated by:
:::

::: lia-revision-info-data-cell
[
[AshiqFaleel](https://techcommunity.microsoft.com/t5/user/viewprofilepage/user-id/435366){#link_13
.lia-link-navigation .lia-page-link .lia-user-name-link} ]{.UserName
.lia-user-name .lia-user-rank-New-Contributor}
:::
:::

::: {.lia-revision-info-row .lia-revision-article-history-link-row .lia-revision-info-data-cell-workflow}
:::
:::
:::
:::
:::

</div>
:::

::: lia-decoration-border-bottom
<div>

</div>
:::
:::
:::

::: {.lia-panel .lia-panel-standard .LabelsTaplet .Chrome .lia-component-labels-widget-labels-list .custom-blog-article-label-widget}
::: lia-decoration-border
::: lia-decoration-border-top
<div>

</div>
:::

::: lia-decoration-border-content
::: lia-panel-heading-bar-wrapper
::: lia-panel-heading-bar
[Labels]{.lia-panel-heading-bar-title aria-level="4" role="heading"}
:::
:::

::: lia-panel-content-wrapper
::: lia-panel-content
::: BlogLabelsTaplet
::: LabelsList
::: {.spinner .labels-spinner}
:::

::: labels-container
:::
:::
:::
:::
:::
:::

::: lia-decoration-border-bottom
<div>

</div>
:::
:::
:::

::: blog-article-social-share-widget-wrapper
::: custom-social-share-component
::: custom-social-share-widget
::: {.lia-panel .lia-panel-standard .Chrome .custom-share-component style=""}
::: lia-decoration-border
::: lia-decoration-border-top
<div>

</div>
:::

::: lia-decoration-border-content
<div>

::: lia-panel-heading-bar-wrapper
::: lia-panel-heading-bar
## Share {#customShareWidget .lia-panel-heading-bar-title .hello}
:::
:::

::: lia-panel-content-wrapper
::: lia-panel-content
-   [[Share to
    LinkedIn]{.social-share-title}](http://www.linkedin.com/shareArticle?mini=true&url=https://techcommunity.microsoft.com/t5/microsoft-365-pnp-blog/how-to-invite-external-users-to-a-sharepoint-site-or-microsoft/ba-p/2385603 "Share to LinkedIn"){.social-share-link
    .social-share-linkedin}
-   [[Share to
    Facebook]{.social-share-title}](http://www.facebook.com/share.php?u=https://techcommunity.microsoft.com/t5/microsoft-365-pnp-blog/how-to-invite-external-users-to-a-sharepoint-site-or-microsoft/ba-p/2385603 "Share to FaceBook"){.social-share-link
    .social-share-facebook}
-   [[Share to
    Twitter]{.social-share-title}](http://twitter.com/share?text=Check%20out%20this%20post%20on%20the%20Microsoft%20Tech%20Community%20:%20How%20to%20invite%20external%20users%20to%20a%20SharePoint%20site%20or%20Microsoft%20Team%20using%20Power%20Automate%20&%20Graph%20API%20-%20Microsoft%20Tech%20Community&url=https://techcommunity.microsoft.com/t5/microsoft-365-pnp-blog/how-to-invite-external-users-to-a-sharepoint-site-or-microsoft/ba-p/2385603 "Share to Twitter"){.social-share-link
    .social-share-twitter}
-   [[Share to
    Email]{.social-share-title}](mailto:?subject=How%20to%20invite%20external%20users%20to%20a%20SharePoint%20site%20or%20Microsoft%20Team%20using%20Power%20Automate%20&%20Graph%20API%20-%20Microsoft%20Tech%20Community&body=I%20found%20this%20on%20the%20Microsoft%20Tech%20Community%20and%20wanted%20to%20share%20it%20with%20you,%20check%20it%20out%20:%20https://techcommunity.microsoft.com/t5/microsoft-365-pnp-blog/how-to-invite-external-users-to-a-sharepoint-site-or-microsoft/ba-p/2385603 "Share via email"){.social-share-link
    .social-share-email}
:::
:::

</div>
:::

::: lia-decoration-border-bottom
<div>

</div>
:::
:::
:::
:::
:::
:::
:::
:::
:::

::: {.lia-quilt-row .lia-quilt-row-footer}
::: {.lia-quilt-column .lia-quilt-column-24 .lia-quilt-column-single .lia-quilt-column-common-footer}
::: {.lia-quilt-column-alley .lia-quilt-column-alley-single}
::: {.lia-quilt .lia-quilt-footer .lia-quilt-layout-footer .lia-component-quilt-footer}
::: {.lia-quilt-row .lia-quilt-row-main}
::: {.lia-quilt-column .lia-quilt-column-24 .lia-quilt-column-single .lia-quilt-column-icons}
::: {.lia-quilt-column-alley .lia-quilt-column-alley-single .lia-mark-empty}
:::
:::
:::
:::
:::
:::
:::
:::
:::
:::
:::
:::

::: {.cse-46444-wa style="display: none"}
::: {.lia-slide-out-nav-menu .lia-component-common-widget-slide-out-nav-menu}
::: {.lia-slide-out-nav-menu-title ng-non-bindable=""}
Browse
:::

::: {.lia-quilt .lia-quilt-navigation-slide-out-menu .lia-quilt-layout-one-column .lia-top-quilt}
::: {.lia-quilt-row .lia-quilt-row-header}
::: {.lia-quilt-column .lia-quilt-column-24 .lia-quilt-column-single .lia-quilt-column-common-header .lia-mark-empty}
:::
:::

::: {.lia-quilt-row .lia-quilt-row-main}
::: {.lia-quilt-column .lia-quilt-column-24 .lia-quilt-column-single .lia-quilt-column-main-content}
::: {.lia-quilt-column-alley .lia-quilt-column-alley-single}
:::
:::
:::

::: {.lia-quilt-row .lia-quilt-row-footer}
::: {.lia-quilt-column .lia-quilt-column-24 .lia-quilt-column-single .lia-quilt-column-common-footer .lia-mark-empty}
:::
:::
:::
:::
:::

::: {.shell-footer bi-view="5xLinks" bi-area="Footer" ms.pgarea="uhffooter" role="contentinfo"}
::: shell-footer-wrapper
::: {.shell-footer-menugroups ms.cmpgrp="footer nav"}
::: {.sfm-group ms.cmpnm="WhatsNew"}
###### What\'s new  {#whats-new .grp-title}

-   [Surface Pro
    X](https://www.microsoft.com/p/surface-pro-x/8vdnrp2m6hhc?activetab=overview)
-   [Surface Laptop
    3](https://www.microsoft.com/p/surface-laptop-3/8VFGGH1R94TM?activetab=overview)
-   [Surface Pro
    7](https://www.microsoft.com/p/surface-pro-7/8N17J0M5ZZQS?activetab=overview)
-   [Windows 10 Apps](https://www.microsoft.com/windows/windows-10-apps)
-   [Office apps](https://store.office.com/appshome.aspx)
:::

::: {.sfm-group ms.cmpnm="MicrosoftStore"}
###### Microsoft Store  {#microsoft-store .grp-title}

-   [Account profile](https://account.microsoft.com/)
-   [Download Center](https://www.microsoft.com/download)
-   [Microsoft Store
    support](https://go.microsoft.com/fwlink/p/?LinkID=824761&clcid=0x409)
-   [Returns](https://go.microsoft.com/fwlink/p/?LinkID=824764&clcid=0x409)
-   [Order tracking](https://account.microsoft.com/orders)
-   [Store
    locations](https://www.microsoft.com/en-us/store/locations/find-a-store?icid=en-us_UF_FAS)
-   [Buy online, pick up in
    store](https://www.microsoft.com/en-us/store/b/buy-online-pick-up-in-store?icid=uhf_footer_bopuis)
-   [In-store
    events](https://www.microsoft.com/en-us/store/locations/events?icid=en_us_store_uhf_events)
:::

::: {.sfm-group ms.cmpnm="Education"}
###### Education  {#education .grp-title}

-   [Microsoft in education](https://www.microsoft.com/education)
-   [Office for
    students](https://www.microsoft.com/education/products/office/default.aspx)
-   [Office for
    schools](https://products.office.com/academic/compare-office-365-education-plans)
-   [Deals for students and
    parents](https://www.microsoft.com/en-us/store/b/education?icid=CNavfooter_Studentsandeducation)
-   [Microsoft Azure in
    education](https://azure.microsoft.com/community/education/)
:::

::: {.sfm-group ms.cmpnm="Enterprise"}
###### Enterprise  {#enterprise .grp-title}

-   [Azure](https://azure.microsoft.com/)
-   [AppSource](https://go.microsoft.com/fwlink/?LinkID=808093)
-   [Automotive](https://www.microsoft.com/enterprise/automotive)
-   [Government](https://www.microsoft.com/enterprise/government)
-   [Healthcare](https://www.microsoft.com/enterprise/health)
-   [Manufacturing](https://www.microsoft.com/enterprise/manufacturing)
-   [Financial
    Services](https://www.microsoft.com/enterprise/financial-services/banking-and-capital-markets)
-   [Retail](https://www.microsoft.com/enterprise/retail-consumer-goods)
:::

::: {.sfm-group ms.cmpnm="Developer"}
###### Developer  {#developer .grp-title}

-   [Microsoft Visual Studio](https://visualstudio.microsoft.com/)
-   [Window Dev Center](https://developer.microsoft.com/windows)
-   [Developer Network](https://msdn.microsoft.com/)
-   [TechNet](https://technet.microsoft.com/)
-   [Microsoft developer
    program](https://developer.microsoft.com/store/register)
-   [Channel 9](https://channel9.msdn.com/)
-   [Office Dev Center](https://developer.microsoft.com/office)
-   [Microsoft Garage](https://www.microsoft.com/garage/)
:::

::: {.sfm-group ms.cmpnm="Company"}
###### Company  {#company .grp-title}

-   [Careers](https://careers.microsoft.com/)
-   [About Microsoft](https://www.microsoft.com/en-us/about)
-   [Company News](https://news.microsoft.com/)
-   [Privacy at Microsoft](https://privacy.microsoft.com/)
-   [Investors](https://www.microsoft.com/investor/default.aspx)
-   [Diversity and inclusion](https://www.microsoft.com/diversity/)
-   [Accessibility](https://www.microsoft.com/accessibility)
-   [Security](https://www.microsoft.com/security/default.aspx)
:::
:::

::: {.shell-footer-copyright ms.cmpnm="corp" ms.cmpgrp="corp links"}
-   [Sitemap](https://www.microsoft.com/en-us/sitemap1.aspx){#shellmenu_0
    .ctl_footerNavLink}
-   [Contact
    Microsoft](https://support.microsoft.com/contactus){#shellmenu_1
    .ctl_footerNavLink}
-   [Privacy](https://go.microsoft.com/fwlink/?LinkId=521839){#shellmenu_2
    .ctl_footerNavLink}
-   [Manage cookies](#){#shellmenu_2B .ctl_footerNavLink .hidden}
-   [Terms of
    use](http://go.microsoft.com/fwlink/?LinkID=206977){#shellmenu_3
    .ctl_footerNavLink}
-   [Trademarks](https://www.microsoft.com/trademarks){#shellmenu_4
    .ctl_footerNavLink}
-   [Safety and
    eco](https://www.microsoft.com/devices/safety-and-eco){#shellmenu_5
    .ctl_footerNavLink}
-   [About our ads](https://choice.microsoft.com/){#shellmenu_6
    .ctl_footerNavLink}
-   © []{#footerDate} Microsoft
:::
:::
:::
:::
