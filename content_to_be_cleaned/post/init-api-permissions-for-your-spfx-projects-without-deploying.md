::: {#437-003-1 .ServiceNodeInfoHeader}
:::

::: lia-page
::: MinimumWidthContainer
::: min-width-wrapper
::: min-width
::: lia-content
::: {.lia-quilt .lia-quilt-blog-article-page .lia-quilt-layout-two-column-main-side-18-6 .lia-top-quilt}
::: {.lia-quilt-row .lia-quilt-row-header}
::: {.lia-quilt-column .lia-quilt-column-24 .lia-quilt-column-single .lia-quilt-column-common-header}
::: {.lia-quilt-column-alley .lia-quilt-column-alley-single}
::: {.lia-quilt .lia-quilt-header .lia-quilt-layout-header .lia-component-quilt-header}
::: {.lia-quilt-row .lia-quilt-row-main-header}
::: {.lia-quilt-column .lia-quilt-column-24 .lia-quilt-column-single .lia-quilt-column-header}
::: {.lia-quilt-column-alley .lia-quilt-column-alley-single}
::: {#cookie-banner .cookie-markup}
:::

::: {#readerAssistMessages .section .live-region aria-live="assertive" role="alert"}
:::

::: community-header-blank
:::

::: community-header-component
::: community-header-wrapper
::: container
::: {#community-menu-wrapper-menu .menu-link}
[](javascript:void(0)){#community-menu-wrapper-menu-link}

::: {#community-menu-wrapper-menu-icon .menu-icon title=""}
:::
:::

[![](https://techcommunity.microsoft.com/html/@6005EEFEC6E5ECADBBFC249DFA7D38A8/assets/Content/Images/GlobalHeader/MicrosoftLogo.png){.c-image
itemprop="logo" role="presentation" aria-hidden="true"}
[Microsoft]{role="presentation"
aria-hidden="true"}](https://www.microsoft.com){#uhfLogo .c-logo
.c-sgl-stk-uhfLogo}

::: {.c-show-pipe aria-hidden="true"}
:::

[Tech Community](/){#uhfCatLogo .c-logo .c-cat-logo}

::: container-inner
::: {#community-menu-wrapper .community-menu-wrapper .community-menu-hidden-init}
::: {#community-menu-wrapper-header-bar .community-header-bar}
[](#){.community-header-button}

::: community-menu-item-icon
:::
:::

::: {#community-menu-wrapper-list .community-menu-list}
::: {.community-menu-item .tab-homepage}
[](/)

::: {.mdl2-glyph .community-menu-item-icon}

:::

::: community-menu-item-title
Home
:::
:::

::: {.community-menu-item .community-menu-dropdown}
[](#){.community-menu-item-desktop-view}

::: {.c-glyph .community-menu-item-icon}

:::

::: community-menu-item-title-with-dropdownicon
Community Hubs
:::

[](/t5/communities/ct-p/communities#category-filter-button-all){.community-menu-item-mobile-view
.community-menu-item-allow-link}

::: {.c-glyph .community-menu-item-icon}

:::

::: community-menu-item-title-with-dropdownicon
Community Hubs
:::

::: {.dropdown .dropdown-communities .dropdown-events .dropdown-primary-nav}
-   [Community Hubs
    Home](/t5/communities/ct-p/communities#category-filter-button-all){#communities_home}
-   [Products](/t5/communities/ct-p/communities#category-filter-button-products-services){#communities_products}
-   [Special
    Topics](/t5/communities/ct-p/communities#category-filter-button-solutions){#communities_special}
-   [Video Hub](/t5/video-hub/ct-p/VideoHub){#communities_videohub}

::: custom-community-hubs-menu-wrapper
::: custom-community-hubs-menu-close
Close
:::

::: custom-community-hubs-menu-content
::: menu
## [ Products]{#menu-link-prod title="Products"} [(72)]{.small} {#menu-products .active}

## [ Special Topics ]{#menu-link-serv title="Special Topics"} [(41)]{.small} {#menu-services}

## [ Video Hub ]{#menu-link-videohub title="VideoHub"} [(834)]{.small} {#menu-videohub}
:::

::: {#products-data .dataBlock .visible key="products"}
::: {.hubs style="width: 600px"}
### Most Active Hubs

::: {.data style="flex-direction: column; height:310px"}
<div>

[Microsoft
Teams](/t5/microsoft-teams/ct-p/MicrosoftTeams "Microsoft Teams")

</div>

<div>

[Excel](/t5/excel/ct-p/Excel_Cat "Excel")

</div>

<div>

[Exchange](/t5/exchange/ct-p/Exchange "Exchange")

</div>

<div>

[SharePoint](/t5/sharepoint/ct-p/SharePoint "SharePoint")

</div>

<div>

[Windows](/t5/windows-10/ct-p/Windows10 "Windows")

</div>

<div>

[Office 365](/t5/office-365/ct-p/Office365 "Office 365")

</div>

<div>

[Security, Compliance and
Identity](/t5/security-compliance-and-identity/ct-p/MicrosoftSecurityandCompliance "Security, Compliance and Identity")

</div>

<div>

[Windows
Server](/t5/windows-server/ct-p/Windows-Server "Windows Server")

</div>

<div>

[Microsoft Edge
Insider](/t5/microsoft-edge-insider/ct-p/MicrosoftEdgeInsider "Microsoft Edge Insider")

</div>

<div>

[Azure](/t5/azure-community/ct-p/Azure "Azure")

</div>

<div>

[Microsoft 365](/t5/microsoft-365/ct-p/microsoft365 "Microsoft 365")

</div>
:::
:::

::: boxes
[](/t5/azure-databases/ct-p/AzureDatabases "Azure Databases")

::: {.box style="background-image: url('https://techcommunity.microsoft.com/html/@D05C7AA27EF9EB31779410FCB608734A/assets/bg-pink.png')"}
::: title
Azure Databases
:::

::: description
Fully managed intelligent database services.
:::
:::

[](/t5/project-bonsai/ct-p/ProjectBonsai "Autonomous Systems")

::: {.box style="background-image: url('https://techcommunity.microsoft.com/html/@FC8AD6AC9A7EBDA58D7E6304E799EA40/assets/bg-orange.png')"}
::: title
Autonomous Systems
:::

::: description
Create and optimise intelligence for industrial control systems.
:::
:::

[](/t5/yammer/ct-p/Yammer "Yammer")

::: {.box style="background-image: url('https://techcommunity.microsoft.com/html/@CF0293463F27444B05A952A3C4B6BF88/assets/bg-light-blue.png')"}
::: title
Yammer
:::

::: description
Connect and engage across your organization.
:::
:::
:::
:::

::: {#services-data .dataBlock key="services"}
::: {.hubs style="width: 600px"}
### Most Active Hubs

::: {.data style="flex-direction: column; height:310px"}
<div>

[ITOps Talk](/t5/itops-talk/ct-p/ITOpsTalk "ITOps Talk")

</div>

<div>

[Education
Sector](/t5/education-sector/ct-p/EducationSector "Education Sector")

</div>

<div>

[Microsoft
Learn](/t5/microsoft-learn/ct-p/MicrosoftLearn "Microsoft Learn")

</div>

<div>

[Microsoft
Localization](/t5/microsoft-localization/ct-p/MicrosoftTranslation "Microsoft Localization")

</div>

<div>

[Microsoft 365
PnP](/t5/microsoft-365-pnp/ct-p/Microsoft365PnP "Microsoft 365 PnP")

</div>

<div>

[Healthcare and Life
Sciences](/t5/healthcare-and-life-sciences/ct-p/HealthcareAndLifeSciences "Healthcare and Life Sciences")

</div>

<div>

[Public Sector](/t5/public-sector/ct-p/PublicSector "Public Sector")

</div>

<div>

[Internet of Things
(IoT)](/t5/internet-of-things-iot/ct-p/IoT "Internet of Things (IoT)")

</div>

<div>

[Mixed
Reality](/t5/mixed-reality/ct-p/MicrosoftMixedReality "Mixed Reality")

</div>

<div>

[Enabling Remote
Work](/t5/enabling-remote-work/ct-p/RemoteWork "Enabling Remote Work")

</div>

<div>

[Small and Medium
Business](/t5/small-and-medium-businesses/ct-p/SMB "Small and Medium Business")

</div>
:::
:::

::: boxes
[](/t5/humans-of-it/ct-p/HumansofIT "Humans of IT")

::: {.box style="background-image: url('https://techcommunity.microsoft.com/html/@A5C0BDB1059C6D1F73B8097424B50ED0/assets/bg-purple.png')"}
::: title
Humans of IT
:::

::: description
Empowering technologists to achieve more by humanizing tech.
:::
:::

[](/t5/green-tech/ct-p/GreenTech "Green Tech")

::: {.box style="background-image: url('https://cdn.techcommunity.microsoft.com/lithium/MicrosoftLearn/Learn-Blue.png')"}
::: title
Green Tech
:::

::: description
Raise awareness about sustainability in the tech sector
:::
:::

[](/t5/mvp-award-program/ct-p/MVPAwardProgram "MVP Award Program")

::: {.box style="background-image: url('https://techcommunity.microsoft.com/html/@02C247197A08F2DB06040AC786E1BF01/assets/bg-green.png')"}
::: title
MVP Award Program
:::

::: description
Find out more about the Microsoft MVP Award Program.
:::
:::
:::
:::

::: {#VideoHub-Data .dataBlock key="VideoHub"}
::: {.hubs style="width: 838px"}
### Video Hub

::: {.data style="flex-direction: row; height:fit-content"}
<div>

[Azure](https://aka.ms/VideoHub/Azure "Azure")

</div>

<div>

[Exchange](https://aka.ms/VideoHub/Exchange "Exchange")

</div>

<div>

[Microsoft 365](https://aka.ms/VideoHub/Microsoft365 "Microsoft 365")

</div>

<div>

[Microsoft 365
Business](https://aka.ms/VideoHub/Microsoft365Business "Microsoft 365 Business")

</div>

<div>

[Microsoft 365
Enterprise](https://aka.ms/VideoHub/Microsoft365Business "Microsoft 365 Enterprise")

</div>

<div>

[Microsoft Edge](https://aka.ms/VideoHub/MicrosoftEdge "Microsoft Edge")

</div>

<div>

[Microsoft Outlook](https://aka.ms/VideoHub/Outlook "Microsoft Outlook")

</div>

<div>

[Microsoft
Teams](https://aka.ms/VideoHub/MicrosoftTeams "Microsoft Teams")

</div>

<div>

[Security](https://aka.ms/VideoHub/Security "Security")

</div>

<div>

[SharePoint](https://aka.ms/VideoHub/SharePoint "SharePoint")

</div>

<div>

[Windows](https://aka.ms/VideoHub/Windows "Windows")

</div>
:::
:::
:::
:::

::: custom-community-hubs-menu-footer
[Browse All Community
Hubs](/t5/Communities/ct-p/communities){#browse-all-communities}
:::
:::
:::
:::

::: {.community-menu-item .my-favorites}
[](/t5/custom/page/page-id/Blogs){.community-menu-item-desktop-view}

::: {.mdl2-glyph .community-menu-item-icon}

:::

::: community-menu-item-title
Blogs
:::

[](/t5/custom/page/page-id/Blogs){.community-menu-item-mobile-view}

::: {.mdl2-glyph .community-menu-item-icon}

:::

::: community-menu-item-title
Blogs
:::
:::

::: {.community-menu-item .tab-events .community-menu-dropdown}
[](#){.community-menu-item-desktop-view}

::: {.c-glyph .community-menu-item-icon}

:::

::: community-menu-item-title-with-dropdownicon
Events
:::

[](#){.community-menu-item-mobile-view}

::: {.c-glyph .community-menu-item-icon}

:::

::: community-menu-item-title-with-dropdownicon
Events
:::

::: {.dropdown .dropdown-events .dropdown-primary-nav}
-   [Events Home](/t5/Events/ct-p/Events)
-   [Microsoft Ignite](https://myignite.microsoft.com/)
-   [Microsoft Build](https://mybuild.microsoft.com/)
-   [Community Events](/t5/Community-Events/ct-p/CommunityEvents)
:::
:::

::: {.community-menu-item .tab-microsoft-learning .community-menu-dropdown}
[](#){.community-menu-item-desktop-view}

::: {.grad .community-menu-item-icon}
:::

::: community-menu-item-title-with-dropdownicon
Microsoft Learn
:::

[](#){.community-menu-item-mobile-view}

::: {.grad .community-menu-item-icon}
:::

::: community-menu-item-title-with-dropdownicon
Microsoft Learn
:::

::: {.dropdown .dropdown-events .dropdown-primary-nav}
-   [Home](%20https://docs.microsoft.com/learn/){.ms-learning-home-link
    .community-menu-item-title}
-   [Community](/t5/microsoft-learn/bd-p/MicrosoftLearn)
-   [Blog](/t5/microsoft-learn-blog/bg-p/MicrosoftLearnBlog)
-   [Azure](https://docs.microsoft.com/learn/azure/?WT.mc_id=techcom_header-webpage-m365)
-   [Dynamics
    365](https://docs.microsoft.com/learn/dynamics365/?WT.mc_id=techcom_header-webpage-m365)
-   [Microsoft
    365](https://docs.microsoft.com/learn/m365/?wt.mc_id=techcom_header-webpage-m365)
-   [Security, Compliance &
    Identity](https://docs.microsoft.com/learn/topics/sci/?wt.mc_id=techcom_header-webpage-m365)
-   [Power
    Platform](https://docs.microsoft.com/learn/powerplatform/?wt.mc_id=techcom_header-webpage-powerplatform)
-   [Github](https://docs.microsoft.com/learn/github/?wt.mc_id=techcom_header-webpage-github)
-   [Teams](https://docs.microsoft.com/learn/teams/?wt.mc_id=techcom_header-webpage-teams)
-   [.NET](https://docs.microsoft.com/learn/dotnet/?wt.mc_id=techcom_header-webpage-dotnet)
:::
:::

::: {.community-menu-item .tab-info-center}
[](/t5/Community-Info-Center/ct-p/Community-Info-Center){.community-menu-item-desktop-view}

::: {.c-glyph .community-menu-item-icon}

:::

::: community-menu-item-title
Lounge
:::

[](/t5/Community-Info-Center/ct-p/Community-Info-Center){.community-menu-item-mobile-view}

::: {.c-glyph .community-menu-item-icon}

:::

::: community-menu-item-title
Lounge
:::
:::
:::

-   [[776K]{#community-menu-wrapper-vitality-stat-count-1
    .community-menu-vitality-stat-count} [
    Members]{#community-menu-wrapper-vitality-stat-title-1
    .community-menu-vitality-stat-title}]{#community-menu-wrapper-vitality-stat-item-1}
-   [[7,337]{#community-menu-wrapper-vitality-stat-count-2
    .community-menu-vitality-stat-count} [
    Online]{#community-menu-wrapper-vitality-stat-title-2
    .community-menu-vitality-stat-title}]{#community-menu-wrapper-vitality-stat-item-2}
-   [[2M]{#community-menu-wrapper-vitality-stat-count-3
    .community-menu-vitality-stat-count} [
    Discussions]{#community-menu-wrapper-vitality-stat-title-3
    .community-menu-vitality-stat-title}]{#community-menu-wrapper-vitality-stat-item-3}
:::

::: nav-right
::: {#search_container}
::: {#search_btn}
Search []{.btn-search}
:::

::: {#search_slider .hidden}
::: custom-lia-search
::: {#lia-searchformV32_231446521a35bf .SearchForm .lia-search-form-wrapper .lia-mode-default .lia-component-common-widget-search-form}
::: lia-inline-ajax-feedback
::: {#ajaxfeedback_231446521a35bf .AjaxFeedback}
:::
:::

::: {#searchautocompletetoggle_231446521a35bf}
::: lia-inline-ajax-feedback
::: {#ajaxfeedback_231446521a35bf_0 .AjaxFeedback}
:::
:::

::: t-invisible
:::

::: lia-inline-ajax-feedback
::: {#feedback_231446521a35bf .AjaxFeedback}
:::
:::

[ [ []{.lia-button-wrapper .lia-button-wrapper-secondary
.lia-button-wrapper-searchForm-action} ]{.lia-search-input-field}
]{.lia-search-input-wrapper} [cancel]{.lia-cancel-search}

::: {.search-autocomplete-toggle-link .lia-js-hidden}
[Turn on
suggestions](https://techcommunity.microsoft.com/t5/blogs/v2/blogarticlepage.enableautocomplete:enableautocomplete?t:ac=blog-id/Microsoft365PnPBlog/article-id/77&t:cp=action/contributions/searchactions){#enableAutoComplete_231446521a35bf
.lia-link-navigation .auto-complete-toggle-on
.lia-link-ticket-post-action
.lia-component-search-action-enable-auto-complete} [
[[]{#display_231446521a35bf .lia-img-icon-help .lia-fa-icon .lia-fa-help
.lia-fa
alt="Auto-suggest helps you quickly narrow down your search results by suggesting possible matches as you type."
aria-label="Help Icon" role="img"}](#){#link_231446521a35bf
.lia-link-navigation .help-icon .lia-tooltip-trigger}]{.HelpIcon}

::: {#link_231446521a35bf_0-tooltip-element .lia-content .lia-tooltip-pos-bottom-left .lia-panel-tooltip-wrapper role="alertdialog"}
::: lia-tooltip-arrow
:::

::: lia-panel-tooltip
::: content
Auto-suggest helps you quickly narrow down your search results by
suggesting possible matches as you type.
:::
:::
:::
:::
:::

::: spell-check-showing-result
Showing results for []{#showingResult_231446521a35bf
.lia-link-navigation .show-results-for-link .lia-link-disabled}
[](#){#showingMoreResult_231446521a35bf .lia-link-navigation
.more-synonym-search-results-for-link} [
]{.all-results-for-synonym-search}
:::

<div>

[ Show [](#){#synonymSearchInstead_231446521a35bf .lia-link-navigation
.synonym-search-instead-for-link} only  ]{.synonym-search-instead
.lia-js-hidden} [ \| ]{.spell-check-and-synonym-search-instead
.lia-js-hidden} [ Search instead for [](#){#searchInstead_231446521a35bf
.lia-link-navigation .search-instead-for-link}
]{.spell-check-search-instead}

</div>

::: {.spell-check-do-you-mean .lia-component-search-widget-spellcheck}
Did you mean: [](#){#doYouMean_231446521a35bf .lia-link-navigation
.do-you-mean-link}
:::
:::
:::
:::
:::

::: sign-in-wrapper
[Sign
In](/plugins/common/feature/oauth2sso/sso_login_redirect?lang=en&referer=https%3A%2F%2Ftechcommunity.microsoft.com%2Ft5%2Fmicrosoft-365-pnp-blog%2Finit-api-permissions-for-your-spfx-projects-without-deploying%2Fba-p%2F2189059)
:::

::: notifications
::: notify-icon
[](/t5/notificationfeed/page)

::: lia-notifications-messages-aggregate
:::
:::

::: email-icon
[](/t5/notes/privatenotespage)

::: lia-notifications-messages-aggregate
:::
:::
:::

::: lia-component-common-widget-slide-out-user-menu
::: {.lia-user-navigation-sign-in .lia-component-users-action-login-with-avatar}
::: user-navigation-user-profile
[Sign
In](/plugins/common/feature/oauth2sso/sso_login_redirect?lang=en&referer=https%3A%2F%2Ftechcommunity.microsoft.com%2Ft5%2Fmicrosoft-365-pnp-blog%2Finit-api-permissions-for-your-spfx-projects-without-deploying%2Fba-p%2F2189059){#link_1_23144653a2bdcb
.lia-link-navigation .login-link .lia-authentication-link}
:::

::: {.UserAvatar .lia-user-avatar}
[](/plugins/common/feature/oauth2sso/sso_login_redirect?lang=en&referer=https%3A%2F%2Ftechcommunity.microsoft.com%2Ft5%2Fmicrosoft-365-pnp-blog%2Finit-api-permissions-for-your-spfx-projects-without-deploying%2Fba-p%2F2189059){#link_2_23144653a2bdcb
.lia-link-navigation .login-link .lia-authentication-link}

::: lia-anonymous-profile-icon
:::
:::
:::
:::
:::
:::
:::
:::
:::

::: notifications-overlay-notif
:::

::: notifications-overlay-mail
:::

::: notifications-overlay-favorites
:::
:::
:::
:::

::: {.lia-quilt-row .lia-quilt-row-sub-header}
::: {.lia-quilt-column .lia-quilt-column-18 .lia-quilt-column-left .lia-quilt-column-breadcrumb .lia-mark-empty}
:::

::: {.lia-quilt-column .lia-quilt-column-06 .lia-quilt-column-right .lia-quilt-column-search-content}
::: {.lia-quilt-column-alley .lia-quilt-column-alley-right}
::: custom-lia-search
::: {#lia-searchformV32 .SearchForm .lia-search-form-wrapper .lia-mode-default .lia-component-common-widget-search-form}
::: lia-inline-ajax-feedback
::: {#ajaxfeedback .AjaxFeedback}
:::
:::

::: {#searchautocompletetoggle}
::: lia-inline-ajax-feedback
::: {#ajaxfeedback_0 .AjaxFeedback}
:::
:::

::: t-invisible
:::

::: lia-inline-ajax-feedback
::: {#feedback .AjaxFeedback}
:::
:::

[ [ []{.lia-button-wrapper .lia-button-wrapper-secondary
.lia-button-wrapper-searchForm-action} ]{.lia-search-input-field}
]{.lia-search-input-wrapper} [cancel]{.lia-cancel-search}

::: {.search-autocomplete-toggle-link .lia-js-hidden}
[Turn on
suggestions](https://techcommunity.microsoft.com/t5/blogs/v2/blogarticlepage.enableautocomplete:enableautocomplete?t:ac=blog-id/Microsoft365PnPBlog/article-id/77&t:cp=action/contributions/searchactions){#enableAutoComplete
.lia-link-navigation .auto-complete-toggle-on
.lia-link-ticket-post-action
.lia-component-search-action-enable-auto-complete} [ [[]{#display
.lia-img-icon-help .lia-fa-icon .lia-fa-help .lia-fa
alt="Auto-suggest helps you quickly narrow down your search results by suggesting possible matches as you type."
aria-label="Help Icon" role="img"}](#){#link_0 .lia-link-navigation
.help-icon .lia-tooltip-trigger}]{.HelpIcon}

::: {#link_1-tooltip-element .lia-content .lia-tooltip-pos-bottom-left .lia-panel-tooltip-wrapper role="alertdialog"}
::: lia-tooltip-arrow
:::

::: lia-panel-tooltip
::: content
Auto-suggest helps you quickly narrow down your search results by
suggesting possible matches as you type.
:::
:::
:::
:::
:::

::: spell-check-showing-result
Showing results for []{#showingResult .lia-link-navigation
.show-results-for-link .lia-link-disabled} [](#){#showingMoreResult
.lia-link-navigation .more-synonym-search-results-for-link} [
]{.all-results-for-synonym-search}
:::

<div>

[ Show [](#){#synonymSearchInstead .lia-link-navigation
.synonym-search-instead-for-link} only  ]{.synonym-search-instead
.lia-js-hidden} [ \| ]{.spell-check-and-synonym-search-instead
.lia-js-hidden} [ Search instead for [](#){#searchInstead
.lia-link-navigation .search-instead-for-link}
]{.spell-check-search-instead}

</div>

::: {.spell-check-do-you-mean .lia-component-search-widget-spellcheck}
Did you mean: [](#){#doYouMean .lia-link-navigation .do-you-mean-link}
:::
:::
:::
:::
:::
:::

::: {.lia-quilt-row .lia-quilt-row-feedback}
::: {.lia-quilt-column .lia-quilt-column-24 .lia-quilt-column-single .lia-quilt-column-feedback}
::: {.lia-quilt-column-alley .lia-quilt-column-alley-single}
:::
:::
:::
:::

::: {.custom-nda-blog-article-page-header-banner .lia-mark-empty}
:::

::: {.community-live-events-banner-blog-article-page-wrapper .lia-mark-empty}
:::

::: custom-blog-article-page-header-wrapper
::: custom-common-widget-breadcrumb
::: {.custom-common-widget-breadcrumb-wrapper .hidden}
[Home](/){.BreadCrumb .home-nav-link}

::: {.BreadCrumb .crumb-line .lia-breadcrumb .lia-component-common-widget-breadcrumb aria-label="breadcrumbs" role="navigation"}
-   [Home](/){#link_23144656a46615 .lia-link-navigation .crumb-community
    .lia-breadcrumb-community .lia-breadcrumb-forum}
-    []{#display_23144656a46615 .lia-img-icon-list-separator-breadcrumb
    .lia-fa-icon .lia-fa-list .lia-fa-separator .lia-fa-breadcrumb
    .lia-fa alt="" aria-label="" role="img"}
-   [Microsoft 365
    PnP](/t5/microsoft-365-pnp/ct-p/Microsoft365PnP){#link_23144656a46615_0
    .lia-link-navigation .crumb-category .lia-breadcrumb-category
    .lia-breadcrumb-forum}
-    []{#display_23144656a46615_0
    .lia-img-icon-list-separator-breadcrumb .lia-fa-icon .lia-fa-list
    .lia-fa-separator .lia-fa-breadcrumb .lia-fa alt="" aria-label=""
    role="img"}
-   [Microsoft 365 PnP
    Blog](/t5/microsoft-365-pnp-blog/bg-p/Microsoft365PnPBlog){#link_23144656a46615_1
    .lia-link-navigation .crumb-board .lia-breadcrumb-board
    .lia-breadcrumb-forum}
-    []{#display_23144656a46615_1
    .lia-img-icon-list-separator-breadcrumb .lia-fa-icon .lia-fa-list
    .lia-fa-separator .lia-fa-breadcrumb .lia-fa alt="" aria-label=""
    role="img"}
-   [Init API permissions for your SPFx projects without deploying
    them]{#link_23144656a46615_2 .lia-link-navigation .child-thread
    .lia-link-disabled aria-disabled="true" disabled="true" role="link"
    aria-label="Init API permissions for your SPFx projects without deploying them"}
:::
:::
:::

::: {.lia-menu-bar .lia-discussion-page-discussion-navigator .lia-component-article-navigator}
::: lia-decoration-border-menu-bar
::: lia-decoration-border-menu-bar-top
<div>

</div>
:::

::: lia-decoration-border-menu-bar-content
<div>

::: lia-menu-bar-buttons
:::

::: {#threadnavigator .lia-paging-full-wrapper}
-   [[]{.lia-paging-page-arrow} [Back to
    Blog]{.lia-paging-page-link}](/t5/microsoft-365-pnp-blog/bg-p/Microsoft365PnPBlog "Microsoft 365 PnP Blog"){#link_2
    .lia-link-navigation}
-   [[]{.lia-paging-page-arrow} [Newer
    Article]{.lia-paging-page-link}](/t5/microsoft-365-pnp-blog/doctor-maintain-your-documentation-on-sharepoint-without-pain/ba-p/2199104 "Doctor - Maintain your documentation on SharePoint without pain"){#link_3
    .lia-link-navigation}
-   [[Older Article]{.lia-paging-page-link}
    []{.lia-paging-page-arrow}](/t5/microsoft-365-pnp-blog/sharepoint-monthly-community-call-march-9-2021/ba-p/2197684 "SharePoint monthly community call – March 9, 2021"){#link_4
    .lia-link-navigation}
:::

</div>
:::

::: lia-decoration-border-menu-bar-bottom
<div>

</div>
:::
:::
:::
:::
:::
:::
:::

::: {.lia-quilt-row .lia-quilt-row-main}
::: {.lia-quilt-column .lia-quilt-column-18 .lia-quilt-column-left .lia-quilt-column-main-content}
::: {.lia-quilt-column-alley .lia-quilt-column-alley-left}
::: ba-subject-header-wrapper
::: ba-subject-wrapper
::: ba-title
# Init API permissions for your SPFx projects without deploying them
:::

::: ba-option-wrapper
::: {.lia-menu-bar .top-block .lia-component-menu-bar-without-options}
::: lia-decoration-border-menu-bar
::: lia-decoration-border-menu-bar-top
<div>

</div>
:::

::: lia-decoration-border-menu-bar-content
<div>

::: lia-menu-bar-buttons
:::

</div>
:::

::: lia-decoration-border-menu-bar-bottom
<div>

</div>
:::
:::
:::
:::
:::

::: ba-author-and-metrics-wrapper
::: ba-author-wrapper
By

::: ba-author-info
[ ]{.UserName .lia-user-name}

::: UserAvatarWrapper
::: {.UserAvatar .lia-user-avatar .lia-component-common-widget-user-avatar .Occasional .Contributor}
[![michaelmaillot](https://techcommunity.microsoft.com/t5/image/serverpage/image-id/247588i11B78FB75491CD72/image-dimensions/150x150/image-coordinates/0%2C21%2C670%2C691?v=v2 "michaelmaillot"){.lia-user-avatar-message
.user-rank-ring style=""
onerror="replaceBrokenAvatars(this, '/html/assets/default-avatar.png')"}](/t5/user/viewprofilepage/user-id/461902){.UserAvatar
.lia-link-navigation}
:::

::: {.user-profile-card user-id="461902"}
::: contents
::: spinner
:::
:::
:::
:::

::: user-login
[Michaël Maillot](/t5/user/viewprofilepage/user-id/461902)
:::
:::
:::

::: ba-metrics-info
[Published]{.ba-published-title} [Mar 10 2021 01:34
AM]{.ba-published-date} [ 2,334 Views ]{.ba-view-count}
:::
:::
:::

::: custom-blog-article-wrapper
::: {#messageview .lia-panel-message .message-uid-2189059 .lia-component-article lia-message-uid="2189059"}
::: {#messageView2_1 .lia-message-view-wrapper .lia-js-data-messageUid-2189059 .lia-component-forums-widget-message-view-two lia-message-uid="2189059"}
[ ]{#U2189059} [ ]{#M77}

::: lia-inline-ajax-feedback
::: {#ajaxfeedback_1 .AjaxFeedback}
:::
:::

::: {.MessageView .lia-message-view-blog-topic-message .lia-message-view-display .lia-row-standard-unread .lia-thread-topic}
[]{.lia-message-state-indicator}

::: {.lia-quilt .lia-quilt-blog-topic-message .lia-quilt-layout-one-column-message}
::: {.lia-quilt-row .lia-quilt-row-header}
::: {.lia-quilt-column .lia-quilt-column-16 .lia-quilt-column-left .lia-quilt-column-header-left}
::: {.lia-quilt-column-alley .lia-quilt-column-alley-left}
::: {.lia-message-author-avatar .lia-component-author-avatar .lia-component-message-view-widget-author-avatar}
::: UserAvatarWrapper
::: {.UserAvatar .lia-user-avatar .lia-component-common-widget-user-avatar .Occasional .Contributor}
[![michaelmaillot](https://techcommunity.microsoft.com/t5/image/serverpage/image-id/247588i11B78FB75491CD72/image-dimensions/40x40?v=v2 "michaelmaillot"){.lia-user-avatar-message
.user-rank-ring style=""
onerror="replaceBrokenAvatars(this, '/html/assets/default-avatar.png')"}](/t5/user/viewprofilepage/user-id/461902){.UserAvatar
.lia-link-navigation}
:::

::: {.user-profile-card user-id="461902"}
::: contents
::: spinner
:::
:::
:::
:::
:::

::: lia-message-author-with-avatar
[
[michaelmaillot](https://techcommunity.microsoft.com/t5/user/viewprofilepage/user-id/461902){#link_5
.lia-link-navigation .lia-page-link .lia-user-name-link} ]{.UserName
.lia-user-name .lia-user-rank-Occasional-Contributor
.lia-component-message-view-widget-author-username}
:::

::: {.lia-message-author-rank .lia-component-author-rank .lia-component-message-view-widget-author-rank}
Occasional Contributor
:::
:::
:::

::: {.lia-quilt-column .lia-quilt-column-08 .lia-quilt-column-right .lia-quilt-column-header-right}
::: {.lia-quilt-column-alley .lia-quilt-column-alley-right}
::: {.lia-message-post-date .lia-component-post-date .lia-component-message-view-widget-post-date title="Posted on"}
[ [‎Mar 10 2021]{.local-date} [01:34 AM]{.local-time} ]{.DateTime}
:::

::: {#actionMenuDropDown .lia-menu-navigation-wrapper .lia-js-hidden .lia-menu-action .lia-component-message-view-widget-action-menu}
::: lia-menu-navigation
::: dropdown-default-item
[](# "Show option menu"){#dropDownLink .lia-js-menu-opener
.default-menu-option .lia-js-mouseover-menu .lia-link-navigation}

::: dropdown-positioning
::: dropdown-positioning-static
-   [Subscribe to RSS
    Feed](/gxcuf89792/rss/message?board.id=Microsoft365PnPBlog&message.id=77){#rssThread
    .lia-link-navigation .rss-thread-link
    .lia-component-rss-action-thread}
-   [ []{.lia-separator-post} []{.lia-separator-pre} ]{.lia-separator
    .lia-component-common-widget-link-separator}
-   [Mark as New]{#markThreadUnread .lia-link-navigation
    .mark-thread-unread .lia-link-disabled
    .lia-component-forums-action-mark-thread-unread}
-   [Mark as Read]{#markThreadRead .lia-link-navigation
    .mark-thread-read .lia-link-disabled
    .lia-component-forums-action-mark-thread-read}
-   [ []{.lia-separator-post} []{.lia-separator-pre} ]{.lia-separator
    .lia-component-common-widget-link-separator}
-   [Bookmark]{#addThreadUserBookmark .lia-link-navigation
    .addThreadUserBookmark .lia-link-disabled
    .lia-component-subscriptions-action-add-thread-user-bookmark}
-   [Subscribe]{#addThreadUserEmailSubscription .lia-link-navigation
    .addThreadUserEmailSubscription .lia-link-disabled
    .lia-component-subscriptions-action-add-thread-user-email}
-   [ []{.lia-separator-post} []{.lia-separator-pre} ]{.lia-separator
    .lia-component-common-widget-link-separator}
-   [Email to a Friend]{#emailMessageToFriend .lia-link-navigation
    .email_friend .lia-link-disabled
    .lia-component-forums-action-email-message-to-friend}
-   [ []{.lia-separator-post} []{.lia-separator-pre} ]{.lia-separator
    .lia-component-common-widget-link-separator}
-   [Printer Friendly
    Page](/t5/blogs/blogarticleprintpage/blog-id/Microsoft365PnPBlog/article-id/77){#printThread
    .lia-link-navigation .print-article
    .lia-component-forums-action-print-thread}
-   [Report Inappropriate
    Content](/t5/notifications/notifymoderatorpage/message-uid/2189059){#reportAbuse
    .lia-link-navigation .report-abuse-link
    .lia-component-forums-action-report-abuse}
:::
:::
:::
:::
:::
:::
:::
:::

::: {.lia-quilt-row .lia-quilt-row-main}
::: {.lia-quilt-column .lia-quilt-column-24 .lia-quilt-column-single .lia-quilt-column-main}
::: {.lia-quilt-column-alley .lia-quilt-column-alley-single}
::: {.lia-message-subject-wrapper .lia-component-subject .lia-component-message-view-widget-subject-with-options}
::: MessageSubject
::: MessageSubjectIcons
# [ [Init API permissions for your SPFx projects without deploying them](/t5/microsoft-365-pnp-blog/init-api-permissions-for-your-spfx-projects-without-deploying/ba-p/2189059){#link_6 .page-link .lia-link-navigation .lia-custom-event} ]{.lia-message-unread} {#init-api-permissions-for-your-spfx-projects-without-deploying-them-1 .message-subject itemprop="name"}

[]{#display_2 .lia-img-message-has-url .lia-fa-message .lia-fa-has
.lia-fa-url .lia-fa title="Contains a hyperlink"
alt="Message contains a hyperlink" aria-label="Contains a hyperlink"
role="img"} []{#display_3 .lia-img-message-has-image .lia-fa-message
.lia-fa-has .lia-fa-image .lia-fa title="Contains an image"
alt="Message contains an image" aria-label="Contains an image"
role="img"}
:::
:::
:::

::: {.lia-message-post-date .lia-component-post-date .lia-component-message-view-widget-post-date title="Posted on"}
[ [‎Mar 10 2021]{.local-date} [01:34 AM]{.local-time} ]{.DateTime}
:::

::: {.lia-message-body-wrapper .lia-component-message-view-widget-body}
::: {#bodyDisplay .lia-message-body itemprop="text"}
::: lia-message-body-content
When developing your SPFx components, you usually first run them locally
before deploying them (really?).

 

And then comes the time to work with API such as Microsoft Graph.

 

If you never use those permissions before in your SPFx projects (and the
tenant with which you\'re working), you realize that you have to:

-   Add required API permissions in your `package-solution.json` file
-   Bundle / Ship your project
-   Publish it
-   Go to the SharePoint Admin Center Web API Permissions page
-   Approve those permissions

 

All of this, just to play with the API as you didn\'t plan to release
your package in a production environment.

 

So what if you could bypass all these steps for both Graph and owned
API?

 

**Warning**

This trick is just for development purposes. In Production environment,
you should update your `package-solution.json` file to add required
permissions and allow them (or ask for validation) in the *API
access* page.

 

## Prerequisites {#toc-hId--521306252}

 

1.  An Office 365 (Dev) Tenant or a Partner Demo Tenant
2.  The following Azure AD role at least
    -   Application Administrator

 

## With Graph API {#toc-hId-1966206581}

 

First, we\'re going to play with Graph API through the [Microsoft Graph
Toolkit](https://docs.microsoft.com/fr-fr/graph/toolkit/overview).

 

### Prepare your sample {#toc-hId--1638199241}

Init a SPFx project (WebPart one with React, let\'s call it *HelloApi*),
then add the Microsoft Graph Toolkit by
executing `npm i @microsoft/mgt @microsoft/mgt-react` from the
project\'s root path.

 

Once done, open your main component file (let\'s say
here **HelloApi.tsx**) and add the `PeoplePicker` component like this:

 

``` {.lia-code-sample .language-javascript}
import * as React from 'react';
import styles from './HelloApi.module.scss';
import { IHelloApiProps } from './IHelloApiProps';
import { escape } from '@microsoft/sp-lodash-subset';
import { PeoplePicker } from '@microsoft/mgt-react';

export default class HelloApi extends React.Component<IHelloApiProps, {}> {
  public render(): React.ReactElement<IHelloApiProps> {
    return (
      <div className={ styles.HelloApi }>
        <div className={ styles.container }>
          <div className={ styles.row }>
            <div className={ styles.column }>
              <span className={ styles.title }>Welcome to SharePoint!</span>
              <p className={ styles.subTitle }>Customize SharePoint experiences using Web Parts.</p>
              <p className={ styles.description }>{escape(this.props.description)}</p>
              <a href="https://aka.ms/spfx" className={ styles.button }>
                <span className={ styles.label }>Learn more</span>
              </a>
            </div>
          </div>
        </div>
        <PeoplePicker />
      </div>
    );
  }
}
```

 

### Run it in remote workbench {#toc-hId-849313592}

Now run your sample with `gulp serve` and display your webpart in your
remote workbench
(<https://contoso.sharepoint.com/_layouts/15/workbench.aspx>). Try to
use the `PeoplePicker` component: you\'ll see that just by clicking on
the search box, you\'ll get *We didn\'t find any matches*.

 

[![peoplepicker-ui-fail.png](https://techcommunity.microsoft.com/t5/image/serverpage/image-id/261327i7C491A73DF1A9A84/image-size/large?v=v2&px=999 "peoplepicker-ui-fail.png"){.lia-media-image
role="button"
li-image-url="https://techcommunity.microsoft.com/t5/image/serverpage/image-id/261327i7C491A73DF1A9A84?v=v2"
li-image-display-id="'261327i7C491A73DF1A9A84'"
li-message-uid="'2189059'" li-messages-message-image="true"
li-bindable="" tabindex="0" li-bypass-lightbox-when-linked="true"
li-use-hover-links="false"}]{.lia-inline-image-display-wrapper
.lia-image-align-center image-alt="peoplepicker-ui-fail.png"
style="width: 804px;"}

 

 

Display your developer toolbox (F12) and go to the browser console, you
should see the following error:

 

[![peoplepicker-console-fail.png](https://techcommunity.microsoft.com/t5/image/serverpage/image-id/261328i877C183AB94DAEC5/image-size/large?v=v2&px=999 "peoplepicker-console-fail.png"){.lia-media-image
role="button"
li-image-url="https://techcommunity.microsoft.com/t5/image/serverpage/image-id/261328i877C183AB94DAEC5?v=v2"
li-image-display-id="'261328i877C183AB94DAEC5'"
li-message-uid="'2189059'" li-messages-message-image="true"
li-bindable="" tabindex="0" li-bypass-lightbox-when-linked="true"
li-use-hover-links="false"}]{.lia-inline-image-display-wrapper
.lia-image-align-center image-alt="peoplepicker-console-fail.png"
style="width: 972px;"}

 

As you can see, it\'s a 403 error, which is well-known when using Graph
API endpoints that have not been allowed on the first place.

 

 

### Add Graph API through UI {#toc-hId--958140871}

From the Azure portal, display the *Azure Active Directory* (AAD), then
select the **App Registration** menu and select **All Applications**,
then click on **SharePoint Online Client Extensibility Web Application
Principal**. It\'s the AAD Application that holds the connection to the
API (Microsoft and others) from SharePoint (SPFx or every other
development) using the *Implicit Flow*.

 

Once here, click on **Add a permission**, then select **Microsoft
Graph** and add the \[*People.Read*\] Graph API [delegated
permission]{.underline} (you can type the name of the permission in the
available search box to get it easily).

 

[![aad-app-spo-api-graph.png](https://techcommunity.microsoft.com/t5/image/serverpage/image-id/261329i49E61D0AD724669F/image-size/large?v=v2&px=999 "aad-app-spo-api-graph.png"){.lia-media-image
role="button"
li-image-url="https://techcommunity.microsoft.com/t5/image/serverpage/image-id/261329i49E61D0AD724669F?v=v2"
li-image-display-id="'261329i49E61D0AD724669F'"
li-message-uid="'2189059'" li-messages-message-image="true"
li-bindable="" tabindex="0" li-bypass-lightbox-when-linked="true"
li-use-hover-links="false"}]{.lia-inline-image-display-wrapper
.lia-image-align-center image-alt="aad-app-spo-api-graph.png"
style="width: 999px;"}

 

Once added, grant it by clicking on **Grant admin consent for contoso**.

 

If you go in the *API access* page
(<https://contoso-admin.sharepoint.com/_layouts/15/online/AdminHome.aspx#/webApiPermissionManagement>),
you should see something like this:

 

[![(other Graph API permissions displayed here won\'t be necessary for
the
sample)](https://techcommunity.microsoft.com/t5/image/serverpage/image-id/261330i6A95D15054FE0812/image-size/large?v=v2&px=999 "api-access-approved.png"){.lia-media-image
role="button"
li-image-url="https://techcommunity.microsoft.com/t5/image/serverpage/image-id/261330i6A95D15054FE0812?v=v2"
li-image-display-id="'261330i6A95D15054FE0812'"
li-message-uid="'2189059'" li-messages-message-image="true"
li-bindable="" tabindex="0" li-bypass-lightbox-when-linked="true"
li-use-hover-links="false"}[(other Graph API permissions displayed here
won\'t be necessary for the sample)]{.lia-inline-image-caption
onclick="event.preventDefault();"}]{.lia-inline-image-display-wrapper
.lia-image-align-center
image-alt="(other Graph API permissions displayed here won't be necessary for the sample)"
style="width: 977px;"}

 

**Warning**

It can take a couple of minutes before consented permissions is
effective, so don\'t be surprised if it\'s not working right away after
approval.

 

### Add Graph API through CLI for Microsoft 365 {#toc-hId-1529371962}

 

``` {.lia-code-sample .language-bash}
m365 login # Don't execute that command if you're already connected
m365 spo serviceprincipal grant add --resource 'Microsoft Graph' --scope 'People.Read'
```

 

**Info**

Don\'t be surprised if by that way, the permission appears in the
\"Other permissions granted for \[your tenant\]\": it won\'t prevent
your SPFx solution to work.

 

### Try again {#toc-hId--278082501}

Now try to use the `PeoplePicker` component again: you\'ll see that with
the addition of the Graph API permission, you should be able to use that
component!

 

[![peoplepicker-ui-success.png](https://techcommunity.microsoft.com/t5/image/serverpage/image-id/261331i81A858A6A4D017BA/image-size/large?v=v2&px=999 "peoplepicker-ui-success.png"){.lia-media-image
role="button"
li-image-url="https://techcommunity.microsoft.com/t5/image/serverpage/image-id/261331i81A858A6A4D017BA?v=v2"
li-image-display-id="'261331i81A858A6A4D017BA'"
li-message-uid="'2189059'" li-messages-message-image="true"
li-bindable="" tabindex="0" li-bypass-lightbox-when-linked="true"
li-use-hover-links="false"}]{.lia-inline-image-display-wrapper
.lia-image-align-center image-alt="peoplepicker-ui-success.png"
style="width: 799px;"}

 

## With custom API {#toc-hId--288585605}

 

When using a custom API, it\'s a little bit more tricky but easy to
handle anyway.

 

You can follow [this Microsoft
article](https://docs.microsoft.com/fr-fr/sharepoint/dev/spfx/use-aadhttpclient-enterpriseapi) until
the \"[Deploy the
solution](https://docs.microsoft.com/en-us/sharepoint/dev/spfx/use-aadhttpclient-enterpriseapi#deploy-the-solution-to-the-sharepoint-app-catalog)\"
part.

 

Instead of bundling and shipping, we\'ll add the AAD App
(called *contoso-api-dp20200915* if we follow the mentioned article)
created from the Azure Function Authentication part in the SharePoint
Service Principal.

 

### Add your AAD Application to the SharePoint Service Principal {#toc-hId-401975869}

Display again the AAD page, then select the **App Registration** menu,
select **All Applications** and click on **SharePoint Online Client
Extensibility Web Application Principal**. Once here, click on **Add a
permission**, then select the **My APIs** tab and select the fresh added
AAD App created before. Select the **user_impersonation** permission,
then confirm.

 

[![aad-app-spo-api-custom.png](https://techcommunity.microsoft.com/t5/image/serverpage/image-id/261332i7206CD2A49DCAEFB/image-size/large?v=v2&px=999 "aad-app-spo-api-custom.png"){.lia-media-image
role="button"
li-image-url="https://techcommunity.microsoft.com/t5/image/serverpage/image-id/261332i7206CD2A49DCAEFB?v=v2"
li-image-display-id="'261332i7206CD2A49DCAEFB'"
li-message-uid="'2189059'" li-messages-message-image="true"
li-bindable="" tabindex="0" li-bypass-lightbox-when-linked="true"
li-use-hover-links="false"}]{.lia-inline-image-display-wrapper
.lia-image-align-center image-alt="aad-app-spo-api-custom.png"
style="width: 999px;"}

 

Finally, grant this permission by clicking on **Grant admin consent for
contoso**.

 

If you go again in the *API access* page, you should see something like
this:

 

[![api-access-custom-approved.png](https://techcommunity.microsoft.com/t5/image/serverpage/image-id/261337i4486CDC42E9CFA65/image-size/large?v=v2&px=999 "api-access-custom-approved.png"){.lia-media-image
role="button"
li-image-url="https://techcommunity.microsoft.com/t5/image/serverpage/image-id/261337i4486CDC42E9CFA65?v=v2"
li-image-display-id="'261337i4486CDC42E9CFA65'"
li-message-uid="'2189059'" li-messages-message-image="true"
li-bindable="" tabindex="0" li-bypass-lightbox-when-linked="true"
li-use-hover-links="false"}]{.lia-inline-image-display-wrapper
.lia-image-align-center image-alt="api-access-custom-approved.png"
style="width: 967px;"}

 

### Add custom API through CLI for Microsoft 365 {#toc-hId--1405478594}

 

``` {.lia-code-sample .language-javascript}
m365 login # Don't execute that command if you're already connected
m365 spo serviceprincipal grant add --resource 'contoso-api-dp20200915' --scope 'user_impersonation'
```

 

**Info**

Don\'t be surprised if by that way, the permission appears in the
\"Other permissions granted for \[your tenant\]\": it won\'t prevent
your SPFx solution to work.

 

**Warning**

If you use an Azure Function as an API and enable **Managed
Identity** for any reason, you better have to rename the linked AAD
Application to give it a different name than both your Function and
its **Managed Identity**. Otherwise, the command will try to find a
scope on it instead of the AAD App and fail.

 

### Updated sample {#toc-hId-386870760}

 

To run your custom API from your SPFx component, you can update your
sample like below:

 

*IHelloApiProps.ts*

 

``` {.lia-code-sample .language-javascript}
import { AadHttpClientFactory } from '@microsoft/sp-http';

export interface IHelloApiProps {
  aadFactory: AadHttpClientFactory;
  description: string;
}
```

 

 

*HelloApiWebPart.ts*

 

``` {.lia-code-sample .language-javascript}
// ...
export default class HelloApiWebPart extends BaseClientSideWebPart<IHelloApiWebPartProps> {

    // ...

    public render(): void {
        const element: React.ReactElement<IHelloApiProps> = React.createElement(
        HelloGraph,
        {
            description: this.properties.description,
            aadFactory: this.context.aadHttpClientFactory,
        }
        );

        ReactDom.render(element, this.domElement);
    }

  // ...
}
```

 

 

*HelloApi.tsx*

 

``` {.lia-code-sample .language-javascript}
import * as React from 'react';
import styles from './HelloApi.module.scss';
import { IHelloApiProps } from './IHelloApiProps';
import { AadHttpClient, HttpClientResponse } from '@microsoft/sp-http';

interface IHelloApiState {
  ordersToDisplay: any;
}

export default class HelloApi extends React.Component<IHelloApiProps, IHelloApiState> {

 public constructor(props) {
    super(props);

    this.state = {
    ordersToDisplay: null
    };
 }

 public componentDidMount() {
    this.props.aadFactory
      .getClient('https://contoso-api-dp20191109.azurewebsites.net')
      .then((client: AadHttpClient): void => {
        client
          .get('https://contoso-api-dp20191109.azurewebsites.net/api/Orders', AadHttpClient.configurations.v1)
          .then((response: HttpClientResponse): Promise<any> => {
            return response.json();
          })
          .then((orders: any): void => {
            this.setState({
              ordersToDisplay: orders
            })
          });
      }).catch((err) => {
        console.log(err);
      });
  }

  public render(): React.ReactElement<IHelloApiProps> {
    return (
      <div className={ styles.HelloApi }>
        <div className={ styles.container }>
          <div className={ styles.row }>
            <div className={ styles.column }>
              <span className={ styles.title }>Welcome to SharePoint!</span>
              <p className={ styles.subTitle }>Customize SharePoint experiences using Web Parts.</p>
              <p className={ styles.description }>
               <ul>
                    {this.state.ordersToDisplay &&
                        this.state.ordersToDisplay.map(o => {
                            return <li>{o.rep}: {o.total}</li>
                        })
                    }
                </ul>
              </p>
            </div>
          </div>
        </div>
      </div>
    );
  }
}
```

 

 

Now you can run your sample locally and try it in your hosted workbench,
playing with it and updating your WebPart as you want!

 

\... And don\'t forget to update your `package-solution.json` file to
include the required APIs before
shipping! ![:smile:](/html/@8341BD79091AF36AA2A09063B554B5CD/images/emoticons/smile_40x40.gif ":smile:"){.lia-deferred-image
.lia-image-emoji}

 

Happy coding!

 

*This article was cross-posted on [my
blog](https://michaelmaillot.github.io/tips/20210302-spfx-api-permissions/).*
:::
:::
:::

::: {#tagsList .TagList .lia-component-tags .lia-component-message-view-widget-tags-list}
-   Tags:
-   [Microsoft365 SPFx SharePoint Graph
    React](/t5/tag/Microsoft365%20SPFx%20SharePoint%20Graph%20React/tg-p/board-id/Microsoft365PnPBlog){#link_7
    .lia-link-navigation .lia-tag .tag .tag-1047275
    .lia-js-data-tagUid-1047275}

    ::: {.tag-list-js-confirmation .hidden}
    :::

::: lia-inline-ajax-feedback
::: {#ajaxFeedback .AjaxFeedback}
:::
:::
:::
:::
:::
:::

::: {.lia-quilt-row .lia-quilt-row-footer}
::: {.lia-quilt-column .lia-quilt-column-12 .lia-quilt-column-left .lia-quilt-column-footer-left}
::: {.lia-quilt-column-alley .lia-quilt-column-alley-left}
::: {#kudosButtonV2 .KudosButton .lia-button-image-kudos-wrapper .lia-component-kudos-widget-button-version-3 .lia-component-kudos-widget-button-horizontal .lia-component-kudos-widget-button .lia-component-kudos-action .lia-component-message-view-widget-kudos-action lia-kudos-id="2189059"}
::: {.lia-button-image-kudos .lia-button-image-kudos-horizontal .lia-button-image-kudos-enabled .lia-button-image-kudos-not-kudoed .lia-button aria-atomic="true" aria-live="assertive"}
::: lia-button-image-kudos-count
[ [ 0 ]{#messageKudosCount_2314465d430ba3 .MessageKudosCount
.lia-component-kudos-widget-message-kudos-count itemprop="upvoteCount"}[
Likes ]{.lia-button-image-kudos-label
.lia-component-kudos-widget-kudos-count-label} ]{#link_8
.lia-link-navigation .kudos-count-link .lia-link-disabled
title="The total number of likes this post has received."}
:::

::: lia-button-image-kudos-give
[Like](https://techcommunity.microsoft.com/t5/blogs/v2/blogarticlepage.kudosbuttonv2.kudoentity:kudoentity/kudosable-gid/2189059?t:ac=blog-id/Microsoft365PnPBlog/article-id/77&t:cp=kudos/contributions/tapletcontributionspage "Click here to give likes to this post."){#kudoEntity
.lia-link-navigation .kudos-link .lia-link-ticket-post-action}
:::
:::
:::
:::
:::

::: {.lia-quilt-column .lia-quilt-column-12 .lia-quilt-column-right .lia-quilt-column-footer-right}
::: {.lia-quilt-column-alley .lia-quilt-column-alley-right}
::: {.lia-button-group .lia-component-comment-button .lia-component-message-view-widget-comment-button}
:::
:::
:::
:::

::: {.lia-quilt-row .lia-quilt-row-mod-controls}
::: {.lia-quilt-column .lia-quilt-column-24 .lia-quilt-column-single .lia-quilt-column-mod-controls-main}
::: {.lia-quilt-column-alley .lia-quilt-column-alley-single .lia-mark-empty}
:::
:::
:::

::: {.lia-quilt-row .lia-quilt-row-sub-footer}
::: {.lia-quilt-column .lia-quilt-column-24 .lia-quilt-column-single .lia-quilt-column-sub-footer .lia-mark-empty}
:::
:::
:::
:::
:::

::: {#progressBar .lia-progress .lia-js-hidden}
::: lia-progress-indeterminate
:::
:::
:::
:::

[]{#comment-on-this} [ ]{#feedback-successinformationbox_7}

::: {#informationbox_7 .InfoMessage .lia-panel-feedback-banner-note .lia-component-comment-editor}
::: {.lia-text role="alert"}
You must be a registered user to add a comment. If you\'ve already
registered, sign in. Otherwise, register and sign in.

-   [Comment](/plugins/common/feature/oauth2sso/sso_login_redirect?lang=en&redirectreason=permissiondenied&referer=https%3A%2F%2Ftechcommunity.microsoft.com%2Ft5%2Fmicrosoft-365-pnp-blog%2Finit-api-permissions-for-your-spfx-projects-without-deploying%2Fba-p%2F2189059%23comment-on-this){#link_9
    .lia-link-navigation .blog-link .lia-message-comment-post}
:::
:::
:::
:::

::: {.lia-quilt-column .lia-quilt-column-06 .lia-quilt-column-right .lia-quilt-column-side-content}
::: {.lia-quilt-column-alley .lia-quilt-column-alley-right}
%3CLINGO-SUB%20id%3D%22lingo-sub-2189059%22%20slang%3D%22en-US%22%3EInit%20API%20permissions%20for%20your%20SPFx%20projects%20without%20deploying%20them%3C%2FLINGO-SUB%3E%3CLINGO-BODY%20id%3D%22lingo-body-2189059%22%20slang%3D%22en-US%22%3E%3CP%3EWhen%20developing%20your%20SPFx%20components%2C%20you%20usually%20first%20run%20them%20locally%20before%20deploying%20them%20(really%3F).%3C%2FP%3E%0A%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3CP%3EAnd%20then%20comes%20the%20time%20to%20work%20with%20API%20such%20as%20Microsoft%20Graph.%3C%2FP%3E%0A%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3CP%3EIf%20you%20never%20use%20those%20permissions%20before%20in%20your%20SPFx%20projects%20(and%20the%20tenant%20with%20which%20you\'re%20working)%2C%20you%20realize%20that%20you%20have%20to%3A%3C%2FP%3E%0A%3CUL%3E%0A%3CLI%3EAdd%20required%20API%20permissions%20in%20your%3CSPAN%3E%26nbsp%3B%3C%2FSPAN%3E%3CCODE%3Epackage-solution.json%3C%2FCODE%3E%3CSPAN%3E%26nbsp%3B%3C%2FSPAN%3Efile%3C%2FLI%3E%0A%3CLI%3EBundle%20%2F%20Ship%20your%20project%3C%2FLI%3E%0A%3CLI%3EPublish%20it%3C%2FLI%3E%0A%3CLI%3EGo%20to%20the%20SharePoint%20Admin%20Center%20Web%20API%20Permissions%20page%3C%2FLI%3E%0A%3CLI%3EApprove%20those%20permissions%3C%2FLI%3E%0A%3C%2FUL%3E%0A%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3CP%3EAll%20of%20this%2C%20just%20to%20play%20with%20the%20API%20as%20you%20didn\'t%20plan%20to%20release%20your%20package%20in%20a%20production%20environment.%3C%2FP%3E%0A%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3CP%3ESo%20what%20if%20you%20could%20bypass%20all%20these%20steps%20for%20both%20Graph%20and%20owned%20API%3F%3C%2FP%3E%0A%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3CP%3E%3CSTRONG%3E%3CFONT%20color%3D%22%23FF9900%22%3EWarning%3C%2FFONT%3E%3C%2FSTRONG%3E%3C%2FP%3E%0A%3CP%20class%3D%22lia-indent-padding-left-30px%20lia-align-left%22%3E%3CSPAN%3EThis%20trick%20is%20just%20for%20development%20purposes.%20In%20Production%20environment%2C%20you%20should%20update%20your%26nbsp%3B%3C%2FSPAN%3E%3CCODE%3Epackage-solution.json%3C%2FCODE%3E%3CSPAN%3E%26nbsp%3Bfile%20to%20add%20required%20permissions%20and%20allow%20them%20(or%20ask%20for%20validation)%20in%20the%26nbsp%3B%3C%2FSPAN%3E%3CEM%3EAPI%20access%3C%2FEM%3E%3CSPAN%3E%26nbsp%3Bpage.%3C%2FSPAN%3E%3C%2FP%3E%0A%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3CH2%20id%3D%22toc-hId\--521305266%22%20id%3D%22toc-hId\--521305264%22%3EPrerequisites%3C%2FH2%3E%0A%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3COL%3E%0A%3CLI%3EAn%20Office%20365%20(Dev)%20Tenant%20or%20a%20Partner%20Demo%20Tenant%3C%2FLI%3E%0A%3CLI%3EThe%20following%20Azure%20AD%20role%20at%20least%3CUL%3E%0A%3CLI%3EApplication%20Administrator%3C%2FLI%3E%0A%3C%2FUL%3E%0A%3C%2FLI%3E%0A%3C%2FOL%3E%0A%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3CH2%20id%3D%22toc-hId-1966207567%22%20id%3D%22toc-hId-1966207569%22%3EWith%20Graph%20API%3C%2FH2%3E%0A%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3CP%3E%3CSPAN%3EFirst%2C%20we\'re%20going%20to%20play%20with%20Graph%20API%20through%20the%26nbsp%3B%3C%2FSPAN%3E%3CA%20href%3D%22https%3A%2F%2Fdocs.microsoft.com%2Ffr-fr%2Fgraph%2Ftoolkit%2Foverview%22%20target%3D%22_blank%22%20rel%3D%22noopener%20noreferrer%22%3EMicrosoft%20Graph%20Toolkit%3C%2FA%3E.%3C%2FP%3E%0A%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3CH3%20id%3D%22toc-hId\--1638198255%22%20id%3D%22toc-hId\--1638198253%22%3EPrepare%20your%20sample%3C%2FH3%3E%0A%3CP%3EInit%20a%20SPFx%20project%20(WebPart%20one%20with%20React%2C%20let\'s%20call%20it%3CSPAN%3E%26nbsp%3B%3C%2FSPAN%3E%3CEM%3EHelloApi%3C%2FEM%3E)%2C%20then%20add%20the%20Microsoft%20Graph%20Toolkit%20by%20executing%3CSPAN%3E%26nbsp%3B%3C%2FSPAN%3E%3CCODE%3Enpm%20i%20%3CA%20href%3D%22https%3A%2F%2Ftechcommunity.microsoft.com%2Ft5%2Fuser%2Fviewprofilepage%2Fuser-id%2F41501%22%20target%3D%22_blank%22%3E%40microsoft%3C%2FA%3E%2Fmgt%20%3CA%20href%3D%22https%3A%2F%2Ftechcommunity.microsoft.com%2Ft5%2Fuser%2Fviewprofilepage%2Fuser-id%2F41501%22%20target%3D%22_blank%22%3E%40microsoft%3C%2FA%3E%2Fmgt-react%3C%2FCODE%3E%3CSPAN%3E%26nbsp%3B%3C%2FSPAN%3Efrom%20the%20project\'s%20root%20path.%3C%2FP%3E%0A%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3CP%3EOnce%20done%2C%20open%20your%20main%20component%20file%20(let\'s%20say%20here%3CSPAN%3E%26nbsp%3B%3C%2FSPAN%3E%3CSTRONG%3EHelloApi.tsx%3C%2FSTRONG%3E)%20and%20add%20the%3CSPAN%3E%26nbsp%3B%3C%2FSPAN%3E%3CCODE%3EPeoplePicker%3C%2FCODE%3E%3CSPAN%3E%26nbsp%3B%3C%2FSPAN%3Ecomponent%20like%20this%3A%3C%2FP%3E%0A%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3CPRE%20class%3D%22lia-code-sample%20language-javascript%22%3E%3CCODE%3Eimport%20\*%20as%20React%20from%20\'react\'%3B%0Aimport%20styles%20from%20\'.%2FHelloApi.module.scss\'%3B%0Aimport%20%7B%20IHelloApiProps%20%7D%20from%20\'.%2FIHelloApiProps\'%3B%0Aimport%20%7B%20escape%20%7D%20from%20\'%40microsoft%2Fsp-lodash-subset\'%3B%0Aimport%20%7B%20PeoplePicker%20%7D%20from%20\'%40microsoft%2Fmgt-react\'%3B%0A%0Aexport%20default%20class%20HelloApi%20extends%20React.Component%3CIHELLOAPIPROPS%3E%20%7B%0A%20%20public%20render()%3A%20React.ReactElement%3CIHELLOAPIPROPS%3E%20%7B%0A%20%20%20%20return%20(%0A%20%20%20%20%20%20%3CDIV%20classname%3D%22%7B%22%20styles.helloapi%3D%22%22%3E%0A%20%20%20%20%20%20%20%20%3CDIV%20classname%3D%22%7B%22%20styles.container%3D%22%22%3E%0A%20%20%20%20%20%20%20%20%20%20%3CDIV%20classname%3D%22%7B%22%20styles.row%3D%22%22%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3CDIV%20classname%3D%22%7B%22%20styles.column%3D%22%22%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3CSPAN%20classname%3D%22%7B%22%20styles.title%3D%22%22%3EWelcome%20to%20SharePoint!%3C%2FSPAN%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3CP%20classname%3D%22%7B%22%20styles.subtitle%3D%22%22%3ECustomize%20SharePoint%20experiences%20using%20Web%20Parts.%3C%2FP%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3CP%20classname%3D%22%7B%22%20styles.description%3D%22%22%3E%7Bescape(this.props.description)%7D%3C%2FP%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3CA%20href%3D%22https%3A%2F%2Faka.ms%2Fspfx%22%20classname%3D%22%7B%22%20styles.button%3D%22%22%20target%3D%22_blank%22%20rel%3D%22noopener%20noreferrer%22%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3CSPAN%20classname%3D%22%7B%22%20styles.label%3D%22%22%3ELearn%20more%3C%2FSPAN%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3C%2FA%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3C%2FDIV%3E%0A%20%20%20%20%20%20%20%20%20%20%3C%2FDIV%3E%0A%20%20%20%20%20%20%20%20%3C%2FDIV%3E%0A%20%20%20%20%20%20%20%20%3CPEOPLEPICKER%3E%3C%2FPEOPLEPICKER%3E%0A%20%20%20%20%20%20%3C%2FDIV%3E%0A%20%20%20%20)%3B%0A%20%20%7D%0A%7D%3C%2FIHELLOAPIPROPS%3E%3C%2FIHELLOAPIPROPS%3E%3C%2FCODE%3E%3C%2FPRE%3E%0A%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3CH3%20id%3D%22toc-hId-849314578%22%20id%3D%22toc-hId-849314580%22%3ERun%20it%20in%20remote%20workbench%3C%2FH3%3E%0A%3CP%3ENow%20run%20your%20sample%20with%3CSPAN%3E%26nbsp%3B%3C%2FSPAN%3E%3CCODE%3Egulp%20serve%3C%2FCODE%3E%3CSPAN%3E%26nbsp%3B%3C%2FSPAN%3Eand%20display%20your%20webpart%20in%20your%20remote%20workbench%20(%3CA%20href%3D%22https%3A%2F%2Fcontoso.sharepoint.com%2F_layouts%2F15%2Fworkbench.aspx%22%20target%3D%22_blank%22%20rel%3D%22nofollow%20noopener%20noreferrer%22%3Ehttps%3A%2F%2Fcontoso.sharepoint.com%2F_layouts%2F15%2Fworkbench.aspx%3C%2FA%3E).%20Try%20to%20use%20the%3CSPAN%3E%26nbsp%3B%3C%2FSPAN%3E%3CCODE%3EPeoplePicker%3C%2FCODE%3E%3CSPAN%3E%26nbsp%3B%3C%2FSPAN%3Ecomponent%3A%20you\'ll%20see%20that%20just%20by%20clicking%20on%20the%20search%20box%2C%20you\'ll%20get%3CSPAN%3E%26nbsp%3B%3C%2FSPAN%3E%3CEM%3EWe%20didn\'t%20find%20any%20matches%3C%2FEM%3E.%3C%2FP%3E%0A%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3CP%3E%3CSPAN%3E%3CSPAN%20class%3D%22lia-inline-image-display-wrapper%20lia-image-align-center%22%20image-alt%3D%22peoplepicker-ui-fail.png%22%20style%3D%22width%3A%20804px%3B%22%3E%3CIMG%20src%3D%22https%3A%2F%2Ftechcommunity.microsoft.com%2Ft5%2Fimage%2Fserverpage%2Fimage-id%2F261327i7C491A73DF1A9A84%2Fimage-size%2Flarge%3Fv%3D1.0%26amp%3Bpx%3D999%22%20role%3D%22button%22%20title%3D%22peoplepicker-ui-fail.png%22%20alt%3D%22peoplepicker-ui-fail.png%22%20%2F%3E%3C%2FSPAN%3E%3C%2FSPAN%3E%3C%2FP%3E%0A%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3CP%3EDisplay%20your%20developer%20toolbox%20(F12)%20and%20go%20to%20the%20browser%20console%2C%20you%20should%20see%20the%20following%20error%3A%3C%2FP%3E%0A%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3CP%3E%3CSPAN%20class%3D%22lia-inline-image-display-wrapper%20lia-image-align-center%22%20image-alt%3D%22peoplepicker-console-fail.png%22%20style%3D%22width%3A%20972px%3B%22%3E%3CIMG%20src%3D%22https%3A%2F%2Ftechcommunity.microsoft.com%2Ft5%2Fimage%2Fserverpage%2Fimage-id%2F261328i877C183AB94DAEC5%2Fimage-size%2Flarge%3Fv%3D1.0%26amp%3Bpx%3D999%22%20role%3D%22button%22%20title%3D%22peoplepicker-console-fail.png%22%20alt%3D%22peoplepicker-console-fail.png%22%20%2F%3E%3C%2FSPAN%3E%3C%2FP%3E%0A%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3CP%3EAs%20you%20can%20see%2C%20it\'s%20a%20403%20error%2C%20which%20is%20well-known%20when%20using%20Graph%20API%20endpoints%20that%20have%20not%20been%20allowed%20on%20the%20first%20place.%3C%2FP%3E%0A%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3CH3%20id%3D%22toc-hId\--958139885%22%20id%3D%22toc-hId\--958139883%22%3EAdd%20Graph%20API%20through%20UI%3C%2FH3%3E%0A%3CP%3EFrom%20the%20Azure%20portal%2C%20display%20the%3CSPAN%3E%26nbsp%3B%3C%2FSPAN%3E%3CEM%3EAzure%20Active%20Directory%3C%2FEM%3E%3CSPAN%3E%26nbsp%3B%3C%2FSPAN%3E(AAD)%2C%20then%20select%20the%3CSPAN%3E%26nbsp%3B%3C%2FSPAN%3E%3CSTRONG%3EApp%20Registration%3C%2FSTRONG%3E%3CSPAN%3E%26nbsp%3B%3C%2FSPAN%3Emenu%20and%20select%3CSPAN%3E%26nbsp%3B%3C%2FSPAN%3E%3CSTRONG%3EAll%20Applications%3C%2FSTRONG%3E%2C%20then%20click%20on%3CSPAN%3E%26nbsp%3B%3C%2FSPAN%3E%3CSTRONG%3ESharePoint%20Online%20Client%20Extensibility%20Web%20Application%20Principal%3C%2FSTRONG%3E.%20It\'s%20the%20AAD%20Application%20that%20holds%20the%20connection%20to%20the%20API%20(Microsoft%20and%20others)%20from%20SharePoint%20(SPFx%20or%20every%20other%20development)%20using%20the%3CSPAN%3E%26nbsp%3B%3C%2FSPAN%3E%3CEM%3EImplicit%20Flow%3C%2FEM%3E.%3C%2FP%3E%0A%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3CP%3EOnce%20here%2C%20click%20on%3CSPAN%3E%26nbsp%3B%3C%2FSPAN%3E%3CSTRONG%3EAdd%20a%20permission%3C%2FSTRONG%3E%2C%20then%20select%3CSPAN%3E%26nbsp%3B%3C%2FSPAN%3E%3CSTRONG%3EMicrosoft%20Graph%3C%2FSTRONG%3E%3CSPAN%3E%26nbsp%3B%3C%2FSPAN%3Eand%20add%20the%20%5B%3CEM%3EPeople.Read%3C%2FEM%3E%5D%20Graph%20API%3CSPAN%3E%26nbsp%3B%3C%2FSPAN%3E%3CINS%3Edelegated%20permission%3C%2FINS%3E%3CSPAN%3E%26nbsp%3B%3C%2FSPAN%3E(you%20can%20type%20the%20name%20of%20the%20permission%20in%20the%20available%20search%20box%20to%20get%20it%20easily).%3C%2FP%3E%0A%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3CP%3E%3CSPAN%20class%3D%22lia-inline-image-display-wrapper%20lia-image-align-center%22%20image-alt%3D%22aad-app-spo-api-graph.png%22%20style%3D%22width%3A%20999px%3B%22%3E%3CIMG%20src%3D%22https%3A%2F%2Ftechcommunity.microsoft.com%2Ft5%2Fimage%2Fserverpage%2Fimage-id%2F261329i49E61D0AD724669F%2Fimage-size%2Flarge%3Fv%3D1.0%26amp%3Bpx%3D999%22%20role%3D%22button%22%20title%3D%22aad-app-spo-api-graph.png%22%20alt%3D%22aad-app-spo-api-graph.png%22%20%2F%3E%3C%2FSPAN%3E%3C%2FP%3E%0A%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3CP%3EOnce%20added%2C%20grant%20it%20by%20clicking%20on%3CSPAN%3E%26nbsp%3B%3C%2FSPAN%3E%3CSTRONG%3EGrant%20admin%20consent%20for%20contoso%3C%2FSTRONG%3E.%3C%2FP%3E%0A%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3CP%3EIf%20you%20go%20in%20the%3CSPAN%3E%26nbsp%3B%3C%2FSPAN%3E%3CEM%3EAPI%20access%3C%2FEM%3E%3CSPAN%3E%26nbsp%3B%3C%2FSPAN%3Epage%20(%3CA%20href%3D%22https%3A%2F%2Fcontoso-admin.sharepoint.com%2F_layouts%2F15%2Fonline%2FAdminHome.aspx%23%2FwebApiPermissionManagement%22%20target%3D%22_blank%22%20rel%3D%22nofollow%20noopener%20noreferrer%22%3Ehttps%3A%2F%2Fcontoso-admin.sharepoint.com%2F_layouts%2F15%2Fonline%2FAdminHome.aspx%23%2FwebApiPermissionManagement%3C%2FA%3E)%2C%20you%20should%20see%20something%20like%20this%3A%3C%2FP%3E%0A%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3CP%3E%3CSPAN%20class%3D%22lia-inline-image-display-wrapper%20lia-image-align-center%22%20image-alt%3D%22api-access-approved.png%22%20style%3D%22width%3A%20977px%3B%22%3E%3CIMG%20src%3D%22https%3A%2F%2Ftechcommunity.microsoft.com%2Ft5%2Fimage%2Fserverpage%2Fimage-id%2F261330i6A95D15054FE0812%2Fimage-size%2Flarge%3Fv%3D1.0%26amp%3Bpx%3D999%22%20role%3D%22button%22%20title%3D%22api-access-approved.png%22%20alt%3D%22(other%20Graph%20API%20permissions%20displayed%20here%20won\'t%20be%20necessary%20for%20the%20sample)%22%20%2F%3E%3CSPAN%20class%3D%22lia-inline-image-caption%22%20onclick%3D%22event.preventDefault()%3B%22%3E(other%20Graph%20API%20permissions%20displayed%20here%20won\'t%20be%20necessary%20for%20the%20sample)%3C%2FSPAN%3E%3C%2FSPAN%3E%3C%2FP%3E%0A%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3CP%3E%3CSPAN%3E%3CSTRONG%3E%3CFONT%20color%3D%22%23FF9900%22%3EWarning%3C%2FFONT%3E%3C%2FSTRONG%3E%3C%2FSPAN%3E%3C%2FP%3E%0A%3CP%20class%3D%22lia-align-left%20lia-indent-padding-left-30px%22%3E%3CSPAN%3EIt%20can%20take%20a%20couple%20of%20minutes%20before%20consented%20permissions%20is%20effective%2C%20so%20don\'t%20be%20surprised%20if%20it\'s%20not%20working%20right%20away%20after%20approval.%3C%2FSPAN%3E%3C%2FP%3E%0A%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3CH3%20id%3D%22toc-hId-1529372948%22%20id%3D%22toc-hId-1529372950%22%3EAdd%20Graph%20API%20through%20CLI%20for%20Microsoft%20365%3C%2FH3%3E%0A%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3CPRE%20class%3D%22lia-code-sample%20language-bash%22%3E%3CCODE%3Em365%20login%20%23%20Don\'t%20execute%20that%20command%20if%20you\'re%20already%20connected%0Am365%20spo%20serviceprincipal%20grant%20add%20\--resource%20\'Microsoft%20Graph\'%20\--scope%20\'People.Read\'%3C%2FCODE%3E%3C%2FPRE%3E%0A%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3CP%3E%3CSTRONG%3E%3CFONT%20color%3D%22%2300CCFF%22%3EInfo%3C%2FFONT%3E%3C%2FSTRONG%3E%3C%2FP%3E%0A%3CP%20class%3D%22lia-align-left%20lia-indent-padding-left-30px%22%3E%3CSPAN%3EDon\'t%20be%20surprised%20if%20by%20that%20way%2C%20the%20permission%20appears%20in%20the%20%22Other%20permissions%20granted%20for%20%5Byour%20tenant%5D%22%3A%20it%20won\'t%20prevent%20your%20SPFx%20solution%20to%20work.%3C%2FSPAN%3E%3C%2FP%3E%0A%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3CH3%20id%3D%22toc-hId\--278081515%22%20id%3D%22toc-hId\--278081513%22%3ETry%20again%3C%2FH3%3E%0A%3CP%3ENow%20try%20to%20use%20the%3CSPAN%3E%26nbsp%3B%3C%2FSPAN%3E%3CCODE%3EPeoplePicker%3C%2FCODE%3E%3CSPAN%3E%26nbsp%3B%3C%2FSPAN%3Ecomponent%20again%3A%20you\'ll%20see%20that%20with%20the%20addition%20of%20the%20Graph%20API%20permission%2C%20you%20should%20be%20able%20to%20use%20that%20component!%3C%2FP%3E%0A%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3CP%3E%3CSPAN%3E%3CSPAN%20class%3D%22lia-inline-image-display-wrapper%20lia-image-align-center%22%20image-alt%3D%22peoplepicker-ui-success.png%22%20style%3D%22width%3A%20799px%3B%22%3E%3CIMG%20src%3D%22https%3A%2F%2Ftechcommunity.microsoft.com%2Ft5%2Fimage%2Fserverpage%2Fimage-id%2F261331i81A858A6A4D017BA%2Fimage-size%2Flarge%3Fv%3D1.0%26amp%3Bpx%3D999%22%20role%3D%22button%22%20title%3D%22peoplepicker-ui-success.png%22%20alt%3D%22peoplepicker-ui-success.png%22%20%2F%3E%3C%2FSPAN%3E%3C%2FSPAN%3E%3C%2FP%3E%0A%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3CH2%20id%3D%22toc-hId\--288584619%22%20id%3D%22toc-hId\--288584617%22%3EWith%20custom%20API%3C%2FH2%3E%0A%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3CP%3EWhen%20using%20a%20custom%20API%2C%20it\'s%20a%20little%20bit%20more%20tricky%20but%20easy%20to%20handle%20anyway.%3C%2FP%3E%0A%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3CP%3EYou%20can%20follow%3CSPAN%3E%26nbsp%3B%3C%2FSPAN%3E%3CA%20href%3D%22https%3A%2F%2Fdocs.microsoft.com%2Ffr-fr%2Fsharepoint%2Fdev%2Fspfx%2Fuse-aadhttpclient-enterpriseapi%22%20target%3D%22_blank%22%20rel%3D%22noopener%20noreferrer%22%3Ethis%20Microsoft%20article%3C%2FA%3E%26nbsp%3Buntil%20the%3CSPAN%3E%26nbsp%3B%22%3C%2FSPAN%3E%3CA%20href%3D%22https%3A%2F%2Fdocs.microsoft.com%2Fen-us%2Fsharepoint%2Fdev%2Fspfx%2Fuse-aadhttpclient-enterpriseapi%23deploy-the-solution-to-the-sharepoint-app-catalog%22%20target%3D%22_self%22%20rel%3D%22noopener%20noreferrer%22%3EDeploy%20the%20solution%3C%2FA%3E%22%20part.%3C%2FP%3E%0A%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3CP%3EInstead%20of%20bundling%20and%20shipping%2C%20we\'ll%20add%20the%20AAD%20App%20(called%3CSPAN%3E%26nbsp%3B%3C%2FSPAN%3E%3CEM%3Econtoso-api-dp20200915%3C%2FEM%3E%3CSPAN%3E%26nbsp%3B%3C%2FSPAN%3Eif%20we%20follow%20the%20mentioned%20article)%20created%20from%20the%20Azure%20Function%20Authentication%20part%20in%20the%20SharePoint%20Service%20Principal.%3C%2FP%3E%0A%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3CH3%20id%3D%22toc-hId-401976855%22%20id%3D%22toc-hId-401976857%22%3EAdd%20your%20AAD%20Application%20to%20the%20SharePoint%20Service%20Principal%3C%2FH3%3E%0A%3CP%3E%3CSPAN%3EDisplay%20again%20the%20AAD%20page%2C%20then%20select%20the%26nbsp%3B%3C%2FSPAN%3E%3CSTRONG%3EApp%20Registration%3C%2FSTRONG%3E%3CSPAN%3E%26nbsp%3Bmenu%2C%20select%26nbsp%3B%3C%2FSPAN%3E%3CSTRONG%3EAll%20Applications%3C%2FSTRONG%3E%3CSPAN%3E%26nbsp%3Band%20click%20on%26nbsp%3B%3C%2FSPAN%3E%3CSTRONG%3ESharePoint%20Online%20Client%20Extensibility%20Web%20Application%20Principal%3C%2FSTRONG%3E%3CSPAN%3E.%20Once%20here%2C%20click%20on%26nbsp%3B%3C%2FSPAN%3E%3CSTRONG%3EAdd%20a%20permission%3C%2FSTRONG%3E%3CSPAN%3E%2C%20then%20select%20the%26nbsp%3B%3C%2FSPAN%3E%3CSTRONG%3EMy%20APIs%3C%2FSTRONG%3E%3CSPAN%3E%26nbsp%3Btab%20and%20select%20the%20fresh%20added%20AAD%20App%20created%20before.%20Select%20the%26nbsp%3B%3C%2FSPAN%3E%3CSTRONG%3Euser_impersonation%3C%2FSTRONG%3E%3CSPAN%3E%26nbsp%3Bpermission%2C%20then%20confirm.%3C%2FSPAN%3E%3C%2FP%3E%0A%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3CP%3E%3CSPAN%3E%3CSPAN%20class%3D%22lia-inline-image-display-wrapper%20lia-image-align-center%22%20image-alt%3D%22aad-app-spo-api-custom.png%22%20style%3D%22width%3A%20999px%3B%22%3E%3CIMG%20src%3D%22https%3A%2F%2Ftechcommunity.microsoft.com%2Ft5%2Fimage%2Fserverpage%2Fimage-id%2F261332i7206CD2A49DCAEFB%2Fimage-size%2Flarge%3Fv%3D1.0%26amp%3Bpx%3D999%22%20role%3D%22button%22%20title%3D%22aad-app-spo-api-custom.png%22%20alt%3D%22aad-app-spo-api-custom.png%22%20%2F%3E%3C%2FSPAN%3E%3C%2FSPAN%3E%3C%2FP%3E%0A%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3CP%3EFinally%2C%20grant%20this%20permission%20by%20clicking%20on%3CSPAN%3E%26nbsp%3B%3C%2FSPAN%3E%3CSTRONG%3EGrant%20admin%20consent%20for%20contoso%3C%2FSTRONG%3E.%3C%2FP%3E%0A%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3CP%3EIf%20you%20go%20again%20in%20the%3CSPAN%3E%26nbsp%3B%3C%2FSPAN%3E%3CEM%3EAPI%20access%3C%2FEM%3E%3CSPAN%3E%26nbsp%3B%3C%2FSPAN%3Epage%2C%20you%20should%20see%20something%20like%20this%3A%3C%2FP%3E%0A%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3CP%3E%3CSPAN%20class%3D%22lia-inline-image-display-wrapper%20lia-image-align-center%22%20image-alt%3D%22api-access-custom-approved.png%22%20style%3D%22width%3A%20967px%3B%22%3E%3CIMG%20src%3D%22https%3A%2F%2Ftechcommunity.microsoft.com%2Ft5%2Fimage%2Fserverpage%2Fimage-id%2F261337i4486CDC42E9CFA65%2Fimage-size%2Flarge%3Fv%3D1.0%26amp%3Bpx%3D999%22%20role%3D%22button%22%20title%3D%22api-access-custom-approved.png%22%20alt%3D%22api-access-custom-approved.png%22%20%2F%3E%3C%2FSPAN%3E%3C%2FP%3E%0A%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3CH3%20id%3D%22toc-hId\--1405477608%22%20id%3D%22toc-hId\--1405477606%22%3EAdd%20custom%20API%20through%20CLI%20for%20Microsoft%20365%3C%2FH3%3E%0A%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3CPRE%20class%3D%22lia-code-sample%20language-javascript%22%3E%3CCODE%3Em365%20login%20%23%20Don\'t%20execute%20that%20command%20if%20you\'re%20already%20connected%0Am365%20spo%20serviceprincipal%20grant%20add%20\--resource%20\'contoso-api-dp20200915\'%20\--scope%20\'user_impersonation\'%3C%2FCODE%3E%3C%2FPRE%3E%0A%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3CP%3E%3CSTRONG%3E%3CFONT%20color%3D%22%2300CCFF%22%3EInfo%3C%2FFONT%3E%3C%2FSTRONG%3E%3C%2FP%3E%0A%3CP%20class%3D%22lia-indent-padding-left-30px%20lia-align-left%22%3E%3CSPAN%3EDon\'t%20be%20surprised%20if%20by%20that%20way%2C%20the%20permission%20appears%20in%20the%20%22Other%20permissions%20granted%20for%20%5Byour%20tenant%5D%22%3A%20it%20won\'t%20prevent%20your%20SPFx%20solution%20to%20work.%3C%2FSPAN%3E%3C%2FP%3E%0A%3CP%20class%3D%22lia-align-left%22%3E%26nbsp%3B%3C%2FP%3E%0A%3CP%3E%3CSPAN%3E%3CSTRONG%3E%3CFONT%20color%3D%22%23FF9900%22%3EWarning%3C%2FFONT%3E%3C%2FSTRONG%3E%3C%2FSPAN%3E%3C%2FP%3E%0A%3CP%20class%3D%22lia-indent-padding-left-30px%20lia-align-left%22%3E%3CSPAN%3EIf%20you%20use%20an%20Azure%20Function%20as%20an%20API%20and%20enable%26nbsp%3B%3CSTRONG%3EManaged%20Identity%3C%2FSTRONG%3E%26nbsp%3Bfor%20any%20reason%2C%20you%20better%20have%20to%20rename%20the%20linked%20AAD%20Application%20to%20give%20it%20a%20different%20name%20than%20both%20your%20Function%20and%20its%26nbsp%3B%3CSTRONG%3EManaged%20Identity%3C%2FSTRONG%3E.%20Otherwise%2C%20the%20command%20will%20try%20to%20find%20a%20scope%20on%20it%20instead%20of%20the%20AAD%20App%20and%20fail.%3C%2FSPAN%3E%3C%2FP%3E%0A%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3CH3%20id%3D%22toc-hId-386871746%22%20id%3D%22toc-hId-386871748%22%3EUpdated%20sample%3C%2FH3%3E%0A%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3CP%3ETo%20run%20your%20custom%20API%20from%20your%20SPFx%20component%2C%20you%20can%20update%20your%20sample%20like%20below%3A%3C%2FP%3E%0A%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3CP%3E%3CEM%3EIHelloApiProps.ts%3C%2FEM%3E%3C%2FP%3E%0A%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3CPRE%20class%3D%22lia-code-sample%20language-javascript%22%3E%3CCODE%3Eimport%20%7B%20AadHttpClientFactory%20%7D%20from%20\'%40microsoft%2Fsp-http\'%3B%0A%0Aexport%20interface%20IHelloApiProps%20%7B%0A%20%20aadFactory%3A%20AadHttpClientFactory%3B%0A%20%20description%3A%20string%3B%0A%7D%3C%2FCODE%3E%3C%2FPRE%3E%0A%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3CP%3E%3CEM%3EHelloApiWebPart.ts%3C%2FEM%3E%3C%2FP%3E%0A%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3CPRE%20class%3D%22lia-code-sample%20language-javascript%22%3E%3CCODE%3E%2F%2F%20\...%0Aexport%20default%20class%20HelloApiWebPart%20extends%20BaseClientSideWebPart%3CIHELLOAPIWEBPARTPROPS%3E%20%7B%0A%0A%20%20%20%20%2F%2F%20\...%0A%0A%20%20%20%20public%20render()%3A%20void%20%7B%0A%20%20%20%20%20%20%20%20const%20element%3A%20React.ReactElement%3CIHELLOAPIPROPS%3E%20%3D%20React.createElement(%0A%20%20%20%20%20%20%20%20HelloGraph%2C%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20description%3A%20this.properties.description%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20aadFactory%3A%20this.context.aadHttpClientFactory%2C%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20)%3B%0A%0A%20%20%20%20%20%20%20%20ReactDom.render(element%2C%20this.domElement)%3B%0A%20%20%20%20%7D%0A%0A%20%20%2F%2F%20\...%0A%7D%3C%2FIHELLOAPIPROPS%3E%3C%2FIHELLOAPIWEBPARTPROPS%3E%3C%2FCODE%3E%3C%2FPRE%3E%0A%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3CP%3E%3CEM%3EHelloApi.tsx%3C%2FEM%3E%3C%2FP%3E%0A%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3CPRE%20class%3D%22lia-code-sample%20language-javascript%22%3E%3CCODE%3Eimport%20\*%20as%20React%20from%20\'react\'%3B%0Aimport%20styles%20from%20\'.%2FHelloApi.module.scss\'%3B%0Aimport%20%7B%20IHelloApiProps%20%7D%20from%20\'.%2FIHelloApiProps\'%3B%0Aimport%20%7B%20AadHttpClient%2C%20HttpClientResponse%20%7D%20from%20\'%40microsoft%2Fsp-http\'%3B%0A%0Ainterface%20IHelloApiState%20%7B%0A%20%20ordersToDisplay%3A%20any%3B%0A%7D%0A%0Aexport%20default%20class%20HelloApi%20extends%20React.Component%3CIHELLOAPIPROPS%3E%20%7B%0A%0A%20public%20constructor(props)%20%7B%0A%20%20%20%20super(props)%3B%0A%0A%20%20%20%20this.state%20%3D%20%7B%0A%20%20%20%20ordersToDisplay%3A%20null%0A%20%20%20%20%7D%3B%0A%20%7D%0A%0A%20public%20componentDidMount()%20%7B%0A%20%20%20%20this.props.aadFactory%0A%20%20%20%20%20%20.getClient(\'https%3A%2F%2Fcontoso-api-dp20191109.azurewebsites.net\')%0A%20%20%20%20%20%20.then((client%3A%20AadHttpClient)%3A%20void%20%3D%26gt%3B%20%7B%0A%20%20%20%20%20%20%20%20client%0A%20%20%20%20%20%20%20%20%20%20.get(\'https%3A%2F%2Fcontoso-api-dp20191109.azurewebsites.net%2Fapi%2FOrders\'%2C%20AadHttpClient.configurations.v1)%0A%20%20%20%20%20%20%20%20%20%20.then((response%3A%20HttpClientResponse)%3A%20Promise%3CANY%3E%20%3D%26gt%3B%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20response.json()%3B%0A%20%20%20%20%20%20%20%20%20%20%7D)%0A%20%20%20%20%20%20%20%20%20%20.then((orders%3A%20any)%3A%20void%20%3D%26gt%3B%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.setState(%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20ordersToDisplay%3A%20orders%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D)%0A%20%20%20%20%20%20%20%20%20%20%7D)%3B%0A%20%20%20%20%20%20%7D).catch((err)%20%3D%26gt%3B%20%7B%0A%20%20%20%20%20%20%20%20console.log(err)%3B%0A%20%20%20%20%20%20%7D)%3B%0A%20%20%7D%0A%0A%20%20public%20render()%3A%20React.ReactElement%3CIHELLOAPIPROPS%3E%20%7B%0A%20%20%20%20return%20(%0A%20%20%20%20%20%20%3CDIV%20classname%3D%22%7B%22%20styles.helloapi%3D%22%22%3E%0A%20%20%20%20%20%20%20%20%3CDIV%20classname%3D%22%7B%22%20styles.container%3D%22%22%3E%0A%20%20%20%20%20%20%20%20%20%20%3CDIV%20classname%3D%22%7B%22%20styles.row%3D%22%22%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3CDIV%20classname%3D%22%7B%22%20styles.column%3D%22%22%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3CSPAN%20classname%3D%22%7B%22%20styles.title%3D%22%22%3EWelcome%20to%20SharePoint!%3C%2FSPAN%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3CP%20classname%3D%22%7B%22%20styles.subtitle%3D%22%22%3ECustomize%20SharePoint%20experiences%20using%20Web%20Parts.%3C%2FP%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3CP%20classname%3D%22%7B%22%20styles.description%3D%22%22%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3CUL%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7Bthis.state.ordersToDisplay%20%26amp%3B%26amp%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20this.state.ordersToDisplay.map(o%20%3D%26gt%3B%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20%3CLI%3E%7Bo.rep%7D%3A%20%7Bo.total%7D%3C%2FLI%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3C%2FUL%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3C%2FP%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3C%2FDIV%3E%0A%20%20%20%20%20%20%20%20%20%20%3C%2FDIV%3E%0A%20%20%20%20%20%20%20%20%3C%2FDIV%3E%0A%20%20%20%20%20%20%3C%2FDIV%3E%0A%20%20%20%20)%3B%0A%20%20%7D%0A%7D%3C%2FIHELLOAPIPROPS%3E%3C%2FANY%3E%3C%2FIHELLOAPIPROPS%3E%3C%2FCODE%3E%3C%2FPRE%3E%0A%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3CP%3ENow%20you%20can%20run%20your%20sample%20locally%20and%20try%20it%20in%20your%20hosted%20workbench%2C%20playing%20with%20it%20and%20updating%20your%20WebPart%20as%20you%20want!%3C%2FP%3E%0A%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3CP%3E\...%20And%20don\'t%20forget%20to%20update%20your%3CSPAN%3E%26nbsp%3B%3C%2FSPAN%3E%3CCODE%3Epackage-solution.json%3C%2FCODE%3E%3CSPAN%3E%26nbsp%3B%3C%2FSPAN%3Efile%20to%20include%20the%20required%20APIs%20before%20shipping!%3CSPAN%3E%26nbsp%3B%3CIMG%20class%3D%22lia-deferred-image%20lia-image-emoji%22%20src%3D%22https%3A%2F%2Ftechcommunity.microsoft.com%2Fhtml%2F%408341BD79091AF36AA2A09063B554B5CD%2Fimages%2Femoticons%2Fsmile_40x40.gif%22%20alt%3D%22%3Asmile%3A%22%20title%3D%22%3Asmile%3A%22%20%2F%3E%3C%2FSPAN%3E%3C%2FP%3E%0A%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3CP%3EHappy%20coding!%3C%2FP%3E%0A%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3CP%3E%3CEM%3EThis%20article%20was%20cross-posted%20on%20%3CA%20href%3D%22https%3A%2F%2Fmichaelmaillot.github.io%2Ftips%2F20210302-spfx-api-permissions%2F%22%20target%3D%22_self%22%20rel%3D%22nofollow%20noopener%20noreferrer%22%3Emy%20blog%3C%2FA%3E.%3C%2FEM%3E%3C%2FP%3E%3C%2FLINGO-BODY%3E%3CLINGO-TEASER%20id%3D%22lingo-teaser-2189059%22%20slang%3D%22en-US%22%3E%3CP%3E%3CSPAN%20class%3D%22lia-inline-image-display-wrapper%20lia-image-align-center%22%20image-alt%3D%227717470502_7afc3ff548_b.jpg%22%20style%3D%22width%3A%20999px%3B%22%3E%3CIMG%20src%3D%22https%3A%2F%2Ftechcommunity.microsoft.com%2Ft5%2Fimage%2Fserverpage%2Fimage-id%2F262362i9A5335DB9EE2853B%2Fimage-size%2Flarge%3Fv%3D1.0%26amp%3Bpx%3D999%22%20role%3D%22button%22%20title%3D%227717470502_7afc3ff548_b.jpg%22%20alt%3D%227717470502_7afc3ff548_b.jpg%22%20%2F%3E%3C%2FSPAN%3E%3C%2FP%3E%0A%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3CP%3EWhen%20developing%20your%20SPFx%20components%2C%20you%20usually%20first%20run%20them%20locally%20before%20deploying%20them%20(really%3F).%3C%2FP%3E%0A%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3CP%3EAnd%20then%20comes%20the%20time%20to%20work%20with%20API%20such%20as%20Microsoft%20Graph.%3C%2FP%3E%3C%2FLINGO-TEASER%3E

::: {#threadTranslationDashboard .Thread_Translation_Dashboard ng-controller="lingotekThreadTranslationCtrl" li-bindable=""}
::: lingotek-admin-dashboard
:::
:::

::: {style="clear:both"}
:::

::: {#contributorsTaplet .ContributorsTaplet .lia-component-tkb-widget-contributors-taplet}
::: {.lia-panel .lia-panel-standard}
::: lia-decoration-border
::: lia-decoration-border-top
<div>

</div>
:::

::: lia-decoration-border-content
<div>

::: lia-panel-heading-bar-wrapper
::: lia-panel-heading-bar
[ Co-Authors ]{.lia-panel-heading-bar-title aria-level="3"
role="heading"}
:::
:::

::: lia-panel-content-wrapper
::: lia-panel-content
::: {.UserProfileSummary .lia-user-item .lia-js-data-userId-461902 .lia-user-info-group}
::: UserAvatarWrapper
::: {.UserAvatar .lia-user-avatar .lia-component-common-widget-user-avatar .Occasional .Contributor}
[![michaelmaillot](https://techcommunity.microsoft.com/t5/image/serverpage/image-id/247588i11B78FB75491CD72/image-dimensions/40x40?v=v2 "michaelmaillot"){.lia-user-avatar-message
.user-rank-ring style=""
onerror="replaceBrokenAvatars(this, '/html/assets/default-avatar.png')"}](/t5/user/viewprofilepage/user-id/461902){.UserAvatar
.lia-link-navigation}
:::

::: {.user-profile-card user-id="461902"}
::: contents
::: spinner
:::
:::
:::
:::

::: lia-user-attributes
::: lia-user-name
[
[michaelmaillot](https://techcommunity.microsoft.com/t5/user/viewprofilepage/user-id/461902){#link_10
.lia-link-navigation .lia-page-link .lia-user-name-link} ]{.UserName
.lia-user-name .lia-user-rank-Occasional-Contributor}
:::
:::
:::
:::
:::

</div>
:::

::: lia-decoration-border-bottom
<div>

</div>
:::
:::
:::
:::

::: {.lia-panel .lia-panel-standard .ArticleRevisionInfoTaplet .Chrome .lia-component-tkb-widget-article-revision-info-taplet}
::: lia-decoration-border
::: lia-decoration-border-top
<div>

</div>
:::

::: lia-decoration-border-content
<div>

::: lia-panel-heading-bar-wrapper
::: lia-panel-heading-bar
[Version history]{.lia-panel-heading-bar-title aria-level="3"
role="heading"}
:::
:::

::: lia-panel-content-wrapper
::: lia-panel-content
::: lia-revision-info-wrapper
::: lia-revision-info-content
::: {.lia-revision-info-row .lia-revision-last-update-row}
::: lia-revision-info-title-cell
Last update:
:::

::: lia-revision-info-data-cell
[ [‎Mar 10 2021]{.local-date} [01:18 AM]{.local-time} ]{.DateTime}
:::
:::

::: {.lia-revision-info-row .lia-revision-author-row}
::: lia-revision-info-title-cell
Updated by:
:::

::: lia-revision-info-data-cell
[
[michaelmaillot](https://techcommunity.microsoft.com/t5/user/viewprofilepage/user-id/461902){#link_11
.lia-link-navigation .lia-page-link .lia-user-name-link} ]{.UserName
.lia-user-name .lia-user-rank-Occasional-Contributor}
:::
:::

::: {.lia-revision-info-row .lia-revision-article-history-link-row .lia-revision-info-data-cell-workflow}
:::
:::
:::
:::
:::

</div>
:::

::: lia-decoration-border-bottom
<div>

</div>
:::
:::
:::

::: blog-article-social-share-widget-wrapper
::: custom-social-share-component
::: custom-social-share-widget
::: {.lia-panel .lia-panel-standard .Chrome .custom-share-component style=""}
::: lia-decoration-border
::: lia-decoration-border-top
<div>

</div>
:::

::: lia-decoration-border-content
<div>

::: lia-panel-heading-bar-wrapper
::: lia-panel-heading-bar
## Share {#customShareWidget .lia-panel-heading-bar-title .hello}
:::
:::

::: lia-panel-content-wrapper
::: lia-panel-content
-   [[Share to
    LinkedIn]{.social-share-title}](http://www.linkedin.com/shareArticle?mini=true&url=https://techcommunity.microsoft.com/t5/microsoft-365-pnp-blog/init-api-permissions-for-your-spfx-projects-without-deploying/ba-p/2189059 "Share to LinkedIn"){.social-share-link
    .social-share-linkedin}
-   [[Share to
    Facebook]{.social-share-title}](http://www.facebook.com/share.php?u=https://techcommunity.microsoft.com/t5/microsoft-365-pnp-blog/init-api-permissions-for-your-spfx-projects-without-deploying/ba-p/2189059 "Share to FaceBook"){.social-share-link
    .social-share-facebook}
-   [[Share to
    Twitter]{.social-share-title}](http://twitter.com/share?text=Check%20out%20this%20post%20on%20the%20Microsoft%20Tech%20Community%20:%20Init%20API%20permissions%20for%20your%20SPFx%20projects%20without%20deploying%20them%20-%20Microsoft%20Tech%20Community&url=https://techcommunity.microsoft.com/t5/microsoft-365-pnp-blog/init-api-permissions-for-your-spfx-projects-without-deploying/ba-p/2189059 "Share to Twitter"){.social-share-link
    .social-share-twitter}
-   [[Share to
    Email]{.social-share-title}](mailto:?subject=Init%20API%20permissions%20for%20your%20SPFx%20projects%20without%20deploying%20them%20-%20Microsoft%20Tech%20Community&body=I%20found%20this%20on%20the%20Microsoft%20Tech%20Community%20and%20wanted%20to%20share%20it%20with%20you,%20check%20it%20out%20:%20https://techcommunity.microsoft.com/t5/microsoft-365-pnp-blog/init-api-permissions-for-your-spfx-projects-without-deploying/ba-p/2189059 "Share via email"){.social-share-link
    .social-share-email}
:::
:::

</div>
:::

::: lia-decoration-border-bottom
<div>

</div>
:::
:::
:::
:::
:::
:::
:::
:::
:::

::: {.lia-quilt-row .lia-quilt-row-footer}
::: {.lia-quilt-column .lia-quilt-column-24 .lia-quilt-column-single .lia-quilt-column-common-footer}
::: {.lia-quilt-column-alley .lia-quilt-column-alley-single}
::: {.lia-quilt .lia-quilt-footer .lia-quilt-layout-footer .lia-component-quilt-footer}
::: {.lia-quilt-row .lia-quilt-row-main}
::: {.lia-quilt-column .lia-quilt-column-24 .lia-quilt-column-single .lia-quilt-column-icons}
::: {.lia-quilt-column-alley .lia-quilt-column-alley-single .lia-mark-empty}
:::
:::
:::
:::
:::
:::
:::
:::
:::
:::
:::
:::

::: {.cse-46444-wa style="display: none"}
::: {.lia-slide-out-nav-menu .lia-component-common-widget-slide-out-nav-menu}
::: {.lia-slide-out-nav-menu-title ng-non-bindable=""}
Browse
:::

::: {.lia-quilt .lia-quilt-navigation-slide-out-menu .lia-quilt-layout-one-column .lia-top-quilt}
::: {.lia-quilt-row .lia-quilt-row-header}
::: {.lia-quilt-column .lia-quilt-column-24 .lia-quilt-column-single .lia-quilt-column-common-header .lia-mark-empty}
:::
:::

::: {.lia-quilt-row .lia-quilt-row-main}
::: {.lia-quilt-column .lia-quilt-column-24 .lia-quilt-column-single .lia-quilt-column-main-content}
::: {.lia-quilt-column-alley .lia-quilt-column-alley-single}
:::
:::
:::

::: {.lia-quilt-row .lia-quilt-row-footer}
::: {.lia-quilt-column .lia-quilt-column-24 .lia-quilt-column-single .lia-quilt-column-common-footer .lia-mark-empty}
:::
:::
:::
:::
:::

::: {.shell-footer bi-view="5xLinks" bi-area="Footer" ms.pgarea="uhffooter" role="contentinfo"}
::: shell-footer-wrapper
::: {.shell-footer-menugroups ms.cmpgrp="footer nav"}
::: {.sfm-group ms.cmpnm="WhatsNew"}
###### What\'s new  {#whats-new .grp-title}

-   [Surface Pro
    X](https://www.microsoft.com/p/surface-pro-x/8vdnrp2m6hhc?activetab=overview)
-   [Surface Laptop
    3](https://www.microsoft.com/p/surface-laptop-3/8VFGGH1R94TM?activetab=overview)
-   [Surface Pro
    7](https://www.microsoft.com/p/surface-pro-7/8N17J0M5ZZQS?activetab=overview)
-   [Windows 10 Apps](https://www.microsoft.com/windows/windows-10-apps)
-   [Office apps](https://store.office.com/appshome.aspx)
:::

::: {.sfm-group ms.cmpnm="MicrosoftStore"}
###### Microsoft Store  {#microsoft-store .grp-title}

-   [Account profile](https://account.microsoft.com/)
-   [Download Center](https://www.microsoft.com/download)
-   [Microsoft Store
    support](https://go.microsoft.com/fwlink/p/?LinkID=824761&clcid=0x409)
-   [Returns](https://go.microsoft.com/fwlink/p/?LinkID=824764&clcid=0x409)
-   [Order tracking](https://account.microsoft.com/orders)
-   [Store
    locations](https://www.microsoft.com/en-us/store/locations/find-a-store?icid=en-us_UF_FAS)
-   [Buy online, pick up in
    store](https://www.microsoft.com/en-us/store/b/buy-online-pick-up-in-store?icid=uhf_footer_bopuis)
-   [In-store
    events](https://www.microsoft.com/en-us/store/locations/events?icid=en_us_store_uhf_events)
:::

::: {.sfm-group ms.cmpnm="Education"}
###### Education  {#education .grp-title}

-   [Microsoft in education](https://www.microsoft.com/education)
-   [Office for
    students](https://www.microsoft.com/education/products/office/default.aspx)
-   [Office for
    schools](https://products.office.com/academic/compare-office-365-education-plans)
-   [Deals for students and
    parents](https://www.microsoft.com/en-us/store/b/education?icid=CNavfooter_Studentsandeducation)
-   [Microsoft Azure in
    education](https://azure.microsoft.com/community/education/)
:::

::: {.sfm-group ms.cmpnm="Enterprise"}
###### Enterprise  {#enterprise .grp-title}

-   [Azure](https://azure.microsoft.com/)
-   [AppSource](https://go.microsoft.com/fwlink/?LinkID=808093)
-   [Automotive](https://www.microsoft.com/enterprise/automotive)
-   [Government](https://www.microsoft.com/enterprise/government)
-   [Healthcare](https://www.microsoft.com/enterprise/health)
-   [Manufacturing](https://www.microsoft.com/enterprise/manufacturing)
-   [Financial
    Services](https://www.microsoft.com/enterprise/financial-services/banking-and-capital-markets)
-   [Retail](https://www.microsoft.com/enterprise/retail-consumer-goods)
:::

::: {.sfm-group ms.cmpnm="Developer"}
###### Developer  {#developer .grp-title}

-   [Microsoft Visual Studio](https://visualstudio.microsoft.com/)
-   [Window Dev Center](https://developer.microsoft.com/windows)
-   [Developer Network](https://msdn.microsoft.com/)
-   [TechNet](https://technet.microsoft.com/)
-   [Microsoft developer
    program](https://developer.microsoft.com/store/register)
-   [Channel 9](https://channel9.msdn.com/)
-   [Office Dev Center](https://developer.microsoft.com/office)
-   [Microsoft Garage](https://www.microsoft.com/garage/)
:::

::: {.sfm-group ms.cmpnm="Company"}
###### Company  {#company .grp-title}

-   [Careers](https://careers.microsoft.com/)
-   [About Microsoft](https://www.microsoft.com/en-us/about)
-   [Company News](https://news.microsoft.com/)
-   [Privacy at Microsoft](https://privacy.microsoft.com/)
-   [Investors](https://www.microsoft.com/investor/default.aspx)
-   [Diversity and inclusion](https://www.microsoft.com/diversity/)
-   [Accessibility](https://www.microsoft.com/accessibility)
-   [Security](https://www.microsoft.com/security/default.aspx)
:::
:::

::: {.shell-footer-copyright ms.cmpnm="corp" ms.cmpgrp="corp links"}
-   [Sitemap](https://www.microsoft.com/en-us/sitemap1.aspx){#shellmenu_0
    .ctl_footerNavLink}
-   [Contact
    Microsoft](https://support.microsoft.com/contactus){#shellmenu_1
    .ctl_footerNavLink}
-   [Privacy](https://go.microsoft.com/fwlink/?LinkId=521839){#shellmenu_2
    .ctl_footerNavLink}
-   [Manage cookies](#){#shellmenu_2B .ctl_footerNavLink .hidden}
-   [Terms of
    use](http://go.microsoft.com/fwlink/?LinkID=206977){#shellmenu_3
    .ctl_footerNavLink}
-   [Trademarks](https://www.microsoft.com/trademarks){#shellmenu_4
    .ctl_footerNavLink}
-   [Safety and
    eco](https://www.microsoft.com/devices/safety-and-eco){#shellmenu_5
    .ctl_footerNavLink}
-   [About our ads](https://choice.microsoft.com/){#shellmenu_6
    .ctl_footerNavLink}
-   © []{#footerDate} Microsoft
:::
:::
:::
:::
