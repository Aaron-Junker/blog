::: {#38D-003-7 .ServiceNodeInfoHeader}
:::

::: lia-page
::: MinimumWidthContainer
::: min-width-wrapper
::: min-width
::: lia-content
::: {.lia-quilt .lia-quilt-blog-article-page .lia-quilt-layout-two-column-main-side-18-6 .lia-top-quilt}
::: {.lia-quilt-row .lia-quilt-row-header}
::: {.lia-quilt-column .lia-quilt-column-24 .lia-quilt-column-single .lia-quilt-column-common-header}
::: {.lia-quilt-column-alley .lia-quilt-column-alley-single}
::: {.lia-quilt .lia-quilt-header .lia-quilt-layout-header .lia-component-quilt-header}
::: {.lia-quilt-row .lia-quilt-row-main-header}
::: {.lia-quilt-column .lia-quilt-column-24 .lia-quilt-column-single .lia-quilt-column-header}
::: {.lia-quilt-column-alley .lia-quilt-column-alley-single}
::: {#cookie-banner .cookie-markup}
:::

::: {#readerAssistMessages .section .live-region aria-live="assertive" role="alert"}
:::

::: community-header-blank
:::

::: community-header-component
::: community-header-wrapper
::: container
::: {#community-menu-wrapper-menu .menu-link}
[](javascript:void(0)){#community-menu-wrapper-menu-link}

::: {#community-menu-wrapper-menu-icon .menu-icon title=""}
:::
:::

[![](https://techcommunity.microsoft.com/html/@6005EEFEC6E5ECADBBFC249DFA7D38A8/assets/Content/Images/GlobalHeader/MicrosoftLogo.png){.c-image
itemprop="logo" role="presentation" aria-hidden="true"}
[Microsoft]{role="presentation"
aria-hidden="true"}](https://www.microsoft.com){#uhfLogo .c-logo
.c-sgl-stk-uhfLogo}

::: {.c-show-pipe aria-hidden="true"}
:::

[Tech Community](/){#uhfCatLogo .c-logo .c-cat-logo}

::: container-inner
::: {#community-menu-wrapper .community-menu-wrapper .community-menu-hidden-init}
::: {#community-menu-wrapper-header-bar .community-header-bar}
[](#){.community-header-button}

::: community-menu-item-icon
:::
:::

::: {#community-menu-wrapper-list .community-menu-list}
::: {.community-menu-item .tab-homepage}
[](/)

::: {.mdl2-glyph .community-menu-item-icon}

:::

::: community-menu-item-title
Home
:::
:::

::: {.community-menu-item .community-menu-dropdown}
[](#){.community-menu-item-desktop-view}

::: {.c-glyph .community-menu-item-icon}

:::

::: community-menu-item-title-with-dropdownicon
Community Hubs
:::

[](/t5/communities/ct-p/communities#category-filter-button-all){.community-menu-item-mobile-view
.community-menu-item-allow-link}

::: {.c-glyph .community-menu-item-icon}

:::

::: community-menu-item-title-with-dropdownicon
Community Hubs
:::

::: {.dropdown .dropdown-communities .dropdown-events .dropdown-primary-nav}
-   [Community Hubs
    Home](/t5/communities/ct-p/communities#category-filter-button-all){#communities_home}
-   [Products](/t5/communities/ct-p/communities#category-filter-button-products-services){#communities_products}
-   [Special
    Topics](/t5/communities/ct-p/communities#category-filter-button-solutions){#communities_special}
-   [Video Hub](/t5/video-hub/ct-p/VideoHub){#communities_videohub}

::: custom-community-hubs-menu-wrapper
::: custom-community-hubs-menu-close
Close
:::

::: custom-community-hubs-menu-content
::: menu
## [ Products]{#menu-link-prod title="Products"} [(72)]{.small} {#menu-products .active}

## [ Special Topics ]{#menu-link-serv title="Special Topics"} [(41)]{.small} {#menu-services}

## [ Video Hub ]{#menu-link-videohub title="VideoHub"} [(834)]{.small} {#menu-videohub}
:::

::: {#products-data .dataBlock .visible key="products"}
::: {.hubs style="width: 600px"}
### Most Active Hubs

::: {.data style="flex-direction: column; height:310px"}
<div>

[Microsoft
Teams](/t5/microsoft-teams/ct-p/MicrosoftTeams "Microsoft Teams")

</div>

<div>

[Excel](/t5/excel/ct-p/Excel_Cat "Excel")

</div>

<div>

[Exchange](/t5/exchange/ct-p/Exchange "Exchange")

</div>

<div>

[SharePoint](/t5/sharepoint/ct-p/SharePoint "SharePoint")

</div>

<div>

[Windows](/t5/windows-10/ct-p/Windows10 "Windows")

</div>

<div>

[Office 365](/t5/office-365/ct-p/Office365 "Office 365")

</div>

<div>

[Security, Compliance and
Identity](/t5/security-compliance-and-identity/ct-p/MicrosoftSecurityandCompliance "Security, Compliance and Identity")

</div>

<div>

[Windows
Server](/t5/windows-server/ct-p/Windows-Server "Windows Server")

</div>

<div>

[Microsoft Edge
Insider](/t5/microsoft-edge-insider/ct-p/MicrosoftEdgeInsider "Microsoft Edge Insider")

</div>

<div>

[Azure](/t5/azure-community/ct-p/Azure "Azure")

</div>

<div>

[Microsoft 365](/t5/microsoft-365/ct-p/microsoft365 "Microsoft 365")

</div>
:::
:::

::: boxes
[](/t5/azure-databases/ct-p/AzureDatabases "Azure Databases")

::: {.box style="background-image: url('https://techcommunity.microsoft.com/html/@D05C7AA27EF9EB31779410FCB608734A/assets/bg-pink.png')"}
::: title
Azure Databases
:::

::: description
Fully managed intelligent database services.
:::
:::

[](/t5/project-bonsai/ct-p/ProjectBonsai "Autonomous Systems")

::: {.box style="background-image: url('https://techcommunity.microsoft.com/html/@FC8AD6AC9A7EBDA58D7E6304E799EA40/assets/bg-orange.png')"}
::: title
Autonomous Systems
:::

::: description
Create and optimise intelligence for industrial control systems.
:::
:::

[](/t5/yammer/ct-p/Yammer "Yammer")

::: {.box style="background-image: url('https://techcommunity.microsoft.com/html/@CF0293463F27444B05A952A3C4B6BF88/assets/bg-light-blue.png')"}
::: title
Yammer
:::

::: description
Connect and engage across your organization.
:::
:::
:::
:::

::: {#services-data .dataBlock key="services"}
::: {.hubs style="width: 600px"}
### Most Active Hubs

::: {.data style="flex-direction: column; height:310px"}
<div>

[ITOps Talk](/t5/itops-talk/ct-p/ITOpsTalk "ITOps Talk")

</div>

<div>

[Education
Sector](/t5/education-sector/ct-p/EducationSector "Education Sector")

</div>

<div>

[Microsoft
Learn](/t5/microsoft-learn/ct-p/MicrosoftLearn "Microsoft Learn")

</div>

<div>

[Microsoft
Localization](/t5/microsoft-localization/ct-p/MicrosoftTranslation "Microsoft Localization")

</div>

<div>

[Microsoft 365
PnP](/t5/microsoft-365-pnp/ct-p/Microsoft365PnP "Microsoft 365 PnP")

</div>

<div>

[Healthcare and Life
Sciences](/t5/healthcare-and-life-sciences/ct-p/HealthcareAndLifeSciences "Healthcare and Life Sciences")

</div>

<div>

[Public Sector](/t5/public-sector/ct-p/PublicSector "Public Sector")

</div>

<div>

[Internet of Things
(IoT)](/t5/internet-of-things-iot/ct-p/IoT "Internet of Things (IoT)")

</div>

<div>

[Mixed
Reality](/t5/mixed-reality/ct-p/MicrosoftMixedReality "Mixed Reality")

</div>

<div>

[Enabling Remote
Work](/t5/enabling-remote-work/ct-p/RemoteWork "Enabling Remote Work")

</div>

<div>

[Small and Medium
Business](/t5/small-and-medium-businesses/ct-p/SMB "Small and Medium Business")

</div>
:::
:::

::: boxes
[](/t5/humans-of-it/ct-p/HumansofIT "Humans of IT")

::: {.box style="background-image: url('https://techcommunity.microsoft.com/html/@A5C0BDB1059C6D1F73B8097424B50ED0/assets/bg-purple.png')"}
::: title
Humans of IT
:::

::: description
Empowering technologists to achieve more by humanizing tech.
:::
:::

[](/t5/green-tech/ct-p/GreenTech "Green Tech")

::: {.box style="background-image: url('https://cdn.techcommunity.microsoft.com/lithium/MicrosoftLearn/Learn-Blue.png')"}
::: title
Green Tech
:::

::: description
Raise awareness about sustainability in the tech sector
:::
:::

[](/t5/mvp-award-program/ct-p/MVPAwardProgram "MVP Award Program")

::: {.box style="background-image: url('https://techcommunity.microsoft.com/html/@02C247197A08F2DB06040AC786E1BF01/assets/bg-green.png')"}
::: title
MVP Award Program
:::

::: description
Find out more about the Microsoft MVP Award Program.
:::
:::
:::
:::

::: {#VideoHub-Data .dataBlock key="VideoHub"}
::: {.hubs style="width: 838px"}
### Video Hub

::: {.data style="flex-direction: row; height:fit-content"}
<div>

[Azure](https://aka.ms/VideoHub/Azure "Azure")

</div>

<div>

[Exchange](https://aka.ms/VideoHub/Exchange "Exchange")

</div>

<div>

[Microsoft 365](https://aka.ms/VideoHub/Microsoft365 "Microsoft 365")

</div>

<div>

[Microsoft 365
Business](https://aka.ms/VideoHub/Microsoft365Business "Microsoft 365 Business")

</div>

<div>

[Microsoft 365
Enterprise](https://aka.ms/VideoHub/Microsoft365Business "Microsoft 365 Enterprise")

</div>

<div>

[Microsoft Edge](https://aka.ms/VideoHub/MicrosoftEdge "Microsoft Edge")

</div>

<div>

[Microsoft Outlook](https://aka.ms/VideoHub/Outlook "Microsoft Outlook")

</div>

<div>

[Microsoft
Teams](https://aka.ms/VideoHub/MicrosoftTeams "Microsoft Teams")

</div>

<div>

[Security](https://aka.ms/VideoHub/Security "Security")

</div>

<div>

[SharePoint](https://aka.ms/VideoHub/SharePoint "SharePoint")

</div>

<div>

[Windows](https://aka.ms/VideoHub/Windows "Windows")

</div>
:::
:::
:::
:::

::: custom-community-hubs-menu-footer
[Browse All Community
Hubs](/t5/Communities/ct-p/communities){#browse-all-communities}
:::
:::
:::
:::

::: {.community-menu-item .my-favorites}
[](/t5/custom/page/page-id/Blogs){.community-menu-item-desktop-view}

::: {.mdl2-glyph .community-menu-item-icon}

:::

::: community-menu-item-title
Blogs
:::

[](/t5/custom/page/page-id/Blogs){.community-menu-item-mobile-view}

::: {.mdl2-glyph .community-menu-item-icon}

:::

::: community-menu-item-title
Blogs
:::
:::

::: {.community-menu-item .tab-events .community-menu-dropdown}
[](#){.community-menu-item-desktop-view}

::: {.c-glyph .community-menu-item-icon}

:::

::: community-menu-item-title-with-dropdownicon
Events
:::

[](#){.community-menu-item-mobile-view}

::: {.c-glyph .community-menu-item-icon}

:::

::: community-menu-item-title-with-dropdownicon
Events
:::

::: {.dropdown .dropdown-events .dropdown-primary-nav}
-   [Events Home](/t5/Events/ct-p/Events)
-   [Microsoft Ignite](https://myignite.microsoft.com/)
-   [Microsoft Build](https://mybuild.microsoft.com/)
-   [Community Events](/t5/Community-Events/ct-p/CommunityEvents)
:::
:::

::: {.community-menu-item .tab-microsoft-learning .community-menu-dropdown}
[](#){.community-menu-item-desktop-view}

::: {.grad .community-menu-item-icon}
:::

::: community-menu-item-title-with-dropdownicon
Microsoft Learn
:::

[](#){.community-menu-item-mobile-view}

::: {.grad .community-menu-item-icon}
:::

::: community-menu-item-title-with-dropdownicon
Microsoft Learn
:::

::: {.dropdown .dropdown-events .dropdown-primary-nav}
-   [Home](%20https://docs.microsoft.com/learn/){.ms-learning-home-link
    .community-menu-item-title}
-   [Community](/t5/microsoft-learn/bd-p/MicrosoftLearn)
-   [Blog](/t5/microsoft-learn-blog/bg-p/MicrosoftLearnBlog)
-   [Azure](https://docs.microsoft.com/learn/azure/?WT.mc_id=techcom_header-webpage-m365)
-   [Dynamics
    365](https://docs.microsoft.com/learn/dynamics365/?WT.mc_id=techcom_header-webpage-m365)
-   [Microsoft
    365](https://docs.microsoft.com/learn/m365/?wt.mc_id=techcom_header-webpage-m365)
-   [Security, Compliance &
    Identity](https://docs.microsoft.com/learn/topics/sci/?wt.mc_id=techcom_header-webpage-m365)
-   [Power
    Platform](https://docs.microsoft.com/learn/powerplatform/?wt.mc_id=techcom_header-webpage-powerplatform)
-   [Github](https://docs.microsoft.com/learn/github/?wt.mc_id=techcom_header-webpage-github)
-   [Teams](https://docs.microsoft.com/learn/teams/?wt.mc_id=techcom_header-webpage-teams)
-   [.NET](https://docs.microsoft.com/learn/dotnet/?wt.mc_id=techcom_header-webpage-dotnet)
:::
:::

::: {.community-menu-item .tab-info-center}
[](/t5/Community-Info-Center/ct-p/Community-Info-Center){.community-menu-item-desktop-view}

::: {.c-glyph .community-menu-item-icon}

:::

::: community-menu-item-title
Lounge
:::

[](/t5/Community-Info-Center/ct-p/Community-Info-Center){.community-menu-item-mobile-view}

::: {.c-glyph .community-menu-item-icon}

:::

::: community-menu-item-title
Lounge
:::
:::
:::

-   [[776K]{#community-menu-wrapper-vitality-stat-count-1
    .community-menu-vitality-stat-count} [
    Members]{#community-menu-wrapper-vitality-stat-title-1
    .community-menu-vitality-stat-title}]{#community-menu-wrapper-vitality-stat-item-1}
-   [[7,440]{#community-menu-wrapper-vitality-stat-count-2
    .community-menu-vitality-stat-count} [
    Online]{#community-menu-wrapper-vitality-stat-title-2
    .community-menu-vitality-stat-title}]{#community-menu-wrapper-vitality-stat-item-2}
-   [[2M]{#community-menu-wrapper-vitality-stat-count-3
    .community-menu-vitality-stat-count} [
    Discussions]{#community-menu-wrapper-vitality-stat-title-3
    .community-menu-vitality-stat-title}]{#community-menu-wrapper-vitality-stat-item-3}
:::

::: nav-right
::: {#search_container}
::: {#search_btn}
Search []{.btn-search}
:::

::: {#search_slider .hidden}
::: custom-lia-search
::: {#lia-searchformV32_23129aa8122766 .SearchForm .lia-search-form-wrapper .lia-mode-default .lia-component-common-widget-search-form}
::: lia-inline-ajax-feedback
::: {#ajaxfeedback_23129aa8122766 .AjaxFeedback}
:::
:::

::: {#searchautocompletetoggle_23129aa8122766}
::: lia-inline-ajax-feedback
::: {#ajaxfeedback_23129aa8122766_0 .AjaxFeedback}
:::
:::

::: t-invisible
:::

::: lia-inline-ajax-feedback
::: {#feedback_23129aa8122766 .AjaxFeedback}
:::
:::

[ [ []{.lia-button-wrapper .lia-button-wrapper-secondary
.lia-button-wrapper-searchForm-action} ]{.lia-search-input-field}
]{.lia-search-input-wrapper} [cancel]{.lia-cancel-search}

::: {.search-autocomplete-toggle-link .lia-js-hidden}
[Turn on
suggestions](https://techcommunity.microsoft.com/t5/blogs/v2/blogarticlepage.enableautocomplete:enableautocomplete?t:ac=blog-id/Microsoft365PnPBlog/article-id/319&t:cp=action/contributions/searchactions){#enableAutoComplete_23129aa8122766
.lia-link-navigation .auto-complete-toggle-on
.lia-link-ticket-post-action
.lia-component-search-action-enable-auto-complete} [
[[]{#display_23129aa8122766 .lia-img-icon-help .lia-fa-icon .lia-fa-help
.lia-fa
alt="Auto-suggest helps you quickly narrow down your search results by suggesting possible matches as you type."
aria-label="Help Icon" role="img"}](#){#link_23129aa8122766
.lia-link-navigation .help-icon .lia-tooltip-trigger}]{.HelpIcon}

::: {#link_23129aa8122766_0-tooltip-element .lia-content .lia-tooltip-pos-bottom-left .lia-panel-tooltip-wrapper role="alertdialog"}
::: lia-tooltip-arrow
:::

::: lia-panel-tooltip
::: content
Auto-suggest helps you quickly narrow down your search results by
suggesting possible matches as you type.
:::
:::
:::
:::
:::

::: spell-check-showing-result
Showing results for []{#showingResult_23129aa8122766
.lia-link-navigation .show-results-for-link .lia-link-disabled}
[](#){#showingMoreResult_23129aa8122766 .lia-link-navigation
.more-synonym-search-results-for-link} [
]{.all-results-for-synonym-search}
:::

<div>

[ Show [](#){#synonymSearchInstead_23129aa8122766 .lia-link-navigation
.synonym-search-instead-for-link} only  ]{.synonym-search-instead
.lia-js-hidden} [ \| ]{.spell-check-and-synonym-search-instead
.lia-js-hidden} [ Search instead for [](#){#searchInstead_23129aa8122766
.lia-link-navigation .search-instead-for-link}
]{.spell-check-search-instead}

</div>

::: {.spell-check-do-you-mean .lia-component-search-widget-spellcheck}
Did you mean: [](#){#doYouMean_23129aa8122766 .lia-link-navigation
.do-you-mean-link}
:::
:::
:::
:::
:::

::: sign-in-wrapper
[Sign
In](/plugins/common/feature/oauth2sso/sso_login_redirect?lang=en&referer=https%3A%2F%2Ftechcommunity.microsoft.com%2Ft5%2Fmicrosoft-365-pnp-blog%2Fuse-pnp-powershell-to-add-a-document-library-webpart-to-a-page%2Fba-p%2F2428310)
:::

::: notifications
::: notify-icon
[](/t5/notificationfeed/page)

::: lia-notifications-messages-aggregate
:::
:::

::: email-icon
[](/t5/notes/privatenotespage)

::: lia-notifications-messages-aggregate
:::
:::
:::

::: lia-component-common-widget-slide-out-user-menu
::: {.lia-user-navigation-sign-in .lia-component-users-action-login-with-avatar}
::: user-navigation-user-profile
[Sign
In](/plugins/common/feature/oauth2sso/sso_login_redirect?lang=en&referer=https%3A%2F%2Ftechcommunity.microsoft.com%2Ft5%2Fmicrosoft-365-pnp-blog%2Fuse-pnp-powershell-to-add-a-document-library-webpart-to-a-page%2Fba-p%2F2428310){#link_1_23129aa964fabb
.lia-link-navigation .login-link .lia-authentication-link}
:::

::: {.UserAvatar .lia-user-avatar}
[](/plugins/common/feature/oauth2sso/sso_login_redirect?lang=en&referer=https%3A%2F%2Ftechcommunity.microsoft.com%2Ft5%2Fmicrosoft-365-pnp-blog%2Fuse-pnp-powershell-to-add-a-document-library-webpart-to-a-page%2Fba-p%2F2428310){#link_2_23129aa964fabb
.lia-link-navigation .login-link .lia-authentication-link}

::: lia-anonymous-profile-icon
:::
:::
:::
:::
:::
:::
:::
:::
:::

::: notifications-overlay-notif
:::

::: notifications-overlay-mail
:::

::: notifications-overlay-favorites
:::
:::
:::
:::

::: {.lia-quilt-row .lia-quilt-row-sub-header}
::: {.lia-quilt-column .lia-quilt-column-18 .lia-quilt-column-left .lia-quilt-column-breadcrumb .lia-mark-empty}
:::

::: {.lia-quilt-column .lia-quilt-column-06 .lia-quilt-column-right .lia-quilt-column-search-content}
::: {.lia-quilt-column-alley .lia-quilt-column-alley-right}
::: custom-lia-search
::: {#lia-searchformV32 .SearchForm .lia-search-form-wrapper .lia-mode-default .lia-component-common-widget-search-form}
::: lia-inline-ajax-feedback
::: {#ajaxfeedback .AjaxFeedback}
:::
:::

::: {#searchautocompletetoggle}
::: lia-inline-ajax-feedback
::: {#ajaxfeedback_0 .AjaxFeedback}
:::
:::

::: t-invisible
:::

::: lia-inline-ajax-feedback
::: {#feedback .AjaxFeedback}
:::
:::

[ [ []{.lia-button-wrapper .lia-button-wrapper-secondary
.lia-button-wrapper-searchForm-action} ]{.lia-search-input-field}
]{.lia-search-input-wrapper} [cancel]{.lia-cancel-search}

::: {.search-autocomplete-toggle-link .lia-js-hidden}
[Turn on
suggestions](https://techcommunity.microsoft.com/t5/blogs/v2/blogarticlepage.enableautocomplete:enableautocomplete?t:ac=blog-id/Microsoft365PnPBlog/article-id/319&t:cp=action/contributions/searchactions){#enableAutoComplete
.lia-link-navigation .auto-complete-toggle-on
.lia-link-ticket-post-action
.lia-component-search-action-enable-auto-complete} [ [[]{#display
.lia-img-icon-help .lia-fa-icon .lia-fa-help .lia-fa
alt="Auto-suggest helps you quickly narrow down your search results by suggesting possible matches as you type."
aria-label="Help Icon" role="img"}](#){#link_0 .lia-link-navigation
.help-icon .lia-tooltip-trigger}]{.HelpIcon}

::: {#link_1-tooltip-element .lia-content .lia-tooltip-pos-bottom-left .lia-panel-tooltip-wrapper role="alertdialog"}
::: lia-tooltip-arrow
:::

::: lia-panel-tooltip
::: content
Auto-suggest helps you quickly narrow down your search results by
suggesting possible matches as you type.
:::
:::
:::
:::
:::

::: spell-check-showing-result
Showing results for []{#showingResult .lia-link-navigation
.show-results-for-link .lia-link-disabled} [](#){#showingMoreResult
.lia-link-navigation .more-synonym-search-results-for-link} [
]{.all-results-for-synonym-search}
:::

<div>

[ Show [](#){#synonymSearchInstead .lia-link-navigation
.synonym-search-instead-for-link} only  ]{.synonym-search-instead
.lia-js-hidden} [ \| ]{.spell-check-and-synonym-search-instead
.lia-js-hidden} [ Search instead for [](#){#searchInstead
.lia-link-navigation .search-instead-for-link}
]{.spell-check-search-instead}

</div>

::: {.spell-check-do-you-mean .lia-component-search-widget-spellcheck}
Did you mean: [](#){#doYouMean .lia-link-navigation .do-you-mean-link}
:::
:::
:::
:::
:::
:::

::: {.lia-quilt-row .lia-quilt-row-feedback}
::: {.lia-quilt-column .lia-quilt-column-24 .lia-quilt-column-single .lia-quilt-column-feedback}
::: {.lia-quilt-column-alley .lia-quilt-column-alley-single}
:::
:::
:::
:::

::: {.custom-nda-blog-article-page-header-banner .lia-mark-empty}
:::

::: {.community-live-events-banner-blog-article-page-wrapper .lia-mark-empty}
:::

::: custom-blog-article-page-header-wrapper
::: custom-common-widget-breadcrumb
::: {.custom-common-widget-breadcrumb-wrapper .hidden}
[Home](/){.BreadCrumb .home-nav-link}

::: {.BreadCrumb .crumb-line .lia-breadcrumb .lia-component-common-widget-breadcrumb aria-label="breadcrumbs" role="navigation"}
-   [Home](/){#link_23129aac5ff11d .lia-link-navigation .crumb-community
    .lia-breadcrumb-community .lia-breadcrumb-forum}
-    []{#display_23129aac5ff11d .lia-img-icon-list-separator-breadcrumb
    .lia-fa-icon .lia-fa-list .lia-fa-separator .lia-fa-breadcrumb
    .lia-fa alt="" aria-label="" role="img"}
-   [Microsoft 365
    PnP](/t5/microsoft-365-pnp/ct-p/Microsoft365PnP){#link_23129aac5ff11d_0
    .lia-link-navigation .crumb-category .lia-breadcrumb-category
    .lia-breadcrumb-forum}
-    []{#display_23129aac5ff11d_0
    .lia-img-icon-list-separator-breadcrumb .lia-fa-icon .lia-fa-list
    .lia-fa-separator .lia-fa-breadcrumb .lia-fa alt="" aria-label=""
    role="img"}
-   [Microsoft 365 PnP
    Blog](/t5/microsoft-365-pnp-blog/bg-p/Microsoft365PnPBlog){#link_23129aac5ff11d_1
    .lia-link-navigation .crumb-board .lia-breadcrumb-board
    .lia-breadcrumb-forum}
-    []{#display_23129aac5ff11d_1
    .lia-img-icon-list-separator-breadcrumb .lia-fa-icon .lia-fa-list
    .lia-fa-separator .lia-fa-breadcrumb .lia-fa alt="" aria-label=""
    role="img"}
-   [Use PnP Powershell to add a document library webpart to a page (and
    only show a specific folder)]{#link_23129aac5ff11d_2
    .lia-link-navigation .child-thread .lia-link-disabled
    aria-disabled="true" disabled="true" role="link"
    aria-label="Use PnP Powershell to add a document library webpart to a page (and only show a specific folder)"}
:::
:::
:::

::: {.lia-menu-bar .lia-discussion-page-discussion-navigator .lia-component-article-navigator}
::: lia-decoration-border-menu-bar
::: lia-decoration-border-menu-bar-top
<div>

</div>
:::

::: lia-decoration-border-menu-bar-content
<div>

::: lia-menu-bar-buttons
:::

::: {#threadnavigator .lia-paging-full-wrapper}
-   [[]{.lia-paging-page-arrow} [Back to
    Blog]{.lia-paging-page-link}](/t5/microsoft-365-pnp-blog/bg-p/Microsoft365PnPBlog "Microsoft 365 PnP Blog"){#link_2
    .lia-link-navigation}
-   [[]{.lia-paging-page-arrow} [Newer
    Article]{.lia-paging-page-link}](/t5/microsoft-365-pnp-blog/what-kind-of-apps-can-you-build-on-microsoft-365/ba-p/2434448 "What kind of apps can you build on Microsoft 365?"){#link_3
    .lia-link-navigation}
-   [[Older Article]{.lia-paging-page-link}
    []{.lia-paging-page-arrow}](/t5/microsoft-365-pnp-blog/sharepoint-community-call-june-8th-2021/ba-p/2427833 "SharePoint community call - June 8th, 2021"){#link_4
    .lia-link-navigation}
:::

</div>
:::

::: lia-decoration-border-menu-bar-bottom
<div>

</div>
:::
:::
:::
:::
:::
:::
:::

::: {.lia-quilt-row .lia-quilt-row-main}
::: {.lia-quilt-column .lia-quilt-column-18 .lia-quilt-column-left .lia-quilt-column-main-content}
::: {.lia-quilt-column-alley .lia-quilt-column-alley-left}
::: ba-subject-header-wrapper
::: ba-subject-wrapper
::: ba-title
# Use PnP Powershell to add a document library webpart to a page (and only show a specific folder)
:::

::: ba-option-wrapper
::: {.lia-menu-bar .top-block .lia-component-menu-bar-without-options}
::: lia-decoration-border-menu-bar
::: lia-decoration-border-menu-bar-top
<div>

</div>
:::

::: lia-decoration-border-menu-bar-content
<div>

::: lia-menu-bar-buttons
:::

</div>
:::

::: lia-decoration-border-menu-bar-bottom
<div>

</div>
:::
:::
:::
:::
:::

::: ba-author-and-metrics-wrapper
::: ba-author-wrapper
By

::: ba-author-info
[ ]{.UserName .lia-user-name}

::: UserAvatarWrapper
::: {.UserAvatar .lia-user-avatar .lia-component-common-widget-user-avatar .MVP}
[![Marijn
Somers](https://techcommunity.microsoft.com/t5/image/serverpage/image-id/20092i5B92B60B703EE158/image-dimensions/150x150/image-coordinates/0%2C23%2C681%2C704?v=v2 "Marijn Somers"){.lia-user-avatar-message
.user-rank-ring .user-rank-ring style="border-color: #107C10"
onerror="replaceBrokenAvatars(this, '/html/assets/default-avatar.png')"}](/t5/user/viewprofilepage/user-id/15624){.UserAvatar
.lia-link-navigation}
:::

::: {.user-profile-card user-id="15624"}
::: contents
::: spinner
:::
:::
:::
:::

::: user-login
[Marijn Somers](/t5/user/viewprofilepage/user-id/15624)
:::
:::
:::

::: ba-metrics-info
[Published]{.ba-published-title} [Jun 10 2021 12:10
AM]{.ba-published-date} [ 2,778 Views ]{.ba-view-count}
:::
:::
:::

::: custom-blog-article-wrapper
::: {#messageview .lia-panel-message .message-uid-2428310 .lia-component-article lia-message-uid="2428310"}
::: {#messageView2_1 .lia-message-view-wrapper .lia-js-data-messageUid-2428310 .lia-component-forums-widget-message-view-two lia-message-uid="2428310"}
[ ]{#U2428310} [ ]{#M319}

::: lia-inline-ajax-feedback
::: {#ajaxfeedback_1 .AjaxFeedback}
:::
:::

::: {.MessageView .lia-message-view-blog-topic-message .lia-message-view-display .lia-row-standard-unread .lia-thread-topic}
[]{.lia-message-state-indicator}

::: {.lia-quilt .lia-quilt-blog-topic-message .lia-quilt-layout-one-column-message}
::: {.lia-quilt-row .lia-quilt-row-header}
::: {.lia-quilt-column .lia-quilt-column-16 .lia-quilt-column-left .lia-quilt-column-header-left}
::: {.lia-quilt-column-alley .lia-quilt-column-alley-left}
::: {.lia-message-author-avatar .lia-component-author-avatar .lia-component-message-view-widget-author-avatar}
::: UserAvatarWrapper
::: {.UserAvatar .lia-user-avatar .lia-component-common-widget-user-avatar .MVP}
[![Marijn
Somers](https://techcommunity.microsoft.com/t5/image/serverpage/image-id/20092i5B92B60B703EE158/image-dimensions/40x40/image-coordinates/1%2C14%2C682%2C695?v=v2 "Marijn Somers"){.lia-user-avatar-message
.user-rank-ring .user-rank-ring style="border-color: #107C10"
onerror="replaceBrokenAvatars(this, '/html/assets/default-avatar.png')"}](/t5/user/viewprofilepage/user-id/15624){.UserAvatar
.lia-link-navigation}
:::

::: {.user-profile-card user-id="15624"}
::: contents
::: spinner
:::
:::
:::
:::
:::

::: lia-message-author-with-avatar
[ [Marijn
Somers](https://techcommunity.microsoft.com/t5/user/viewprofilepage/user-id/15624){#link_5
.lia-link-navigation .lia-page-link .lia-user-name-link} ]{.UserName
.lia-user-name .lia-user-rank-MVP
.lia-component-message-view-widget-author-username}
:::

::: {.lia-message-author-rank .lia-component-author-rank .lia-component-message-view-widget-author-rank}
MVP
:::
:::
:::

::: {.lia-quilt-column .lia-quilt-column-08 .lia-quilt-column-right .lia-quilt-column-header-right}
::: {.lia-quilt-column-alley .lia-quilt-column-alley-right}
::: {.lia-message-post-date .lia-component-post-date .lia-component-message-view-widget-post-date title="Posted on"}
[ [‎Jun 10 2021]{.local-date} [12:10 AM]{.local-time} ]{.DateTime}
:::

::: {#actionMenuDropDown .lia-menu-navigation-wrapper .lia-js-hidden .lia-menu-action .lia-component-message-view-widget-action-menu}
::: lia-menu-navigation
::: dropdown-default-item
[](# "Show option menu"){#dropDownLink .lia-js-menu-opener
.default-menu-option .lia-js-mouseover-menu .lia-link-navigation}

::: dropdown-positioning
::: dropdown-positioning-static
-   [Subscribe to RSS
    Feed](/gxcuf89792/rss/message?board.id=Microsoft365PnPBlog&message.id=319){#rssThread
    .lia-link-navigation .rss-thread-link
    .lia-component-rss-action-thread}
-   [ []{.lia-separator-post} []{.lia-separator-pre} ]{.lia-separator
    .lia-component-common-widget-link-separator}
-   [Mark as New]{#markThreadUnread .lia-link-navigation
    .mark-thread-unread .lia-link-disabled
    .lia-component-forums-action-mark-thread-unread}
-   [Mark as Read]{#markThreadRead .lia-link-navigation
    .mark-thread-read .lia-link-disabled
    .lia-component-forums-action-mark-thread-read}
-   [ []{.lia-separator-post} []{.lia-separator-pre} ]{.lia-separator
    .lia-component-common-widget-link-separator}
-   [Bookmark]{#addThreadUserBookmark .lia-link-navigation
    .addThreadUserBookmark .lia-link-disabled
    .lia-component-subscriptions-action-add-thread-user-bookmark}
-   [Subscribe]{#addThreadUserEmailSubscription .lia-link-navigation
    .addThreadUserEmailSubscription .lia-link-disabled
    .lia-component-subscriptions-action-add-thread-user-email}
-   [ []{.lia-separator-post} []{.lia-separator-pre} ]{.lia-separator
    .lia-component-common-widget-link-separator}
-   [Email to a Friend]{#emailMessageToFriend .lia-link-navigation
    .email_friend .lia-link-disabled
    .lia-component-forums-action-email-message-to-friend}
-   [ []{.lia-separator-post} []{.lia-separator-pre} ]{.lia-separator
    .lia-component-common-widget-link-separator}
-   [Printer Friendly
    Page](/t5/blogs/blogarticleprintpage/blog-id/Microsoft365PnPBlog/article-id/319){#printThread
    .lia-link-navigation .print-article
    .lia-component-forums-action-print-thread}
-   [Report Inappropriate
    Content](/t5/notifications/notifymoderatorpage/message-uid/2428310){#reportAbuse
    .lia-link-navigation .report-abuse-link
    .lia-component-forums-action-report-abuse}
:::
:::
:::
:::
:::
:::
:::
:::

::: {.lia-quilt-row .lia-quilt-row-main}
::: {.lia-quilt-column .lia-quilt-column-24 .lia-quilt-column-single .lia-quilt-column-main}
::: {.lia-quilt-column-alley .lia-quilt-column-alley-single}
::: {.lia-message-subject-wrapper .lia-component-subject .lia-component-message-view-widget-subject-with-options}
::: MessageSubject
::: MessageSubjectIcons
# [ [Use PnP Powershell to add a document library webpart to a page (and only show a specific folder)](/t5/microsoft-365-pnp-blog/use-pnp-powershell-to-add-a-document-library-webpart-to-a-page/ba-p/2428310){#link_6 .page-link .lia-link-navigation .lia-custom-event} ]{.lia-message-unread} {#use-pnp-powershell-to-add-a-document-library-webpart-to-a-page-and-only-show-a-specific-folder-1 .message-subject itemprop="name"}

[]{#display_2 .lia-img-message-has-url .lia-fa-message .lia-fa-has
.lia-fa-url .lia-fa title="Contains a hyperlink"
alt="Message contains a hyperlink" aria-label="Contains a hyperlink"
role="img"} []{#display_3 .lia-img-message-has-image .lia-fa-message
.lia-fa-has .lia-fa-image .lia-fa title="Contains an image"
alt="Message contains an image" aria-label="Contains an image"
role="img"}
:::
:::
:::

::: {.lia-message-post-date .lia-component-post-date .lia-component-message-view-widget-post-date title="Posted on"}
[ [‎Jun 10 2021]{.local-date} [12:10 AM]{.local-time} ]{.DateTime}
:::

::: {.lia-message-body-wrapper .lia-component-message-view-widget-body}
::: {#bodyDisplay .lia-message-body itemprop="text"}
::: lia-message-body-content
As a non-developer (please read this as a disclaimer) I still try to
make my life as easy as possible (yes, I am that lazy). PnP Powershell
is a big component of that goal. A customer had the requirement to
create a page for each of their 86 folders in a document library so they
could add more information on those topics. That meant creating 86
pages, each with a document library webpart on it that showed a specific
folder. No chance I was going to do that manually!

Creating the page wasn't really difficult. Showing the document library
and just the items in the folder was the hard part that I couldn't find
any examples of. The idea of this blog post is to help future people
like me to just copy/paste the code.

 

 

# The goal {#toc-hId-1355964393}

We started with a document library containing 86 folders, each having a
few documents. The goal was to create 86 pages, with each page showing a
block of text on the left and the document library webpart showing only
the files from that folder.

# How to do this in the user interface {#toc-hId--451490070}

Using the user interface, following steps were required:

-   Create a new page (with the same name as the folder)
-   Add a section to the page with 2 columns
-   Add a text webpart to the left column
-   Add a document library webpart to the right column
-   As a subrequirement, only show the files from the necessary folder.
    This can be set up from the web part properties

::: wp-block-image
![Document library UI
properties](https://techcommunity.microsoft.com/t5/image/serverpage/image-id/287231iEA8C8F80460DE259/image-size/medium?v=v2&px=400 "MS-list.png"){.lia-media-image
role="button"
li-image-url="https://techcommunity.microsoft.com/t5/image/serverpage/image-id/287231iEA8C8F80460DE259?v=v2"
li-image-display-id="'287231iEA8C8F80460DE259'"
li-message-uid="'2428310'" li-messages-message-image="true"
li-bindable="" tabindex="0" li-bypass-lightbox-when-linked="true"
li-use-hover-links="false"}
:::

That would definitely be a lot of work to do manually, so I decided that
PnP PowerShell needed to come to the rescue.

# The code {#toc-hId-2036022763}

Lets dig in to the code. I imagine that you have already dabbled with
PnP Powershell and I will not explain how to install and configure it to
run.

::: wp-block-syntaxhighlighter-code
::: {#highlighter_645158 .syntaxhighlighter .powershell}
``` {.lia-code-sample .language-powershell}
Connect-PnPOnline -Url https://yourtenant.sharepoint.com/sites/thesite/ -UseWebLogin
```
:::
:::

First we need to connect to the site. Replace the url with the correct
url of your site. I am using -UseWebLogin in this example because I am
using 2factor authentication.

## Create the page {#toc-hId--1568383059}

First thing to do is to create the page, using
the [Add-PnPClientSidePage ](https://pnp.github.io/powershell/cmdlets/Add-PnPClientSidePage.html)command.
I am using the \$name variable here to give it a name.

::: wp-block-syntaxhighlighter-code
::: {#highlighter_199923 .syntaxhighlighter .powershell}
``` {.lia-code-sample .language-powershell}
Add-PnPClientSidePage -Name $name
  -LayoutType Article
  -HeaderLayoutType NoImage
  -CommentsEnabled:$false
```
:::
:::

 

Disabling the comments section on a modern SharePoint Page\
I couldn't figure out how to disable the comments section on the modern
client page. I tried setting it to false, or 0, but that didn't work.

The correct way to do is to use:

-CommentsEnabled:\$false

## Adding sections to the page {#toc-hId-919129774}

To add a new section to the page, I am using
the [Add-PnPClientSidePageSection](https://pnp.github.io/powershell/cmdlets/Add-PnPClientSidePageSection.html) command.
I can just add a TwoColumn section on the page.

::: wp-block-syntaxhighlighter-code
::: {#highlighter_139207 .syntaxhighlighter .powershell}
``` {.lia-code-sample .language-powershell}
Add-PnPClientSidePageSection -Page $name -SectionTemplate TwoColumn -Order 1
```
:::
:::

## Adding a text editor webpart {#toc-hId--888324689}

Adding a text editor is super easy, just use the Add-PnPClientSideText
command. Don't forget to add some text or it will fail.

::: wp-block-syntaxhighlighter-code
::: {#highlighter_664808 .syntaxhighlighter .powershell}
``` {.lia-code-sample .language-powershell}
Add-PnPClientSideText -Page $name -Section 1 -Column 1 -Text " "
```
:::
:::

## The hard part: adding an existing document library as a webpart to the page {#toc-hId-1599188144}

This was the easy bit, in my opinion. Adding a document library to a
page is surprisingly hard in PnP Powershell (unless I am missing
something big.. in that case please call me out on this!)

What you need to do, is to use the[ Add-PnPClientSideWebPart
command](https://pnp.github.io/powershell/cmdlets/Add-PnPClientSideWebPart.html).
With this command you can add all kinds of webparts to the page.
Document library isn't one of them.

You need to add a List webparttype, and in the WebpartProperties you
need to mention that it is a document library AND what the ID is.

::: wp-block-syntaxhighlighter-code
::: {#highlighter_600997 .syntaxhighlighter .powershell}
``` {.lia-code-sample .language-applescript}
Add-PnPClientSideWebPart -Page $name
  -DefaultWebPartType List -Section 1 -Column 2
  -WebPartProperties @{isDocumentLibrary="true";
                       selectedListId="1fa1fb45-e53b-4ea1-9325-ddca7afe986e";}
```
:::
:::

### Where can I find the SharePoint document library Id ? {#toc-hId--2005217678}

I didn't have a clue how to get this Id via code, so I resorted to the
UI: If you go to the library settings, the document library Id is shown
in the url:

::: wp-block-image
![SharePoint document library ID in the url of the library settings
page](https://techcommunity.microsoft.com/t5/image/serverpage/image-id/287222iE3871EB251E50F68/image-size/large?v=v2&px=999 "documentlibrary-id.png"){.lia-media-image
role="button"
li-image-url="https://techcommunity.microsoft.com/t5/image/serverpage/image-id/287222iE3871EB251E50F68?v=v2"
li-image-display-id="'287222iE3871EB251E50F68'"
li-message-uid="'2428310'" li-messages-message-image="true"
li-bindable="" tabindex="0" li-bypass-lightbox-when-linked="true"
li-use-hover-links="false"}
:::

Just cut out the %7B in the front, and the %7D on the back.\
In this example, the document library Id is
4683b239-caf6-40a3-96c4-a02dedfa3418.

## Bonus: Only show a specific folder from the document library {#toc-hId--2015720782}

I couldn't figure out how to show only documents from a specific folder.
Doing this in the UI is supereasy. But there wasn't any example code out
there. So here it is:

In the WebPartProperties, add selectedFolderPath="/yourfoldername";

::: wp-block-syntaxhighlighter-code
::: {#highlighter_720175 .syntaxhighlighter .powershell}
``` {.lia-code-sample .language-powershell}
Add-PnPClientSideWebPart -Page $name
  -DefaultWebPartType List -Section 1 -Column 2
  -WebPartProperties @{isDocumentLibrary="true";
                       selectedListId="1fa1fb45-e53b-4ea1-9325-ddca7afe986e";
                       selectedFolderPath="/$name";}
```
:::
:::

## Bonus 2: hide the command bar on the SharePoint Document Library Webpart {#toc-hId-471792051}

In the UI, there is a way to simply hide the command bar. Because we are
showing this information in a nice looking page, there is no need for
all that extra fluff of "new", "upload" and so on.

In the same way as showing just files from a specific folder, you can
use the hideCommandBar="false"; in the WebPartProperties:

::: wp-block-syntaxhighlighter-code
::: {#highlighter_988677 .syntaxhighlighter .powershell}
``` {.lia-code-sample .language-powershell}
Add-PnPClientSideWebPart -Page $name
  -DefaultWebPartType List -Section 1 -Column 2
  -WebPartProperties @{isDocumentLibrary="true";
                       selectedListId="1fa1fb45-e53b-4ea1-9325-ddca7afe986e";
                       selectedFolderPath="/$name";
                       hideCommandBar="false"}
```
:::
:::

## Publishing the page {#toc-hId-338107327}

All the parts we need are now on the page. The only thing now is to
publish the page so it is visible to all visitors. For that, we need to
grab the page again and publish it.

::: wp-block-syntaxhighlighter-code
::: {#highlighter_460127 .syntaxhighlighter .powershell}
``` {.lia-code-sample .language-powershell}
$page = Get-PnPClientSidePage -Identity $name
$page.Publish()
```
:::
:::

# Looping the code for all folders {#toc-hId--1598429855}

The last part of the code was to make this repeatable, for all 86
folders. There is probably a really nice way to , in code, get all
folders from the doclib and loop through them, but as stated a gazillion
times.. I am not a
developer.![:smile:](/html/@8341BD79091AF36AA2A09063B554B5CD/images/emoticons/smile_40x40.gif ":smile:"){.lia-deferred-image
.lia-image-emoji} 

 

So I exported the document library to Excel and copied the foldernames.
I added some quotes and a comma (in an Excel formula using =CHAR(34) & 
A2 & CHAR(34) &",") and added an array to store these.

The full code is:

::: wp-block-syntaxhighlighter-code
::: {#highlighter_239645 .syntaxhighlighter .powershell}
``` {.lia-code-sample .language-powershell}
Connect-PnPOnline -Url https://yourtenant.sharepoint.com/sites/Yoursite/ -UseWebLogin
$ray = "folder1",
"folder2",
"folder3"
foreach ($name in $ray) {

#create page
Add-PnPClientSidePage -Name $name -LayoutType Article -HeaderLayoutType NoImage -CommentsEnabled:$false

#add sections
Add-PnPClientSidePageSection -Page $name -SectionTemplate TwoColumn -Order 1

#add text webpart
Add-PnPClientSideText -Page $name -Section 1 -Column 1 -Text " "

#add doclib
Add-PnPClientSideWebPart -Page $name -DefaultWebPartType List -Section 1 -Column 2 -WebPartProperties @{isDocumentLibrary="true";selectedListId="1fa1fb45-e53b-4ea1-9325-ddca7afe986e";selectedFolderPath="/$name";hideCommandBar="false"}
$page = Get-PnPClientSidePage -Identity $name
$page.Publish()
}
```
:::
:::
:::
:::
:::
:::
:::
:::

::: {.lia-quilt-row .lia-quilt-row-footer}
::: {.lia-quilt-column .lia-quilt-column-12 .lia-quilt-column-left .lia-quilt-column-footer-left}
::: {.lia-quilt-column-alley .lia-quilt-column-alley-left}
::: {#kudosButtonV2 .KudosButton .lia-button-image-kudos-wrapper .lia-component-kudos-widget-button-version-3 .lia-component-kudos-widget-button-horizontal .lia-component-kudos-widget-button .lia-component-kudos-action .lia-component-message-view-widget-kudos-action lia-kudos-id="2428310"}
::: {.lia-button-image-kudos .lia-button-image-kudos-horizontal .lia-button-image-kudos-enabled .lia-button-image-kudos-not-kudoed .lia-button-image-kudos-has-kudoes .lia-button-image-kudos-has-kudos .lia-button aria-atomic="true" aria-live="assertive"}
::: lia-button-image-kudos-count
[[ 4 ]{#messageKudosCount_23129ab2e3be84 .MessageKudosCount
.lia-component-kudos-widget-message-kudos-count itemprop="upvoteCount"}[
Likes ]{.lia-button-image-kudos-label
.lia-component-kudos-widget-kudos-count-label}](/t5/kudos/messagepage/board-id/Microsoft365PnPBlog/message-id/319/tab/all-users "Click here to see who gave likes to this post."){#link_7
.lia-link-navigation .kudos-count-link}
:::

::: lia-button-image-kudos-give
[Like](https://techcommunity.microsoft.com/t5/blogs/v2/blogarticlepage.kudosbuttonv2.kudoentity:kudoentity/kudosable-gid/2428310?t:ac=blog-id/Microsoft365PnPBlog/article-id/319&t:cp=kudos/contributions/tapletcontributionspage "Click here to give likes to this post."){#kudoEntity
.lia-link-navigation .kudos-link .lia-link-ticket-post-action}
:::
:::
:::
:::
:::

::: {.lia-quilt-column .lia-quilt-column-12 .lia-quilt-column-right .lia-quilt-column-footer-right}
::: {.lia-quilt-column-alley .lia-quilt-column-alley-right}
::: {.lia-button-group .lia-component-comment-button .lia-component-message-view-widget-comment-button}
:::
:::
:::
:::

::: {.lia-quilt-row .lia-quilt-row-mod-controls}
::: {.lia-quilt-column .lia-quilt-column-24 .lia-quilt-column-single .lia-quilt-column-mod-controls-main}
::: {.lia-quilt-column-alley .lia-quilt-column-alley-single .lia-mark-empty}
:::
:::
:::

::: {.lia-quilt-row .lia-quilt-row-sub-footer}
::: {.lia-quilt-column .lia-quilt-column-24 .lia-quilt-column-single .lia-quilt-column-sub-footer .lia-mark-empty}
:::
:::
:::
:::
:::

::: {#progressBar .lia-progress .lia-js-hidden}
::: lia-progress-indeterminate
:::
:::
:::
:::

::: {.lia-text .lia-blog-article-page-comment-count .lia-discussion-page-sub-section-header .lia-component-comment-count-conditional}
3 Comments
:::

[]{#comments}

::: {#lazyload .lia-component-blogs-page-comment-list-loader .lia-component-lazy-loader .lia-lazy-load .lia-component-comment-list}
:::

[]{#comment-on-this} [ ]{#feedback-successinformationbox_6}

::: {#informationbox_6 .InfoMessage .lia-panel-feedback-banner-note .lia-component-comment-editor}
::: {.lia-text role="alert"}
You must be a registered user to add a comment. If you\'ve already
registered, sign in. Otherwise, register and sign in.

-   [Comment](/plugins/common/feature/oauth2sso/sso_login_redirect?lang=en&redirectreason=permissiondenied&referer=https%3A%2F%2Ftechcommunity.microsoft.com%2Ft5%2Fmicrosoft-365-pnp-blog%2Fuse-pnp-powershell-to-add-a-document-library-webpart-to-a-page%2Fba-p%2F2428310%23comment-on-this){#link_8
    .lia-link-navigation .blog-link .lia-message-comment-post}
:::
:::
:::
:::

::: {.lia-quilt-column .lia-quilt-column-06 .lia-quilt-column-right .lia-quilt-column-side-content}
::: {.lia-quilt-column-alley .lia-quilt-column-alley-right}
%3CLINGO-SUB%20id%3D%22lingo-sub-2428310%22%20slang%3D%22en-US%22%3EUse%20PnP%20Powershell%20to%20add%20a%20document%20library%20webpart%20to%20a%20page%20(and%20only%20show%20a%20specific%20folder)%3C%2FLINGO-SUB%3E%3CLINGO-BODY%20id%3D%22lingo-body-2428310%22%20slang%3D%22en-US%22%3E%3CP%3EAs%20a%20non-developer%20(please%20read%20this%20as%20a%20disclaimer)%20I%20still%20try%20to%20make%20my%20life%20as%20easy%20as%20possible%20(yes%2C%20I%20am%20that%20lazy).%20PnP%20Powershell%20is%20a%20big%20component%20of%20that%20goal.%20A%20customer%20had%20the%20requirement%20to%20create%20a%20page%20for%20each%20of%20their%2086%20folders%20in%20a%20document%20library%20so%20they%20could%20add%20more%20information%20on%20those%20topics.%20That%20meant%20creating%2086%20pages%2C%20each%20with%20a%20document%20library%20webpart%20on%20it%20that%20showed%20a%20specific%20folder.%20No%20chance%20I%20was%20going%20to%20do%20that%20manually!%3C%2FP%3E%0A%3CP%3ECreating%20the%20page%20wasn%E2%80%99t%20really%20difficult.%20Showing%20the%20document%20library%20and%20just%20the%20items%20in%20the%20folder%20was%20the%20hard%20part%20that%20I%20couldn%E2%80%99t%20find%20any%20examples%20of.%20The%20idea%20of%20this%20blog%20post%20is%20to%20help%20future%20people%20like%20me%20to%20just%20copy%2Fpaste%20the%20code.%3C%2FP%3E%0A%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3CH1%20id%3D%22toc-hId-1356743022%22%20id%3D%22toc-hId-1356743022%22%20id%3D%22toc-hId-1356743022%22%20id%3D%22toc-hId-1356743022%22%20id%3D%22toc-hId-1356743022%22%20id%3D%22toc-hId-1356743022%22%3EThe%20goal%3C%2FH1%3E%0A%3CP%3EWe%20started%20with%20a%20document%20library%20containing%2086%20folders%2C%20each%20having%20a%20few%20documents.%20The%20goal%20was%20to%20create%2086%20pages%2C%20with%20each%20page%20showing%20a%20block%20of%20text%20on%20the%20left%20and%20the%20document%20library%20webpart%20showing%20only%20the%20files%20from%20that%20folder.%3C%2FP%3E%0A%3CH1%20id%3D%22toc-hId\--450711441%22%20id%3D%22toc-hId\--450711441%22%20id%3D%22toc-hId\--450711441%22%20id%3D%22toc-hId\--450711441%22%20id%3D%22toc-hId\--450711441%22%20id%3D%22toc-hId\--450711441%22%3EHow%20to%20do%20this%20in%20the%20user%20interface%3C%2FH1%3E%0A%3CP%3EUsing%20the%20user%20interface%2C%20following%20steps%20were%20required%3A%3C%2FP%3E%0A%3CUL%3E%0A%3CLI%3ECreate%20a%20new%20page%20(with%20the%20same%20name%20as%20the%20folder)%3C%2FLI%3E%0A%3CLI%3EAdd%20a%20section%20to%20the%20page%20with%202%20columns%3C%2FLI%3E%0A%3CLI%3EAdd%20a%20text%20webpart%20to%20the%20left%20column%3C%2FLI%3E%0A%3CLI%3EAdd%20a%20document%20library%20webpart%20to%20the%20right%20column%3C%2FLI%3E%0A%3CLI%3EAs%20a%20subrequirement%2C%20only%20show%20the%20files%20from%20the%20necessary%20folder.%20This%20can%20be%20set%20up%20from%20the%20web%20part%20properties%3C%2FLI%3E%0A%3C%2FUL%3E%0A%3CDIV%20class%3D%22wp-block-image%22%3E%0A%3CFIGURE%20class%3D%22aligncenter%20size-large%22%3E%0A%3CDIV%20id%3D%22tinyMceEditorMarijn%20Somers_0%22%20class%3D%22mceNonEditable%20lia-copypaste-placeholder%22%3E%26nbsp%3B%3C%2FDIV%3E%0A%3CP%3E%3CSPAN%20class%3D%22lia-inline-image-display-wrapper%20lia-image-align-inline%22%20image-alt%3D%22MS-list.png%22%20style%3D%22width%3A%20400px%3B%22%3E%3CIMG%20src%3D%22https%3A%2F%2Ftechcommunity.microsoft.com%2Ft5%2Fimage%2Fserverpage%2Fimage-id%2F287231iEA8C8F80460DE259%2Fimage-size%2Fmedium%3Fv%3Dv2%26amp%3Bpx%3D400%22%20role%3D%22button%22%20title%3D%22MS-list.png%22%20alt%3D%22MS-list.png%22%20%2F%3E%3C%2FSPAN%3E%3C%2FP%3E%0A%3CFIGCAPTION%3EDocument%20library%20UI%20properties%3C%2FFIGCAPTION%3E%0A%3C%2FFIGURE%3E%0A%3C%2FDIV%3E%0A%3CP%3EThat%20would%20definitely%20be%20a%20lot%20of%20work%20to%20do%20manually%2C%20so%20I%20decided%20that%20PnP%20PowerShell%20needed%20to%20come%20to%20the%20rescue.%3C%2FP%3E%0A%3CH1%20id%3D%22toc-hId-2036801392%22%20id%3D%22toc-hId-2036801392%22%20id%3D%22toc-hId-2036801392%22%20id%3D%22toc-hId-2036801392%22%20id%3D%22toc-hId-2036801392%22%20id%3D%22toc-hId-2036801392%22%3EThe%20code%3C%2FH1%3E%0A%3CP%3ELets%20dig%20in%20to%20the%20code.%20I%20imagine%20that%20you%20have%20already%20dabbled%20with%20PnP%20Powershell%20and%20I%20will%20not%20explain%20how%20to%20install%20and%20configure%20it%20to%20run.%3C%2FP%3E%0A%3CDIV%20class%3D%22wp-block-syntaxhighlighter-code%20%22%3E%0A%3CDIV%20id%3D%22highlighter_645158%22%20class%3D%22syntaxhighlighter%20%20powershell%22%3E%3CPRE%20class%3D%22lia-code-sample%20language-powershell%22%3E%3CCODE%3EConnect-PnPOnline%20-Url%20https%3A%2F%2Fyourtenant.sharepoint.com%2Fsites%2Fthesite%2F%20-UseWebLogin%0A%3C%2FCODE%3E%3C%2FPRE%3E%3C%2FDIV%3E%0A%3C%2FDIV%3E%0A%3CP%3EFirst%20we%20need%20to%20connect%20to%20the%20site.%20Replace%20the%20url%20with%20the%20correct%20url%20of%20your%20site.%20I%20am%20using%20-UseWebLogin%20in%20this%20example%20because%20I%20am%20using%202factor%20authentication.%3C%2FP%3E%0A%3CH2%20id%3D%22toc-hId\--1567604430%22%20id%3D%22toc-hId\--1567604430%22%20id%3D%22toc-hId\--1567604430%22%20id%3D%22toc-hId\--1567604430%22%20id%3D%22toc-hId\--1567604430%22%20id%3D%22toc-hId\--1567604430%22%3ECreate%20the%20page%3C%2FH2%3E%0A%3CP%3EFirst%20thing%20to%20do%20is%20to%20create%20the%20page%2C%20using%20the%3CSPAN%3E%26nbsp%3B%3C%2FSPAN%3E%3CA%20href%3D%22https%3A%2F%2Fpnp.github.io%2Fpowershell%2Fcmdlets%2FAdd-PnPClientSidePage.html%22%20target%3D%22_blank%22%20rel%3D%22noopener%20nofollow%20noreferrer%22%3EAdd-PnPClientSidePage%3CSPAN%3E%26nbsp%3B%3C%2FSPAN%3E%3C%2FA%3Ecommand.%20I%20am%20using%20the%20%24name%20variable%20here%20to%20give%20it%20a%20name.%3C%2FP%3E%0A%3CDIV%20class%3D%22wp-block-syntaxhighlighter-code%20%22%3E%0A%3CDIV%20id%3D%22highlighter_199923%22%20class%3D%22syntaxhighlighter%20%20powershell%22%3E%3CPRE%20class%3D%22lia-code-sample%20language-powershell%22%3E%3CCODE%3EAdd-PnPClientSidePage%20-Name%20%24name%0A%26nbsp%3B%26nbsp%3B-LayoutType%20Article%0A%26nbsp%3B%26nbsp%3B-HeaderLayoutType%20NoImage%0A%26nbsp%3B%26nbsp%3B-CommentsEnabled%3A%24false%3C%2FCODE%3E%3C%2FPRE%3E%3C%2FDIV%3E%0A%3C%2FDIV%3E%0A%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3CP%3EDisabling%20the%20comments%20section%20on%20a%20modern%20SharePoint%20Page%3CBR%20%2F%3EI%20couldn%E2%80%99t%20figure%20out%20how%20to%20disable%20the%20comments%20section%20on%20the%20modern%20client%20page.%20I%20tried%20setting%20it%20to%20false%2C%20or%200%2C%20but%20that%20didn%E2%80%99t%20work.%3C%2FP%3E%0A%3CP%3EThe%20correct%20way%20to%20do%20is%20to%20use%3A%3C%2FP%3E%0A%3CP%3E-CommentsEnabled%3A%24false%3C%2FP%3E%0A%3CH2%20id%3D%22toc-hId-919908403%22%20id%3D%22toc-hId-919908403%22%20id%3D%22toc-hId-919908403%22%20id%3D%22toc-hId-919908403%22%20id%3D%22toc-hId-919908403%22%20id%3D%22toc-hId-919908403%22%3EAdding%20sections%20to%20the%20page%3C%2FH2%3E%0A%3CP%3ETo%20add%20a%20new%20section%20to%20the%20page%2C%20I%20am%20using%20the%3CSPAN%3E%26nbsp%3B%3C%2FSPAN%3E%3CA%20href%3D%22https%3A%2F%2Fpnp.github.io%2Fpowershell%2Fcmdlets%2FAdd-PnPClientSidePageSection.html%22%20target%3D%22_blank%22%20rel%3D%22noopener%20nofollow%20noreferrer%22%3EAdd-PnPClientSidePageSection%3C%2FA%3E%3CSPAN%3E%26nbsp%3B%3C%2FSPAN%3Ecommand.%20I%20can%20just%20add%20a%20TwoColumn%20section%20on%20the%20page.%3C%2FP%3E%0A%3CDIV%20class%3D%22wp-block-syntaxhighlighter-code%20%22%3E%0A%3CDIV%20id%3D%22highlighter_139207%22%20class%3D%22syntaxhighlighter%20%20powershell%22%3E%3CPRE%20class%3D%22lia-code-sample%20language-powershell%22%3E%3CCODE%3EAdd-PnPClientSidePageSection%20-Page%20%24name%20-SectionTemplate%20TwoColumn%20-Order%201%0A%3C%2FCODE%3E%3C%2FPRE%3E%3C%2FDIV%3E%0A%3C%2FDIV%3E%0A%3CH2%20id%3D%22toc-hId\--887546060%22%20id%3D%22toc-hId\--887546060%22%20id%3D%22toc-hId\--887546060%22%20id%3D%22toc-hId\--887546060%22%20id%3D%22toc-hId\--887546060%22%20id%3D%22toc-hId\--887546060%22%3EAdding%20a%20text%20editor%20webpart%3C%2FH2%3E%0A%3CP%3EAdding%20a%20text%20editor%20is%20super%20easy%2C%20just%20use%20the%20Add-PnPClientSideText%20command.%20Don%E2%80%99t%20forget%20to%20add%20some%20text%20or%20it%20will%20fail.%3C%2FP%3E%0A%3CDIV%20class%3D%22wp-block-syntaxhighlighter-code%20%22%3E%0A%3CDIV%20id%3D%22highlighter_664808%22%20class%3D%22syntaxhighlighter%20%20powershell%22%3E%3CPRE%20class%3D%22lia-code-sample%20language-powershell%22%3E%3CCODE%3EAdd-PnPClientSideText%20-Page%20%24name%20-Section%201%20-Column%201%20-Text%20%22%20%22%0A%3C%2FCODE%3E%3C%2FPRE%3E%3C%2FDIV%3E%0A%3C%2FDIV%3E%0A%3CH2%20id%3D%22toc-hId-1599966773%22%20id%3D%22toc-hId-1599966773%22%20id%3D%22toc-hId-1599966773%22%20id%3D%22toc-hId-1599966773%22%20id%3D%22toc-hId-1599966773%22%20id%3D%22toc-hId-1599966773%22%3EThe%20hard%20part%3A%20adding%20an%20existing%20document%20library%20as%20a%20webpart%20to%20the%20page%3C%2FH2%3E%0A%3CP%3EThis%20was%20the%20easy%20bit%2C%20in%20my%20opinion.%20Adding%20a%20document%20library%20to%20a%20page%20is%20surprisingly%20hard%20in%20PnP%20Powershell%20(unless%20I%20am%20missing%20something%20big..%20in%20that%20case%20please%20call%20me%20out%20on%20this!)%3C%2FP%3E%0A%3CP%3EWhat%20you%20need%20to%20do%2C%20is%20to%20use%20the%3CA%20href%3D%22https%3A%2F%2Fpnp.github.io%2Fpowershell%2Fcmdlets%2FAdd-PnPClientSideWebPart.html%22%20target%3D%22_blank%22%20rel%3D%22noopener%20nofollow%20noreferrer%22%3E%3CSPAN%3E%26nbsp%3B%3C%2FSPAN%3EAdd-PnPClientSideWebPart%20command%3C%2FA%3E.%20With%20this%20command%20you%20can%20add%20all%20kinds%20of%20webparts%20to%20the%20page.%20Document%20library%20isn%E2%80%99t%20one%20of%20them.%3C%2FP%3E%0A%3CP%3EYou%20need%20to%20add%20a%20List%20webparttype%2C%20and%20in%20the%20WebpartProperties%20you%20need%20to%20mention%20that%20it%20is%20a%20document%20library%20AND%20what%20the%20ID%20is.%3C%2FP%3E%0A%3CDIV%20class%3D%22wp-block-syntaxhighlighter-code%20%22%3E%0A%3CDIV%20id%3D%22highlighter_600997%22%20class%3D%22syntaxhighlighter%20%20powershell%22%3E%3CPRE%20class%3D%22lia-code-sample%20language-applescript%22%3E%3CCODE%3EAdd-PnPClientSideWebPart%20-Page%20%24name%0A%26nbsp%3B%26nbsp%3B-DefaultWebPartType%20List%20-Section%201%20-Column%202%0A%26nbsp%3B%26nbsp%3B-WebPartProperties%20%40%7BisDocumentLibrary%3D%22true%22%3B%0A%26nbsp%3B%26nbsp%3B%26nbsp%3B%26nbsp%3B%26nbsp%3B%26nbsp%3B%26nbsp%3B%26nbsp%3B%26nbsp%3B%26nbsp%3B%26nbsp%3B%26nbsp%3B%26nbsp%3B%26nbsp%3B%26nbsp%3B%26nbsp%3B%26nbsp%3B%26nbsp%3B%26nbsp%3B%26nbsp%3B%26nbsp%3B%26nbsp%3B%26nbsp%3BselectedListId%3D%221fa1fb45-e53b-4ea1-9325-ddca7afe986e%22%3B%7D%3C%2FCODE%3E%3C%2FPRE%3E%3C%2FDIV%3E%0A%3C%2FDIV%3E%0A%3CH3%20id%3D%22toc-hId\--2004439049%22%20id%3D%22toc-hId\--2004439049%22%20id%3D%22toc-hId\--2004439049%22%20id%3D%22toc-hId\--2004439049%22%20id%3D%22toc-hId\--2004439049%22%20id%3D%22toc-hId\--2004439049%22%3EWhere%20can%20I%20find%20the%20SharePoint%20document%20library%20Id%20%3F%3C%2FH3%3E%0A%3CP%3EI%20didn%E2%80%99t%20have%20a%20clue%20how%20to%20get%20this%20Id%20via%20code%2C%20so%20I%20resorted%20to%20the%20UI%3A%20If%20you%20go%20to%20the%20library%20settings%2C%20the%20document%20library%20Id%20is%20shown%20in%20the%20url%3A%3C%2FP%3E%0A%3CDIV%20class%3D%22wp-block-image%22%3E%0A%3CFIGURE%20class%3D%22aligncenter%20size-large%22%3E%0A%3CDIV%20id%3D%22tinyMceEditorMarijn%20Somers_1%22%20class%3D%22mceNonEditable%20lia-copypaste-placeholder%22%3E%26nbsp%3B%3C%2FDIV%3E%0A%3CP%3E%3CSPAN%20class%3D%22lia-inline-image-display-wrapper%20lia-image-align-center%22%20image-alt%3D%22documentlibrary-id.png%22%20style%3D%22width%3A%20581px%3B%22%3E%3CIMG%20src%3D%22https%3A%2F%2Ftechcommunity.microsoft.com%2Ft5%2Fimage%2Fserverpage%2Fimage-id%2F287222iE3871EB251E50F68%2Fimage-size%2Flarge%3Fv%3Dv2%26amp%3Bpx%3D999%22%20role%3D%22button%22%20title%3D%22documentlibrary-id.png%22%20alt%3D%22documentlibrary-id.png%22%20%2F%3E%3C%2FSPAN%3E%3C%2FP%3E%0A%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3CFIGCAPTION%3ESharePoint%20document%20library%20ID%20in%20the%20url%20of%20the%20library%20settings%20page%3C%2FFIGCAPTION%3E%0A%3C%2FFIGURE%3E%0A%3C%2FDIV%3E%0A%3CP%3EJust%20cut%20out%20the%20%257B%20in%20the%20front%2C%20and%20the%20%257D%20on%20the%20back.%3CBR%20%2F%3EIn%20this%20example%2C%20the%20document%20library%20Id%20is%204683b239-caf6-40a3-96c4-a02dedfa3418.%3C%2FP%3E%0A%3CH2%20id%3D%22toc-hId\--2014942153%22%20id%3D%22toc-hId\--2014942153%22%20id%3D%22toc-hId\--2014942153%22%20id%3D%22toc-hId\--2014942153%22%20id%3D%22toc-hId\--2014942153%22%20id%3D%22toc-hId\--2014942153%22%3EBonus%3A%20Only%20show%20a%20specific%20folder%20from%20the%20document%20library%3C%2FH2%3E%0A%3CP%3EI%20couldn%E2%80%99t%20figure%20out%20how%20to%20show%20only%20documents%20from%20a%20specific%20folder.%20Doing%20this%20in%20the%20UI%20is%20supereasy.%20But%20there%20wasn%E2%80%99t%20any%20example%20code%20out%20there.%20So%20here%20it%20is%3A%3C%2FP%3E%0A%3CP%3EIn%20the%20WebPartProperties%2C%20add%20selectedFolderPath%3D%E2%80%9D%2Fyourfoldername%E2%80%9D%3B%3C%2FP%3E%0A%3CDIV%20class%3D%22wp-block-syntaxhighlighter-code%20%22%3E%0A%3CDIV%20id%3D%22highlighter_720175%22%20class%3D%22syntaxhighlighter%20%20powershell%22%3E%3CPRE%20class%3D%22lia-code-sample%20language-powershell%22%3E%3CCODE%3EAdd-PnPClientSideWebPart%20-Page%20%24name%0A%26nbsp%3B%26nbsp%3B-DefaultWebPartType%20List%20-Section%201%20-Column%202%0A%26nbsp%3B%26nbsp%3B-WebPartProperties%20%40%7BisDocumentLibrary%3D%22true%22%3B%0A%26nbsp%3B%26nbsp%3B%26nbsp%3B%26nbsp%3B%26nbsp%3B%26nbsp%3B%26nbsp%3B%26nbsp%3B%26nbsp%3B%26nbsp%3B%26nbsp%3B%26nbsp%3B%26nbsp%3B%26nbsp%3B%26nbsp%3B%26nbsp%3B%26nbsp%3B%26nbsp%3B%26nbsp%3B%26nbsp%3B%26nbsp%3B%26nbsp%3B%26nbsp%3BselectedListId%3D%221fa1fb45-e53b-4ea1-9325-ddca7afe986e%22%3B%0A%26nbsp%3B%26nbsp%3B%26nbsp%3B%26nbsp%3B%26nbsp%3B%26nbsp%3B%26nbsp%3B%26nbsp%3B%26nbsp%3B%26nbsp%3B%26nbsp%3B%26nbsp%3B%26nbsp%3B%26nbsp%3B%26nbsp%3B%26nbsp%3B%26nbsp%3B%26nbsp%3B%26nbsp%3B%26nbsp%3B%26nbsp%3B%26nbsp%3B%26nbsp%3BselectedFolderPath%3D%22%2F%24name%22%3B%7D%3C%2FCODE%3E%3C%2FPRE%3E%3C%2FDIV%3E%0A%3C%2FDIV%3E%0A%3CH2%20id%3D%22toc-hId-472570680%22%20id%3D%22toc-hId-472570680%22%20id%3D%22toc-hId-472570680%22%20id%3D%22toc-hId-472570680%22%20id%3D%22toc-hId-472570680%22%20id%3D%22toc-hId-472570680%22%3EBonus%202%3A%20hide%20the%20command%20bar%20on%20the%20SharePoint%20Document%20Library%20Webpart%3C%2FH2%3E%0A%3CP%3EIn%20the%20UI%2C%20there%20is%20a%20way%20to%20simply%20hide%20the%20command%20bar.%20Because%20we%20are%20showing%20this%20information%20in%20a%20nice%20looking%20page%2C%20there%20is%20no%20need%20for%20all%20that%20extra%20fluff%20of%20%E2%80%9Cnew%E2%80%9D%2C%20%E2%80%9Cupload%E2%80%9D%20and%20so%20on.%3C%2FP%3E%0A%3CP%3EIn%20the%20same%20way%20as%20showing%20just%20files%20from%20a%20specific%20folder%2C%20you%20can%20use%20the%20hideCommandBar%3D%E2%80%9Dfalse%E2%80%9D%3B%20in%20the%20WebPartProperties%3A%3C%2FP%3E%0A%3CDIV%20class%3D%22wp-block-syntaxhighlighter-code%20%22%3E%0A%3CDIV%20id%3D%22highlighter_988677%22%20class%3D%22syntaxhighlighter%20%20powershell%22%3E%3CPRE%20class%3D%22lia-code-sample%20language-powershell%22%3E%3CCODE%3EAdd-PnPClientSideWebPart%20-Page%20%24name%0A%26nbsp%3B%26nbsp%3B-DefaultWebPartType%20List%20-Section%201%20-Column%202%0A%26nbsp%3B%26nbsp%3B-WebPartProperties%20%40%7BisDocumentLibrary%3D%22true%22%3B%0A%26nbsp%3B%26nbsp%3B%26nbsp%3B%26nbsp%3B%26nbsp%3B%26nbsp%3B%26nbsp%3B%26nbsp%3B%26nbsp%3B%26nbsp%3B%26nbsp%3B%26nbsp%3B%26nbsp%3B%26nbsp%3B%26nbsp%3B%26nbsp%3B%26nbsp%3B%26nbsp%3B%26nbsp%3B%26nbsp%3B%26nbsp%3B%26nbsp%3B%26nbsp%3BselectedListId%3D%221fa1fb45-e53b-4ea1-9325-ddca7afe986e%22%3B%0A%26nbsp%3B%26nbsp%3B%26nbsp%3B%26nbsp%3B%26nbsp%3B%26nbsp%3B%26nbsp%3B%26nbsp%3B%26nbsp%3B%26nbsp%3B%26nbsp%3B%26nbsp%3B%26nbsp%3B%26nbsp%3B%26nbsp%3B%26nbsp%3B%26nbsp%3B%26nbsp%3B%26nbsp%3B%26nbsp%3B%26nbsp%3B%26nbsp%3B%26nbsp%3BselectedFolderPath%3D%22%2F%24name%22%3B%0A%26nbsp%3B%26nbsp%3B%26nbsp%3B%26nbsp%3B%26nbsp%3B%26nbsp%3B%26nbsp%3B%26nbsp%3B%26nbsp%3B%26nbsp%3B%26nbsp%3B%26nbsp%3B%26nbsp%3B%26nbsp%3B%26nbsp%3B%26nbsp%3B%26nbsp%3B%26nbsp%3B%26nbsp%3B%26nbsp%3B%26nbsp%3B%26nbsp%3B%26nbsp%3BhideCommandBar%3D%22false%22%7D%3C%2FCODE%3E%3C%2FPRE%3E%3C%2FDIV%3E%0A%3C%2FDIV%3E%0A%3CH2%20id%3D%22toc-hId-338885956%22%20id%3D%22toc-hId-338885956%22%20id%3D%22toc-hId-338885956%22%20id%3D%22toc-hId-338885956%22%20id%3D%22toc-hId-338885956%22%20id%3D%22toc-hId-338885956%22%3EPublishing%20the%20page%3C%2FH2%3E%0A%3CP%3EAll%20the%20parts%20we%20need%20are%20now%20on%20the%20page.%20The%20only%20thing%20now%20is%20to%20publish%20the%20page%20so%20it%20is%20visible%20to%20all%20visitors.%20For%20that%2C%20we%20need%20to%20grab%20the%20page%20again%20and%20publish%20it.%3C%2FP%3E%0A%3CDIV%20class%3D%22wp-block-syntaxhighlighter-code%20%22%3E%0A%3CDIV%20id%3D%22highlighter_460127%22%20class%3D%22syntaxhighlighter%20%20powershell%22%3E%3CPRE%20class%3D%22lia-code-sample%20language-powershell%22%3E%3CCODE%3E%24page%20%3D%20Get-PnPClientSidePage%20-Identity%20%24name%0A%24page.Publish()%3C%2FCODE%3E%3C%2FPRE%3E%3C%2FDIV%3E%0A%3C%2FDIV%3E%0A%3CH1%20id%3D%22toc-hId\--1597651226%22%20id%3D%22toc-hId\--1597651226%22%20id%3D%22toc-hId\--1597651226%22%20id%3D%22toc-hId\--1597651226%22%20id%3D%22toc-hId\--1597651226%22%20id%3D%22toc-hId\--1597651226%22%3ELooping%20the%20code%20for%20all%20folders%3C%2FH1%3E%0A%3CP%3EThe%20last%20part%20of%20the%20code%20was%20to%20make%20this%20repeatable%2C%20for%20all%2086%20folders.%20There%20is%20probably%20a%20really%20nice%20way%20to%20%2C%20in%20code%2C%20get%20all%20folders%20from%20the%20doclib%20and%20loop%20through%20them%2C%20but%20as%20stated%20a%20gazillion%20times..%20I%20am%20not%20a%20developer.%3CIMG%20class%3D%22lia-deferred-image%20lia-image-emoji%22%20src%3D%22https%3A%2F%2Ftechcommunity.microsoft.com%2Fhtml%2F%408341BD79091AF36AA2A09063B554B5CD%2Fimages%2Femoticons%2Fsmile_40x40.gif%22%20alt%3D%22%3Asmile%3A%22%20title%3D%22%3Asmile%3A%22%20%2F%3E%3CSPAN%3E%26nbsp%3B%3C%2FSPAN%3E%3C%2FP%3E%0A%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3CP%3ESo%20I%20exported%20the%20document%20library%20to%20Excel%20and%20copied%20the%20foldernames.%20I%20added%20some%20quotes%20and%20a%20comma%20(in%20an%20Excel%20formula%20using%20%3DCHAR(34)%20%26amp%3B%26nbsp%3B%20A2%20%26amp%3B%20CHAR(34)%20%26amp%3B%E2%80%9D%2C%E2%80%9D)%20and%20added%20an%20array%20to%20store%20these.%3C%2FP%3E%0A%3CP%3EThe%20full%20code%20is%3A%3C%2FP%3E%0A%3CDIV%20class%3D%22wp-block-syntaxhighlighter-code%20%22%3E%0A%3CDIV%20id%3D%22highlighter_239645%22%20class%3D%22syntaxhighlighter%20%20powershell%22%3E%3CPRE%20class%3D%22lia-code-sample%20language-powershell%22%3E%3CCODE%3EConnect-PnPOnline%20-Url%20https%3A%2F%2Fyourtenant.sharepoint.com%2Fsites%2FYoursite%2F%20-UseWebLogin%0A%24ray%20%3D%20%22folder1%22%2C%0A%22folder2%22%2C%0A%22folder3%22%0Aforeach%20(%24name%20in%20%24ray)%20%7B%0A%0A%23create%20page%0AAdd-PnPClientSidePage%20-Name%20%24name%20-LayoutType%20Article%20-HeaderLayoutType%20NoImage%20-CommentsEnabled%3A%24false%0A%0A%23add%20sections%0AAdd-PnPClientSidePageSection%20-Page%20%24name%20-SectionTemplate%20TwoColumn%20-Order%201%0A%0A%23add%20text%20webpart%0AAdd-PnPClientSideText%20-Page%20%24name%20-Section%201%20-Column%201%20-Text%20%22%20%22%0A%0A%23add%20doclib%0AAdd-PnPClientSideWebPart%20-Page%20%24name%20-DefaultWebPartType%20List%20-Section%201%20-Column%202%20-WebPartProperties%20%40%7BisDocumentLibrary%3D%22true%22%3BselectedListId%3D%221fa1fb45-e53b-4ea1-9325-ddca7afe986e%22%3BselectedFolderPath%3D%22%2F%24name%22%3BhideCommandBar%3D%22false%22%7D%0A%24page%20%3D%20Get-PnPClientSidePage%20-Identity%20%24name%0A%24page.Publish()%0A%7D%3C%2FCODE%3E%3C%2FPRE%3E%3C%2FDIV%3E%0A%3C%2FDIV%3E%3C%2FLINGO-BODY%3E%3CLINGO-TEASER%20id%3D%22lingo-teaser-2428310%22%20slang%3D%22en-US%22%3E%3CP%3EAs%20a%20non-developer%20(please%20read%20this%20as%20a%20disclaimer)%20I%20still%20try%20to%20make%20my%20life%20as%20easy%20as%20possible%20(yes%2C%20I%20am%20that%20lazy).%20PnP%20Powershell%20is%20a%20big%20component%20of%20that%20goal.%20A%20customer%20had%20the%20requirement%20to%20create%20an%20accompanying%20page%20for%20each%20of%20their%2086%20folders%20in%20a%20document%20library%20so%20they%20could%20add%20more%20information%20on%20those%20topics.%20That%20meant%20creating%2086%20pages%2C%20each%20with%20a%20document%20library%20webpart%20on%20it%20that%20showed%20a%20specific%20folder.%20No%20chance%20I%20was%20going%20to%20do%20that%20manually!%3C%2FP%3E%3C%2FLINGO-TEASER%3E%3CLINGO-SUB%20id%3D%22lingo-sub-2436814%22%20slang%3D%22en-US%22%3ERe%3A%20Use%20PnP%20Powershell%20to%20add%20a%20document%20library%20webpart%20to%20a%20page%20(and%20only%20show%20a%20specific%20folder)%3C%2FLINGO-SUB%3E%3CLINGO-BODY%20id%3D%22lingo-body-2436814%22%20slang%3D%22en-US%22%3E%3CP%3EGreat%20job%20Marijn%3C%2FP%3E%3CP%3EI%20hope%20a%20lot%20of%20people%20find%20this%20useful%20and%20to%20take%20it%20further.%20Thanks%20for%20sharing%20your%20learning%20journey.%26nbsp%3B%3C%2FP%3E%3C%2FLINGO-BODY%3E%3CLINGO-SUB%20id%3D%22lingo-sub-2602910%22%20slang%3D%22en-US%22%3ERe%3A%20Use%20PnP%20Powershell%20to%20add%20a%20document%20library%20webpart%20to%20a%20page%20(and%20only%20show%20a%20specific%20folder)%3C%2FLINGO-SUB%3E%3CLINGO-BODY%20id%3D%22lingo-body-2602910%22%20slang%3D%22en-US%22%3E%3CP%3EThanks%20for%20sharing%20this.%20Marijn!%3C%2FP%3E%3CP%3EThis%20helped%20me%20a%20lot.%3C%2FP%3E%3C%2FLINGO-BODY%3E

::: {#threadTranslationDashboard .Thread_Translation_Dashboard ng-controller="lingotekThreadTranslationCtrl" li-bindable=""}
::: lingotek-admin-dashboard
:::
:::

::: {style="clear:both"}
:::

::: {#contributorsTaplet .ContributorsTaplet .lia-component-tkb-widget-contributors-taplet}
::: {.lia-panel .lia-panel-standard}
::: lia-decoration-border
::: lia-decoration-border-top
<div>

</div>
:::

::: lia-decoration-border-content
<div>

::: lia-panel-heading-bar-wrapper
::: lia-panel-heading-bar
[ Co-Authors ]{.lia-panel-heading-bar-title aria-level="3"
role="heading"}
:::
:::

::: lia-panel-content-wrapper
::: lia-panel-content
::: {.UserProfileSummary .lia-user-item .lia-js-data-userId-15624 .lia-user-info-group}
::: UserAvatarWrapper
::: {.UserAvatar .lia-user-avatar .lia-component-common-widget-user-avatar .MVP}
[![Marijn
Somers](https://techcommunity.microsoft.com/t5/image/serverpage/image-id/20092i5B92B60B703EE158/image-dimensions/40x40/image-coordinates/1%2C14%2C682%2C695?v=v2 "Marijn Somers"){.lia-user-avatar-message
.user-rank-ring .user-rank-ring style="border-color: #107C10"
onerror="replaceBrokenAvatars(this, '/html/assets/default-avatar.png')"}](/t5/user/viewprofilepage/user-id/15624){.UserAvatar
.lia-link-navigation}
:::

::: {.user-profile-card user-id="15624"}
::: contents
::: spinner
:::
:::
:::
:::

::: lia-user-attributes
::: lia-user-name
[ [Marijn
Somers](https://techcommunity.microsoft.com/t5/user/viewprofilepage/user-id/15624){#link_9
.lia-link-navigation .lia-page-link .lia-user-name-link} ]{.UserName
.lia-user-name .lia-user-rank-MVP}
:::
:::
:::
:::
:::

</div>
:::

::: lia-decoration-border-bottom
<div>

</div>
:::
:::
:::
:::

::: {.lia-panel .lia-panel-standard .ArticleRevisionInfoTaplet .Chrome .lia-component-tkb-widget-article-revision-info-taplet}
::: lia-decoration-border
::: lia-decoration-border-top
<div>

</div>
:::

::: lia-decoration-border-content
<div>

::: lia-panel-heading-bar-wrapper
::: lia-panel-heading-bar
[Version history]{.lia-panel-heading-bar-title aria-level="3"
role="heading"}
:::
:::

::: lia-panel-content-wrapper
::: lia-panel-content
::: lia-revision-info-wrapper
::: lia-revision-info-content
::: {.lia-revision-info-row .lia-revision-last-update-row}
::: lia-revision-info-title-cell
Last update:
:::

::: lia-revision-info-data-cell
[ [‎Jun 08 2021]{.local-date} [01:21 PM]{.local-time} ]{.DateTime}
:::
:::

::: {.lia-revision-info-row .lia-revision-author-row}
::: lia-revision-info-title-cell
Updated by:
:::

::: lia-revision-info-data-cell
[ [Marijn
Somers](https://techcommunity.microsoft.com/t5/user/viewprofilepage/user-id/15624){#link_10
.lia-link-navigation .lia-page-link .lia-user-name-link} ]{.UserName
.lia-user-name .lia-user-rank-MVP}
:::
:::

::: {.lia-revision-info-row .lia-revision-article-history-link-row .lia-revision-info-data-cell-workflow}
:::
:::
:::
:::
:::

</div>
:::

::: lia-decoration-border-bottom
<div>

</div>
:::
:::
:::

::: blog-article-social-share-widget-wrapper
::: custom-social-share-component
::: custom-social-share-widget
::: {.lia-panel .lia-panel-standard .Chrome .custom-share-component style=""}
::: lia-decoration-border
::: lia-decoration-border-top
<div>

</div>
:::

::: lia-decoration-border-content
<div>

::: lia-panel-heading-bar-wrapper
::: lia-panel-heading-bar
## Share {#customShareWidget .lia-panel-heading-bar-title .hello}
:::
:::

::: lia-panel-content-wrapper
::: lia-panel-content
-   [[Share to
    LinkedIn]{.social-share-title}](http://www.linkedin.com/shareArticle?mini=true&url=https://techcommunity.microsoft.com/t5/microsoft-365-pnp-blog/use-pnp-powershell-to-add-a-document-library-webpart-to-a-page/ba-p/2428310 "Share to LinkedIn"){.social-share-link
    .social-share-linkedin}
-   [[Share to
    Facebook]{.social-share-title}](http://www.facebook.com/share.php?u=https://techcommunity.microsoft.com/t5/microsoft-365-pnp-blog/use-pnp-powershell-to-add-a-document-library-webpart-to-a-page/ba-p/2428310 "Share to FaceBook"){.social-share-link
    .social-share-facebook}
-   [[Share to
    Twitter]{.social-share-title}](http://twitter.com/share?text=Check%20out%20this%20post%20on%20the%20Microsoft%20Tech%20Community%20:%20Use%20PnP%20Powershell%20to%20add%20a%20document%20library%20webpart%20to%20a%20page%20(and%20only%20show%20a%20specific%20folder)%20-%20Microsoft%20Tech%20Community&url=https://techcommunity.microsoft.com/t5/microsoft-365-pnp-blog/use-pnp-powershell-to-add-a-document-library-webpart-to-a-page/ba-p/2428310 "Share to Twitter"){.social-share-link
    .social-share-twitter}
-   [[Share to
    Email]{.social-share-title}](mailto:?subject=Use%20PnP%20Powershell%20to%20add%20a%20document%20library%20webpart%20to%20a%20page%20(and%20only%20show%20a%20specific%20folder)%20-%20Microsoft%20Tech%20Community&body=I%20found%20this%20on%20the%20Microsoft%20Tech%20Community%20and%20wanted%20to%20share%20it%20with%20you,%20check%20it%20out%20:%20https://techcommunity.microsoft.com/t5/microsoft-365-pnp-blog/use-pnp-powershell-to-add-a-document-library-webpart-to-a-page/ba-p/2428310 "Share via email"){.social-share-link
    .social-share-email}
:::
:::

</div>
:::

::: lia-decoration-border-bottom
<div>

</div>
:::
:::
:::
:::
:::
:::
:::
:::
:::

::: {.lia-quilt-row .lia-quilt-row-footer}
::: {.lia-quilt-column .lia-quilt-column-24 .lia-quilt-column-single .lia-quilt-column-common-footer}
::: {.lia-quilt-column-alley .lia-quilt-column-alley-single}
::: {.lia-quilt .lia-quilt-footer .lia-quilt-layout-footer .lia-component-quilt-footer}
::: {.lia-quilt-row .lia-quilt-row-main}
::: {.lia-quilt-column .lia-quilt-column-24 .lia-quilt-column-single .lia-quilt-column-icons}
::: {.lia-quilt-column-alley .lia-quilt-column-alley-single .lia-mark-empty}
:::
:::
:::
:::
:::
:::
:::
:::
:::
:::
:::
:::

::: {.cse-46444-wa style="display: none"}
::: {.lia-slide-out-nav-menu .lia-component-common-widget-slide-out-nav-menu}
::: {.lia-slide-out-nav-menu-title ng-non-bindable=""}
Browse
:::

::: {.lia-quilt .lia-quilt-navigation-slide-out-menu .lia-quilt-layout-one-column .lia-top-quilt}
::: {.lia-quilt-row .lia-quilt-row-header}
::: {.lia-quilt-column .lia-quilt-column-24 .lia-quilt-column-single .lia-quilt-column-common-header .lia-mark-empty}
:::
:::

::: {.lia-quilt-row .lia-quilt-row-main}
::: {.lia-quilt-column .lia-quilt-column-24 .lia-quilt-column-single .lia-quilt-column-main-content}
::: {.lia-quilt-column-alley .lia-quilt-column-alley-single}
:::
:::
:::

::: {.lia-quilt-row .lia-quilt-row-footer}
::: {.lia-quilt-column .lia-quilt-column-24 .lia-quilt-column-single .lia-quilt-column-common-footer .lia-mark-empty}
:::
:::
:::
:::
:::

::: {.shell-footer bi-view="5xLinks" bi-area="Footer" ms.pgarea="uhffooter" role="contentinfo"}
::: shell-footer-wrapper
::: {.shell-footer-menugroups ms.cmpgrp="footer nav"}
::: {.sfm-group ms.cmpnm="WhatsNew"}
###### What\'s new  {#whats-new .grp-title}

-   [Surface Pro
    X](https://www.microsoft.com/p/surface-pro-x/8vdnrp2m6hhc?activetab=overview)
-   [Surface Laptop
    3](https://www.microsoft.com/p/surface-laptop-3/8VFGGH1R94TM?activetab=overview)
-   [Surface Pro
    7](https://www.microsoft.com/p/surface-pro-7/8N17J0M5ZZQS?activetab=overview)
-   [Windows 10 Apps](https://www.microsoft.com/windows/windows-10-apps)
-   [Office apps](https://store.office.com/appshome.aspx)
:::

::: {.sfm-group ms.cmpnm="MicrosoftStore"}
###### Microsoft Store  {#microsoft-store .grp-title}

-   [Account profile](https://account.microsoft.com/)
-   [Download Center](https://www.microsoft.com/download)
-   [Microsoft Store
    support](https://go.microsoft.com/fwlink/p/?LinkID=824761&clcid=0x409)
-   [Returns](https://go.microsoft.com/fwlink/p/?LinkID=824764&clcid=0x409)
-   [Order tracking](https://account.microsoft.com/orders)
-   [Store
    locations](https://www.microsoft.com/en-us/store/locations/find-a-store?icid=en-us_UF_FAS)
-   [Buy online, pick up in
    store](https://www.microsoft.com/en-us/store/b/buy-online-pick-up-in-store?icid=uhf_footer_bopuis)
-   [In-store
    events](https://www.microsoft.com/en-us/store/locations/events?icid=en_us_store_uhf_events)
:::

::: {.sfm-group ms.cmpnm="Education"}
###### Education  {#education .grp-title}

-   [Microsoft in education](https://www.microsoft.com/education)
-   [Office for
    students](https://www.microsoft.com/education/products/office/default.aspx)
-   [Office for
    schools](https://products.office.com/academic/compare-office-365-education-plans)
-   [Deals for students and
    parents](https://www.microsoft.com/en-us/store/b/education?icid=CNavfooter_Studentsandeducation)
-   [Microsoft Azure in
    education](https://azure.microsoft.com/community/education/)
:::

::: {.sfm-group ms.cmpnm="Enterprise"}
###### Enterprise  {#enterprise .grp-title}

-   [Azure](https://azure.microsoft.com/)
-   [AppSource](https://go.microsoft.com/fwlink/?LinkID=808093)
-   [Automotive](https://www.microsoft.com/enterprise/automotive)
-   [Government](https://www.microsoft.com/enterprise/government)
-   [Healthcare](https://www.microsoft.com/enterprise/health)
-   [Manufacturing](https://www.microsoft.com/enterprise/manufacturing)
-   [Financial
    Services](https://www.microsoft.com/enterprise/financial-services/banking-and-capital-markets)
-   [Retail](https://www.microsoft.com/enterprise/retail-consumer-goods)
:::

::: {.sfm-group ms.cmpnm="Developer"}
###### Developer  {#developer .grp-title}

-   [Microsoft Visual Studio](https://visualstudio.microsoft.com/)
-   [Window Dev Center](https://developer.microsoft.com/windows)
-   [Developer Network](https://msdn.microsoft.com/)
-   [TechNet](https://technet.microsoft.com/)
-   [Microsoft developer
    program](https://developer.microsoft.com/store/register)
-   [Channel 9](https://channel9.msdn.com/)
-   [Office Dev Center](https://developer.microsoft.com/office)
-   [Microsoft Garage](https://www.microsoft.com/garage/)
:::

::: {.sfm-group ms.cmpnm="Company"}
###### Company  {#company .grp-title}

-   [Careers](https://careers.microsoft.com/)
-   [About Microsoft](https://www.microsoft.com/en-us/about)
-   [Company News](https://news.microsoft.com/)
-   [Privacy at Microsoft](https://privacy.microsoft.com/)
-   [Investors](https://www.microsoft.com/investor/default.aspx)
-   [Diversity and inclusion](https://www.microsoft.com/diversity/)
-   [Accessibility](https://www.microsoft.com/accessibility)
-   [Security](https://www.microsoft.com/security/default.aspx)
:::
:::

::: {.shell-footer-copyright ms.cmpnm="corp" ms.cmpgrp="corp links"}
-   [Sitemap](https://www.microsoft.com/en-us/sitemap1.aspx){#shellmenu_0
    .ctl_footerNavLink}
-   [Contact
    Microsoft](https://support.microsoft.com/contactus){#shellmenu_1
    .ctl_footerNavLink}
-   [Privacy](https://go.microsoft.com/fwlink/?LinkId=521839){#shellmenu_2
    .ctl_footerNavLink}
-   [Manage cookies](#){#shellmenu_2B .ctl_footerNavLink .hidden}
-   [Terms of
    use](http://go.microsoft.com/fwlink/?LinkID=206977){#shellmenu_3
    .ctl_footerNavLink}
-   [Trademarks](https://www.microsoft.com/trademarks){#shellmenu_4
    .ctl_footerNavLink}
-   [Safety and
    eco](https://www.microsoft.com/devices/safety-and-eco){#shellmenu_5
    .ctl_footerNavLink}
-   [About our ads](https://choice.microsoft.com/){#shellmenu_6
    .ctl_footerNavLink}
-   © []{#footerDate} Microsoft
:::
:::
:::
:::
