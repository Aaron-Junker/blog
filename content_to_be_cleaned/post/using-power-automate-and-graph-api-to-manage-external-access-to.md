::: {#437-003-1 .ServiceNodeInfoHeader}
:::

::: lia-page
::: MinimumWidthContainer
::: min-width-wrapper
::: min-width
::: lia-content
::: {.lia-quilt .lia-quilt-blog-article-page .lia-quilt-layout-two-column-main-side-18-6 .lia-top-quilt}
::: {.lia-quilt-row .lia-quilt-row-header}
::: {.lia-quilt-column .lia-quilt-column-24 .lia-quilt-column-single .lia-quilt-column-common-header}
::: {.lia-quilt-column-alley .lia-quilt-column-alley-single}
::: {.lia-quilt .lia-quilt-header .lia-quilt-layout-header .lia-component-quilt-header}
::: {.lia-quilt-row .lia-quilt-row-main-header}
::: {.lia-quilt-column .lia-quilt-column-24 .lia-quilt-column-single .lia-quilt-column-header}
::: {.lia-quilt-column-alley .lia-quilt-column-alley-single}
::: {#cookie-banner .cookie-markup}
:::

::: {#readerAssistMessages .section .live-region aria-live="assertive" role="alert"}
:::

::: community-header-blank
:::

::: community-header-component
::: community-header-wrapper
::: container
::: {#community-menu-wrapper-menu .menu-link}
[](javascript:void(0)){#community-menu-wrapper-menu-link}

::: {#community-menu-wrapper-menu-icon .menu-icon title=""}
:::
:::

[![](https://techcommunity.microsoft.com/html/@6005EEFEC6E5ECADBBFC249DFA7D38A8/assets/Content/Images/GlobalHeader/MicrosoftLogo.png){.c-image
itemprop="logo" role="presentation" aria-hidden="true"}
[Microsoft]{role="presentation"
aria-hidden="true"}](https://www.microsoft.com){#uhfLogo .c-logo
.c-sgl-stk-uhfLogo}

::: {.c-show-pipe aria-hidden="true"}
:::

[Tech Community](/){#uhfCatLogo .c-logo .c-cat-logo}

::: container-inner
::: {#community-menu-wrapper .community-menu-wrapper .community-menu-hidden-init}
::: {#community-menu-wrapper-header-bar .community-header-bar}
[](#){.community-header-button}

::: community-menu-item-icon
:::
:::

::: {#community-menu-wrapper-list .community-menu-list}
::: {.community-menu-item .tab-homepage}
[](/)

::: {.mdl2-glyph .community-menu-item-icon}

:::

::: community-menu-item-title
Home
:::
:::

::: {.community-menu-item .community-menu-dropdown}
[](#){.community-menu-item-desktop-view}

::: {.c-glyph .community-menu-item-icon}

:::

::: community-menu-item-title-with-dropdownicon
Community Hubs
:::

[](/t5/communities/ct-p/communities#category-filter-button-all){.community-menu-item-mobile-view
.community-menu-item-allow-link}

::: {.c-glyph .community-menu-item-icon}

:::

::: community-menu-item-title-with-dropdownicon
Community Hubs
:::

::: {.dropdown .dropdown-communities .dropdown-events .dropdown-primary-nav}
-   [Community Hubs
    Home](/t5/communities/ct-p/communities#category-filter-button-all){#communities_home}
-   [Products](/t5/communities/ct-p/communities#category-filter-button-products-services){#communities_products}
-   [Special
    Topics](/t5/communities/ct-p/communities#category-filter-button-solutions){#communities_special}
-   [Video Hub](/t5/video-hub/ct-p/VideoHub){#communities_videohub}

::: custom-community-hubs-menu-wrapper
::: custom-community-hubs-menu-close
Close
:::

::: custom-community-hubs-menu-content
::: menu
## [ Products]{#menu-link-prod title="Products"} [(72)]{.small} {#menu-products .active}

## [ Special Topics ]{#menu-link-serv title="Special Topics"} [(41)]{.small} {#menu-services}

## [ Video Hub ]{#menu-link-videohub title="VideoHub"} [(834)]{.small} {#menu-videohub}
:::

::: {#products-data .dataBlock .visible key="products"}
::: {.hubs style="width: 600px"}
### Most Active Hubs

::: {.data style="flex-direction: column; height:310px"}
<div>

[Microsoft
Teams](/t5/microsoft-teams/ct-p/MicrosoftTeams "Microsoft Teams")

</div>

<div>

[Excel](/t5/excel/ct-p/Excel_Cat "Excel")

</div>

<div>

[Exchange](/t5/exchange/ct-p/Exchange "Exchange")

</div>

<div>

[SharePoint](/t5/sharepoint/ct-p/SharePoint "SharePoint")

</div>

<div>

[Windows](/t5/windows-10/ct-p/Windows10 "Windows")

</div>

<div>

[Office 365](/t5/office-365/ct-p/Office365 "Office 365")

</div>

<div>

[Security, Compliance and
Identity](/t5/security-compliance-and-identity/ct-p/MicrosoftSecurityandCompliance "Security, Compliance and Identity")

</div>

<div>

[Windows
Server](/t5/windows-server/ct-p/Windows-Server "Windows Server")

</div>

<div>

[Microsoft Edge
Insider](/t5/microsoft-edge-insider/ct-p/MicrosoftEdgeInsider "Microsoft Edge Insider")

</div>

<div>

[Azure](/t5/azure-community/ct-p/Azure "Azure")

</div>

<div>

[Microsoft 365](/t5/microsoft-365/ct-p/microsoft365 "Microsoft 365")

</div>
:::
:::

::: boxes
[](/t5/azure-databases/ct-p/AzureDatabases "Azure Databases")

::: {.box style="background-image: url('https://techcommunity.microsoft.com/html/@D05C7AA27EF9EB31779410FCB608734A/assets/bg-pink.png')"}
::: title
Azure Databases
:::

::: description
Fully managed intelligent database services.
:::
:::

[](/t5/project-bonsai/ct-p/ProjectBonsai "Autonomous Systems")

::: {.box style="background-image: url('https://techcommunity.microsoft.com/html/@FC8AD6AC9A7EBDA58D7E6304E799EA40/assets/bg-orange.png')"}
::: title
Autonomous Systems
:::

::: description
Create and optimise intelligence for industrial control systems.
:::
:::

[](/t5/yammer/ct-p/Yammer "Yammer")

::: {.box style="background-image: url('https://techcommunity.microsoft.com/html/@CF0293463F27444B05A952A3C4B6BF88/assets/bg-light-blue.png')"}
::: title
Yammer
:::

::: description
Connect and engage across your organization.
:::
:::
:::
:::

::: {#services-data .dataBlock key="services"}
::: {.hubs style="width: 600px"}
### Most Active Hubs

::: {.data style="flex-direction: column; height:310px"}
<div>

[ITOps Talk](/t5/itops-talk/ct-p/ITOpsTalk "ITOps Talk")

</div>

<div>

[Education
Sector](/t5/education-sector/ct-p/EducationSector "Education Sector")

</div>

<div>

[Microsoft
Learn](/t5/microsoft-learn/ct-p/MicrosoftLearn "Microsoft Learn")

</div>

<div>

[Microsoft
Localization](/t5/microsoft-localization/ct-p/MicrosoftTranslation "Microsoft Localization")

</div>

<div>

[Microsoft 365
PnP](/t5/microsoft-365-pnp/ct-p/Microsoft365PnP "Microsoft 365 PnP")

</div>

<div>

[Healthcare and Life
Sciences](/t5/healthcare-and-life-sciences/ct-p/HealthcareAndLifeSciences "Healthcare and Life Sciences")

</div>

<div>

[Public Sector](/t5/public-sector/ct-p/PublicSector "Public Sector")

</div>

<div>

[Internet of Things
(IoT)](/t5/internet-of-things-iot/ct-p/IoT "Internet of Things (IoT)")

</div>

<div>

[Mixed
Reality](/t5/mixed-reality/ct-p/MicrosoftMixedReality "Mixed Reality")

</div>

<div>

[Enabling Remote
Work](/t5/enabling-remote-work/ct-p/RemoteWork "Enabling Remote Work")

</div>

<div>

[Small and Medium
Business](/t5/small-and-medium-businesses/ct-p/SMB "Small and Medium Business")

</div>
:::
:::

::: boxes
[](/t5/humans-of-it/ct-p/HumansofIT "Humans of IT")

::: {.box style="background-image: url('https://techcommunity.microsoft.com/html/@A5C0BDB1059C6D1F73B8097424B50ED0/assets/bg-purple.png')"}
::: title
Humans of IT
:::

::: description
Empowering technologists to achieve more by humanizing tech.
:::
:::

[](/t5/green-tech/ct-p/GreenTech "Green Tech")

::: {.box style="background-image: url('https://cdn.techcommunity.microsoft.com/lithium/MicrosoftLearn/Learn-Blue.png')"}
::: title
Green Tech
:::

::: description
Raise awareness about sustainability in the tech sector
:::
:::

[](/t5/mvp-award-program/ct-p/MVPAwardProgram "MVP Award Program")

::: {.box style="background-image: url('https://techcommunity.microsoft.com/html/@02C247197A08F2DB06040AC786E1BF01/assets/bg-green.png')"}
::: title
MVP Award Program
:::

::: description
Find out more about the Microsoft MVP Award Program.
:::
:::
:::
:::

::: {#VideoHub-Data .dataBlock key="VideoHub"}
::: {.hubs style="width: 838px"}
### Video Hub

::: {.data style="flex-direction: row; height:fit-content"}
<div>

[Azure](https://aka.ms/VideoHub/Azure "Azure")

</div>

<div>

[Exchange](https://aka.ms/VideoHub/Exchange "Exchange")

</div>

<div>

[Microsoft 365](https://aka.ms/VideoHub/Microsoft365 "Microsoft 365")

</div>

<div>

[Microsoft 365
Business](https://aka.ms/VideoHub/Microsoft365Business "Microsoft 365 Business")

</div>

<div>

[Microsoft 365
Enterprise](https://aka.ms/VideoHub/Microsoft365Business "Microsoft 365 Enterprise")

</div>

<div>

[Microsoft Edge](https://aka.ms/VideoHub/MicrosoftEdge "Microsoft Edge")

</div>

<div>

[Microsoft Outlook](https://aka.ms/VideoHub/Outlook "Microsoft Outlook")

</div>

<div>

[Microsoft
Teams](https://aka.ms/VideoHub/MicrosoftTeams "Microsoft Teams")

</div>

<div>

[Security](https://aka.ms/VideoHub/Security "Security")

</div>

<div>

[SharePoint](https://aka.ms/VideoHub/SharePoint "SharePoint")

</div>

<div>

[Windows](https://aka.ms/VideoHub/Windows "Windows")

</div>
:::
:::
:::
:::

::: custom-community-hubs-menu-footer
[Browse All Community
Hubs](/t5/Communities/ct-p/communities){#browse-all-communities}
:::
:::
:::
:::

::: {.community-menu-item .my-favorites}
[](/t5/custom/page/page-id/Blogs){.community-menu-item-desktop-view}

::: {.mdl2-glyph .community-menu-item-icon}

:::

::: community-menu-item-title
Blogs
:::

[](/t5/custom/page/page-id/Blogs){.community-menu-item-mobile-view}

::: {.mdl2-glyph .community-menu-item-icon}

:::

::: community-menu-item-title
Blogs
:::
:::

::: {.community-menu-item .tab-events .community-menu-dropdown}
[](#){.community-menu-item-desktop-view}

::: {.c-glyph .community-menu-item-icon}

:::

::: community-menu-item-title-with-dropdownicon
Events
:::

[](#){.community-menu-item-mobile-view}

::: {.c-glyph .community-menu-item-icon}

:::

::: community-menu-item-title-with-dropdownicon
Events
:::

::: {.dropdown .dropdown-events .dropdown-primary-nav}
-   [Events Home](/t5/Events/ct-p/Events)
-   [Microsoft Ignite](https://myignite.microsoft.com/)
-   [Microsoft Build](https://mybuild.microsoft.com/)
-   [Community Events](/t5/Community-Events/ct-p/CommunityEvents)
:::
:::

::: {.community-menu-item .tab-microsoft-learning .community-menu-dropdown}
[](#){.community-menu-item-desktop-view}

::: {.grad .community-menu-item-icon}
:::

::: community-menu-item-title-with-dropdownicon
Microsoft Learn
:::

[](#){.community-menu-item-mobile-view}

::: {.grad .community-menu-item-icon}
:::

::: community-menu-item-title-with-dropdownicon
Microsoft Learn
:::

::: {.dropdown .dropdown-events .dropdown-primary-nav}
-   [Home](%20https://docs.microsoft.com/learn/){.ms-learning-home-link
    .community-menu-item-title}
-   [Community](/t5/microsoft-learn/bd-p/MicrosoftLearn)
-   [Blog](/t5/microsoft-learn-blog/bg-p/MicrosoftLearnBlog)
-   [Azure](https://docs.microsoft.com/learn/azure/?WT.mc_id=techcom_header-webpage-m365)
-   [Dynamics
    365](https://docs.microsoft.com/learn/dynamics365/?WT.mc_id=techcom_header-webpage-m365)
-   [Microsoft
    365](https://docs.microsoft.com/learn/m365/?wt.mc_id=techcom_header-webpage-m365)
-   [Security, Compliance &
    Identity](https://docs.microsoft.com/learn/topics/sci/?wt.mc_id=techcom_header-webpage-m365)
-   [Power
    Platform](https://docs.microsoft.com/learn/powerplatform/?wt.mc_id=techcom_header-webpage-powerplatform)
-   [Github](https://docs.microsoft.com/learn/github/?wt.mc_id=techcom_header-webpage-github)
-   [Teams](https://docs.microsoft.com/learn/teams/?wt.mc_id=techcom_header-webpage-teams)
-   [.NET](https://docs.microsoft.com/learn/dotnet/?wt.mc_id=techcom_header-webpage-dotnet)
:::
:::

::: {.community-menu-item .tab-info-center}
[](/t5/Community-Info-Center/ct-p/Community-Info-Center){.community-menu-item-desktop-view}

::: {.c-glyph .community-menu-item-icon}

:::

::: community-menu-item-title
Lounge
:::

[](/t5/Community-Info-Center/ct-p/Community-Info-Center){.community-menu-item-mobile-view}

::: {.c-glyph .community-menu-item-icon}

:::

::: community-menu-item-title
Lounge
:::
:::
:::

-   [[776K]{#community-menu-wrapper-vitality-stat-count-1
    .community-menu-vitality-stat-count} [
    Members]{#community-menu-wrapper-vitality-stat-title-1
    .community-menu-vitality-stat-title}]{#community-menu-wrapper-vitality-stat-item-1}
-   [[7,337]{#community-menu-wrapper-vitality-stat-count-2
    .community-menu-vitality-stat-count} [
    Online]{#community-menu-wrapper-vitality-stat-title-2
    .community-menu-vitality-stat-title}]{#community-menu-wrapper-vitality-stat-item-2}
-   [[2M]{#community-menu-wrapper-vitality-stat-count-3
    .community-menu-vitality-stat-count} [
    Discussions]{#community-menu-wrapper-vitality-stat-title-3
    .community-menu-vitality-stat-title}]{#community-menu-wrapper-vitality-stat-item-3}
:::

::: nav-right
::: {#search_container}
::: {#search_btn}
Search []{.btn-search}
:::

::: {#search_slider .hidden}
::: custom-lia-search
::: {#lia-searchformV32_231422aba5825f .SearchForm .lia-search-form-wrapper .lia-mode-default .lia-component-common-widget-search-form}
::: lia-inline-ajax-feedback
::: {#ajaxfeedback_231422aba5825f .AjaxFeedback}
:::
:::

::: {#searchautocompletetoggle_231422aba5825f}
::: lia-inline-ajax-feedback
::: {#ajaxfeedback_231422aba5825f_0 .AjaxFeedback}
:::
:::

::: t-invisible
:::

::: lia-inline-ajax-feedback
::: {#feedback_231422aba5825f .AjaxFeedback}
:::
:::

[ [ []{.lia-button-wrapper .lia-button-wrapper-secondary
.lia-button-wrapper-searchForm-action} ]{.lia-search-input-field}
]{.lia-search-input-wrapper} [cancel]{.lia-cancel-search}

::: {.search-autocomplete-toggle-link .lia-js-hidden}
[Turn on
suggestions](https://techcommunity.microsoft.com/t5/blogs/v2/blogarticlepage.enableautocomplete:enableautocomplete?t:ac=blog-id/Microsoft365PnPBlog/article-id/260&t:cp=action/contributions/searchactions){#enableAutoComplete_231422aba5825f
.lia-link-navigation .auto-complete-toggle-on
.lia-link-ticket-post-action
.lia-component-search-action-enable-auto-complete} [
[[]{#display_231422aba5825f .lia-img-icon-help .lia-fa-icon .lia-fa-help
.lia-fa
alt="Auto-suggest helps you quickly narrow down your search results by suggesting possible matches as you type."
aria-label="Help Icon" role="img"}](#){#link_231422aba5825f
.lia-link-navigation .help-icon .lia-tooltip-trigger}]{.HelpIcon}

::: {#link_231422aba5825f_0-tooltip-element .lia-content .lia-tooltip-pos-bottom-left .lia-panel-tooltip-wrapper role="alertdialog"}
::: lia-tooltip-arrow
:::

::: lia-panel-tooltip
::: content
Auto-suggest helps you quickly narrow down your search results by
suggesting possible matches as you type.
:::
:::
:::
:::
:::

::: spell-check-showing-result
Showing results for []{#showingResult_231422aba5825f
.lia-link-navigation .show-results-for-link .lia-link-disabled}
[](#){#showingMoreResult_231422aba5825f .lia-link-navigation
.more-synonym-search-results-for-link} [
]{.all-results-for-synonym-search}
:::

<div>

[ Show [](#){#synonymSearchInstead_231422aba5825f .lia-link-navigation
.synonym-search-instead-for-link} only  ]{.synonym-search-instead
.lia-js-hidden} [ \| ]{.spell-check-and-synonym-search-instead
.lia-js-hidden} [ Search instead for [](#){#searchInstead_231422aba5825f
.lia-link-navigation .search-instead-for-link}
]{.spell-check-search-instead}

</div>

::: {.spell-check-do-you-mean .lia-component-search-widget-spellcheck}
Did you mean: [](#){#doYouMean_231422aba5825f .lia-link-navigation
.do-you-mean-link}
:::
:::
:::
:::
:::

::: sign-in-wrapper
[Sign
In](/plugins/common/feature/oauth2sso/sso_login_redirect?lang=en&referer=https%3A%2F%2Ftechcommunity.microsoft.com%2Ft5%2Fmicrosoft-365-pnp-blog%2Fusing-power-automate-and-graph-api-to-manage-external-access-to%2Fba-p%2F2330775)
:::

::: notifications
::: notify-icon
[](/t5/notificationfeed/page)

::: lia-notifications-messages-aggregate
:::
:::

::: email-icon
[](/t5/notes/privatenotespage)

::: lia-notifications-messages-aggregate
:::
:::
:::

::: lia-component-common-widget-slide-out-user-menu
::: {.lia-user-navigation-sign-in .lia-component-users-action-login-with-avatar}
::: user-navigation-user-profile
[Sign
In](/plugins/common/feature/oauth2sso/sso_login_redirect?lang=en&referer=https%3A%2F%2Ftechcommunity.microsoft.com%2Ft5%2Fmicrosoft-365-pnp-blog%2Fusing-power-automate-and-graph-api-to-manage-external-access-to%2Fba-p%2F2330775){#link_1_231422ad37cc7f
.lia-link-navigation .login-link .lia-authentication-link}
:::

::: {.UserAvatar .lia-user-avatar}
[](/plugins/common/feature/oauth2sso/sso_login_redirect?lang=en&referer=https%3A%2F%2Ftechcommunity.microsoft.com%2Ft5%2Fmicrosoft-365-pnp-blog%2Fusing-power-automate-and-graph-api-to-manage-external-access-to%2Fba-p%2F2330775){#link_2_231422ad37cc7f
.lia-link-navigation .login-link .lia-authentication-link}

::: lia-anonymous-profile-icon
:::
:::
:::
:::
:::
:::
:::
:::
:::

::: notifications-overlay-notif
:::

::: notifications-overlay-mail
:::

::: notifications-overlay-favorites
:::
:::
:::
:::

::: {.lia-quilt-row .lia-quilt-row-sub-header}
::: {.lia-quilt-column .lia-quilt-column-18 .lia-quilt-column-left .lia-quilt-column-breadcrumb .lia-mark-empty}
:::

::: {.lia-quilt-column .lia-quilt-column-06 .lia-quilt-column-right .lia-quilt-column-search-content}
::: {.lia-quilt-column-alley .lia-quilt-column-alley-right}
::: custom-lia-search
::: {#lia-searchformV32 .SearchForm .lia-search-form-wrapper .lia-mode-default .lia-component-common-widget-search-form}
::: lia-inline-ajax-feedback
::: {#ajaxfeedback .AjaxFeedback}
:::
:::

::: {#searchautocompletetoggle}
::: lia-inline-ajax-feedback
::: {#ajaxfeedback_0 .AjaxFeedback}
:::
:::

::: t-invisible
:::

::: lia-inline-ajax-feedback
::: {#feedback .AjaxFeedback}
:::
:::

[ [ []{.lia-button-wrapper .lia-button-wrapper-secondary
.lia-button-wrapper-searchForm-action} ]{.lia-search-input-field}
]{.lia-search-input-wrapper} [cancel]{.lia-cancel-search}

::: {.search-autocomplete-toggle-link .lia-js-hidden}
[Turn on
suggestions](https://techcommunity.microsoft.com/t5/blogs/v2/blogarticlepage.enableautocomplete:enableautocomplete?t:ac=blog-id/Microsoft365PnPBlog/article-id/260&t:cp=action/contributions/searchactions){#enableAutoComplete
.lia-link-navigation .auto-complete-toggle-on
.lia-link-ticket-post-action
.lia-component-search-action-enable-auto-complete} [ [[]{#display
.lia-img-icon-help .lia-fa-icon .lia-fa-help .lia-fa
alt="Auto-suggest helps you quickly narrow down your search results by suggesting possible matches as you type."
aria-label="Help Icon" role="img"}](#){#link_0 .lia-link-navigation
.help-icon .lia-tooltip-trigger}]{.HelpIcon}

::: {#link_1-tooltip-element .lia-content .lia-tooltip-pos-bottom-left .lia-panel-tooltip-wrapper role="alertdialog"}
::: lia-tooltip-arrow
:::

::: lia-panel-tooltip
::: content
Auto-suggest helps you quickly narrow down your search results by
suggesting possible matches as you type.
:::
:::
:::
:::
:::

::: spell-check-showing-result
Showing results for []{#showingResult .lia-link-navigation
.show-results-for-link .lia-link-disabled} [](#){#showingMoreResult
.lia-link-navigation .more-synonym-search-results-for-link} [
]{.all-results-for-synonym-search}
:::

<div>

[ Show [](#){#synonymSearchInstead .lia-link-navigation
.synonym-search-instead-for-link} only  ]{.synonym-search-instead
.lia-js-hidden} [ \| ]{.spell-check-and-synonym-search-instead
.lia-js-hidden} [ Search instead for [](#){#searchInstead
.lia-link-navigation .search-instead-for-link}
]{.spell-check-search-instead}

</div>

::: {.spell-check-do-you-mean .lia-component-search-widget-spellcheck}
Did you mean: [](#){#doYouMean .lia-link-navigation .do-you-mean-link}
:::
:::
:::
:::
:::
:::

::: {.lia-quilt-row .lia-quilt-row-feedback}
::: {.lia-quilt-column .lia-quilt-column-24 .lia-quilt-column-single .lia-quilt-column-feedback}
::: {.lia-quilt-column-alley .lia-quilt-column-alley-single}
:::
:::
:::
:::

::: {.custom-nda-blog-article-page-header-banner .lia-mark-empty}
:::

::: {.community-live-events-banner-blog-article-page-wrapper .lia-mark-empty}
:::

::: custom-blog-article-page-header-wrapper
::: custom-common-widget-breadcrumb
::: {.custom-common-widget-breadcrumb-wrapper .hidden}
[Home](/){.BreadCrumb .home-nav-link}

::: {.BreadCrumb .crumb-line .lia-breadcrumb .lia-component-common-widget-breadcrumb aria-label="breadcrumbs" role="navigation"}
-   [Home](/){#link_231422b2917cac .lia-link-navigation .crumb-community
    .lia-breadcrumb-community .lia-breadcrumb-forum}
-    []{#display_231422b2917cac .lia-img-icon-list-separator-breadcrumb
    .lia-fa-icon .lia-fa-list .lia-fa-separator .lia-fa-breadcrumb
    .lia-fa alt="" aria-label="" role="img"}
-   [Microsoft 365
    PnP](/t5/microsoft-365-pnp/ct-p/Microsoft365PnP){#link_231422b2917cac_0
    .lia-link-navigation .crumb-category .lia-breadcrumb-category
    .lia-breadcrumb-forum}
-    []{#display_231422b2917cac_0
    .lia-img-icon-list-separator-breadcrumb .lia-fa-icon .lia-fa-list
    .lia-fa-separator .lia-fa-breadcrumb .lia-fa alt="" aria-label=""
    role="img"}
-   [Microsoft 365 PnP
    Blog](/t5/microsoft-365-pnp-blog/bg-p/Microsoft365PnPBlog){#link_231422b2917cac_1
    .lia-link-navigation .crumb-board .lia-breadcrumb-board
    .lia-breadcrumb-forum}
-    []{#display_231422b2917cac_1
    .lia-img-icon-list-separator-breadcrumb .lia-fa-icon .lia-fa-list
    .lia-fa-separator .lia-fa-breadcrumb .lia-fa alt="" aria-label=""
    role="img"}
-   [Using Power Automate And Graph API To Manage External Access To
    Teams]{#link_231422b2917cac_2 .lia-link-navigation .child-thread
    .lia-link-disabled aria-disabled="true" disabled="true" role="link"
    aria-label="Using Power Automate And Graph API To Manage External Access To Teams"}
:::
:::
:::

::: {.lia-menu-bar .lia-discussion-page-discussion-navigator .lia-component-article-navigator}
::: lia-decoration-border-menu-bar
::: lia-decoration-border-menu-bar-top
<div>

</div>
:::

::: lia-decoration-border-menu-bar-content
<div>

::: lia-menu-bar-buttons
:::

::: {#threadnavigator .lia-paging-full-wrapper}
-   [[]{.lia-paging-page-arrow} [Back to
    Blog]{.lia-paging-page-link}](/t5/microsoft-365-pnp-blog/bg-p/Microsoft365PnPBlog "Microsoft 365 PnP Blog"){#link_2
    .lia-link-navigation}
-   [[]{.lia-paging-page-arrow} [Newer
    Article]{.lia-paging-page-link}](/t5/microsoft-365-pnp-blog/introducing-react-video-banner-web-part/ba-p/2329002 "Introducing React Video Banner Web Part"){#link_3
    .lia-link-navigation}
-   [[Older Article]{.lia-paging-page-link}
    []{.lia-paging-page-arrow}](/t5/microsoft-365-pnp-blog/simple-reminders-for-any-teams-channel-or-chat-message/ba-p/2319963 "Simple reminders for any Teams Channel or Chat message"){#link_4
    .lia-link-navigation}
:::

</div>
:::

::: lia-decoration-border-menu-bar-bottom
<div>

</div>
:::
:::
:::
:::
:::
:::
:::

::: {.lia-quilt-row .lia-quilt-row-main}
::: {.lia-quilt-column .lia-quilt-column-18 .lia-quilt-column-left .lia-quilt-column-main-content}
::: {.lia-quilt-column-alley .lia-quilt-column-alley-left}
::: ba-subject-header-wrapper
::: ba-subject-wrapper
::: ba-title
# Using Power Automate And Graph API To Manage External Access To Teams
:::

::: ba-option-wrapper
::: {.lia-menu-bar .top-block .lia-component-menu-bar-without-options}
::: lia-decoration-border-menu-bar
::: lia-decoration-border-menu-bar-top
<div>

</div>
:::

::: lia-decoration-border-menu-bar-content
<div>

::: lia-menu-bar-buttons
:::

</div>
:::

::: lia-decoration-border-menu-bar-bottom
<div>

</div>
:::
:::
:::
:::
:::

::: ba-author-and-metrics-wrapper
::: ba-author-wrapper
By

::: ba-author-info
[ ]{.UserName .lia-user-name}

::: UserAvatarWrapper
::: {.UserAvatar .lia-user-avatar .lia-component-common-widget-user-avatar .Regular .Visitor}
[![LinkeD365](https://techcommunity.microsoft.com/t5/image/serverpage/image-id/277043i5EDFC7A64CB04079/image-dimensions/150x150/image-coordinates/1610%2C605%2C3267%2C2262?v=v2 "LinkeD365"){.lia-user-avatar-message
.user-rank-ring style=""
onerror="replaceBrokenAvatars(this, '/html/assets/default-avatar.png')"}](/t5/user/viewprofilepage/user-id/416726){.UserAvatar
.lia-link-navigation}
:::

::: {.user-profile-card user-id="416726"}
::: contents
::: spinner
:::
:::
:::
:::

::: user-login
[Carl Cookson](/t5/user/viewprofilepage/user-id/416726)
:::
:::
:::

::: ba-metrics-info
[Published]{.ba-published-title} [May 06 2021 03:50
AM]{.ba-published-date} [ 3,745 Views ]{.ba-view-count}
:::
:::
:::

::: custom-blog-article-wrapper
::: {#messageview .lia-panel-message .message-uid-2330775 .lia-component-article lia-message-uid="2330775"}
::: {#messageView2_1 .lia-message-view-wrapper .lia-js-data-messageUid-2330775 .lia-component-forums-widget-message-view-two lia-message-uid="2330775"}
[ ]{#U2330775} [ ]{#M260}

::: lia-inline-ajax-feedback
::: {#ajaxfeedback_1 .AjaxFeedback}
:::
:::

::: {.MessageView .lia-message-view-blog-topic-message .lia-message-view-display .lia-row-standard-unread .lia-thread-topic}
[]{.lia-message-state-indicator}

::: {.lia-quilt .lia-quilt-blog-topic-message .lia-quilt-layout-one-column-message}
::: {.lia-quilt-row .lia-quilt-row-header}
::: {.lia-quilt-column .lia-quilt-column-16 .lia-quilt-column-left .lia-quilt-column-header-left}
::: {.lia-quilt-column-alley .lia-quilt-column-alley-left}
::: {.lia-message-author-avatar .lia-component-author-avatar .lia-component-message-view-widget-author-avatar}
::: UserAvatarWrapper
::: {.UserAvatar .lia-user-avatar .lia-component-common-widget-user-avatar .Regular .Visitor}
[![LinkeD365](https://techcommunity.microsoft.com/t5/image/serverpage/image-id/277043i5EDFC7A64CB04079/image-dimensions/40x40/image-coordinates/1493%2C341%2C3254%2C2102?v=v2 "LinkeD365"){.lia-user-avatar-message
.user-rank-ring style=""
onerror="replaceBrokenAvatars(this, '/html/assets/default-avatar.png')"}](/t5/user/viewprofilepage/user-id/416726){.UserAvatar
.lia-link-navigation}
:::

::: {.user-profile-card user-id="416726"}
::: contents
::: spinner
:::
:::
:::
:::
:::

::: lia-message-author-with-avatar
[
[LinkeD365](https://techcommunity.microsoft.com/t5/user/viewprofilepage/user-id/416726){#link_5
.lia-link-navigation .lia-page-link .lia-user-name-link} ]{.UserName
.lia-user-name .lia-user-rank-Regular-Visitor
.lia-component-message-view-widget-author-username}
:::

::: {.lia-message-author-rank .lia-component-author-rank .lia-component-message-view-widget-author-rank}
Regular Visitor
:::
:::
:::

::: {.lia-quilt-column .lia-quilt-column-08 .lia-quilt-column-right .lia-quilt-column-header-right}
::: {.lia-quilt-column-alley .lia-quilt-column-alley-right}
::: {.lia-message-post-date .lia-component-post-date .lia-component-message-view-widget-post-date title="Posted on"}
[ [‎May 06 2021]{.local-date} [03:50 AM]{.local-time} ]{.DateTime}
:::

::: {#actionMenuDropDown .lia-menu-navigation-wrapper .lia-js-hidden .lia-menu-action .lia-component-message-view-widget-action-menu}
::: lia-menu-navigation
::: dropdown-default-item
[](# "Show option menu"){#dropDownLink .lia-js-menu-opener
.default-menu-option .lia-js-mouseover-menu .lia-link-navigation}

::: dropdown-positioning
::: dropdown-positioning-static
-   [Subscribe to RSS
    Feed](/gxcuf89792/rss/message?board.id=Microsoft365PnPBlog&message.id=260){#rssThread
    .lia-link-navigation .rss-thread-link
    .lia-component-rss-action-thread}
-   [ []{.lia-separator-post} []{.lia-separator-pre} ]{.lia-separator
    .lia-component-common-widget-link-separator}
-   [Mark as New]{#markThreadUnread .lia-link-navigation
    .mark-thread-unread .lia-link-disabled
    .lia-component-forums-action-mark-thread-unread}
-   [Mark as Read]{#markThreadRead .lia-link-navigation
    .mark-thread-read .lia-link-disabled
    .lia-component-forums-action-mark-thread-read}
-   [ []{.lia-separator-post} []{.lia-separator-pre} ]{.lia-separator
    .lia-component-common-widget-link-separator}
-   [Bookmark]{#addThreadUserBookmark .lia-link-navigation
    .addThreadUserBookmark .lia-link-disabled
    .lia-component-subscriptions-action-add-thread-user-bookmark}
-   [Subscribe]{#addThreadUserEmailSubscription .lia-link-navigation
    .addThreadUserEmailSubscription .lia-link-disabled
    .lia-component-subscriptions-action-add-thread-user-email}
-   [ []{.lia-separator-post} []{.lia-separator-pre} ]{.lia-separator
    .lia-component-common-widget-link-separator}
-   [Email to a Friend]{#emailMessageToFriend .lia-link-navigation
    .email_friend .lia-link-disabled
    .lia-component-forums-action-email-message-to-friend}
-   [ []{.lia-separator-post} []{.lia-separator-pre} ]{.lia-separator
    .lia-component-common-widget-link-separator}
-   [Printer Friendly
    Page](/t5/blogs/blogarticleprintpage/blog-id/Microsoft365PnPBlog/article-id/260){#printThread
    .lia-link-navigation .print-article
    .lia-component-forums-action-print-thread}
-   [Report Inappropriate
    Content](/t5/notifications/notifymoderatorpage/message-uid/2330775){#reportAbuse
    .lia-link-navigation .report-abuse-link
    .lia-component-forums-action-report-abuse}
:::
:::
:::
:::
:::
:::
:::
:::

::: {.lia-quilt-row .lia-quilt-row-main}
::: {.lia-quilt-column .lia-quilt-column-24 .lia-quilt-column-single .lia-quilt-column-main}
::: {.lia-quilt-column-alley .lia-quilt-column-alley-single}
::: {.lia-message-subject-wrapper .lia-component-subject .lia-component-message-view-widget-subject-with-options}
::: MessageSubject
::: MessageSubjectIcons
# [ [Using Power Automate And Graph API To Manage External Access To Teams](/t5/microsoft-365-pnp-blog/using-power-automate-and-graph-api-to-manage-external-access-to/ba-p/2330775){#link_6 .page-link .lia-link-navigation .lia-custom-event} ]{.lia-message-unread} {#using-power-automate-and-graph-api-to-manage-external-access-to-teams-1 .message-subject itemprop="name"}

[]{#display_2 .lia-img-message-has-url .lia-fa-message .lia-fa-has
.lia-fa-url .lia-fa title="Contains a hyperlink"
alt="Message contains a hyperlink" aria-label="Contains a hyperlink"
role="img"} []{#display_3 .lia-img-message-has-image .lia-fa-message
.lia-fa-has .lia-fa-image .lia-fa title="Contains an image"
alt="Message contains an image" aria-label="Contains an image"
role="img"}
:::
:::
:::

::: {.lia-message-post-date .lia-component-post-date .lia-component-message-view-widget-post-date title="Posted on"}
[ [‎May 06 2021]{.local-date} [03:50 AM]{.local-time} ]{.DateTime}
:::

::: {.lia-message-body-wrapper .lia-component-message-view-widget-body}
::: {#bodyDisplay .lia-message-body itemprop="text"}
::: lia-message-body-content
Matt Collins Jones and I presented [API's -- The most powerful tool,
anyone can
use!](https://d365uguk-22-apr-2021.sessionize.com/session/244458) for
D365 UG and Swiss Power Saturday recently and I thought it would be good
to share the Cloud Flow I created to automate the onboarding of external
users to a Microsoft Team.

This is usually an admin driven activity -- A team owner will have to
type in the email address for each guest they want to add, rather than
something you can push to external users and allow them to request
access.

By using the Graph API via a Custom Connector, Microsoft Forms and Power
Automate, we are able to realise this quickly and save a lot of time and
effort in the manual process.

Also, I have been lucky to have this solution accepted as part of the
samples in the [Microsoft Patterns And
Practices](https://pnp.github.io/) initiative, so the Flow, Custom
Connector and implementation instructions are available in
GitHub [here](https://github.com/pnp/powerautomate-samples/tree/main/samples/teams-invites-via-graph-api).

## Getting Hands-On With Graph {#toc-hId--468926889}

The main part of this flow is numerous calls to the [Graph
API](https://docs.microsoft.com/en-us/graph/overview). The Graph API is
Microsoft's standard endpoint to expose and interact with data relevant
to your tenant. It includes Microsoft 365 (such as Teams, Exchange,
SharePoint, Workspace Analytics), Enterprise and Mobility and even
Windows 10 activities and devices. It really should be seen as a single
stop shop for anything and everything in your tenant. The only thing it
doesn't expose is D365 data.

 

There is a [Graph
connector](https://docs.microsoft.com/en-us/connectors/microsoftgraphsecurity/) already
available in Power Automate, but it is very limited to Security
considerations. Thankfully, the rest of the Graph API abilities are
available, but you have to go via a custom connector. You could call
these directly via an HTTP request action, but by wrapping the Graph API
in a connector, you are enabling other members of your organisation to
re-use the connector and security you establish.

 

Microsoft also allows you to "play" with the Graph API as well, via
the [Graph
Explorer](https://developer.microsoft.com/en-us/graph/graph-explorer).
This web interface shows you all the sample calls you can make and also
what permissions you require to call it and allows you to set up a call
without using Power Automate or configuring a connector. It really
should be the starting point for any Graph Customer Connector.

::: wp-block-image
![](https://techcommunity.microsoft.com/t5/image/serverpage/image-id/278720iE6EF5EC2AD373D22/image-size/medium?v=v2&px=400 "LinkeD365_0-1620296690001.png"){.lia-media-image
role="button"
li-image-url="https://techcommunity.microsoft.com/t5/image/serverpage/image-id/278720iE6EF5EC2AD373D22?v=v2"
li-image-display-id="'278720iE6EF5EC2AD373D22'"
li-message-uid="'2330775'" li-messages-message-image="true"
li-bindable="" tabindex="0" li-bypass-lightbox-when-linked="true"
li-use-hover-links="false"}
:::

If things go wrong, it is usually around the permissions. Within the
Graph Explorer you can consent to these extra permissions on the fly,
but more importantly, tells you what you need to configure in the
permissions of your App registration to allow your connector the same
access.

::: wp-block-image
![](https://techcommunity.microsoft.com/t5/image/serverpage/image-id/278721i3E87D2001F9D266F/image-size/medium?v=v2&px=400 "LinkeD365_1-1620296689997.png"){.lia-media-image
role="button"
li-image-url="https://techcommunity.microsoft.com/t5/image/serverpage/image-id/278721i3E87D2001F9D266F?v=v2"
li-image-display-id="'278721i3E87D2001F9D266F'"
li-message-uid="'2330775'" li-messages-message-image="true"
li-bindable="" tabindex="0" li-bypass-lightbox-when-linked="true"
li-use-hover-links="false"}
:::

Select New client secret give it a name & expiry date and select Save.

::: wp-block-image
![](https://techcommunity.microsoft.com/t5/image/serverpage/image-id/278722i17C94A6316C64A72/image-size/medium?v=v2&px=400 "LinkeD365_3-1620296726932.png"){.lia-media-image
role="button"
li-image-url="https://techcommunity.microsoft.com/t5/image/serverpage/image-id/278722i17C94A6316C64A72?v=v2"
li-image-display-id="'278722i17C94A6316C64A72'"
li-message-uid="'2330775'" li-messages-message-image="true"
li-bindable="" tabindex="0" li-bypass-lightbox-when-linked="true"
li-use-hover-links="false"}
:::

Ensure you copy the Value here, you will only be able to see this for a
short while, if you navigate away it will be gone. Not a big deal, just
recreate the client secret, but you will need it later. Now select API
permissions. This will list what permissions this registration has, and
by inference, the caller using the client secret/application id.

 

Select the Add a permission button.

::: wp-block-image
![](https://techcommunity.microsoft.com/t5/image/serverpage/image-id/278724i9E666341ADBF0C54/image-size/medium?v=v2&px=400 "LinkeD365_4-1620296727532.png"){.lia-media-image
role="button"
li-image-url="https://techcommunity.microsoft.com/t5/image/serverpage/image-id/278724i9E666341ADBF0C54?v=v2"
li-image-display-id="'278724i9E666341ADBF0C54'"
li-message-uid="'2330775'" li-messages-message-image="true"
li-bindable="" tabindex="0" li-bypass-lightbox-when-linked="true"
li-use-hover-links="false"}
:::

This presents a choice of which API to expose. The first on the list is
Microsoft Graph, the one we want.

::: wp-block-image
![](https://techcommunity.microsoft.com/t5/image/serverpage/image-id/278725i65C0C81ACBD86229/image-size/medium?v=v2&px=400 "LinkeD365_5-1620296727260.png"){.lia-media-image
role="button"
li-image-url="https://techcommunity.microsoft.com/t5/image/serverpage/image-id/278725i65C0C81ACBD86229?v=v2"
li-image-display-id="'278725i65C0C81ACBD86229'"
li-message-uid="'2330775'" li-messages-message-image="true"
li-bindable="" tabindex="0" li-bypass-lightbox-when-linked="true"
li-use-hover-links="false"}
:::

Select Delegated Permissions (Custom connectors doesn\'t support
Application permissions yet, will run in the context of the person who
runs the flow, so use an admin/system account) then type in the
permission you want, listed here.

-   Directory.ReadWrite.All
-   User.Invite.All
-   User.ReadWrite.All

::: wp-block-image
![](https://techcommunity.microsoft.com/t5/image/serverpage/image-id/278726iA101607BA2412A4B/image-size/medium?v=v2&px=400 "LinkeD365_6-1620296727107.png"){.lia-media-image
role="button"
li-image-url="https://techcommunity.microsoft.com/t5/image/serverpage/image-id/278726iA101607BA2412A4B?v=v2"
li-image-display-id="'278726iA101607BA2412A4B'"
li-message-uid="'2330775'" li-messages-message-image="true"
li-bindable="" tabindex="0" li-bypass-lightbox-when-linked="true"
li-use-hover-links="false"}
:::

Select Add Permissions to return you to the Configured permissions
screen, then select Grant Admin consent button. This shortcuts and
pre-approves the app.

 

Leave this tab open and let's go and define our custom connector.

 

## Defining The Custom Connector {#toc-hId--1596322982}

Jan Bakker has done an excellent job of walking you through
this, [here](https://powerusers.microsoft.com/t5/Power-Automate-Community-Blog/Build-a-custom-connector-for-Microsoft-Graph-API/ba-p/647492).
His article goes into a lot of detail, so I will just take you through
what is needed for this project.

 

In make.powerapps.com, select the appropriate environment and chose
Custom Connectors under Data. Then select New custom connector. You can
import from various sources, but we want to create from blank, give it a
name then fill out the next page.

::: wp-block-image
![](https://techcommunity.microsoft.com/t5/image/serverpage/image-id/278727iB9538CB3C93155D7/image-size/medium?v=v2&px=400 "LinkeD365_7-1620296727214.png"){.lia-media-image
role="button"
li-image-url="https://techcommunity.microsoft.com/t5/image/serverpage/image-id/278727iB9538CB3C93155D7?v=v2"
li-image-display-id="'278727iB9538CB3C93155D7'"
li-message-uid="'2330775'" li-messages-message-image="true"
li-bindable="" tabindex="0" li-bypass-lightbox-when-linked="true"
li-use-hover-links="false"}
:::

On the next screen, there are four tabs, which we need to step through.
First the General Tab.

::: wp-block-image
![](https://techcommunity.microsoft.com/t5/image/serverpage/image-id/278730i784160EBB968FE0A/image-size/medium?v=v2&px=400 "LinkeD365_8-1620296727082.png"){.lia-media-image
role="button"
li-image-url="https://techcommunity.microsoft.com/t5/image/serverpage/image-id/278730i784160EBB968FE0A?v=v2"
li-image-display-id="'278730i784160EBB968FE0A'"
li-message-uid="'2330775'" li-messages-message-image="true"
li-bindable="" tabindex="0" li-bypass-lightbox-when-linked="true"
li-use-hover-links="false"}
:::

Other stuff is nice to have and you *should *document your work. Ensure
Scheme is HTTPS and Host/Base URL are populated.

-   Host -- graph.microsoft.com
-   Base URL -- /v1.0

Select the Security Tab next, Authentication type is OAuth 2.0. You
should be presented with the below screen.

::: wp-block-image
![](https://techcommunity.microsoft.com/t5/image/serverpage/image-id/278728i3B1CBC4AFF3283AB/image-size/medium?v=v2&px=400 "LinkeD365_9-1620296727183.png"){.lia-media-image
role="button"
li-image-url="https://techcommunity.microsoft.com/t5/image/serverpage/image-id/278728i3B1CBC4AFF3283AB?v=v2"
li-image-display-id="'278728i3B1CBC4AFF3283AB'"
li-message-uid="'2330775'" li-messages-message-image="true"
li-bindable="" tabindex="0" li-bypass-lightbox-when-linked="true"
li-use-hover-links="false"}
:::

Now, this is where we need to use the values you saved (you did save
them?) when you were registering your app
up [here](https://linked365.blog/2021/05/06/using-power-automate-and-graph-api-to-manage-external-access-to-teams/#Granting-Permissions).
Client Id is populated with the Application (client) ID, the Client
secret is populated with the Value from the Client Secret grid. Login
URL will be populated for you. The Resource URL value should be
<https://graph.microsoft.com.Select> Create Connector now, as you need
the Redirect URL, created when you create the connector to put back into
your App registration to complete the security process.

 

::: wp-block-image
![](https://techcommunity.microsoft.com/t5/image/serverpage/image-id/278729i2177D603AC6DB247/image-size/medium?v=v2&px=400 "LinkeD365_10-1620296727075.png"){.lia-media-image
role="button"
li-image-url="https://techcommunity.microsoft.com/t5/image/serverpage/image-id/278729i2177D603AC6DB247?v=v2"
li-image-display-id="'278729i2177D603AC6DB247'"
li-message-uid="'2330775'" li-messages-message-image="true"
li-bindable="" tabindex="0" li-bypass-lightbox-when-linked="true"
li-use-hover-links="false"}
:::

I *think* that this is now standard, but just in case, copy the Redirect
URL and go back to your App Registration in Azure AD. Click on the link
highlighted.

::: wp-block-image
![](https://techcommunity.microsoft.com/t5/image/serverpage/image-id/278732i946DB0EABD8A40CC/image-size/medium?v=v2&px=400 "LinkeD365_11-1620296727170.png"){.lia-media-image
role="button"
li-image-url="https://techcommunity.microsoft.com/t5/image/serverpage/image-id/278732i946DB0EABD8A40CC?v=v2"
li-image-display-id="'278732i946DB0EABD8A40CC'"
li-message-uid="'2330775'" li-messages-message-image="true"
li-bindable="" tabindex="0" li-bypass-lightbox-when-linked="true"
li-use-hover-links="false"}
:::

Select Add a platform then chose Web. Enter the Redirect URL from the
Custom Connector. Now we are ready to define the actions for our
connector.

### Creating the Actions {#toc-hId--905761508}

For our flow, we need 3 actions, Get the owners of a team, Get a user
and Invite a User. This is where Graph Explorer and Postman help. You
need to establish what you are sending and what you expect back for each
action. For example, lets walk through the Get Owners of a team.

 

Select New Action and Populate General section. The Operation ID needs
to be unique and is what appears within Power Automate when you select
it.

::: wp-block-image
![](https://techcommunity.microsoft.com/t5/image/serverpage/image-id/278731i12760317B955FB81/image-size/medium?v=v2&px=400 "LinkeD365_12-1620296727067.png"){.lia-media-image
role="button"
li-image-url="https://techcommunity.microsoft.com/t5/image/serverpage/image-id/278731i12760317B955FB81?v=v2"
li-image-display-id="'278731i12760317B955FB81'"
li-message-uid="'2330775'" li-messages-message-image="true"
li-bindable="" tabindex="0" li-bypass-lightbox-when-linked="true"
li-use-hover-links="false"}
:::

I usually use the same for each, but be creative and descriptive. Select
Import from sample then use the url below as the URL and select Get as
the Verb.

 

URL -- <https://graph.microsoft.com/v1.0/groups/%7BteamId%7D/owners>

::: wp-block-image
![](https://techcommunity.microsoft.com/t5/image/serverpage/image-id/278733i2CC688EEC790F524/image-size/medium?v=v2&px=400 "LinkeD365_13-1620296727114.png"){.lia-media-image
role="button"
li-image-url="https://techcommunity.microsoft.com/t5/image/serverpage/image-id/278733i2CC688EEC790F524?v=v2"
li-image-display-id="'278733i2CC688EEC790F524'"
li-message-uid="'2330775'" li-messages-message-image="true"
li-bindable="" tabindex="0" li-bypass-lightbox-when-linked="true"
li-use-hover-links="false"}
:::

By placing teamid in curly brackets { } you denote to the custom
connector you want to use a parameter in that URL. You can call
<https://graph.microsoft.com/v1.0/groups/%7BteamId>} (without the
/owners) but that will return the detail from the group. In this I want
get associated data, hence the /owners.

 

Select Import. You are returned to the definition screen, where we can
see that the request has been populated for us.

::: wp-block-image
![](https://techcommunity.microsoft.com/t5/image/serverpage/image-id/278734iF6F5147136A1897F/image-size/medium?v=v2&px=400 "LinkeD365_14-1620296727100.png"){.lia-media-image
role="button"
li-image-url="https://techcommunity.microsoft.com/t5/image/serverpage/image-id/278734iF6F5147136A1897F?v=v2"
li-image-display-id="'278734iF6F5147136A1897F'"
li-message-uid="'2330775'" li-messages-message-image="true"
li-bindable="" tabindex="0" li-bypass-lightbox-when-linked="true"
li-use-hover-links="false"}
:::

We are ready to test our Get Owners now. Update the connector once more
then head over to the Test tab. You will have to create a connection if
not already done, which prompts you to establish who you are running the
connector under (only for testing). Then supply a team id. These can be
found by using Graph Explorer to find all teams. Hit the Test operation
and if everything is working you will get a 200 response with some JSON
in a body showing you all the information about the owners.

::: wp-block-image
![](https://techcommunity.microsoft.com/t5/image/serverpage/image-id/278735iC11272B604C84DE8/image-size/medium?v=v2&px=400 "LinkeD365_15-1620296727218.png"){.lia-media-image
role="button"
li-image-url="https://techcommunity.microsoft.com/t5/image/serverpage/image-id/278735iC11272B604C84DE8?v=v2"
li-image-display-id="'278735iC11272B604C84DE8'"
li-message-uid="'2330775'" li-messages-message-image="true"
li-bindable="" tabindex="0" li-bypass-lightbox-when-linked="true"
li-use-hover-links="false"}
:::

To just define the others

#### Get User {#toc-hId--215200034}

Verb: Get, URL: <https://graph.microsoft.com/v1.0/users?$filter=>

#### Invite User {#toc-hId--2022654497}

Verb: Put, URL: <https://graph.microsoft.com/v1.0/invitations>, Body is
below, as you need to define a new invite, with the required parameters.
The data doesn't matter, just the parameters that you need to pass.

``` {.lia-code-sample .language-json}
{
    "invitedUserEmailAddress": "emailaddress",
    "inviteRedirectUrl": "https://myapp.contoso.com",
    "invitedUserDisplayName": "Testy McTest",
    "sendInvitationMessage": true
}
```

Make sure you test all your actions and lets move on to the Form.

## Microsoft Form To Capture Information {#toc-hId--236206242}

Not going to dwell here, as others are doing a much better job at
describing Forms. Basically, a simple form to define First and Last
name, the email address and a choice field to define which team the user
wants access to.

::: wp-block-image
![](https://techcommunity.microsoft.com/t5/image/serverpage/image-id/278736iF5AABAE9C3D7BBF8/image-size/medium?v=v2&px=400 "LinkeD365_16-1620296727638.png"){.lia-media-image
role="button"
li-image-url="https://techcommunity.microsoft.com/t5/image/serverpage/image-id/278736iF5AABAE9C3D7BBF8?v=v2"
li-image-display-id="'278736iF5AABAE9C3D7BBF8'"
li-message-uid="'2330775'" li-messages-message-image="true"
li-bindable="" tabindex="0" li-bypass-lightbox-when-linked="true"
li-use-hover-links="false"}
:::

The teams list will have to be maintained to those that you want the
public to be able to request access to.

 

Finally, lets take a look at the flow.

## Power Automate Definition {#toc-hId--2043660705}

This Flow is triggered by a new response being submitted against the
Form defined above. Next, get the response details.

::: wp-block-image
![](https://techcommunity.microsoft.com/t5/image/serverpage/image-id/278737i7F18D99AAA7E5490/image-size/medium?v=v2&px=400 "LinkeD365_17-1620296727108.png"){.lia-media-image
role="button"
li-image-url="https://techcommunity.microsoft.com/t5/image/serverpage/image-id/278737i7F18D99AAA7E5490?v=v2"
li-image-display-id="'278737i7F18D99AAA7E5490'"
li-message-uid="'2330775'" li-messages-message-image="true"
li-bindable="" tabindex="0" li-bypass-lightbox-when-linked="true"
li-use-hover-links="false"}
:::

Next, retrieve all the Teams in your environment. This will return a
JSON object which defines an array of Team definitions. We need to
filter that to the one the user selected so that we can get the team id.

::: wp-block-image
![](https://techcommunity.microsoft.com/t5/image/serverpage/image-id/278739i5E65D6B9EE1F5D98/image-size/medium?v=v2&px=400 "LinkeD365_18-1620296726929.png"){.lia-media-image
role="button"
li-image-url="https://techcommunity.microsoft.com/t5/image/serverpage/image-id/278739i5E65D6B9EE1F5D98?v=v2"
li-image-display-id="'278739i5E65D6B9EE1F5D98'"
li-message-uid="'2330775'" li-messages-message-image="true"
li-bindable="" tabindex="0" li-bypass-lightbox-when-linked="true"
li-use-hover-links="false"}
:::

To do this, I use the Filter Array action, pass in the output from the
List Teams and ensure we select where team Name is equal to the team
selected (the Which Team? field in my case).

::: wp-block-image
![](https://techcommunity.microsoft.com/t5/image/serverpage/image-id/278738i472750509E2B0643/image-size/medium?v=v2&px=400 "LinkeD365_19-1620296726827.png"){.lia-media-image
role="button"
li-image-url="https://techcommunity.microsoft.com/t5/image/serverpage/image-id/278738i472750509E2B0643?v=v2"
li-image-display-id="'278738i472750509E2B0643'"
li-message-uid="'2330775'" li-messages-message-image="true"
li-bindable="" tabindex="0" li-bypass-lightbox-when-linked="true"
li-use-hover-links="false"}
:::

Next, is a compose statement. I do that just to simplify the way the
flow works, as the return of filter array is an array, and I just want
the first one.

::: wp-block-image
![](https://techcommunity.microsoft.com/t5/image/serverpage/image-id/278740i08DF731CA5EF6648/image-size/medium?v=v2&px=400 "LinkeD365_20-1620296726837.png"){.lia-media-image
role="button"
li-image-url="https://techcommunity.microsoft.com/t5/image/serverpage/image-id/278740i08DF731CA5EF6648?v=v2"
li-image-display-id="'278740i08DF731CA5EF6648'"
li-message-uid="'2330775'" li-messages-message-image="true"
li-bindable="" tabindex="0" li-bypass-lightbox-when-linked="true"
li-use-hover-links="false"}
:::

``` {.lia-code-sample .language-json}
body('Filter_array')[0]?['id']
```

Next, lets get the Owners of the team selected, using the Id just
retrieved. This is the first time using the Custom Connector, it is
available under the Custom Tab.

::: wp-block-image
![](https://techcommunity.microsoft.com/t5/image/serverpage/image-id/278741iA891B0D0C5FFEADE/image-size/medium?v=v2&px=400 "LinkeD365_21-1620296726920.png"){.lia-media-image
role="button"
li-image-url="https://techcommunity.microsoft.com/t5/image/serverpage/image-id/278741iA891B0D0C5FFEADE?v=v2"
li-image-display-id="'278741iA891B0D0C5FFEADE'"
li-message-uid="'2330775'" li-messages-message-image="true"
li-bindable="" tabindex="0" li-bypass-lightbox-when-linked="true"
li-use-hover-links="false"}
:::

Selecting the connector will show the actions or triggers available.

::: wp-block-image
![](https://techcommunity.microsoft.com/t5/image/serverpage/image-id/278742iA347FA871C4BB576/image-size/medium?v=v2&px=400 "LinkeD365_22-1620296726951.png"){.lia-media-image
role="button"
li-image-url="https://techcommunity.microsoft.com/t5/image/serverpage/image-id/278742iA347FA871C4BB576?v=v2"
li-image-display-id="'278742iA347FA871C4BB576'"
li-message-uid="'2330775'" li-messages-message-image="true"
li-bindable="" tabindex="0" li-bypass-lightbox-when-linked="true"
li-use-hover-links="false"}
:::

The parameters are those that were defined in the Custom connector,
passing in the output from the compose above.

::: wp-block-image
![](https://techcommunity.microsoft.com/t5/image/serverpage/image-id/278743iC144E51B4C93AB12/image-size/medium?v=v2&px=400 "LinkeD365_23-1620296726812.png"){.lia-media-image
role="button"
li-image-url="https://techcommunity.microsoft.com/t5/image/serverpage/image-id/278743iC144E51B4C93AB12?v=v2"
li-image-display-id="'278743iC144E51B4C93AB12'"
li-message-uid="'2330775'" li-messages-message-image="true"
li-bindable="" tabindex="0" li-bypass-lightbox-when-linked="true"
li-use-hover-links="false"}
:::

Now, the response back from Get Owners is a JSON object, so next, Parse
the JSON so there is a list of JSON objects for the flow to use. All
that is needed in the approval that comes next is the email address(es)
of the return from the owners call. But the approval needs a semi-colon
separated list of emails. To achieve this, firstly use a Select to just
return the email address from the JSON object, then join the output to
that with a semi colon.

::: wp-block-image
![](https://techcommunity.microsoft.com/t5/image/serverpage/image-id/278744iAFFCE77F8C1CDB17/image-size/medium?v=v2&px=400 "LinkeD365_24-1620296727149.png"){.lia-media-image
role="button"
li-image-url="https://techcommunity.microsoft.com/t5/image/serverpage/image-id/278744iAFFCE77F8C1CDB17?v=v2"
li-image-display-id="'278744iAFFCE77F8C1CDB17'"
li-message-uid="'2330775'" li-messages-message-image="true"
li-bindable="" tabindex="0" li-bypass-lightbox-when-linked="true"
li-use-hover-links="false"}
:::

Next, start an approval. This is populated to let the owner know who has
asked for access to the team and which team.

::: wp-block-image
![](https://techcommunity.microsoft.com/t5/image/serverpage/image-id/278745i9D5BBBB41CFEFFBF/image-size/medium?v=v2&px=400 "LinkeD365_25-1620296726984.png"){.lia-media-image
role="button"
li-image-url="https://techcommunity.microsoft.com/t5/image/serverpage/image-id/278745i9D5BBBB41CFEFFBF?v=v2"
li-image-display-id="'278745i9D5BBBB41CFEFFBF'"
li-message-uid="'2330775'" li-messages-message-image="true"
li-bindable="" tabindex="0" li-bypass-lightbox-when-linked="true"
li-use-hover-links="false"}
:::

Check whether the response is positive. If this was for production, I
would probably send an email to the requesting user to let them know
that they were denied access. You could also use the response written in
the rejection.

::: wp-block-image
![](https://techcommunity.microsoft.com/t5/image/serverpage/image-id/278746i6FCB1C1D739F03C4/image-size/medium?v=v2&px=400 "LinkeD365_26-1620296726933.png"){.lia-media-image
role="button"
li-image-url="https://techcommunity.microsoft.com/t5/image/serverpage/image-id/278746i6FCB1C1D739F03C4?v=v2"
li-image-display-id="'278746i6FCB1C1D739F03C4'"
li-message-uid="'2330775'" li-messages-message-image="true"
li-bindable="" tabindex="0" li-bypass-lightbox-when-linked="true"
li-use-hover-links="false"}
:::

In the Yes path, call the Custom connector again to check if the user is
already a part of your organisation as a guest user. As the parameter is
expecting a query, use the expression below

::: wp-block-image
![](https://techcommunity.microsoft.com/t5/image/serverpage/image-id/278748i62EBF6746B590C70/image-size/medium?v=v2&px=400 "LinkeD365_27-1620296726901.png"){.lia-media-image
role="button"
li-image-url="https://techcommunity.microsoft.com/t5/image/serverpage/image-id/278748i62EBF6746B590C70?v=v2"
li-image-display-id="'278748i62EBF6746B590C70'"
li-message-uid="'2330775'" li-messages-message-image="true"
li-bindable="" tabindex="0" li-bypass-lightbox-when-linked="true"
li-use-hover-links="false"}
:::

mail eq 'Email Parameter from the Form response'

``` {.lia-code-sample .language-json}
mail eq 'Email Parameter from the Form response'
```

 

Next, check the length of the returned object from the custom connector.
This basically checks if the user already belongs to your environment.

::: wp-block-image
![](https://techcommunity.microsoft.com/t5/image/serverpage/image-id/278747iDE1C834645FBE6A0/image-size/medium?v=v2&px=400 "LinkeD365_28-1620296726899.png"){.lia-media-image
role="button"
li-image-url="https://techcommunity.microsoft.com/t5/image/serverpage/image-id/278747iDE1C834645FBE6A0?v=v2"
li-image-display-id="'278747iDE1C834645FBE6A0'"
li-message-uid="'2330775'" li-messages-message-image="true"
li-bindable="" tabindex="0" li-bypass-lightbox-when-linked="true"
li-use-hover-links="false"}
:::

``` wp-block-code
length(outputs('GetUser')?['body/value'])
```

 

If there is a value in the return, use the return to invite the user to
the team.

::: wp-block-image
![](https://techcommunity.microsoft.com/t5/image/serverpage/image-id/278749iFB862B74F014B55D/image-size/medium?v=v2&px=400 "LinkeD365_29-1620296726913.png"){.lia-media-image
role="button"
li-image-url="https://techcommunity.microsoft.com/t5/image/serverpage/image-id/278749iFB862B74F014B55D?v=v2"
li-image-display-id="'278749iFB862B74F014B55D'"
li-message-uid="'2330775'" li-messages-message-image="true"
li-bindable="" tabindex="0" li-bypass-lightbox-when-linked="true"
li-use-hover-links="false"}
:::

The User id is returned by using the expression below

``` {.lia-code-sample .language-json}
body('GetUser')?['value'][0]?['id']
```

 

On the negative side, firstly invite the user to your organisation by
using the final action of the custom connector.

::: wp-block-image
![](https://techcommunity.microsoft.com/t5/image/serverpage/image-id/278751i0CF826AB0B282F23/image-size/medium?v=v2&px=400 "LinkeD365_30-1620296727013.png"){.lia-media-image
role="button"
li-image-url="https://techcommunity.microsoft.com/t5/image/serverpage/image-id/278751i0CF826AB0B282F23?v=v2"
li-image-display-id="'278751i0CF826AB0B282F23'"
li-message-uid="'2330775'" li-messages-message-image="true"
li-bindable="" tabindex="0" li-bypass-lightbox-when-linked="true"
li-use-hover-links="false"}
:::

And finally, use the response from your custom connector, the invited
user to the team.

::: wp-block-image
![](https://techcommunity.microsoft.com/t5/image/serverpage/image-id/278750i582EA815223E2E4E/image-size/medium?v=v2&px=400 "LinkeD365_31-1620296727008.png"){.lia-media-image
role="button"
li-image-url="https://techcommunity.microsoft.com/t5/image/serverpage/image-id/278750i582EA815223E2E4E?v=v2"
li-image-display-id="'278750i582EA815223E2E4E'"
li-message-uid="'2330775'" li-messages-message-image="true"
li-bindable="" tabindex="0" li-bypass-lightbox-when-linked="true"
li-use-hover-links="false"}
:::

That\'s it! There is a lot of configuration here, but you can see how
you can extend your usage of Power Automate to automate a function
usually confined to manual work by the team owner.\
\
This post was originally published on
[LinkeD365.blog](https://linked365.blog/2021/05/06/using-power-automate-and-graph-api-to-manage-external-access-to-teams/)
:::
:::
:::
:::

::: {#tagsList .TagList .lia-component-tags .lia-component-message-view-widget-tags-list}
-   Tags:
-   [forms](/t5/tag/forms/tg-p/board-id/Microsoft365PnPBlog){#link_7
    .lia-link-navigation .lia-tag .tag .tag-676 .lia-js-data-tagUid-676}

    ::: {.tag-list-js-confirmation .hidden}
    :::
-   [GraphAPI](/t5/tag/GraphAPI/tg-p/board-id/Microsoft365PnPBlog){#link_8
    .lia-link-navigation .lia-tag .tag .tag-11207
    .lia-js-data-tagUid-11207}

    ::: {.tag-list-js-confirmation .hidden}
    :::
-   [Power
    Automate](/t5/tag/Power%20Automate/tg-p/board-id/Microsoft365PnPBlog){#link_9
    .lia-link-navigation .lia-tag .tag .tag-426886
    .lia-js-data-tagUid-426886}

    ::: {.tag-list-js-confirmation .hidden}
    :::

::: lia-inline-ajax-feedback
::: {#ajaxFeedback .AjaxFeedback}
:::
:::
:::
:::
:::
:::

::: {.lia-quilt-row .lia-quilt-row-footer}
::: {.lia-quilt-column .lia-quilt-column-12 .lia-quilt-column-left .lia-quilt-column-footer-left}
::: {.lia-quilt-column-alley .lia-quilt-column-alley-left}
::: {#kudosButtonV2 .KudosButton .lia-button-image-kudos-wrapper .lia-component-kudos-widget-button-version-3 .lia-component-kudos-widget-button-horizontal .lia-component-kudos-widget-button .lia-component-kudos-action .lia-component-message-view-widget-kudos-action lia-kudos-id="2330775"}
::: {.lia-button-image-kudos .lia-button-image-kudos-horizontal .lia-button-image-kudos-enabled .lia-button-image-kudos-not-kudoed .lia-button-image-kudos-has-kudoes .lia-button-image-kudos-has-kudos .lia-button aria-atomic="true" aria-live="assertive"}
::: lia-button-image-kudos-count
[[ 2 ]{#messageKudosCount_231422bcd7f369 .MessageKudosCount
.lia-component-kudos-widget-message-kudos-count itemprop="upvoteCount"}[
Likes ]{.lia-button-image-kudos-label
.lia-component-kudos-widget-kudos-count-label}](/t5/kudos/messagepage/board-id/Microsoft365PnPBlog/message-id/260/tab/all-users "Click here to see who gave likes to this post."){#link_10
.lia-link-navigation .kudos-count-link}
:::

::: lia-button-image-kudos-give
[Like](https://techcommunity.microsoft.com/t5/blogs/v2/blogarticlepage.kudosbuttonv2.kudoentity:kudoentity/kudosable-gid/2330775?t:ac=blog-id/Microsoft365PnPBlog/article-id/260&t:cp=kudos/contributions/tapletcontributionspage "Click here to give likes to this post."){#kudoEntity
.lia-link-navigation .kudos-link .lia-link-ticket-post-action}
:::
:::
:::
:::
:::

::: {.lia-quilt-column .lia-quilt-column-12 .lia-quilt-column-right .lia-quilt-column-footer-right}
::: {.lia-quilt-column-alley .lia-quilt-column-alley-right}
::: {.lia-button-group .lia-component-comment-button .lia-component-message-view-widget-comment-button}
:::
:::
:::
:::

::: {.lia-quilt-row .lia-quilt-row-mod-controls}
::: {.lia-quilt-column .lia-quilt-column-24 .lia-quilt-column-single .lia-quilt-column-mod-controls-main}
::: {.lia-quilt-column-alley .lia-quilt-column-alley-single .lia-mark-empty}
:::
:::
:::

::: {.lia-quilt-row .lia-quilt-row-sub-footer}
::: {.lia-quilt-column .lia-quilt-column-24 .lia-quilt-column-single .lia-quilt-column-sub-footer .lia-mark-empty}
:::
:::
:::
:::
:::

::: {#progressBar .lia-progress .lia-js-hidden}
::: lia-progress-indeterminate
:::
:::
:::
:::

[]{#comment-on-this} [ ]{#feedback-successinformationbox_7}

::: {#informationbox_7 .InfoMessage .lia-panel-feedback-banner-note .lia-component-comment-editor}
::: {.lia-text role="alert"}
You must be a registered user to add a comment. If you\'ve already
registered, sign in. Otherwise, register and sign in.

-   [Comment](/plugins/common/feature/oauth2sso/sso_login_redirect?lang=en&redirectreason=permissiondenied&referer=https%3A%2F%2Ftechcommunity.microsoft.com%2Ft5%2Fmicrosoft-365-pnp-blog%2Fusing-power-automate-and-graph-api-to-manage-external-access-to%2Fba-p%2F2330775%23comment-on-this){#link_11
    .lia-link-navigation .blog-link .lia-message-comment-post}
:::
:::
:::
:::

::: {.lia-quilt-column .lia-quilt-column-06 .lia-quilt-column-right .lia-quilt-column-side-content}
::: {.lia-quilt-column-alley .lia-quilt-column-alley-right}
%3CLINGO-SUB%20id%3D%22lingo-sub-2330775%22%20slang%3D%22en-US%22%3EUsing%20Power%20Automate%20And%20Graph%20API%20To%20Manage%20External%20Access%20To%20Teams%3C%2FLINGO-SUB%3E%3CLINGO-BODY%20id%3D%22lingo-body-2330775%22%20slang%3D%22en-US%22%3E%3CP%3EMatt%20Collins%20Jones%20and%20I%20presented%3CSPAN%3E%26nbsp%3B%3C%2FSPAN%3E%3CA%20href%3D%22https%3A%2F%2Fd365uguk-22-apr-2021.sessionize.com%2Fsession%2F244458%22%20target%3D%22_blank%22%20rel%3D%22noopener%20nofollow%20noreferrer%22%3EAPI%E2%80%99s%20%E2%80%93%20The%20most%20powerful%20tool%2C%20anyone%20can%20use!%3C%2FA%3E%3CSPAN%3E%26nbsp%3B%3C%2FSPAN%3Efor%20D365%20UG%20and%20Swiss%20Power%20Saturday%20recently%20and%20I%20thought%20it%20would%20be%20good%20to%20share%20the%20Cloud%20Flow%20I%20created%20to%20automate%20the%20onboarding%20of%20external%20users%20to%20a%20Microsoft%20Team.%3C%2FP%3E%0A%3CP%3EThis%20is%20usually%20an%20admin%20driven%20activity%20%E2%80%93%20A%20team%20owner%20will%20have%20to%20type%20in%20the%20email%20address%20for%20each%20guest%20they%20want%20to%20add%2C%20rather%20than%20something%20you%20can%20push%20to%20external%20users%20and%20allow%20them%20to%20request%20access.%3C%2FP%3E%0A%3CP%3EBy%20using%20the%20Graph%20API%20via%20a%20Custom%20Connector%2C%20Microsoft%20Forms%20and%20Power%20Automate%2C%20we%20are%20able%20to%20realise%20this%20quickly%20and%20save%20a%20lot%20of%20time%20and%20effort%20in%20the%20manual%20process.%3C%2FP%3E%0A%3CP%3EAlso%2C%20I%20have%20been%20lucky%20to%20have%20this%20solution%20accepted%20as%20part%20of%20the%20samples%20in%20the%3CSPAN%3E%26nbsp%3B%3C%2FSPAN%3E%3CA%20href%3D%22https%3A%2F%2Fpnp.github.io%2F%22%20target%3D%22_blank%22%20rel%3D%22noreferrer%20noopener%20nofollow%22%20data-type%3D%22URL%22%20data-id%3D%22https%3A%2F%2Fpnp.github.io%2F%22%3EMicrosoft%20Patterns%20And%20Practices%3C%2FA%3E%3CSPAN%3E%26nbsp%3B%3C%2FSPAN%3Einitiative%2C%20so%20the%20Flow%2C%20Custom%20Connector%20and%20implementation%20instructions%20are%20available%20in%20GitHub%3CSPAN%3E%26nbsp%3B%3C%2FSPAN%3E%3CA%20href%3D%22https%3A%2F%2Fgithub.com%2Fpnp%2Fpowerautomate-samples%2Ftree%2Fmain%2Fsamples%2Fteams-invites-via-graph-api%22%20target%3D%22_blank%22%20rel%3D%22noopener%20noreferrer%22%20data-type%3D%22URL%22%20data-id%3D%22https%3A%2F%2Fgithub.com%2Fpnp%2Fpowerautomate-samples%22%3Ehere%3C%2FA%3E.%3C%2FP%3E%0A%3CH2%20id%3D%22toc-hId\--468926889%22%20id%3D%22toc-hId\--468926118%22%3EGetting%20Hands-On%20With%20Graph%3C%2FH2%3E%0A%3CP%3EThe%20main%20part%20of%20this%20flow%20is%20numerous%20calls%20to%20the%3CSPAN%3E%26nbsp%3B%3C%2FSPAN%3E%3CA%20href%3D%22https%3A%2F%2Fdocs.microsoft.com%2Fen-us%2Fgraph%2Foverview%22%20target%3D%22_blank%22%20rel%3D%22noreferrer%20noopener%22%20data-type%3D%22URL%22%20data-id%3D%22https%3A%2F%2Fdocs.microsoft.com%2Fen-us%2Fgraph%2Foverview%22%3EGraph%20API%3C%2FA%3E.%20The%20Graph%20API%20is%20Microsoft%E2%80%99s%20standard%20endpoint%20to%20expose%20and%20interact%20with%20data%20relevant%20to%20your%20tenant.%20It%20includes%20Microsoft%20365%20(such%20as%20Teams%2C%20Exchange%2C%20SharePoint%2C%20Workspace%20Analytics)%2C%20Enterprise%20and%20Mobility%20and%20even%20Windows%2010%20activities%20and%20devices.%20It%20really%20should%20be%20seen%20as%20a%20single%20stop%20shop%20for%20anything%20and%20everything%20in%20your%20tenant.%20The%20only%20thing%20it%20doesn%E2%80%99t%20expose%20is%20D365%20data.%3C%2FP%3E%0A%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3CP%3EThere%20is%20a%3CSPAN%3E%26nbsp%3B%3C%2FSPAN%3E%3CA%20href%3D%22https%3A%2F%2Fdocs.microsoft.com%2Fen-us%2Fconnectors%2Fmicrosoftgraphsecurity%2F%22%20target%3D%22_blank%22%20rel%3D%22noreferrer%20noopener%22%20data-type%3D%22URL%22%20data-id%3D%22https%3A%2F%2Fdocs.microsoft.com%2Fen-us%2Fconnectors%2Fmicrosoftgraphsecurity%2F%22%3EGraph%20connector%3C%2FA%3E%3CSPAN%3E%26nbsp%3B%3C%2FSPAN%3Ealready%20available%20in%20Power%20Automate%2C%20but%20it%20is%20very%20limited%20to%20Security%20considerations.%20Thankfully%2C%20the%20rest%20of%20the%20Graph%20API%20abilities%20are%20available%2C%20but%20you%20have%20to%20go%20via%20a%20custom%20connector.%20You%20could%20call%20these%20directly%20via%20an%20HTTP%20request%20action%2C%20but%20by%20wrapping%20the%20Graph%20API%20in%20a%20connector%2C%20you%20are%20enabling%20other%20members%20of%20your%20organisation%20to%20re-use%20the%20connector%20and%20security%20you%20establish.%3C%2FP%3E%0A%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3CP%3EMicrosoft%20also%20allows%20you%20to%20%E2%80%9Cplay%E2%80%9D%20with%20the%20Graph%20API%20as%20well%2C%20via%20the%3CSPAN%3E%26nbsp%3B%3C%2FSPAN%3E%3CA%20href%3D%22https%3A%2F%2Fdeveloper.microsoft.com%2Fen-us%2Fgraph%2Fgraph-explorer%22%20target%3D%22_blank%22%20rel%3D%22noreferrer%20noopener%22%20data-type%3D%22URL%22%20data-id%3D%22https%3A%2F%2Fdeveloper.microsoft.com%2Fen-us%2Fgraph%2Fgraph-explorer%22%3EGraph%20Explorer%3C%2FA%3E.%20This%20web%20interface%20shows%20you%20all%20the%20sample%20calls%20you%20can%20make%20and%20also%20what%20permissions%20you%20require%20to%20call%20it%20and%20allows%20you%20to%20set%20up%20a%20call%20without%20using%20Power%20Automate%20or%20configuring%20a%20connector.%20It%20really%20should%20be%20the%20starting%20point%20for%20any%20Graph%20Customer%20Connector.%3C%2FP%3E%0A%3CDIV%20class%3D%22wp-block-image%22%3E%0A%3CFIGURE%20class%3D%22aligncenter%20size-large%22%3E%3CSPAN%20class%3D%22lia-inline-image-display-wrapper%20lia-image-align-inline%22%20image-alt%3D%22LinkeD365_0-1620296690001.png%22%20style%3D%22width%3A%20400px%3B%22%3E%3CIMG%20src%3D%22https%3A%2F%2Ftechcommunity.microsoft.com%2Ft5%2Fimage%2Fserverpage%2Fimage-id%2F278720iE6EF5EC2AD373D22%2Fimage-size%2Fmedium%3Fv%3Dv2%26amp%3Bpx%3D400%22%20role%3D%22button%22%20title%3D%22LinkeD365_0-1620296690001.png%22%20alt%3D%22LinkeD365_0-1620296690001.png%22%20%2F%3E%3C%2FSPAN%3E%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3C%2FFIGURE%3E%0A%3C%2FDIV%3E%0A%3CP%3EIf%20things%20go%20wrong%2C%20it%20is%20usually%20around%20the%20permissions.%20Within%20the%20Graph%20Explorer%20you%20can%20consent%20to%20these%20extra%20permissions%20on%20the%20fly%2C%20but%20more%20importantly%2C%20tells%20you%20what%20you%20need%20to%20configure%20in%20the%20permissions%20of%20your%20App%20registration%20to%20allow%20your%20connector%20the%20same%20access.%3C%2FP%3E%0A%3CDIV%20class%3D%22wp-block-image%22%3E%0A%3CFIGURE%20class%3D%22aligncenter%20size-large%22%3E%3CSPAN%20class%3D%22lia-inline-image-display-wrapper%20lia-image-align-inline%22%20image-alt%3D%22LinkeD365_1-1620296689997.png%22%20style%3D%22width%3A%20400px%3B%22%3E%3CIMG%20src%3D%22https%3A%2F%2Ftechcommunity.microsoft.com%2Ft5%2Fimage%2Fserverpage%2Fimage-id%2F278721i3E87D2001F9D266F%2Fimage-size%2Fmedium%3Fv%3Dv2%26amp%3Bpx%3D400%22%20role%3D%22button%22%20title%3D%22LinkeD365_1-1620296689997.png%22%20alt%3D%22LinkeD365_1-1620296689997.png%22%20%2F%3E%3C%2FSPAN%3E%3CH2%20id%3D%22toc-hId-2018585944%22%20id%3D%22toc-hId-2018586715%22%3E%26nbsp%3B%3C%2FH2%3E%0A%3CH2%20id%3D%22Granting-Permissions%22%20id%3D%22toc-hId-211131481%22%20id%3D%22toc-hId-211132252%22%3EGranting%20Permissions%3C%2FH2%3E%0A%3CP%3ENow%20that%20we%20understand%20what%20permissions%20that%20are%20needed%20to%20get%20at%20the%20actions%20required%2C%20let%E2%80%99s%20jump%20in%20and%20create%20an%3CSPAN%3E%26nbsp%3B%3C%2FSPAN%3E%3CA%20href%3D%22https%3A%2F%2Fdocs.microsoft.com%2Fen-us%2Fazure%2Factive-directory%2Fdevelop%2Fquickstart-register-app%22%20target%3D%22_blank%22%20rel%3D%22noreferrer%20noopener%22%20data-type%3D%22URL%22%20data-id%3D%22https%3A%2F%2Fdocs.microsoft.com%2Fen-us%2Fazure%2Factive-directory%2Fdevelop%2Fquickstart-register-app%22%3EAzure%20App%20Registration%3C%2FA%3E.%20This%20allows%20you%20to%20grant%20rights%20to%20a%20particular%20application%2C%20which%20presents%20a%20client%20secret%20and%20App%20ID%20as%20part%20of%20the%20request.%20By%20doing%20this%20registration%2C%20you%20establish%20trust%20between%20your%20app%20(Custom%20Connector%20in%20our%20case)%20and%20your%20tenant.%3C%2FP%3E%0A%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3CP%3ENavigate%20to%3CSPAN%3E%26nbsp%3B%3C%2FSPAN%3E%3CA%20href%3D%22https%3A%2F%2Faad.portal.azure.com%2F%22%20target%3D%22_blank%22%20rel%3D%22noreferrer%20noopener%20nofollow%22%3Ehttps%3A%2F%2Faad.portal.azure.com%3C%2FA%3E%3CSPAN%3E%26nbsp%3B%3C%2FSPAN%3Eand%20log%20in.%20Select%20Azure%20Active%20Directory%20then%20App%20registrations.%20Select%20New%2C%20give%20it%20an%20appropriate%20name%20then%20hit%20Register.%3C%2FP%3E%0A%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3CP%3EIn%20the%20next%20screen%2C%20record%20the%20Application%20Id%2C%20going%20to%20need%20it%20later.%20On%20the%20left%2C%20select%20Certificates%20%26amp%3B%20secrets%3C%2FP%3E%0A%3CDIV%20class%3D%22wp-block-image%22%3E%0A%3CFIGURE%20class%3D%22aligncenter%20size-large%22%3E%3CSPAN%20class%3D%22lia-inline-image-display-wrapper%20lia-image-align-inline%22%20image-alt%3D%22LinkeD365_2-1620296727206.png%22%20style%3D%22width%3A%20400px%3B%22%3E%3CIMG%20src%3D%22https%3A%2F%2Ftechcommunity.microsoft.com%2Ft5%2Fimage%2Fserverpage%2Fimage-id%2F278723i33D3954CC917EE20%2Fimage-size%2Fmedium%3Fv%3Dv2%26amp%3Bpx%3D400%22%20role%3D%22button%22%20title%3D%22LinkeD365_2-1620296727206.png%22%20alt%3D%22LinkeD365_2-1620296727206.png%22%20%2F%3E%3C%2FSPAN%3E%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3C%2FFIGURE%3E%0A%3C%2FDIV%3E%0A%3CP%3ESelect%20New%20client%20secret%20give%20it%20a%20name%20%26amp%3B%20expiry%20date%20and%20select%20Save.%3C%2FP%3E%0A%3CDIV%20class%3D%22wp-block-image%22%3E%0A%3CFIGURE%20class%3D%22aligncenter%20size-large%22%3E%3CSPAN%20class%3D%22lia-inline-image-display-wrapper%20lia-image-align-inline%22%20image-alt%3D%22LinkeD365_3-1620296726932.png%22%20style%3D%22width%3A%20400px%3B%22%3E%3CIMG%20src%3D%22https%3A%2F%2Ftechcommunity.microsoft.com%2Ft5%2Fimage%2Fserverpage%2Fimage-id%2F278722i17C94A6316C64A72%2Fimage-size%2Fmedium%3Fv%3Dv2%26amp%3Bpx%3D400%22%20role%3D%22button%22%20title%3D%22LinkeD365_3-1620296726932.png%22%20alt%3D%22LinkeD365_3-1620296726932.png%22%20%2F%3E%3C%2FSPAN%3E%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3C%2FFIGURE%3E%0A%3C%2FDIV%3E%0A%3CP%3EEnsure%20you%20copy%20the%20Value%20here%2C%20you%20will%20only%20be%20able%20to%20see%20this%20for%20a%20short%20while%2C%20if%20you%20navigate%20away%20it%20will%20be%20gone.%20Not%20a%20big%20deal%2C%20just%20recreate%20the%20client%20secret%2C%20but%20you%20will%20need%20it%20later.%20Now%20select%20API%20permissions.%20This%20will%20list%20what%20permissions%20this%20registration%20has%2C%20and%20by%20inference%2C%20the%20caller%20using%20the%20client%20secret%2Fapplication%20id.%3C%2FP%3E%0A%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3CP%3ESelect%20the%20Add%20a%20permission%20button.%3C%2FP%3E%0A%3CDIV%20class%3D%22wp-block-image%22%3E%0A%3CFIGURE%20class%3D%22aligncenter%20size-large%22%3E%3CSPAN%20class%3D%22lia-inline-image-display-wrapper%20lia-image-align-inline%22%20image-alt%3D%22LinkeD365_4-1620296727532.png%22%20style%3D%22width%3A%20400px%3B%22%3E%3CIMG%20src%3D%22https%3A%2F%2Ftechcommunity.microsoft.com%2Ft5%2Fimage%2Fserverpage%2Fimage-id%2F278724i9E666341ADBF0C54%2Fimage-size%2Fmedium%3Fv%3Dv2%26amp%3Bpx%3D400%22%20role%3D%22button%22%20title%3D%22LinkeD365_4-1620296727532.png%22%20alt%3D%22LinkeD365_4-1620296727532.png%22%20%2F%3E%3C%2FSPAN%3E%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3C%2FFIGURE%3E%0A%3C%2FDIV%3E%0A%3CP%3EThis%20presents%20a%20choice%20of%20which%20API%20to%20expose.%20The%20first%20on%20the%20list%20is%20Microsoft%20Graph%2C%20the%20one%20we%20want.%3C%2FP%3E%0A%3CDIV%20class%3D%22wp-block-image%22%3E%0A%3CFIGURE%20class%3D%22aligncenter%20size-large%22%3E%3CSPAN%20class%3D%22lia-inline-image-display-wrapper%20lia-image-align-inline%22%20image-alt%3D%22LinkeD365_5-1620296727260.png%22%20style%3D%22width%3A%20400px%3B%22%3E%3CIMG%20src%3D%22https%3A%2F%2Ftechcommunity.microsoft.com%2Ft5%2Fimage%2Fserverpage%2Fimage-id%2F278725i65C0C81ACBD86229%2Fimage-size%2Fmedium%3Fv%3Dv2%26amp%3Bpx%3D400%22%20role%3D%22button%22%20title%3D%22LinkeD365_5-1620296727260.png%22%20alt%3D%22LinkeD365_5-1620296727260.png%22%20%2F%3E%3C%2FSPAN%3E%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3C%2FFIGURE%3E%0A%3C%2FDIV%3E%0A%3CP%3ESelect%20Delegated%20Permissions%20(Custom%20connectors%20doesn\'t%20support%20Application%20permissions%20yet%2C%20will%20run%20in%20the%20context%20of%20the%20person%20who%20runs%20the%20flow%2C%20so%20use%20an%20admin%2Fsystem%20account)%20then%20type%20in%20the%20permission%20you%20want%2C%20listed%20here.%3C%2FP%3E%0A%3CUL%3E%0A%3CLI%3EDirectory.ReadWrite.All%3C%2FLI%3E%0A%3CLI%3EUser.Invite.All%3C%2FLI%3E%0A%3CLI%3EUser.ReadWrite.All%3C%2FLI%3E%0A%3C%2FUL%3E%0A%3CDIV%20class%3D%22wp-block-image%22%3E%0A%3CFIGURE%20class%3D%22aligncenter%20size-large%22%3E%3CSPAN%20class%3D%22lia-inline-image-display-wrapper%20lia-image-align-inline%22%20image-alt%3D%22LinkeD365_6-1620296727107.png%22%20style%3D%22width%3A%20400px%3B%22%3E%3CIMG%20src%3D%22https%3A%2F%2Ftechcommunity.microsoft.com%2Ft5%2Fimage%2Fserverpage%2Fimage-id%2F278726iA101607BA2412A4B%2Fimage-size%2Fmedium%3Fv%3Dv2%26amp%3Bpx%3D400%22%20role%3D%22button%22%20title%3D%22LinkeD365_6-1620296727107.png%22%20alt%3D%22LinkeD365_6-1620296727107.png%22%20%2F%3E%3C%2FSPAN%3E%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3C%2FFIGURE%3E%0A%3C%2FDIV%3E%0A%3CP%3ESelect%20Add%20Permissions%20to%20return%20you%20to%20the%20Configured%20permissions%20screen%2C%20then%20select%20Grant%20Admin%20consent%20button.%20This%20shortcuts%20and%20pre-approves%20the%20app.%3C%2FP%3E%0A%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3CP%3ELeave%20this%20tab%20open%20and%20let%E2%80%99s%20go%20and%20define%20our%20custom%20connector.%3C%2FP%3E%0A%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3CH2%20id%3D%22toc-hId\--1596322982%22%20id%3D%22toc-hId\--1596322211%22%3EDefining%20The%20Custom%20Connector%3C%2FH2%3E%0A%3CP%3EJan%20Bakker%20has%20done%20an%20excellent%20job%20of%20walking%20you%20through%20this%2C%3CSPAN%3E%26nbsp%3B%3C%2FSPAN%3E%3CA%20href%3D%22https%3A%2F%2Fpowerusers.microsoft.com%2Ft5%2FPower-Automate-Community-Blog%2FBuild-a-custom-connector-for-Microsoft-Graph-API%2Fba-p%2F647492%22%20target%3D%22_blank%22%20rel%3D%22noreferrer%20noopener%22%20data-type%3D%22URL%22%20data-id%3D%22https%3A%2F%2Fpowerusers.microsoft.com%2Ft5%2FPower-Automate-Community-Blog%2FBuild-a-custom-connector-for-Microsoft-Graph-API%2Fba-p%2F647492%22%3Ehere%3C%2FA%3E.%20His%20article%20goes%20into%20a%20lot%20of%20detail%2C%20so%20I%20will%20just%20take%20you%20through%20what%20is%20needed%20for%20this%20project.%3C%2FP%3E%0A%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3CP%3EIn%20make.powerapps.com%2C%20select%20the%20appropriate%20environment%20and%20chose%20Custom%20Connectors%20under%20Data.%20Then%20select%20New%20custom%20connector.%20You%20can%20import%20from%20various%20sources%2C%20but%20we%20want%20to%20create%20from%20blank%2C%20give%20it%20a%20name%20then%20fill%20out%20the%20next%20page.%3C%2FP%3E%0A%3CDIV%20class%3D%22wp-block-image%22%3E%0A%3CFIGURE%20class%3D%22aligncenter%20size-large%22%3E%3CSPAN%20class%3D%22lia-inline-image-display-wrapper%20lia-image-align-inline%22%20image-alt%3D%22LinkeD365_7-1620296727214.png%22%20style%3D%22width%3A%20400px%3B%22%3E%3CIMG%20src%3D%22https%3A%2F%2Ftechcommunity.microsoft.com%2Ft5%2Fimage%2Fserverpage%2Fimage-id%2F278727iB9538CB3C93155D7%2Fimage-size%2Fmedium%3Fv%3Dv2%26amp%3Bpx%3D400%22%20role%3D%22button%22%20title%3D%22LinkeD365_7-1620296727214.png%22%20alt%3D%22LinkeD365_7-1620296727214.png%22%20%2F%3E%3C%2FSPAN%3E%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3C%2FFIGURE%3E%0A%3C%2FDIV%3E%0A%3CP%3EOn%20the%20next%20screen%2C%20there%20are%20four%20tabs%2C%20which%20we%20need%20to%20step%20through.%20First%20the%20General%20Tab.%3C%2FP%3E%0A%3CDIV%20class%3D%22wp-block-image%22%3E%0A%3CFIGURE%20class%3D%22aligncenter%20size-large%20is-resized%22%3E%3CSPAN%20class%3D%22lia-inline-image-display-wrapper%20lia-image-align-inline%22%20image-alt%3D%22LinkeD365_8-1620296727082.png%22%20style%3D%22width%3A%20400px%3B%22%3E%3CIMG%20src%3D%22https%3A%2F%2Ftechcommunity.microsoft.com%2Ft5%2Fimage%2Fserverpage%2Fimage-id%2F278730i784160EBB968FE0A%2Fimage-size%2Fmedium%3Fv%3Dv2%26amp%3Bpx%3D400%22%20role%3D%22button%22%20title%3D%22LinkeD365_8-1620296727082.png%22%20alt%3D%22LinkeD365_8-1620296727082.png%22%20%2F%3E%3C%2FSPAN%3E%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3C%2FFIGURE%3E%0A%3C%2FDIV%3E%0A%3CP%3EOther%20stuff%20is%20nice%20to%20have%20and%20you%3CSPAN%3E%26nbsp%3B%3C%2FSPAN%3E%3CEM%3Eshould%3CSPAN%3E%26nbsp%3B%3C%2FSPAN%3E%3C%2FEM%3Edocument%20your%20work.%20Ensure%20Scheme%20is%20HTTPS%20and%20Host%2FBase%20URL%20are%20populated.%3C%2FP%3E%0A%3CUL%3E%0A%3CLI%3EHost%20%E2%80%93%20graph.microsoft.com%3C%2FLI%3E%0A%3CLI%3EBase%20URL%20%E2%80%93%20%2Fv1.0%3C%2FLI%3E%0A%3C%2FUL%3E%0A%3CP%3ESelect%20the%20Security%20Tab%20next%2C%20Authentication%20type%20is%20OAuth%202.0.%20You%20should%20be%20presented%20with%20the%20below%20screen.%3C%2FP%3E%0A%3CDIV%20class%3D%22wp-block-image%22%3E%0A%3CFIGURE%20class%3D%22aligncenter%20size-large%22%3E%3CSPAN%20class%3D%22lia-inline-image-display-wrapper%20lia-image-align-inline%22%20image-alt%3D%22LinkeD365_9-1620296727183.png%22%20style%3D%22width%3A%20400px%3B%22%3E%3CIMG%20src%3D%22https%3A%2F%2Ftechcommunity.microsoft.com%2Ft5%2Fimage%2Fserverpage%2Fimage-id%2F278728i3B1CBC4AFF3283AB%2Fimage-size%2Fmedium%3Fv%3Dv2%26amp%3Bpx%3D400%22%20role%3D%22button%22%20title%3D%22LinkeD365_9-1620296727183.png%22%20alt%3D%22LinkeD365_9-1620296727183.png%22%20%2F%3E%3C%2FSPAN%3E%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3C%2FFIGURE%3E%0A%3C%2FDIV%3E%0A%3CP%3ENow%2C%20this%20is%20where%20we%20need%20to%20use%20the%20values%20you%20saved%20(you%20did%20save%20them%3F)%20when%20you%20were%20registering%20your%20app%20up%3CSPAN%3E%26nbsp%3B%3C%2FSPAN%3E%3CA%20href%3D%22https%3A%2F%2Flinked365.blog%2F2021%2F05%2F06%2Fusing-power-automate-and-graph-api-to-manage-external-access-to-teams%2F%23Granting-Permissions%22%20target%3D%22_blank%22%20rel%3D%22noopener%20nofollow%20noreferrer%22%20data-type%3D%22internal%22%20data-id%3D%22%23Granting-Permissions%22%3Ehere%3C%2FA%3E.%20Client%20Id%20is%20populated%20with%20the%20Application%20(client)%20ID%2C%20the%20Client%20secret%20is%20populated%20with%20the%20Value%20from%20the%20Client%20Secret%20grid.%20Login%20URL%20will%20be%20populated%20for%20you.%20The%20Resource%20URL%20value%20should%20be%20%3CA%20href%3D%22https%3A%2F%2Fgraph.microsoft.com.Select%22%20target%3D%22_blank%22%20rel%3D%22noopener%20noreferrer%22%3Ehttps%3A%2F%2Fgraph.microsoft.com.Select%3C%2FA%3E%20Create%20Connector%20now%2C%20as%20you%20need%20the%20Redirect%20URL%2C%20created%20when%20you%20create%20the%20connector%20to%20put%20back%20into%20your%20App%20registration%20to%20complete%20the%20security%20process.%3C%2FP%3E%0A%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3CDIV%20class%3D%22wp-block-image%22%3E%0A%3CFIGURE%20class%3D%22aligncenter%20size-large%22%3E%3CSPAN%20class%3D%22lia-inline-image-display-wrapper%20lia-image-align-inline%22%20image-alt%3D%22LinkeD365_10-1620296727075.png%22%20style%3D%22width%3A%20400px%3B%22%3E%3CIMG%20src%3D%22https%3A%2F%2Ftechcommunity.microsoft.com%2Ft5%2Fimage%2Fserverpage%2Fimage-id%2F278729i2177D603AC6DB247%2Fimage-size%2Fmedium%3Fv%3Dv2%26amp%3Bpx%3D400%22%20role%3D%22button%22%20title%3D%22LinkeD365_10-1620296727075.png%22%20alt%3D%22LinkeD365_10-1620296727075.png%22%20%2F%3E%3C%2FSPAN%3E%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3C%2FFIGURE%3E%0A%3C%2FDIV%3E%0A%3CP%3EI%3CSPAN%3E%26nbsp%3B%3C%2FSPAN%3E%3CEM%3Ethink%3C%2FEM%3E%3CSPAN%3E%26nbsp%3B%3C%2FSPAN%3Ethat%20this%20is%20now%20standard%2C%20but%20just%20in%20case%2C%20copy%20the%20Redirect%20URL%20and%20go%20back%20to%20your%20App%20Registration%20in%20Azure%20AD.%20Click%20on%20the%20link%20highlighted.%3C%2FP%3E%0A%3CDIV%20class%3D%22wp-block-image%22%3E%0A%3CFIGURE%20class%3D%22aligncenter%20size-large%22%3E%3CSPAN%20class%3D%22lia-inline-image-display-wrapper%20lia-image-align-inline%22%20image-alt%3D%22LinkeD365_11-1620296727170.png%22%20style%3D%22width%3A%20400px%3B%22%3E%3CIMG%20src%3D%22https%3A%2F%2Ftechcommunity.microsoft.com%2Ft5%2Fimage%2Fserverpage%2Fimage-id%2F278732i946DB0EABD8A40CC%2Fimage-size%2Fmedium%3Fv%3Dv2%26amp%3Bpx%3D400%22%20role%3D%22button%22%20title%3D%22LinkeD365_11-1620296727170.png%22%20alt%3D%22LinkeD365_11-1620296727170.png%22%20%2F%3E%3C%2FSPAN%3E%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3C%2FFIGURE%3E%0A%3C%2FDIV%3E%0A%3CP%3ESelect%20Add%20a%20platform%20then%20chose%20Web.%20Enter%20the%20Redirect%20URL%20from%20the%20Custom%20Connector.%20Now%20we%20are%20ready%20to%20define%20the%20actions%20for%20our%20connector.%3C%2FP%3E%0A%3CH3%20id%3D%22toc-hId\--905761508%22%20id%3D%22toc-hId\--905760737%22%3ECreating%20the%20Actions%3C%2FH3%3E%0A%3CP%3EFor%20our%20flow%2C%20we%20need%203%20actions%2C%20Get%20the%20owners%20of%20a%20team%2C%20Get%20a%20user%20and%20Invite%20a%20User.%20This%20is%20where%20Graph%20Explorer%20and%20Postman%20help.%20You%20need%20to%20establish%20what%20you%20are%20sending%20and%20what%20you%20expect%20back%20for%20each%20action.%20For%20example%2C%20lets%20walk%20through%20the%20Get%20Owners%20of%20a%20team.%3C%2FP%3E%0A%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3CP%3ESelect%20New%20Action%20and%20Populate%20General%20section.%20The%20Operation%20ID%20needs%20to%20be%20unique%20and%20is%20what%20appears%20within%20Power%20Automate%20when%20you%20select%20it.%3C%2FP%3E%0A%3CDIV%20class%3D%22wp-block-image%22%3E%0A%3CFIGURE%20class%3D%22aligncenter%20size-large%22%3E%3CSPAN%20class%3D%22lia-inline-image-display-wrapper%20lia-image-align-inline%22%20image-alt%3D%22LinkeD365_12-1620296727067.png%22%20style%3D%22width%3A%20400px%3B%22%3E%3CIMG%20src%3D%22https%3A%2F%2Ftechcommunity.microsoft.com%2Ft5%2Fimage%2Fserverpage%2Fimage-id%2F278731i12760317B955FB81%2Fimage-size%2Fmedium%3Fv%3Dv2%26amp%3Bpx%3D400%22%20role%3D%22button%22%20title%3D%22LinkeD365_12-1620296727067.png%22%20alt%3D%22LinkeD365_12-1620296727067.png%22%20%2F%3E%3C%2FSPAN%3E%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3C%2FFIGURE%3E%0A%3C%2FDIV%3E%0A%3CP%3EI%20usually%20use%20the%20same%20for%20each%2C%20but%20be%20creative%20and%20descriptive.%20Select%20Import%20from%20sample%20then%20use%20the%20url%20below%20as%20the%20URL%20and%20select%20Get%20as%20the%20Verb.%3C%2FP%3E%0A%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3CP%3EURL%20%E2%80%93%20%3CA%20href%3D%22https%3A%2F%2Fgraph.microsoft.com%2Fv1.0%2Fgroups%2F%7BteamId%7D%2Fowners%22%20target%3D%22_blank%22%20rel%3D%22noopener%20noreferrer%22%3Ehttps%3A%2F%2Fgraph.microsoft.com%2Fv1.0%2Fgroups%2F%7BteamId%7D%2Fowners%3C%2FA%3E%3C%2FP%3E%0A%3CDIV%20class%3D%22wp-block-image%22%3E%0A%3CFIGURE%20class%3D%22aligncenter%20size-large%22%3E%3CSPAN%20class%3D%22lia-inline-image-display-wrapper%20lia-image-align-inline%22%20image-alt%3D%22LinkeD365_13-1620296727114.png%22%20style%3D%22width%3A%20400px%3B%22%3E%3CIMG%20src%3D%22https%3A%2F%2Ftechcommunity.microsoft.com%2Ft5%2Fimage%2Fserverpage%2Fimage-id%2F278733i2CC688EEC790F524%2Fimage-size%2Fmedium%3Fv%3Dv2%26amp%3Bpx%3D400%22%20role%3D%22button%22%20title%3D%22LinkeD365_13-1620296727114.png%22%20alt%3D%22LinkeD365_13-1620296727114.png%22%20%2F%3E%3C%2FSPAN%3E%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3C%2FFIGURE%3E%0A%3C%2FDIV%3E%0A%3CP%3EBy%20placing%20teamid%20in%20curly%20brackets%20%7B%20%7D%20you%20denote%20to%20the%20custom%20connector%20you%20want%20to%20use%20a%20parameter%20in%20that%20URL.%20You%20can%20call%20%3CA%20href%3D%22https%3A%2F%2Fgraph.microsoft.com%2Fv1.0%2Fgroups%2F%7BteamId%22%20target%3D%22_blank%22%20rel%3D%22noopener%20noreferrer%22%3Ehttps%3A%2F%2Fgraph.microsoft.com%2Fv1.0%2Fgroups%2F%7BteamId%3C%2FA%3E%7D%20(without%20the%20%2Fowners)%20but%20that%20will%20return%20the%20detail%20from%20the%20group.%20In%20this%20I%20want%20get%20associated%20data%2C%20hence%20the%20%2Fowners.%3C%2FP%3E%0A%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3CP%3ESelect%20Import.%20You%20are%20returned%20to%20the%20definition%20screen%2C%20where%20we%20can%20see%20that%20the%20request%20has%20been%20populated%20for%20us.%3C%2FP%3E%0A%3CDIV%20class%3D%22wp-block-image%22%3E%0A%3CFIGURE%20class%3D%22aligncenter%20size-large%22%3E%3CSPAN%20class%3D%22lia-inline-image-display-wrapper%20lia-image-align-inline%22%20image-alt%3D%22LinkeD365_14-1620296727100.png%22%20style%3D%22width%3A%20400px%3B%22%3E%3CIMG%20src%3D%22https%3A%2F%2Ftechcommunity.microsoft.com%2Ft5%2Fimage%2Fserverpage%2Fimage-id%2F278734iF6F5147136A1897F%2Fimage-size%2Fmedium%3Fv%3Dv2%26amp%3Bpx%3D400%22%20role%3D%22button%22%20title%3D%22LinkeD365_14-1620296727100.png%22%20alt%3D%22LinkeD365_14-1620296727100.png%22%20%2F%3E%3C%2FSPAN%3E%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3C%2FFIGURE%3E%0A%3C%2FDIV%3E%0A%3CP%3EWe%20are%20ready%20to%20test%20our%20Get%20Owners%20now.%20Update%20the%20connector%20once%20more%20then%20head%20over%20to%20the%20Test%20tab.%20You%20will%20have%20to%20create%20a%20connection%20if%20not%20already%20done%2C%20which%20prompts%20you%20to%20establish%20who%20you%20are%20running%20the%20connector%20under%20(only%20for%20testing).%20Then%20supply%20a%20team%20id.%20These%20can%20be%20found%20by%20using%20Graph%20Explorer%20to%20find%20all%20teams.%20Hit%20the%20Test%20operation%20and%20if%20everything%20is%20working%20you%20will%20get%20a%20200%20response%20with%20some%20JSON%20in%20a%20body%20showing%20you%20all%20the%20information%20about%20the%20owners.%3C%2FP%3E%0A%3CDIV%20class%3D%22wp-block-image%22%3E%0A%3CFIGURE%20class%3D%22aligncenter%20size-large%22%3E%3CSPAN%20class%3D%22lia-inline-image-display-wrapper%20lia-image-align-inline%22%20image-alt%3D%22LinkeD365_15-1620296727218.png%22%20style%3D%22width%3A%20400px%3B%22%3E%3CIMG%20src%3D%22https%3A%2F%2Ftechcommunity.microsoft.com%2Ft5%2Fimage%2Fserverpage%2Fimage-id%2F278735iC11272B604C84DE8%2Fimage-size%2Fmedium%3Fv%3Dv2%26amp%3Bpx%3D400%22%20role%3D%22button%22%20title%3D%22LinkeD365_15-1620296727218.png%22%20alt%3D%22LinkeD365_15-1620296727218.png%22%20%2F%3E%3C%2FSPAN%3E%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3C%2FFIGURE%3E%0A%3C%2FDIV%3E%0A%3CP%3ETo%20just%20define%20the%20others%3C%2FP%3E%0A%3CH4%20id%3D%22toc-hId\--215200034%22%20id%3D%22toc-hId\--215199263%22%3EGet%20User%3C%2FH4%3E%0A%3CP%3EVerb%3A%20Get%2C%20URL%3A%20%3CA%20href%3D%22https%3A%2F%2Fgraph.microsoft.com%2Fv1.0%2Fusers%3F%24filter%3D%22%20target%3D%22_blank%22%20rel%3D%22noopener%20noreferrer%22%3Ehttps%3A%2F%2Fgraph.microsoft.com%2Fv1.0%2Fusers%3F%24filter%3D%3C%2FA%3E%3C%2FP%3E%0A%3CH4%20id%3D%22toc-hId\--2022654497%22%20id%3D%22toc-hId\--2022653726%22%3EInvite%20User%3C%2FH4%3E%0A%3CP%3EVerb%3A%20Put%2C%20URL%3A%20%3CA%20href%3D%22https%3A%2F%2Fgraph.microsoft.com%2Fv1.0%2Finvitations%22%20target%3D%22_blank%22%20rel%3D%22noopener%20noreferrer%22%3Ehttps%3A%2F%2Fgraph.microsoft.com%2Fv1.0%2Finvitations%3C%2FA%3E%2C%20Body%20is%20below%2C%20as%20you%20need%20to%20define%20a%20new%20invite%2C%20with%20the%20required%20parameters.%20The%20data%20doesn%E2%80%99t%20matter%2C%20just%20the%20parameters%20that%20you%20need%20to%20pass.%3C%2FP%3E%0A%3CPRE%20class%3D%22lia-code-sample%20language-json%22%3E%3CCODE%3E%7B%0A%20%20%20%20%22invitedUserEmailAddress%22%3A%20%22emailaddress%22%2C%0A%20%20%20%20%22inviteRedirectUrl%22%3A%20%22https%3A%2F%2Fmyapp.contoso.com%22%2C%0A%20%20%20%20%22invitedUserDisplayName%22%3A%20%22Testy%20McTest%22%2C%0A%20%20%20%20%22sendInvitationMessage%22%3A%20true%0A%7D%3C%2FCODE%3E%3C%2FPRE%3E%0A%3CP%3EMake%20sure%20you%20test%20all%20your%20actions%20and%20lets%20move%20on%20to%20the%20Form.%3C%2FP%3E%0A%3CH2%20id%3D%22toc-hId\--236206242%22%20id%3D%22toc-hId\--236205471%22%3EMicrosoft%20Form%20To%20Capture%20Information%3C%2FH2%3E%0A%3CP%3ENot%20going%20to%20dwell%20here%2C%20as%20others%20are%20doing%20a%20much%20better%20job%20at%20describing%20Forms.%20Basically%2C%20a%20simple%20form%20to%20define%20First%20and%20Last%20name%2C%20the%20email%20address%20and%20a%20choice%20field%20to%20define%20which%20team%20the%20user%20wants%20access%20to.%3C%2FP%3E%0A%3CDIV%20class%3D%22wp-block-image%22%3E%0A%3CFIGURE%20class%3D%22aligncenter%20size-large%22%3E%3CSPAN%20class%3D%22lia-inline-image-display-wrapper%20lia-image-align-inline%22%20image-alt%3D%22LinkeD365_16-1620296727638.png%22%20style%3D%22width%3A%20400px%3B%22%3E%3CIMG%20src%3D%22https%3A%2F%2Ftechcommunity.microsoft.com%2Ft5%2Fimage%2Fserverpage%2Fimage-id%2F278736iF5AABAE9C3D7BBF8%2Fimage-size%2Fmedium%3Fv%3Dv2%26amp%3Bpx%3D400%22%20role%3D%22button%22%20title%3D%22LinkeD365_16-1620296727638.png%22%20alt%3D%22LinkeD365_16-1620296727638.png%22%20%2F%3E%3C%2FSPAN%3E%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3C%2FFIGURE%3E%0A%3C%2FDIV%3E%0A%3CP%3EThe%20teams%20list%20will%20have%20to%20be%20maintained%20to%20those%20that%20you%20want%20the%20public%20to%20be%20able%20to%20request%20access%20to.%3C%2FP%3E%0A%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3CP%3EFinally%2C%20lets%20take%20a%20look%20at%20the%20flow.%3C%2FP%3E%0A%3CH2%20id%3D%22toc-hId\--2043660705%22%20id%3D%22toc-hId\--2043659934%22%3EPower%20Automate%20Definition%3C%2FH2%3E%0A%3CP%3EThis%20Flow%20is%20triggered%20by%20a%20new%20response%20being%20submitted%20against%20the%20Form%20defined%20above.%20Next%2C%20get%20the%20response%20details.%3C%2FP%3E%0A%3CDIV%20class%3D%22wp-block-image%22%3E%0A%3CFIGURE%20class%3D%22aligncenter%20size-large%22%3E%3CSPAN%20class%3D%22lia-inline-image-display-wrapper%20lia-image-align-inline%22%20image-alt%3D%22LinkeD365_17-1620296727108.png%22%20style%3D%22width%3A%20400px%3B%22%3E%3CIMG%20src%3D%22https%3A%2F%2Ftechcommunity.microsoft.com%2Ft5%2Fimage%2Fserverpage%2Fimage-id%2F278737i7F18D99AAA7E5490%2Fimage-size%2Fmedium%3Fv%3Dv2%26amp%3Bpx%3D400%22%20role%3D%22button%22%20title%3D%22LinkeD365_17-1620296727108.png%22%20alt%3D%22LinkeD365_17-1620296727108.png%22%20%2F%3E%3C%2FSPAN%3E%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3C%2FFIGURE%3E%0A%3C%2FDIV%3E%0A%3CP%3ENext%2C%20retrieve%20all%20the%20Teams%20in%20your%20environment.%20This%20will%20return%20a%20JSON%20object%20which%20defines%20an%20array%20of%20Team%20definitions.%20We%20need%20to%20filter%20that%20to%20the%20one%20the%20user%20selected%20so%20that%20we%20can%20get%20the%20team%20id.%3C%2FP%3E%0A%3CDIV%20class%3D%22wp-block-image%22%3E%0A%3CFIGURE%20class%3D%22aligncenter%20size-large%22%3E%3CSPAN%20class%3D%22lia-inline-image-display-wrapper%20lia-image-align-inline%22%20image-alt%3D%22LinkeD365_18-1620296726929.png%22%20style%3D%22width%3A%20400px%3B%22%3E%3CIMG%20src%3D%22https%3A%2F%2Ftechcommunity.microsoft.com%2Ft5%2Fimage%2Fserverpage%2Fimage-id%2F278739i5E65D6B9EE1F5D98%2Fimage-size%2Fmedium%3Fv%3Dv2%26amp%3Bpx%3D400%22%20role%3D%22button%22%20title%3D%22LinkeD365_18-1620296726929.png%22%20alt%3D%22LinkeD365_18-1620296726929.png%22%20%2F%3E%3C%2FSPAN%3E%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3C%2FFIGURE%3E%0A%3C%2FDIV%3E%0A%3CP%3ETo%20do%20this%2C%20I%20use%20the%20Filter%20Array%20action%2C%20pass%20in%20the%20output%20from%20the%20List%20Teams%20and%20ensure%20we%20select%20where%20team%20Name%20is%20equal%20to%20the%20team%20selected%20(the%20Which%20Team%3F%20field%20in%20my%20case).%3C%2FP%3E%0A%3CDIV%20class%3D%22wp-block-image%22%3E%0A%3CFIGURE%20class%3D%22aligncenter%20size-large%22%3E%3CSPAN%20class%3D%22lia-inline-image-display-wrapper%20lia-image-align-inline%22%20image-alt%3D%22LinkeD365_19-1620296726827.png%22%20style%3D%22width%3A%20400px%3B%22%3E%3CIMG%20src%3D%22https%3A%2F%2Ftechcommunity.microsoft.com%2Ft5%2Fimage%2Fserverpage%2Fimage-id%2F278738i472750509E2B0643%2Fimage-size%2Fmedium%3Fv%3Dv2%26amp%3Bpx%3D400%22%20role%3D%22button%22%20title%3D%22LinkeD365_19-1620296726827.png%22%20alt%3D%22LinkeD365_19-1620296726827.png%22%20%2F%3E%3C%2FSPAN%3E%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3C%2FFIGURE%3E%0A%3C%2FDIV%3E%0A%3CP%3ENext%2C%20is%20a%20compose%20statement.%20I%20do%20that%20just%20to%20simplify%20the%20way%20the%20flow%20works%2C%20as%20the%20return%20of%20filter%20array%20is%20an%20array%2C%20and%20I%20just%20want%20the%20first%20one.%3C%2FP%3E%0A%3CDIV%20class%3D%22wp-block-image%22%3E%0A%3CFIGURE%20class%3D%22aligncenter%20size-large%22%3E%3CSPAN%20class%3D%22lia-inline-image-display-wrapper%20lia-image-align-inline%22%20image-alt%3D%22LinkeD365_20-1620296726837.png%22%20style%3D%22width%3A%20400px%3B%22%3E%3CIMG%20src%3D%22https%3A%2F%2Ftechcommunity.microsoft.com%2Ft5%2Fimage%2Fserverpage%2Fimage-id%2F278740i08DF731CA5EF6648%2Fimage-size%2Fmedium%3Fv%3Dv2%26amp%3Bpx%3D400%22%20role%3D%22button%22%20title%3D%22LinkeD365_20-1620296726837.png%22%20alt%3D%22LinkeD365_20-1620296726837.png%22%20%2F%3E%3C%2FSPAN%3E%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3C%2FFIGURE%3E%0A%3C%2FDIV%3E%0A%3CPRE%20class%3D%22lia-code-sample%20language-json%22%3E%3CCODE%3Ebody(\'Filter_array\')%5B0%5D%3F%5B\'id\'%5D%3C%2FCODE%3E%3C%2FPRE%3E%0A%3CP%3ENext%2C%20lets%20get%20the%20Owners%20of%20the%20team%20selected%2C%20using%20the%20Id%20just%20retrieved.%20This%20is%20the%20first%20time%20using%20the%20Custom%20Connector%2C%20it%20is%20available%20under%20the%20Custom%20Tab.%3C%2FP%3E%0A%3CDIV%20class%3D%22wp-block-image%22%3E%0A%3CFIGURE%20class%3D%22aligncenter%20size-large%22%3E%3CSPAN%20class%3D%22lia-inline-image-display-wrapper%20lia-image-align-inline%22%20image-alt%3D%22LinkeD365_21-1620296726920.png%22%20style%3D%22width%3A%20400px%3B%22%3E%3CIMG%20src%3D%22https%3A%2F%2Ftechcommunity.microsoft.com%2Ft5%2Fimage%2Fserverpage%2Fimage-id%2F278741iA891B0D0C5FFEADE%2Fimage-size%2Fmedium%3Fv%3Dv2%26amp%3Bpx%3D400%22%20role%3D%22button%22%20title%3D%22LinkeD365_21-1620296726920.png%22%20alt%3D%22LinkeD365_21-1620296726920.png%22%20%2F%3E%3C%2FSPAN%3E%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3C%2FFIGURE%3E%0A%3C%2FDIV%3E%0A%3CP%3ESelecting%20the%20connector%20will%20show%20the%20actions%20or%20triggers%20available.%3C%2FP%3E%0A%3CDIV%20class%3D%22wp-block-image%22%3E%0A%3CFIGURE%20class%3D%22aligncenter%20size-large%22%3E%3CSPAN%20class%3D%22lia-inline-image-display-wrapper%20lia-image-align-inline%22%20image-alt%3D%22LinkeD365_22-1620296726951.png%22%20style%3D%22width%3A%20400px%3B%22%3E%3CIMG%20src%3D%22https%3A%2F%2Ftechcommunity.microsoft.com%2Ft5%2Fimage%2Fserverpage%2Fimage-id%2F278742iA347FA871C4BB576%2Fimage-size%2Fmedium%3Fv%3Dv2%26amp%3Bpx%3D400%22%20role%3D%22button%22%20title%3D%22LinkeD365_22-1620296726951.png%22%20alt%3D%22LinkeD365_22-1620296726951.png%22%20%2F%3E%3C%2FSPAN%3E%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3C%2FFIGURE%3E%0A%3C%2FDIV%3E%0A%3CP%3EThe%20parameters%20are%20those%20that%20were%20defined%20in%20the%20Custom%20connector%2C%20passing%20in%20the%20output%20from%20the%20compose%20above.%3C%2FP%3E%0A%3CDIV%20class%3D%22wp-block-image%22%3E%0A%3CFIGURE%20class%3D%22aligncenter%20size-large%22%3E%3CSPAN%20class%3D%22lia-inline-image-display-wrapper%20lia-image-align-inline%22%20image-alt%3D%22LinkeD365_23-1620296726812.png%22%20style%3D%22width%3A%20400px%3B%22%3E%3CIMG%20src%3D%22https%3A%2F%2Ftechcommunity.microsoft.com%2Ft5%2Fimage%2Fserverpage%2Fimage-id%2F278743iC144E51B4C93AB12%2Fimage-size%2Fmedium%3Fv%3Dv2%26amp%3Bpx%3D400%22%20role%3D%22button%22%20title%3D%22LinkeD365_23-1620296726812.png%22%20alt%3D%22LinkeD365_23-1620296726812.png%22%20%2F%3E%3C%2FSPAN%3E%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3C%2FFIGURE%3E%0A%3C%2FDIV%3E%0A%3CP%3ENow%2C%20the%20response%20back%20from%20Get%20Owners%20is%20a%20JSON%20object%2C%20so%20next%2C%20Parse%20the%20JSON%20so%20there%20is%20a%20list%20of%20JSON%20objects%20for%20the%20flow%20to%20use.%20All%20that%20is%20needed%20in%20the%20approval%20that%20comes%20next%20is%20the%20email%20address(es)%20of%20the%20return%20from%20the%20owners%20call.%20But%20the%20approval%20needs%20a%20semi-colon%20separated%20list%20of%20emails.%20To%20achieve%20this%2C%20firstly%20use%20a%20Select%20to%20just%20return%20the%20email%20address%20from%20the%20JSON%20object%2C%20then%20join%20the%20output%20to%20that%20with%20a%20semi%20colon.%3C%2FP%3E%0A%3CDIV%20class%3D%22wp-block-image%22%3E%0A%3CFIGURE%20class%3D%22aligncenter%20size-large%22%3E%3CSPAN%20class%3D%22lia-inline-image-display-wrapper%20lia-image-align-inline%22%20image-alt%3D%22LinkeD365_24-1620296727149.png%22%20style%3D%22width%3A%20400px%3B%22%3E%3CIMG%20src%3D%22https%3A%2F%2Ftechcommunity.microsoft.com%2Ft5%2Fimage%2Fserverpage%2Fimage-id%2F278744iAFFCE77F8C1CDB17%2Fimage-size%2Fmedium%3Fv%3Dv2%26amp%3Bpx%3D400%22%20role%3D%22button%22%20title%3D%22LinkeD365_24-1620296727149.png%22%20alt%3D%22LinkeD365_24-1620296727149.png%22%20%2F%3E%3C%2FSPAN%3E%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3C%2FFIGURE%3E%0A%3C%2FDIV%3E%0A%3CP%3ENext%2C%20start%20an%20approval.%20This%20is%20populated%20to%20let%20the%20owner%20know%20who%20has%20asked%20for%20access%20to%20the%20team%20and%20which%20team.%3C%2FP%3E%0A%3CDIV%20class%3D%22wp-block-image%22%3E%0A%3CFIGURE%20class%3D%22aligncenter%20size-large%22%3E%3CSPAN%20class%3D%22lia-inline-image-display-wrapper%20lia-image-align-inline%22%20image-alt%3D%22LinkeD365_25-1620296726984.png%22%20style%3D%22width%3A%20400px%3B%22%3E%3CIMG%20src%3D%22https%3A%2F%2Ftechcommunity.microsoft.com%2Ft5%2Fimage%2Fserverpage%2Fimage-id%2F278745i9D5BBBB41CFEFFBF%2Fimage-size%2Fmedium%3Fv%3Dv2%26amp%3Bpx%3D400%22%20role%3D%22button%22%20title%3D%22LinkeD365_25-1620296726984.png%22%20alt%3D%22LinkeD365_25-1620296726984.png%22%20%2F%3E%3C%2FSPAN%3E%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3C%2FFIGURE%3E%0A%3C%2FDIV%3E%0A%3CP%3ECheck%20whether%20the%20response%20is%20positive.%20If%20this%20was%20for%20production%2C%20I%20would%20probably%20send%20an%20email%20to%20the%20requesting%20user%20to%20let%20them%20know%20that%20they%20were%20denied%20access.%20You%20could%20also%20use%20the%20response%20written%20in%20the%20rejection.%3C%2FP%3E%0A%3CDIV%20class%3D%22wp-block-image%22%3E%0A%3CFIGURE%20class%3D%22aligncenter%20size-large%22%3E%3CSPAN%20class%3D%22lia-inline-image-display-wrapper%20lia-image-align-inline%22%20image-alt%3D%22LinkeD365_26-1620296726933.png%22%20style%3D%22width%3A%20400px%3B%22%3E%3CIMG%20src%3D%22https%3A%2F%2Ftechcommunity.microsoft.com%2Ft5%2Fimage%2Fserverpage%2Fimage-id%2F278746i6FCB1C1D739F03C4%2Fimage-size%2Fmedium%3Fv%3Dv2%26amp%3Bpx%3D400%22%20role%3D%22button%22%20title%3D%22LinkeD365_26-1620296726933.png%22%20alt%3D%22LinkeD365_26-1620296726933.png%22%20%2F%3E%3C%2FSPAN%3E%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3C%2FFIGURE%3E%0A%3C%2FDIV%3E%0A%3CP%3EIn%20the%20Yes%20path%2C%20call%20the%20Custom%20connector%20again%20to%20check%20if%20the%20user%20is%20already%20a%20part%20of%20your%20organisation%20as%20a%20guest%20user.%20As%20the%20parameter%20is%20expecting%20a%20query%2C%20use%20the%20expression%20below%3C%2FP%3E%0A%3CDIV%20class%3D%22wp-block-image%22%3E%0A%3CFIGURE%20class%3D%22aligncenter%20size-large%22%3E%3CSPAN%20class%3D%22lia-inline-image-display-wrapper%20lia-image-align-inline%22%20image-alt%3D%22LinkeD365_27-1620296726901.png%22%20style%3D%22width%3A%20400px%3B%22%3E%3CIMG%20src%3D%22https%3A%2F%2Ftechcommunity.microsoft.com%2Ft5%2Fimage%2Fserverpage%2Fimage-id%2F278748i62EBF6746B590C70%2Fimage-size%2Fmedium%3Fv%3Dv2%26amp%3Bpx%3D400%22%20role%3D%22button%22%20title%3D%22LinkeD365_27-1620296726901.png%22%20alt%3D%22LinkeD365_27-1620296726901.png%22%20%2F%3E%3C%2FSPAN%3E%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3C%2FFIGURE%3E%0A%3C%2FDIV%3E%0A%3CP%3Email%20eq%20%E2%80%98Email%20Parameter%20from%20the%20Form%20response%E2%80%99%3C%2FP%3E%0A%3CPRE%20class%3D%22lia-code-sample%20language-json%22%3E%3CCODE%3Email%20eq%20\'Email%20Parameter%20from%20the%20Form%20response\'%3C%2FCODE%3E%3C%2FPRE%3E%0A%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3CP%3ENext%2C%20check%20the%20length%20of%20the%20returned%20object%20from%20the%20custom%20connector.%20This%20basically%20checks%20if%20the%20user%20already%20belongs%20to%20your%20environment.%3C%2FP%3E%0A%3CDIV%20class%3D%22wp-block-image%22%3E%0A%3CFIGURE%20class%3D%22aligncenter%20size-large%22%3E%3CSPAN%20class%3D%22lia-inline-image-display-wrapper%20lia-image-align-inline%22%20image-alt%3D%22LinkeD365_28-1620296726899.png%22%20style%3D%22width%3A%20400px%3B%22%3E%3CIMG%20src%3D%22https%3A%2F%2Ftechcommunity.microsoft.com%2Ft5%2Fimage%2Fserverpage%2Fimage-id%2F278747iDE1C834645FBE6A0%2Fimage-size%2Fmedium%3Fv%3Dv2%26amp%3Bpx%3D400%22%20role%3D%22button%22%20title%3D%22LinkeD365_28-1620296726899.png%22%20alt%3D%22LinkeD365_28-1620296726899.png%22%20%2F%3E%3C%2FSPAN%3E%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3C%2FFIGURE%3E%0A%3C%2FDIV%3E%0A%3CPRE%20class%3D%22wp-block-code%22%3E%3CCODE%20class%3D%22%22%3Elength(outputs(\'GetUser\')%3F%5B\'body%2Fvalue\'%5D)%3C%2FCODE%3E%3C%2FPRE%3E%0A%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3CP%3EIf%20there%20is%20a%20value%20in%20the%20return%2C%20use%20the%20return%20to%20invite%20the%20user%20to%20the%20team.%3C%2FP%3E%0A%3CDIV%20class%3D%22wp-block-image%22%3E%0A%3CFIGURE%20class%3D%22aligncenter%20size-large%22%3E%3CSPAN%20class%3D%22lia-inline-image-display-wrapper%20lia-image-align-inline%22%20image-alt%3D%22LinkeD365_29-1620296726913.png%22%20style%3D%22width%3A%20400px%3B%22%3E%3CIMG%20src%3D%22https%3A%2F%2Ftechcommunity.microsoft.com%2Ft5%2Fimage%2Fserverpage%2Fimage-id%2F278749iFB862B74F014B55D%2Fimage-size%2Fmedium%3Fv%3Dv2%26amp%3Bpx%3D400%22%20role%3D%22button%22%20title%3D%22LinkeD365_29-1620296726913.png%22%20alt%3D%22LinkeD365_29-1620296726913.png%22%20%2F%3E%3C%2FSPAN%3E%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3C%2FFIGURE%3E%0A%3C%2FDIV%3E%0A%3CP%3EThe%20User%20id%20is%20returned%20by%20using%20the%20expression%20below%3C%2FP%3E%0A%3CPRE%20class%3D%22lia-code-sample%20language-json%22%3E%3CCODE%3Ebody(\'GetUser\')%3F%5B\'value\'%5D%5B0%5D%3F%5B\'id\'%5D%3C%2FCODE%3E%3C%2FPRE%3E%0A%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3CP%3EOn%20the%20negative%20side%2C%20firstly%20invite%20the%20user%20to%20your%20organisation%20by%20using%20the%20final%20action%20of%20the%20custom%20connector.%3C%2FP%3E%0A%3CDIV%20class%3D%22wp-block-image%22%3E%0A%3CFIGURE%20class%3D%22aligncenter%20size-large%22%3E%3CSPAN%20class%3D%22lia-inline-image-display-wrapper%20lia-image-align-inline%22%20image-alt%3D%22LinkeD365_30-1620296727013.png%22%20style%3D%22width%3A%20400px%3B%22%3E%3CIMG%20src%3D%22https%3A%2F%2Ftechcommunity.microsoft.com%2Ft5%2Fimage%2Fserverpage%2Fimage-id%2F278751i0CF826AB0B282F23%2Fimage-size%2Fmedium%3Fv%3Dv2%26amp%3Bpx%3D400%22%20role%3D%22button%22%20title%3D%22LinkeD365_30-1620296727013.png%22%20alt%3D%22LinkeD365_30-1620296727013.png%22%20%2F%3E%3C%2FSPAN%3E%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3C%2FFIGURE%3E%0A%3C%2FDIV%3E%0A%3CP%3EAnd%20finally%2C%20use%20the%20response%20from%20your%20custom%20connector%2C%20the%20invited%20user%20to%20the%20team.%3C%2FP%3E%0A%3CDIV%20class%3D%22wp-block-image%22%3E%0A%3CFIGURE%20class%3D%22aligncenter%20size-large%22%3E%3CSPAN%20class%3D%22lia-inline-image-display-wrapper%20lia-image-align-inline%22%20image-alt%3D%22LinkeD365_31-1620296727008.png%22%20style%3D%22width%3A%20400px%3B%22%3E%3CIMG%20src%3D%22https%3A%2F%2Ftechcommunity.microsoft.com%2Ft5%2Fimage%2Fserverpage%2Fimage-id%2F278750i582EA815223E2E4E%2Fimage-size%2Fmedium%3Fv%3Dv2%26amp%3Bpx%3D400%22%20role%3D%22button%22%20title%3D%22LinkeD365_31-1620296727008.png%22%20alt%3D%22LinkeD365_31-1620296727008.png%22%20%2F%3E%3C%2FSPAN%3E%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3C%2FFIGURE%3E%0A%3C%2FDIV%3E%0A%3CP%3EThat\'s%20it!%20There%20is%20a%20lot%20of%20configuration%20here%2C%20but%20you%20can%20see%20how%20you%20can%20extend%20your%20usage%20of%20Power%20Automate%20to%20automate%20a%20function%20usually%20confined%20to%20manual%20work%20by%20the%20team%20owner.%3CBR%20%2F%3E%3CBR%20%2F%3EThis%20post%20was%20originally%20published%20on%20%3CA%20href%3D%22https%3A%2F%2Flinked365.blog%2F2021%2F05%2F06%2Fusing-power-automate-and-graph-api-to-manage-external-access-to-teams%2F%22%20target%3D%22_blank%22%20rel%3D%22noopener%20nofollow%20noreferrer%22%3ELinkeD365.blog%3C%2FA%3E%3C%2FP%3E%0A%3C%2FFIGURE%3E%0A%3C%2FDIV%3E%3C%2FLINGO-BODY%3E%3CLINGO-TEASER%20id%3D%22lingo-teaser-2330775%22%20slang%3D%22en-US%22%3E%3CP%3EA%20look%20at%20producing%20a%20Power%20Automate%20to%20allow%20external%20users%20to%20request%20access%20to%20a%20Team%2C%20the%20Teams%20owners%20approve%20the%20request%20then%20invite%20the%20user%20the%20tenant%20and%20Team.%26nbsp%3B%3CBR%20%2F%3EUtilising%20Forms%2C%20Power%20Automate%20and%20Graph%20API%20via%20a%20Custom%20Connector%3C%2FP%3E%3C%2FLINGO-TEASER%3E%3CLINGO-LABS%20id%3D%22lingo-labs-2330775%22%20slang%3D%22en-US%22%3E%3CLINGO-LABEL%3EHow%20to%3C%2FLINGO-LABEL%3E%3C%2FLINGO-LABS%3E

::: {#threadTranslationDashboard .Thread_Translation_Dashboard ng-controller="lingotekThreadTranslationCtrl" li-bindable=""}
::: lingotek-admin-dashboard
:::
:::

::: {style="clear:both"}
:::

::: {#contributorsTaplet .ContributorsTaplet .lia-component-tkb-widget-contributors-taplet}
::: {.lia-panel .lia-panel-standard}
::: lia-decoration-border
::: lia-decoration-border-top
<div>

</div>
:::

::: lia-decoration-border-content
<div>

::: lia-panel-heading-bar-wrapper
::: lia-panel-heading-bar
[ Co-Authors ]{.lia-panel-heading-bar-title aria-level="3"
role="heading"}
:::
:::

::: lia-panel-content-wrapper
::: lia-panel-content
::: {.UserProfileSummary .lia-user-item .lia-js-data-userId-416726 .lia-user-info-group}
::: UserAvatarWrapper
::: {.UserAvatar .lia-user-avatar .lia-component-common-widget-user-avatar .Regular .Visitor}
[![LinkeD365](https://techcommunity.microsoft.com/t5/image/serverpage/image-id/277043i5EDFC7A64CB04079/image-dimensions/40x40/image-coordinates/1493%2C341%2C3254%2C2102?v=v2 "LinkeD365"){.lia-user-avatar-message
.user-rank-ring style=""
onerror="replaceBrokenAvatars(this, '/html/assets/default-avatar.png')"}](/t5/user/viewprofilepage/user-id/416726){.UserAvatar
.lia-link-navigation}
:::

::: {.user-profile-card user-id="416726"}
::: contents
::: spinner
:::
:::
:::
:::

::: lia-user-attributes
::: lia-user-name
[
[LinkeD365](https://techcommunity.microsoft.com/t5/user/viewprofilepage/user-id/416726){#link_12
.lia-link-navigation .lia-page-link .lia-user-name-link} ]{.UserName
.lia-user-name .lia-user-rank-Regular-Visitor}
:::
:::
:::
:::
:::

</div>
:::

::: lia-decoration-border-bottom
<div>

</div>
:::
:::
:::
:::

::: {.lia-panel .lia-panel-standard .ArticleRevisionInfoTaplet .Chrome .lia-component-tkb-widget-article-revision-info-taplet}
::: lia-decoration-border
::: lia-decoration-border-top
<div>

</div>
:::

::: lia-decoration-border-content
<div>

::: lia-panel-heading-bar-wrapper
::: lia-panel-heading-bar
[Version history]{.lia-panel-heading-bar-title aria-level="3"
role="heading"}
:::
:::

::: lia-panel-content-wrapper
::: lia-panel-content
::: lia-revision-info-wrapper
::: lia-revision-info-content
::: {.lia-revision-info-row .lia-revision-last-update-row}
::: lia-revision-info-title-cell
Last update:
:::

::: lia-revision-info-data-cell
[ [‎May 06 2021]{.local-date} [03:50 AM]{.local-time} ]{.DateTime}
:::
:::

::: {.lia-revision-info-row .lia-revision-author-row}
::: lia-revision-info-title-cell
Updated by:
:::

::: lia-revision-info-data-cell
[ [Luise
Freese](https://techcommunity.microsoft.com/t5/user/viewprofilepage/user-id/89985){#link_13
.lia-link-navigation .lia-page-link .lia-user-name-link} ]{.UserName
.lia-user-name .lia-user-rank-MVP}
:::
:::

::: {.lia-revision-info-row .lia-revision-article-history-link-row .lia-revision-info-data-cell-workflow}
:::
:::
:::
:::
:::

</div>
:::

::: lia-decoration-border-bottom
<div>

</div>
:::
:::
:::

::: {.lia-panel .lia-panel-standard .LabelsTaplet .Chrome .lia-component-labels-widget-labels-list .custom-blog-article-label-widget}
::: lia-decoration-border
::: lia-decoration-border-top
<div>

</div>
:::

::: lia-decoration-border-content
::: lia-panel-heading-bar-wrapper
::: lia-panel-heading-bar
[Labels]{.lia-panel-heading-bar-title aria-level="4" role="heading"}
:::
:::

::: lia-panel-content-wrapper
::: lia-panel-content
::: BlogLabelsTaplet
::: LabelsList
::: {.spinner .labels-spinner}
:::

::: labels-container
:::
:::
:::
:::
:::
:::

::: lia-decoration-border-bottom
<div>

</div>
:::
:::
:::

::: blog-article-social-share-widget-wrapper
::: custom-social-share-component
::: custom-social-share-widget
::: {.lia-panel .lia-panel-standard .Chrome .custom-share-component style=""}
::: lia-decoration-border
::: lia-decoration-border-top
<div>

</div>
:::

::: lia-decoration-border-content
<div>

::: lia-panel-heading-bar-wrapper
::: lia-panel-heading-bar
## Share {#customShareWidget .lia-panel-heading-bar-title .hello}
:::
:::

::: lia-panel-content-wrapper
::: lia-panel-content
-   [[Share to
    LinkedIn]{.social-share-title}](http://www.linkedin.com/shareArticle?mini=true&url=https://techcommunity.microsoft.com/t5/microsoft-365-pnp-blog/using-power-automate-and-graph-api-to-manage-external-access-to/ba-p/2330775 "Share to LinkedIn"){.social-share-link
    .social-share-linkedin}
-   [[Share to
    Facebook]{.social-share-title}](http://www.facebook.com/share.php?u=https://techcommunity.microsoft.com/t5/microsoft-365-pnp-blog/using-power-automate-and-graph-api-to-manage-external-access-to/ba-p/2330775 "Share to FaceBook"){.social-share-link
    .social-share-facebook}
-   [[Share to
    Twitter]{.social-share-title}](http://twitter.com/share?text=Check%20out%20this%20post%20on%20the%20Microsoft%20Tech%20Community%20:%20Using%20Power%20Automate%20And%20Graph%20API%20To%20Manage%20External%20Access%20To%20Teams%20-%20Microsoft%20Tech%20Community&url=https://techcommunity.microsoft.com/t5/microsoft-365-pnp-blog/using-power-automate-and-graph-api-to-manage-external-access-to/ba-p/2330775 "Share to Twitter"){.social-share-link
    .social-share-twitter}
-   [[Share to
    Email]{.social-share-title}](mailto:?subject=Using%20Power%20Automate%20And%20Graph%20API%20To%20Manage%20External%20Access%20To%20Teams%20-%20Microsoft%20Tech%20Community&body=I%20found%20this%20on%20the%20Microsoft%20Tech%20Community%20and%20wanted%20to%20share%20it%20with%20you,%20check%20it%20out%20:%20https://techcommunity.microsoft.com/t5/microsoft-365-pnp-blog/using-power-automate-and-graph-api-to-manage-external-access-to/ba-p/2330775 "Share via email"){.social-share-link
    .social-share-email}
:::
:::

</div>
:::

::: lia-decoration-border-bottom
<div>

</div>
:::
:::
:::
:::
:::
:::
:::
:::
:::

::: {.lia-quilt-row .lia-quilt-row-footer}
::: {.lia-quilt-column .lia-quilt-column-24 .lia-quilt-column-single .lia-quilt-column-common-footer}
::: {.lia-quilt-column-alley .lia-quilt-column-alley-single}
::: {.lia-quilt .lia-quilt-footer .lia-quilt-layout-footer .lia-component-quilt-footer}
::: {.lia-quilt-row .lia-quilt-row-main}
::: {.lia-quilt-column .lia-quilt-column-24 .lia-quilt-column-single .lia-quilt-column-icons}
::: {.lia-quilt-column-alley .lia-quilt-column-alley-single .lia-mark-empty}
:::
:::
:::
:::
:::
:::
:::
:::
:::
:::
:::
:::

::: {.cse-46444-wa style="display: none"}
::: {.lia-slide-out-nav-menu .lia-component-common-widget-slide-out-nav-menu}
::: {.lia-slide-out-nav-menu-title ng-non-bindable=""}
Browse
:::

::: {.lia-quilt .lia-quilt-navigation-slide-out-menu .lia-quilt-layout-one-column .lia-top-quilt}
::: {.lia-quilt-row .lia-quilt-row-header}
::: {.lia-quilt-column .lia-quilt-column-24 .lia-quilt-column-single .lia-quilt-column-common-header .lia-mark-empty}
:::
:::

::: {.lia-quilt-row .lia-quilt-row-main}
::: {.lia-quilt-column .lia-quilt-column-24 .lia-quilt-column-single .lia-quilt-column-main-content}
::: {.lia-quilt-column-alley .lia-quilt-column-alley-single}
:::
:::
:::

::: {.lia-quilt-row .lia-quilt-row-footer}
::: {.lia-quilt-column .lia-quilt-column-24 .lia-quilt-column-single .lia-quilt-column-common-footer .lia-mark-empty}
:::
:::
:::
:::
:::

::: {.shell-footer bi-view="5xLinks" bi-area="Footer" ms.pgarea="uhffooter" role="contentinfo"}
::: shell-footer-wrapper
::: {.shell-footer-menugroups ms.cmpgrp="footer nav"}
::: {.sfm-group ms.cmpnm="WhatsNew"}
###### What\'s new  {#whats-new .grp-title}

-   [Surface Pro
    X](https://www.microsoft.com/p/surface-pro-x/8vdnrp2m6hhc?activetab=overview)
-   [Surface Laptop
    3](https://www.microsoft.com/p/surface-laptop-3/8VFGGH1R94TM?activetab=overview)
-   [Surface Pro
    7](https://www.microsoft.com/p/surface-pro-7/8N17J0M5ZZQS?activetab=overview)
-   [Windows 10 Apps](https://www.microsoft.com/windows/windows-10-apps)
-   [Office apps](https://store.office.com/appshome.aspx)
:::

::: {.sfm-group ms.cmpnm="MicrosoftStore"}
###### Microsoft Store  {#microsoft-store .grp-title}

-   [Account profile](https://account.microsoft.com/)
-   [Download Center](https://www.microsoft.com/download)
-   [Microsoft Store
    support](https://go.microsoft.com/fwlink/p/?LinkID=824761&clcid=0x409)
-   [Returns](https://go.microsoft.com/fwlink/p/?LinkID=824764&clcid=0x409)
-   [Order tracking](https://account.microsoft.com/orders)
-   [Store
    locations](https://www.microsoft.com/en-us/store/locations/find-a-store?icid=en-us_UF_FAS)
-   [Buy online, pick up in
    store](https://www.microsoft.com/en-us/store/b/buy-online-pick-up-in-store?icid=uhf_footer_bopuis)
-   [In-store
    events](https://www.microsoft.com/en-us/store/locations/events?icid=en_us_store_uhf_events)
:::

::: {.sfm-group ms.cmpnm="Education"}
###### Education  {#education .grp-title}

-   [Microsoft in education](https://www.microsoft.com/education)
-   [Office for
    students](https://www.microsoft.com/education/products/office/default.aspx)
-   [Office for
    schools](https://products.office.com/academic/compare-office-365-education-plans)
-   [Deals for students and
    parents](https://www.microsoft.com/en-us/store/b/education?icid=CNavfooter_Studentsandeducation)
-   [Microsoft Azure in
    education](https://azure.microsoft.com/community/education/)
:::

::: {.sfm-group ms.cmpnm="Enterprise"}
###### Enterprise  {#enterprise .grp-title}

-   [Azure](https://azure.microsoft.com/)
-   [AppSource](https://go.microsoft.com/fwlink/?LinkID=808093)
-   [Automotive](https://www.microsoft.com/enterprise/automotive)
-   [Government](https://www.microsoft.com/enterprise/government)
-   [Healthcare](https://www.microsoft.com/enterprise/health)
-   [Manufacturing](https://www.microsoft.com/enterprise/manufacturing)
-   [Financial
    Services](https://www.microsoft.com/enterprise/financial-services/banking-and-capital-markets)
-   [Retail](https://www.microsoft.com/enterprise/retail-consumer-goods)
:::

::: {.sfm-group ms.cmpnm="Developer"}
###### Developer  {#developer .grp-title}

-   [Microsoft Visual Studio](https://visualstudio.microsoft.com/)
-   [Window Dev Center](https://developer.microsoft.com/windows)
-   [Developer Network](https://msdn.microsoft.com/)
-   [TechNet](https://technet.microsoft.com/)
-   [Microsoft developer
    program](https://developer.microsoft.com/store/register)
-   [Channel 9](https://channel9.msdn.com/)
-   [Office Dev Center](https://developer.microsoft.com/office)
-   [Microsoft Garage](https://www.microsoft.com/garage/)
:::

::: {.sfm-group ms.cmpnm="Company"}
###### Company  {#company .grp-title}

-   [Careers](https://careers.microsoft.com/)
-   [About Microsoft](https://www.microsoft.com/en-us/about)
-   [Company News](https://news.microsoft.com/)
-   [Privacy at Microsoft](https://privacy.microsoft.com/)
-   [Investors](https://www.microsoft.com/investor/default.aspx)
-   [Diversity and inclusion](https://www.microsoft.com/diversity/)
-   [Accessibility](https://www.microsoft.com/accessibility)
-   [Security](https://www.microsoft.com/security/default.aspx)
:::
:::

::: {.shell-footer-copyright ms.cmpnm="corp" ms.cmpgrp="corp links"}
-   [Sitemap](https://www.microsoft.com/en-us/sitemap1.aspx){#shellmenu_0
    .ctl_footerNavLink}
-   [Contact
    Microsoft](https://support.microsoft.com/contactus){#shellmenu_1
    .ctl_footerNavLink}
-   [Privacy](https://go.microsoft.com/fwlink/?LinkId=521839){#shellmenu_2
    .ctl_footerNavLink}
-   [Manage cookies](#){#shellmenu_2B .ctl_footerNavLink .hidden}
-   [Terms of
    use](http://go.microsoft.com/fwlink/?LinkID=206977){#shellmenu_3
    .ctl_footerNavLink}
-   [Trademarks](https://www.microsoft.com/trademarks){#shellmenu_4
    .ctl_footerNavLink}
-   [Safety and
    eco](https://www.microsoft.com/devices/safety-and-eco){#shellmenu_5
    .ctl_footerNavLink}
-   [About our ads](https://choice.microsoft.com/){#shellmenu_6
    .ctl_footerNavLink}
-   © []{#footerDate} Microsoft
:::
:::
:::
