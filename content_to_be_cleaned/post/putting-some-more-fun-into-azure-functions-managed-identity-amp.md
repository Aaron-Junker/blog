::: {#DB2-001-3 .ServiceNodeInfoHeader}
:::

::: lia-page
::: MinimumWidthContainer
::: min-width-wrapper
::: min-width
::: lia-content
::: {.lia-quilt .lia-quilt-blog-article-page .lia-quilt-layout-two-column-main-side-18-6 .lia-top-quilt}
::: {.lia-quilt-row .lia-quilt-row-header}
::: {.lia-quilt-column .lia-quilt-column-24 .lia-quilt-column-single .lia-quilt-column-common-header}
::: {.lia-quilt-column-alley .lia-quilt-column-alley-single}
::: {.lia-quilt .lia-quilt-header .lia-quilt-layout-header .lia-component-quilt-header}
::: {.lia-quilt-row .lia-quilt-row-main-header}
::: {.lia-quilt-column .lia-quilt-column-24 .lia-quilt-column-single .lia-quilt-column-header}
::: {.lia-quilt-column-alley .lia-quilt-column-alley-single}
::: {#cookie-banner .cookie-markup}
:::

::: {#readerAssistMessages .section .live-region aria-live="assertive" role="alert"}
:::

::: community-header-blank
:::

::: community-header-component
::: community-header-wrapper
::: container
::: {#community-menu-wrapper-menu .menu-link}
[](javascript:void(0)){#community-menu-wrapper-menu-link}

::: {#community-menu-wrapper-menu-icon .menu-icon title=""}
:::
:::

[![](https://techcommunity.microsoft.com/html/@6005EEFEC6E5ECADBBFC249DFA7D38A8/assets/Content/Images/GlobalHeader/MicrosoftLogo.png){.c-image
itemprop="logo" role="presentation" aria-hidden="true"}
[Microsoft]{role="presentation"
aria-hidden="true"}](https://www.microsoft.com){#uhfLogo .c-logo
.c-sgl-stk-uhfLogo}

::: {.c-show-pipe aria-hidden="true"}
:::

[Tech Community](/){#uhfCatLogo .c-logo .c-cat-logo}

::: container-inner
::: {#community-menu-wrapper .community-menu-wrapper .community-menu-hidden-init}
::: {#community-menu-wrapper-header-bar .community-header-bar}
[](#){.community-header-button}

::: community-menu-item-icon
:::
:::

::: {#community-menu-wrapper-list .community-menu-list}
::: {.community-menu-item .tab-homepage}
[](/)

::: {.mdl2-glyph .community-menu-item-icon}

:::

::: community-menu-item-title
Home
:::
:::

::: {.community-menu-item .community-menu-dropdown}
[](#){.community-menu-item-desktop-view}

::: {.c-glyph .community-menu-item-icon}

:::

::: community-menu-item-title-with-dropdownicon
Community Hubs
:::

[](/t5/communities/ct-p/communities#category-filter-button-all){.community-menu-item-mobile-view
.community-menu-item-allow-link}

::: {.c-glyph .community-menu-item-icon}

:::

::: community-menu-item-title-with-dropdownicon
Community Hubs
:::

::: {.dropdown .dropdown-communities .dropdown-events .dropdown-primary-nav}
-   [Community Hubs
    Home](/t5/communities/ct-p/communities#category-filter-button-all){#communities_home}
-   [Products](/t5/communities/ct-p/communities#category-filter-button-products-services){#communities_products}
-   [Special
    Topics](/t5/communities/ct-p/communities#category-filter-button-solutions){#communities_special}
-   [Video Hub](/t5/video-hub/ct-p/VideoHub){#communities_videohub}

::: custom-community-hubs-menu-wrapper
::: custom-community-hubs-menu-close
Close
:::

::: custom-community-hubs-menu-content
::: menu
## [ Products]{#menu-link-prod title="Products"} [(72)]{.small} {#menu-products .active}

## [ Special Topics ]{#menu-link-serv title="Special Topics"} [(41)]{.small} {#menu-services}

## [ Video Hub ]{#menu-link-videohub title="VideoHub"} [(834)]{.small} {#menu-videohub}
:::

::: {#products-data .dataBlock .visible key="products"}
::: {.hubs style="width: 600px"}
### Most Active Hubs

::: {.data style="flex-direction: column; height:310px"}
<div>

[Microsoft
Teams](/t5/microsoft-teams/ct-p/MicrosoftTeams "Microsoft Teams")

</div>

<div>

[Excel](/t5/excel/ct-p/Excel_Cat "Excel")

</div>

<div>

[Exchange](/t5/exchange/ct-p/Exchange "Exchange")

</div>

<div>

[SharePoint](/t5/sharepoint/ct-p/SharePoint "SharePoint")

</div>

<div>

[Windows](/t5/windows-10/ct-p/Windows10 "Windows")

</div>

<div>

[Office 365](/t5/office-365/ct-p/Office365 "Office 365")

</div>

<div>

[Security, Compliance and
Identity](/t5/security-compliance-and-identity/ct-p/MicrosoftSecurityandCompliance "Security, Compliance and Identity")

</div>

<div>

[Windows
Server](/t5/windows-server/ct-p/Windows-Server "Windows Server")

</div>

<div>

[Microsoft Edge
Insider](/t5/microsoft-edge-insider/ct-p/MicrosoftEdgeInsider "Microsoft Edge Insider")

</div>

<div>

[Azure](/t5/azure-community/ct-p/Azure "Azure")

</div>

<div>

[Microsoft 365](/t5/microsoft-365/ct-p/microsoft365 "Microsoft 365")

</div>
:::
:::

::: boxes
[](/t5/azure-databases/ct-p/AzureDatabases "Azure Databases")

::: {.box style="background-image: url('https://techcommunity.microsoft.com/html/@D05C7AA27EF9EB31779410FCB608734A/assets/bg-pink.png')"}
::: title
Azure Databases
:::

::: description
Fully managed intelligent database services.
:::
:::

[](/t5/project-bonsai/ct-p/ProjectBonsai "Autonomous Systems")

::: {.box style="background-image: url('https://techcommunity.microsoft.com/html/@FC8AD6AC9A7EBDA58D7E6304E799EA40/assets/bg-orange.png')"}
::: title
Autonomous Systems
:::

::: description
Create and optimise intelligence for industrial control systems.
:::
:::

[](/t5/yammer/ct-p/Yammer "Yammer")

::: {.box style="background-image: url('https://techcommunity.microsoft.com/html/@CF0293463F27444B05A952A3C4B6BF88/assets/bg-light-blue.png')"}
::: title
Yammer
:::

::: description
Connect and engage across your organization.
:::
:::
:::
:::

::: {#services-data .dataBlock key="services"}
::: {.hubs style="width: 600px"}
### Most Active Hubs

::: {.data style="flex-direction: column; height:310px"}
<div>

[ITOps Talk](/t5/itops-talk/ct-p/ITOpsTalk "ITOps Talk")

</div>

<div>

[Education
Sector](/t5/education-sector/ct-p/EducationSector "Education Sector")

</div>

<div>

[Microsoft
Learn](/t5/microsoft-learn/ct-p/MicrosoftLearn "Microsoft Learn")

</div>

<div>

[Microsoft
Localization](/t5/microsoft-localization/ct-p/MicrosoftTranslation "Microsoft Localization")

</div>

<div>

[Microsoft 365
PnP](/t5/microsoft-365-pnp/ct-p/Microsoft365PnP "Microsoft 365 PnP")

</div>

<div>

[Healthcare and Life
Sciences](/t5/healthcare-and-life-sciences/ct-p/HealthcareAndLifeSciences "Healthcare and Life Sciences")

</div>

<div>

[Public Sector](/t5/public-sector/ct-p/PublicSector "Public Sector")

</div>

<div>

[Internet of Things
(IoT)](/t5/internet-of-things-iot/ct-p/IoT "Internet of Things (IoT)")

</div>

<div>

[Mixed
Reality](/t5/mixed-reality/ct-p/MicrosoftMixedReality "Mixed Reality")

</div>

<div>

[Enabling Remote
Work](/t5/enabling-remote-work/ct-p/RemoteWork "Enabling Remote Work")

</div>

<div>

[Small and Medium
Business](/t5/small-and-medium-businesses/ct-p/SMB "Small and Medium Business")

</div>
:::
:::

::: boxes
[](/t5/humans-of-it/ct-p/HumansofIT "Humans of IT")

::: {.box style="background-image: url('https://techcommunity.microsoft.com/html/@A5C0BDB1059C6D1F73B8097424B50ED0/assets/bg-purple.png')"}
::: title
Humans of IT
:::

::: description
Empowering technologists to achieve more by humanizing tech.
:::
:::

[](/t5/green-tech/ct-p/GreenTech "Green Tech")

::: {.box style="background-image: url('https://cdn.techcommunity.microsoft.com/lithium/MicrosoftLearn/Learn-Blue.png')"}
::: title
Green Tech
:::

::: description
Raise awareness about sustainability in the tech sector
:::
:::

[](/t5/mvp-award-program/ct-p/MVPAwardProgram "MVP Award Program")

::: {.box style="background-image: url('https://techcommunity.microsoft.com/html/@02C247197A08F2DB06040AC786E1BF01/assets/bg-green.png')"}
::: title
MVP Award Program
:::

::: description
Find out more about the Microsoft MVP Award Program.
:::
:::
:::
:::

::: {#VideoHub-Data .dataBlock key="VideoHub"}
::: {.hubs style="width: 838px"}
### Video Hub

::: {.data style="flex-direction: row; height:fit-content"}
<div>

[Azure](https://aka.ms/VideoHub/Azure "Azure")

</div>

<div>

[Exchange](https://aka.ms/VideoHub/Exchange "Exchange")

</div>

<div>

[Microsoft 365](https://aka.ms/VideoHub/Microsoft365 "Microsoft 365")

</div>

<div>

[Microsoft 365
Business](https://aka.ms/VideoHub/Microsoft365Business "Microsoft 365 Business")

</div>

<div>

[Microsoft 365
Enterprise](https://aka.ms/VideoHub/Microsoft365Business "Microsoft 365 Enterprise")

</div>

<div>

[Microsoft Edge](https://aka.ms/VideoHub/MicrosoftEdge "Microsoft Edge")

</div>

<div>

[Microsoft Outlook](https://aka.ms/VideoHub/Outlook "Microsoft Outlook")

</div>

<div>

[Microsoft
Teams](https://aka.ms/VideoHub/MicrosoftTeams "Microsoft Teams")

</div>

<div>

[Security](https://aka.ms/VideoHub/Security "Security")

</div>

<div>

[SharePoint](https://aka.ms/VideoHub/SharePoint "SharePoint")

</div>

<div>

[Windows](https://aka.ms/VideoHub/Windows "Windows")

</div>
:::
:::
:::
:::

::: custom-community-hubs-menu-footer
[Browse All Community
Hubs](/t5/Communities/ct-p/communities){#browse-all-communities}
:::
:::
:::
:::

::: {.community-menu-item .my-favorites}
[](/t5/custom/page/page-id/Blogs){.community-menu-item-desktop-view}

::: {.mdl2-glyph .community-menu-item-icon}

:::

::: community-menu-item-title
Blogs
:::

[](/t5/custom/page/page-id/Blogs){.community-menu-item-mobile-view}

::: {.mdl2-glyph .community-menu-item-icon}

:::

::: community-menu-item-title
Blogs
:::
:::

::: {.community-menu-item .tab-events .community-menu-dropdown}
[](#){.community-menu-item-desktop-view}

::: {.c-glyph .community-menu-item-icon}

:::

::: community-menu-item-title-with-dropdownicon
Events
:::

[](#){.community-menu-item-mobile-view}

::: {.c-glyph .community-menu-item-icon}

:::

::: community-menu-item-title-with-dropdownicon
Events
:::

::: {.dropdown .dropdown-events .dropdown-primary-nav}
-   [Events Home](/t5/Events/ct-p/Events)
-   [Microsoft Ignite](https://myignite.microsoft.com/)
-   [Microsoft Build](https://mybuild.microsoft.com/)
-   [Community Events](/t5/Community-Events/ct-p/CommunityEvents)
:::
:::

::: {.community-menu-item .tab-microsoft-learning .community-menu-dropdown}
[](#){.community-menu-item-desktop-view}

::: {.grad .community-menu-item-icon}
:::

::: community-menu-item-title-with-dropdownicon
Microsoft Learn
:::

[](#){.community-menu-item-mobile-view}

::: {.grad .community-menu-item-icon}
:::

::: community-menu-item-title-with-dropdownicon
Microsoft Learn
:::

::: {.dropdown .dropdown-events .dropdown-primary-nav}
-   [Home](%20https://docs.microsoft.com/learn/){.ms-learning-home-link
    .community-menu-item-title}
-   [Community](/t5/microsoft-learn/bd-p/MicrosoftLearn)
-   [Blog](/t5/microsoft-learn-blog/bg-p/MicrosoftLearnBlog)
-   [Azure](https://docs.microsoft.com/learn/azure/?WT.mc_id=techcom_header-webpage-m365)
-   [Dynamics
    365](https://docs.microsoft.com/learn/dynamics365/?WT.mc_id=techcom_header-webpage-m365)
-   [Microsoft
    365](https://docs.microsoft.com/learn/m365/?wt.mc_id=techcom_header-webpage-m365)
-   [Security, Compliance &
    Identity](https://docs.microsoft.com/learn/topics/sci/?wt.mc_id=techcom_header-webpage-m365)
-   [Power
    Platform](https://docs.microsoft.com/learn/powerplatform/?wt.mc_id=techcom_header-webpage-powerplatform)
-   [Github](https://docs.microsoft.com/learn/github/?wt.mc_id=techcom_header-webpage-github)
-   [Teams](https://docs.microsoft.com/learn/teams/?wt.mc_id=techcom_header-webpage-teams)
-   [.NET](https://docs.microsoft.com/learn/dotnet/?wt.mc_id=techcom_header-webpage-dotnet)
:::
:::

::: {.community-menu-item .tab-info-center}
[](/t5/Community-Info-Center/ct-p/Community-Info-Center){.community-menu-item-desktop-view}

::: {.c-glyph .community-menu-item-icon}

:::

::: community-menu-item-title
Lounge
:::

[](/t5/Community-Info-Center/ct-p/Community-Info-Center){.community-menu-item-mobile-view}

::: {.c-glyph .community-menu-item-icon}

:::

::: community-menu-item-title
Lounge
:::
:::
:::

-   [[776K]{#community-menu-wrapper-vitality-stat-count-1
    .community-menu-vitality-stat-count} [
    Members]{#community-menu-wrapper-vitality-stat-title-1
    .community-menu-vitality-stat-title}]{#community-menu-wrapper-vitality-stat-item-1}
-   [[7,304]{#community-menu-wrapper-vitality-stat-count-2
    .community-menu-vitality-stat-count} [
    Online]{#community-menu-wrapper-vitality-stat-title-2
    .community-menu-vitality-stat-title}]{#community-menu-wrapper-vitality-stat-item-2}
-   [[2M]{#community-menu-wrapper-vitality-stat-count-3
    .community-menu-vitality-stat-count} [
    Discussions]{#community-menu-wrapper-vitality-stat-title-3
    .community-menu-vitality-stat-title}]{#community-menu-wrapper-vitality-stat-item-3}
:::

::: nav-right
::: {#search_container}
::: {#search_btn}
Search []{.btn-search}
:::

::: {#search_slider .hidden}
::: custom-lia-search
::: {#lia-searchformV32_23165e92d71fc8 .SearchForm .lia-search-form-wrapper .lia-mode-default .lia-component-common-widget-search-form}
::: lia-inline-ajax-feedback
::: {#ajaxfeedback_23165e92d71fc8 .AjaxFeedback}
:::
:::

::: {#searchautocompletetoggle_23165e92d71fc8}
::: lia-inline-ajax-feedback
::: {#ajaxfeedback_23165e92d71fc8_0 .AjaxFeedback}
:::
:::

::: t-invisible
:::

::: lia-inline-ajax-feedback
::: {#feedback_23165e92d71fc8 .AjaxFeedback}
:::
:::

[ [ []{.lia-button-wrapper .lia-button-wrapper-secondary
.lia-button-wrapper-searchForm-action} ]{.lia-search-input-field}
]{.lia-search-input-wrapper} [cancel]{.lia-cancel-search}

::: {.search-autocomplete-toggle-link .lia-js-hidden}
[Turn on
suggestions](https://techcommunity.microsoft.com/t5/blogs/v2/blogarticlepage.enableautocomplete:enableautocomplete?t:ac=blog-id/Microsoft365PnPBlog/article-id/404&t:cp=action/contributions/searchactions){#enableAutoComplete_23165e92d71fc8
.lia-link-navigation .auto-complete-toggle-on
.lia-link-ticket-post-action
.lia-component-search-action-enable-auto-complete} [
[[]{#display_23165e92d71fc8 .lia-img-icon-help .lia-fa-icon .lia-fa-help
.lia-fa
alt="Auto-suggest helps you quickly narrow down your search results by suggesting possible matches as you type."
aria-label="Help Icon" role="img"}](#){#link_23165e92d71fc8
.lia-link-navigation .help-icon .lia-tooltip-trigger}]{.HelpIcon}

::: {#link_23165e92d71fc8_0-tooltip-element .lia-content .lia-tooltip-pos-bottom-left .lia-panel-tooltip-wrapper role="alertdialog"}
::: lia-tooltip-arrow
:::

::: lia-panel-tooltip
::: content
Auto-suggest helps you quickly narrow down your search results by
suggesting possible matches as you type.
:::
:::
:::
:::
:::

::: spell-check-showing-result
Showing results for []{#showingResult_23165e92d71fc8
.lia-link-navigation .show-results-for-link .lia-link-disabled}
[](#){#showingMoreResult_23165e92d71fc8 .lia-link-navigation
.more-synonym-search-results-for-link} [
]{.all-results-for-synonym-search}
:::

<div>

[ Show [](#){#synonymSearchInstead_23165e92d71fc8 .lia-link-navigation
.synonym-search-instead-for-link} only  ]{.synonym-search-instead
.lia-js-hidden} [ \| ]{.spell-check-and-synonym-search-instead
.lia-js-hidden} [ Search instead for [](#){#searchInstead_23165e92d71fc8
.lia-link-navigation .search-instead-for-link}
]{.spell-check-search-instead}

</div>

::: {.spell-check-do-you-mean .lia-component-search-widget-spellcheck}
Did you mean: [](#){#doYouMean_23165e92d71fc8 .lia-link-navigation
.do-you-mean-link}
:::
:::
:::
:::
:::

::: sign-in-wrapper
[Sign
In](/plugins/common/feature/oauth2sso/sso_login_redirect?lang=en&referer=https%3A%2F%2Ftechcommunity.microsoft.com%2Ft5%2Fmicrosoft-365-pnp-blog%2Fputting-some-more-fun-into-azure-functions-managed-identity-amp%2Fba-p%2F2628047)
:::

::: notifications
::: notify-icon
[](/t5/notificationfeed/page)

::: lia-notifications-messages-aggregate
:::
:::

::: email-icon
[](/t5/notes/privatenotespage)

::: lia-notifications-messages-aggregate
:::
:::
:::

::: lia-component-common-widget-slide-out-user-menu
::: {.lia-user-navigation-sign-in .lia-component-users-action-login-with-avatar}
::: user-navigation-user-profile
[Sign
In](/plugins/common/feature/oauth2sso/sso_login_redirect?lang=en&referer=https%3A%2F%2Ftechcommunity.microsoft.com%2Ft5%2Fmicrosoft-365-pnp-blog%2Fputting-some-more-fun-into-azure-functions-managed-identity-amp%2Fba-p%2F2628047){#link_1_23165e948fe28c
.lia-link-navigation .login-link .lia-authentication-link}
:::

::: {.UserAvatar .lia-user-avatar}
[](/plugins/common/feature/oauth2sso/sso_login_redirect?lang=en&referer=https%3A%2F%2Ftechcommunity.microsoft.com%2Ft5%2Fmicrosoft-365-pnp-blog%2Fputting-some-more-fun-into-azure-functions-managed-identity-amp%2Fba-p%2F2628047){#link_2_23165e948fe28c
.lia-link-navigation .login-link .lia-authentication-link}

::: lia-anonymous-profile-icon
:::
:::
:::
:::
:::
:::
:::
:::
:::

::: notifications-overlay-notif
:::

::: notifications-overlay-mail
:::

::: notifications-overlay-favorites
:::
:::
:::
:::

::: {.lia-quilt-row .lia-quilt-row-sub-header}
::: {.lia-quilt-column .lia-quilt-column-18 .lia-quilt-column-left .lia-quilt-column-breadcrumb .lia-mark-empty}
:::

::: {.lia-quilt-column .lia-quilt-column-06 .lia-quilt-column-right .lia-quilt-column-search-content}
::: {.lia-quilt-column-alley .lia-quilt-column-alley-right}
::: custom-lia-search
::: {#lia-searchformV32 .SearchForm .lia-search-form-wrapper .lia-mode-default .lia-component-common-widget-search-form}
::: lia-inline-ajax-feedback
::: {#ajaxfeedback .AjaxFeedback}
:::
:::

::: {#searchautocompletetoggle}
::: lia-inline-ajax-feedback
::: {#ajaxfeedback_0 .AjaxFeedback}
:::
:::

::: t-invisible
:::

::: lia-inline-ajax-feedback
::: {#feedback .AjaxFeedback}
:::
:::

[ [ []{.lia-button-wrapper .lia-button-wrapper-secondary
.lia-button-wrapper-searchForm-action} ]{.lia-search-input-field}
]{.lia-search-input-wrapper} [cancel]{.lia-cancel-search}

::: {.search-autocomplete-toggle-link .lia-js-hidden}
[Turn on
suggestions](https://techcommunity.microsoft.com/t5/blogs/v2/blogarticlepage.enableautocomplete:enableautocomplete?t:ac=blog-id/Microsoft365PnPBlog/article-id/404&t:cp=action/contributions/searchactions){#enableAutoComplete
.lia-link-navigation .auto-complete-toggle-on
.lia-link-ticket-post-action
.lia-component-search-action-enable-auto-complete} [ [[]{#display
.lia-img-icon-help .lia-fa-icon .lia-fa-help .lia-fa
alt="Auto-suggest helps you quickly narrow down your search results by suggesting possible matches as you type."
aria-label="Help Icon" role="img"}](#){#link_0 .lia-link-navigation
.help-icon .lia-tooltip-trigger}]{.HelpIcon}

::: {#link_1-tooltip-element .lia-content .lia-tooltip-pos-bottom-left .lia-panel-tooltip-wrapper role="alertdialog"}
::: lia-tooltip-arrow
:::

::: lia-panel-tooltip
::: content
Auto-suggest helps you quickly narrow down your search results by
suggesting possible matches as you type.
:::
:::
:::
:::
:::

::: spell-check-showing-result
Showing results for []{#showingResult .lia-link-navigation
.show-results-for-link .lia-link-disabled} [](#){#showingMoreResult
.lia-link-navigation .more-synonym-search-results-for-link} [
]{.all-results-for-synonym-search}
:::

<div>

[ Show [](#){#synonymSearchInstead .lia-link-navigation
.synonym-search-instead-for-link} only  ]{.synonym-search-instead
.lia-js-hidden} [ \| ]{.spell-check-and-synonym-search-instead
.lia-js-hidden} [ Search instead for [](#){#searchInstead
.lia-link-navigation .search-instead-for-link}
]{.spell-check-search-instead}

</div>

::: {.spell-check-do-you-mean .lia-component-search-widget-spellcheck}
Did you mean: [](#){#doYouMean .lia-link-navigation .do-you-mean-link}
:::
:::
:::
:::
:::
:::

::: {.lia-quilt-row .lia-quilt-row-feedback}
::: {.lia-quilt-column .lia-quilt-column-24 .lia-quilt-column-single .lia-quilt-column-feedback}
::: {.lia-quilt-column-alley .lia-quilt-column-alley-single}
:::
:::
:::
:::

::: {.custom-nda-blog-article-page-header-banner .lia-mark-empty}
:::

::: {.community-live-events-banner-blog-article-page-wrapper .lia-mark-empty}
:::

::: custom-blog-article-page-header-wrapper
::: custom-common-widget-breadcrumb
::: {.custom-common-widget-breadcrumb-wrapper .hidden}
[Home](/){.BreadCrumb .home-nav-link}

::: {.BreadCrumb .crumb-line .lia-breadcrumb .lia-component-common-widget-breadcrumb aria-label="breadcrumbs" role="navigation"}
-   [Home](/){#link_23165e97fb893f .lia-link-navigation .crumb-community
    .lia-breadcrumb-community .lia-breadcrumb-forum}
-    []{#display_23165e97fb893f .lia-img-icon-list-separator-breadcrumb
    .lia-fa-icon .lia-fa-list .lia-fa-separator .lia-fa-breadcrumb
    .lia-fa alt="" aria-label="" role="img"}
-   [Microsoft 365
    PnP](/t5/microsoft-365-pnp/ct-p/Microsoft365PnP){#link_23165e97fb893f_0
    .lia-link-navigation .crumb-category .lia-breadcrumb-category
    .lia-breadcrumb-forum}
-    []{#display_23165e97fb893f_0
    .lia-img-icon-list-separator-breadcrumb .lia-fa-icon .lia-fa-list
    .lia-fa-separator .lia-fa-breadcrumb .lia-fa alt="" aria-label=""
    role="img"}
-   [Microsoft 365 PnP
    Blog](/t5/microsoft-365-pnp-blog/bg-p/Microsoft365PnPBlog){#link_23165e97fb893f_1
    .lia-link-navigation .crumb-board .lia-breadcrumb-board
    .lia-breadcrumb-forum}
-    []{#display_23165e97fb893f_1
    .lia-img-icon-list-separator-breadcrumb .lia-fa-icon .lia-fa-list
    .lia-fa-separator .lia-fa-breadcrumb .lia-fa alt="" aria-label=""
    role="img"}
-   [Putting some more FUN into Azure Functions, Managed Identity &
    Microsoft Graph]{#link_23165e97fb893f_2 .lia-link-navigation
    .child-thread .lia-link-disabled aria-disabled="true"
    disabled="true" role="link"
    aria-label="Putting some more FUN into Azure Functions, Managed Identity &amp; Microsoft Graph"}
:::
:::
:::

::: {.lia-menu-bar .lia-discussion-page-discussion-navigator .lia-component-article-navigator}
::: lia-decoration-border-menu-bar
::: lia-decoration-border-menu-bar-top
<div>

</div>
:::

::: lia-decoration-border-menu-bar-content
<div>

::: lia-menu-bar-buttons
:::

::: {#threadnavigator .lia-paging-full-wrapper}
-   [[]{.lia-paging-page-arrow} [Back to
    Blog]{.lia-paging-page-link}](/t5/microsoft-365-pnp-blog/bg-p/Microsoft365PnPBlog "Microsoft 365 PnP Blog"){#link_2
    .lia-link-navigation}
-   [[]{.lia-paging-page-arrow} [Newer
    Article]{.lia-paging-page-link}](/t5/microsoft-365-pnp-blog/getting-started-with-pnp-script-samples/ba-p/2629414 "Getting started with PnP Script Samples"){#link_3
    .lia-link-navigation}
-   [[Older Article]{.lia-paging-page-link}
    []{.lia-paging-page-arrow}](/t5/microsoft-365-pnp-blog/update-sharepoint-list-s-author-editor-field-in-app-only-context/ba-p/2622569 "Update SharePoint list's Author / Editor field in App-Only context"){#link_4
    .lia-link-navigation}
:::

</div>
:::

::: lia-decoration-border-menu-bar-bottom
<div>

</div>
:::
:::
:::
:::
:::
:::
:::

::: {.lia-quilt-row .lia-quilt-row-main}
::: {.lia-quilt-column .lia-quilt-column-18 .lia-quilt-column-left .lia-quilt-column-main-content}
::: {.lia-quilt-column-alley .lia-quilt-column-alley-left}
::: ba-subject-header-wrapper
::: ba-subject-wrapper
::: ba-title
# Putting some more FUN into Azure Functions, Managed Identity & Microsoft Graph
:::

::: ba-option-wrapper
::: {.lia-menu-bar .top-block .lia-component-menu-bar-without-options}
::: lia-decoration-border-menu-bar
::: lia-decoration-border-menu-bar-top
<div>

</div>
:::

::: lia-decoration-border-menu-bar-content
<div>

::: lia-menu-bar-buttons
:::

</div>
:::

::: lia-decoration-border-menu-bar-bottom
<div>

</div>
:::
:::
:::
:::
:::

::: ba-author-and-metrics-wrapper
::: ba-author-wrapper
By

::: ba-author-info
[ ]{.UserName .lia-user-name}

::: UserAvatarWrapper
::: {.UserAvatar .lia-user-avatar .lia-component-common-widget-user-avatar .MVP}
[![Luise
Freese](https://techcommunity.microsoft.com/t5/image/serverpage/image-id/267080i7F999E88693CAB4E/image-dimensions/150x150/image-coordinates/0%2C0%2C576%2C576?v=v2 "Luise Freese"){.lia-user-avatar-message
.user-rank-ring .user-rank-ring style="border-color: #107C10"
onerror="replaceBrokenAvatars(this, '/html/assets/default-avatar.png')"}](/t5/user/viewprofilepage/user-id/89985){.UserAvatar
.lia-link-navigation}
:::

::: {.user-profile-card user-id="89985"}
::: contents
::: spinner
:::
:::
:::
:::

::: user-login
[Luise Freese](/t5/user/viewprofilepage/user-id/89985)
:::
:::
:::

::: ba-metrics-info
[Published]{.ba-published-title} [Aug 09 2021 11:14
AM]{.ba-published-date} [ 3,398 Views ]{.ba-view-count}
:::
:::
:::

::: custom-blog-article-wrapper
::: {#messageview .lia-panel-message .message-uid-2628047 .lia-component-article lia-message-uid="2628047"}
::: {#messageView2_1 .lia-message-view-wrapper .lia-js-data-messageUid-2628047 .lia-component-forums-widget-message-view-two lia-message-uid="2628047"}
[ ]{#U2628047} [ ]{#M404}

::: lia-inline-ajax-feedback
::: {#ajaxfeedback_1 .AjaxFeedback}
:::
:::

::: {.MessageView .lia-message-view-blog-topic-message .lia-message-view-display .lia-row-standard-unread .lia-thread-topic}
[]{.lia-message-state-indicator}

::: {.lia-quilt .lia-quilt-blog-topic-message .lia-quilt-layout-one-column-message}
::: {.lia-quilt-row .lia-quilt-row-header}
::: {.lia-quilt-column .lia-quilt-column-16 .lia-quilt-column-left .lia-quilt-column-header-left}
::: {.lia-quilt-column-alley .lia-quilt-column-alley-left}
::: {.lia-message-author-avatar .lia-component-author-avatar .lia-component-message-view-widget-author-avatar}
::: UserAvatarWrapper
::: {.UserAvatar .lia-user-avatar .lia-component-common-widget-user-avatar .MVP}
[![Luise
Freese](https://techcommunity.microsoft.com/t5/image/serverpage/image-id/267080i7F999E88693CAB4E/image-dimensions/40x40/image-coordinates/0%2C0%2C576%2C576?v=v2 "Luise Freese"){.lia-user-avatar-message
.user-rank-ring .user-rank-ring style="border-color: #107C10"
onerror="replaceBrokenAvatars(this, '/html/assets/default-avatar.png')"}](/t5/user/viewprofilepage/user-id/89985){.UserAvatar
.lia-link-navigation}
:::

::: {.user-profile-card user-id="89985"}
::: contents
::: spinner
:::
:::
:::
:::
:::

::: lia-message-author-with-avatar
[ [Luise
Freese](https://techcommunity.microsoft.com/t5/user/viewprofilepage/user-id/89985){#link_5
.lia-link-navigation .lia-page-link .lia-user-name-link} ]{.UserName
.lia-user-name .lia-user-rank-MVP
.lia-component-message-view-widget-author-username}
:::

::: {.lia-message-author-rank .lia-component-author-rank .lia-component-message-view-widget-author-rank}
MVP
:::
:::
:::

::: {.lia-quilt-column .lia-quilt-column-08 .lia-quilt-column-right .lia-quilt-column-header-right}
::: {.lia-quilt-column-alley .lia-quilt-column-alley-right}
::: {.lia-message-post-date .lia-component-post-date .lia-component-message-view-widget-post-date title="Posted on"}
[ [‎Aug 09 2021]{.local-date} [11:14 AM]{.local-time} ]{.DateTime}
:::

::: {#actionMenuDropDown .lia-menu-navigation-wrapper .lia-js-hidden .lia-menu-action .lia-component-message-view-widget-action-menu}
::: lia-menu-navigation
::: dropdown-default-item
[](# "Show option menu"){#dropDownLink .lia-js-menu-opener
.default-menu-option .lia-js-mouseover-menu .lia-link-navigation}

::: dropdown-positioning
::: dropdown-positioning-static
-   [Subscribe to RSS
    Feed](/gxcuf89792/rss/message?board.id=Microsoft365PnPBlog&message.id=404){#rssThread
    .lia-link-navigation .rss-thread-link
    .lia-component-rss-action-thread}
-   [ []{.lia-separator-post} []{.lia-separator-pre} ]{.lia-separator
    .lia-component-common-widget-link-separator}
-   [Mark as New]{#markThreadUnread .lia-link-navigation
    .mark-thread-unread .lia-link-disabled
    .lia-component-forums-action-mark-thread-unread}
-   [Mark as Read]{#markThreadRead .lia-link-navigation
    .mark-thread-read .lia-link-disabled
    .lia-component-forums-action-mark-thread-read}
-   [ []{.lia-separator-post} []{.lia-separator-pre} ]{.lia-separator
    .lia-component-common-widget-link-separator}
-   [Bookmark]{#addThreadUserBookmark .lia-link-navigation
    .addThreadUserBookmark .lia-link-disabled
    .lia-component-subscriptions-action-add-thread-user-bookmark}
-   [Subscribe]{#addThreadUserEmailSubscription .lia-link-navigation
    .addThreadUserEmailSubscription .lia-link-disabled
    .lia-component-subscriptions-action-add-thread-user-email}
-   [ []{.lia-separator-post} []{.lia-separator-pre} ]{.lia-separator
    .lia-component-common-widget-link-separator}
-   [Email to a Friend]{#emailMessageToFriend .lia-link-navigation
    .email_friend .lia-link-disabled
    .lia-component-forums-action-email-message-to-friend}
-   [ []{.lia-separator-post} []{.lia-separator-pre} ]{.lia-separator
    .lia-component-common-widget-link-separator}
-   [Printer Friendly
    Page](/t5/blogs/blogarticleprintpage/blog-id/Microsoft365PnPBlog/article-id/404){#printThread
    .lia-link-navigation .print-article
    .lia-component-forums-action-print-thread}
-   [Report Inappropriate
    Content](/t5/notifications/notifymoderatorpage/message-uid/2628047){#reportAbuse
    .lia-link-navigation .report-abuse-link
    .lia-component-forums-action-report-abuse}
:::
:::
:::
:::
:::
:::
:::
:::

::: {.lia-quilt-row .lia-quilt-row-main}
::: {.lia-quilt-column .lia-quilt-column-24 .lia-quilt-column-single .lia-quilt-column-main}
::: {.lia-quilt-column-alley .lia-quilt-column-alley-single}
::: {.lia-message-subject-wrapper .lia-component-subject .lia-component-message-view-widget-subject-with-options}
::: MessageSubject
::: MessageSubjectIcons
# [ [Putting some more FUN into Azure Functions, Managed Identity & Microsoft Graph](/t5/microsoft-365-pnp-blog/putting-some-more-fun-into-azure-functions-managed-identity-amp/ba-p/2628047){#link_6 .page-link .lia-link-navigation .lia-custom-event} ]{.lia-message-unread} {#putting-some-more-fun-into-azure-functions-managed-identity-microsoft-graph-1 .message-subject itemprop="name"}

[]{#display_2 .lia-img-message-has-url .lia-fa-message .lia-fa-has
.lia-fa-url .lia-fa title="Contains a hyperlink"
alt="Message contains a hyperlink" aria-label="Contains a hyperlink"
role="img"} []{#display_3 .lia-img-message-has-image .lia-fa-message
.lia-fa-has .lia-fa-image .lia-fa title="Contains an image"
alt="Message contains an image" aria-label="Contains an image"
role="img"}
:::
:::
:::

::: {.lia-message-post-date .lia-component-post-date .lia-component-message-view-widget-post-date title="Posted on"}
[ [‎Aug 09 2021]{.local-date} [11:14 AM]{.local-time} ]{.DateTime}
:::

::: {.lia-message-body-wrapper .lia-component-message-view-widget-body}
::: {#bodyDisplay .lia-message-body itemprop="text"}
::: lia-message-body-content
# Usecase & purpose of this blog post {#toc-hId-1413219912}

I want to show, how you can use a Managed Identity in Azure Functions to
get an access token for Microsoft Graph API.

 

[![image-8.png](https://techcommunity.microsoft.com/t5/image/serverpage/image-id/304842i590EDC4B973AB05C/image-size/large?v=v2&px=999 "image-8.png"){.lia-media-image
role="button"
li-image-url="https://techcommunity.microsoft.com/t5/image/serverpage/image-id/304842i590EDC4B973AB05C?v=v2"
li-image-display-id="'304842i590EDC4B973AB05C'"
li-message-uid="'2628047'" li-messages-message-image="true"
li-bindable="" tabindex="0" li-bypass-lightbox-when-linked="true"
li-use-hover-links="false"}]{.lia-inline-image-display-wrapper
.lia-image-align-inline image-alt="image-8.png" style="width: 999px;"}\
\

# Prerequisites to benefit from this article: {#toc-hId--394234551}

To get the most out of this post, you should understand the following
concepts -- I included some links that should help you getting started.

## Managed Identity -- What is that and why would I want one? {#toc-hId-296326923}

Managed Identities are the state-of-the-art way to get Azure Active
Directory access tokens, because you won't need to handle credentials,
which is of course a security benefit

\>...where there are credentials, there are leaks ¯\\\_(ツ)\_/¯

If you are unfamiliar with tokens, [this article by Lee
Ford](https://techcommunity.microsoft.com/t5/microsoft-365-pnp-blog/introduction-to-tokens/ba-p/2267853)
will help. This is not a full tutorial on Managed Identities, for more
information please start to read here. Also, [Yannick
Reekmans](https://twitter.com/YannickReekmans) posted an entire [series
on Managed
Identities](https://blog.yannickreekmans.be/secretless-applications-managed-identities/),
highly recommended to read this -- helped me a lot to understand.

## Azure Functions {#toc-hId--1511127540}

If you'd like to deploy and execute code without needing to THINK about
server infrastructure or VMs, you may like Azure Functions. Azure
Functions can be written in a lot of languages and you can deploy and
execute Azure Functions on any platform that can run .NET Core. Azure
functions are scalable, as they use compute-on-demand: More resources
are allocated automagically, when the demand of execution increases. If
the demand decreases again, you don't need to worry about the extra
resources anymore as they drop off again. This way, you only pay what
you need. For more info please start to read here: [Azure Functions
Overview \| Microsoft
Docs](https://docs.microsoft.com/en-us/azure/azure-functions/functions-overview)

I will use PowerShell for my Azure Functions, so that IT-Pros can
benefit from this post as well. But please do choose [your poison
]{style="text-decoration: line-through;"}your favourite language, the
concept stays the same. Use whatever you are familiar with or what makes
you happy.

## Microsoft Graph {#toc-hId-976385293}

Microsoft Graph is THE API to access Microsoft 365 resources, in our
case we will want to read all Microsoft 365 groups -- for more
information see also the [Microsoft Graph permissions reference --
Microsoft Graph \| Microsoft
Docs.](https://docs.microsoft.com/en-us/graph/permissions-reference#group-permissions)

Our challenge will be to access the Graph API with a Managed Identity. I
will show how to do this entirely in Azure CLI & [VS
Code](https://code.visualstudio.com/). Creating and assigning Managed
Identities has been shown often before in the Azure portal, but a script
would allow for automation, it is usually faster than working in a
visual environment and you can use the tool of your choice. I highly
recommend VS Code as editor (and I like the built-in terminal as well).

# Create your Azure Functions locally {#toc-hId-965882189}

You still may create your first Azure Functions in the Azure Portal (I
did as well), which demoes really nicely, but as we want to go for real
world, I will show how to develop your Azure Functions in Visual Studio
code. This has some great advantages:

-   you develop locally using the tools that you are already familiar
    with
-   you don't need to adjust to ever changing UI in Azure portal
-   you can benefit from source control
-   you can collaborate with others

I covered how to do this also in a previous post, but for the sake of a
start-to-end scenario, here we go again:

-   Install the Core Tools package with npm install -g
    azure-functions-core-tools\@3 \--unsafe-perm true
-   Install the Azure Functions extension for VS Code
-   Select New Project
-   Select a folder for your project
-   Select a language -- I will use PowerShell
-   Select HTTP trigger as a template
-   Type in a better name like GetGraphToken
-   Select Authorization level Function
-   Select how you want to open your project -- I prefer Add to
    workspace
-   You will now see your Local Project in the pane.

 

(yes, my pane is on the right hand side so that my code doesn't "jump"
all the time when I am expanding or collapsing the pane)\
\

We will now write the code for our Azure Functions. Replace the default
code of run.ps1 in VS Code by this:

 

``` {.lia-code-sample .language-bash}
using namespace System.Net

# Input bindings are passed in via param block
param($Request, $TriggerMetadata)

# Write to the Azure Functions log stream.
Write-Host "PowerShell HTTP trigger function processed a request."

# Interact with query parameters or the body of the request
.$Scope = $Request.Query.Scope
if (-not $Scope) {
$Scope = $Request.Body.Scope
}
#If parameter "Scope" has not been provided, we assume that graph.microsoft.com is the target resource
If (!$Scope) {
$Scope = "https://graph.microsoft.com/"
}

$tokenAuthUri = $env:IDENTITY_ENDPOINT + "?resource=$Scope&amp;api-version=2019-08-01"
$response = Invoke-RestMethod -Method Get -Headers @{"X-IDENTITY-HEADER"="$env:IDENTITY_HEADER"} -Uri $tokenAuthUri -UseBasicParsing

$accessToken = $response.access_token

#Invoke REST call to Graph API
$uri = 'https://graph.microsoft.com/v1.0/groups'
$authHeader = @{
'Content-Type'='application/json'
'Authorization'='Bearer ' + $accessToken
}

$result = (Invoke-RestMethod -Uri $uri -Headers $authHeader -Method Get -ResponseHeadersVariable RES).value

If ($result) {
$body = $result
$StatusCode = '200'
}
Else {
$body = $RES
$StatusCode = '400'}

# Associate values to output bindings by calling 'Push-OutputBinding'
Push-OutputBinding -Name Response -Value ([HttpResponseContext]@{
StatusCode = $StatusCode
Body = $body
})
```

 

Take a moment to understand what the code does:

-   log that a request was received
-   define the scope (if not stated, it's Microsoft Graph)
-   obtain the token from the environment variables
    \`IDENTITY_ENDPOINT\` and \`IDENTITY_HEADER\` which come from the
    Managed Identity (thanks [Yannick
    Reekmans](https://twitter.com/yannickreekmans) for this hint) --
    learn more here: [Managed identities -- Azure App Service \|
    Microsoft
    Docs](https://docs.microsoft.com/en-us/azure/app-service/overview-managed-identity?tabs=powershell&WT.mc_id=M365-MVP-5003400#obtain-tokens-for-azure-resources)
    -- you can also see your environment variables here, the mentioned
    ones will show after you assigned the system assigned Managed
    Identity:
    [https://\<YOUR-FUNCTIONAPPNAME-HERE>.scm.azurewebsites.net/ENV.cshtml#envVariables](https://%3cYOUR-FUNCTIONAPPNAME-HERE%3e.scm.azurewebsites.net/ENV.cshtml#envVariables))
-   pass that token in the header of the REST call towards the group
    endpoint of Microsoft Graph
-   get the status code (hopefully 200)

Watch out -- the Graph API will this way return up to 100 groups --
Please adjust with [query
parameters](https://docs.microsoft.com/en-us/graph/query-parameters) as
needed like [https://graph.microsoft.com/v1.0/groups?\$top=42
or](https://graph.microsoft.com/v1.0/groups?$top=42&nbsp;or) use paging,
which is described here: [Paging Microsoft Graph data in your app --
Microsoft Graph \| Microsoft
Docs](https://docs.microsoft.com/en-us/graph/paging)

 

# Resources in Azure {#toc-hId--841572274}

We will now create the Functions App in Azure -- You can either install
the CLI or use Cloud shell (available on shell.azure.com -- no
installation is needed then and it works in any browser!)

## Variables & names {#toc-hId--151010800}

For testing purposes, I pseudo-randomized a number to not always need to
come up with new names:

 

``` {.lia-code-sample .language-bash}
#Get a random number between 100 and 300 to more easily be able to distinguish between several trials
$rand = Get-Random -Minimum 100 -Maximum 300
```

We will now set some variables, this reduces risk of typos and makes our
code better readable -- also we can reuse it better -- this is a
courtesy to future-self

``` {.lia-code-sample .language-applescript}
#Set values
$resourceGroup = "DemoPlay$rand"
$location = "westeurope"
$storage = "luisedemostorage$rand"
$functionapp = "LuiseDemo-functionapp$rand"
```

## Resource group {#toc-hId--1958465263}

Let's create a resource-group that will later hold our Azure Functions
App

 

``` {.lia-code-sample .language-bash}
#create group
az group create -n $resourceGroup -l $location
```

## Storage Account {#toc-hId-529047570}

As our Functions App will need a storage account, we will create this as
well:

``` {.lia-code-sample .language-bash}
#create storage account
az storage account create `
-n $storage `
-l $location `
-g $resourceGroup `
--sku Standard_LRS
```

 

## Functions App {#toc-hId-395362846}

Now create the Azure Functions app which later holds our functions
(remember we created that earlier locally, but will later deploy it to
Azure)

 

``` {.lia-code-sample .language-bash}
#create function
az functionapp create `
-n $functionapp `
--storage-account $storage `
--consumption-plan-location $location `
--runtime powershell `
-g $resourceGroup `
--functions-version 3
```

It will take a few moments for everything to be set, once this step is
completed, you will be prompted with a message, that you also can
benefit from Application Insights.

## Managed Identity {#toc-hId--1412091617}

We want things to be super secure -- this is why we want to enable a
system assigned Managed Identity for our new Functions:

``` {.lia-code-sample .language-bash}
az functionapp identity assign -n $functionapp -g $resourceGroup
```

 Our Managed Identity shall have the right permission scope to access
Graph API for Group.Read.All, and to eventually be able to make the
required REST call, we will need

-   the Graph API service Provider
-   permission scope, expressed as App role\
    Let's do this:

``` {.lia-code-sample .language-bash}
#Get Graph Api service provider (that's later needed for --api) 
az ad sp list --query "[?appDisplayName=='Microsoft Graph'].{Name:appDisplayName, Id:appId}" --output table --all

#Save that service provider 
$graphId = az ad sp list --query "[?appDisplayName=='Microsoft Graph'].appId | [0]" --all 

# Get permission scope for "Group.Read.All"
$appRoleId = az ad sp show --id $graphId --query "appRoles[?value=='Group.Read.All'].id | [0]" 
```

Time to make the REST call to assign the permissions as shown above to
the Managed Identity:

``` {.lia-code-sample .language-bash}
#Set values
$webAppName="LuiseDemo-functionapp$rand"
$principalId=$(az resource list -n $webAppName --query [*].identity.principalId --out tsv)
$graphResourceId=$(az ad sp list --display-name "Microsoft Graph" --query [0].objectId --out tsv)
$appRoleId=$(az ad sp list --display-name "Microsoft Graph" --query "[0].appRoles[?value=='Group.Read.All' &amp;&amp; contains(allowedMemberTypes, 'Application')].id" --out tsv)
$body="{'principalId':'$principalId','resourceId':'$graphResourceId','appRoleId':'$appRoleId'}"

#the actual REST call 
az rest --method post --uri https://graph.microsoft.com/v1.0/servicePrincipals/$principalId/appRoleAssignments --body $body --headers Content-Type=application/json
```

 

If you like to, you may now have a look at our Managed Identity
permissions in the Azure portal -- for everyone who loves to be assured
in a UI that things have worked:\
\

 

[![image-10-2048x664.png](https://techcommunity.microsoft.com/t5/image/serverpage/image-id/304844i72C17561D5475584/image-size/large?v=v2&px=999 "image-10-2048x664.png"){.lia-media-image
role="button"
li-image-url="https://techcommunity.microsoft.com/t5/image/serverpage/image-id/304844i72C17561D5475584?v=v2"
li-image-display-id="'304844i72C17561D5475584'"
li-message-uid="'2628047'" li-messages-message-image="true"
li-bindable="" tabindex="0" li-bypass-lightbox-when-linked="true"
li-use-hover-links="false"}]{.lia-inline-image-display-wrapper
.lia-image-align-inline image-alt="image-10-2048x664.png"
style="width: 999px;"}

-   Open [portal.azure.com](https://portal.azure.com/)
-   Select Azure Active Directory
-   Select Enterprise applications
-   Select Managed Identity from the Applications dropdown
-   Note the app level permission Read all groups for Microsoft Graph

## Deploy to Azure {#toc-hId-1075421216}

 

Let's now deploy our Function to our Functions App. Go back to Visual
Studio Code:\
\

-   Select the Azure extension
-   Select deploy to Functions App -- its that little cloud icon
-   Select the Functions App you already created in Azure
-   Confirm the Pop up window by selecting Deploy
-   Check progress results in the output window

Time to test!\
Please note, that due to our Managed Identity, we can't test locally.
You can trigger your Functions with Postman or similar or run a test in
the Azure portal

 

-   Open portal.azure.com
-   Select **Resource groups**
-   Select the resource group you worked in
-   Select the Azure Functions App you worked in
-   Select **Functions**
-   Select **Code + Test**
-   Select **Test/Run**
-   Select **Run**

 

You should see a status code 200 -- and a list of all your Microsoft 365
groups. YAY!

 

[![groups
(1).png](https://techcommunity.microsoft.com/t5/image/serverpage/image-id/304845i4E5F31051B73B9B8/image-size/large?v=v2&px=999 "groups (1).png"){.lia-media-image
role="button"
li-image-url="https://techcommunity.microsoft.com/t5/image/serverpage/image-id/304845i4E5F31051B73B9B8?v=v2"
li-image-display-id="'304845i4E5F31051B73B9B8'"
li-message-uid="'2628047'" li-messages-message-image="true"
li-bindable="" tabindex="0" li-bypass-lightbox-when-linked="true"
li-use-hover-links="false"}]{.lia-inline-image-display-wrapper
.lia-image-align-inline image-alt="groups (1).png"
style="width: 906px;"}

## Conclusion and FusionDev scenario {#toc-hId--732033247}

As developers, we could build a robust, scalable and secure solution,
developed with familiar tools like VS Code, PowerShell or Azure CLI. But
what if we want to make this available to makers/citizen developers?
What if we want to make sure, that this could be used in Power Apps and
Power Automate? One way to achieve this, is creating a Power Platform
custom connector. This way, makers can use the connector which calls our
Azure Functions in a canvas app and display for example the groups in a
gallery or table.\
\
Please note, that there are of course more fancy use cases, I will focus
in this blog post on the code -- If you have a good story, please reach
out.\
\
Sample script is available at [Script Samples \| PnP
Samples](https://pnp.github.io/script-samples/)

 

 

## More Resources to learn {#toc-hId-1755479586}

\
Get started with Microsoft 365 development by signing up for a [free
Developer
tenant](https://developer.microsoft.com/en-us/microsoft-365/dev-program)\
Join the [Microsoft 365 PnP Community](https://pnp.github.io/) -- join
our calls and benefit from guidance, tools, sample\
 \
Originally published at [Putting some more FUN into Azure Functions,
Managed Identity & Microsoft Graph -- M365
Princess](https://m365princess.com/putting-some-fun-into-azure-functions-managed-identity-and-microsoft-graph/)
:::
:::
:::
:::
:::
:::

::: {.lia-quilt-row .lia-quilt-row-footer}
::: {.lia-quilt-column .lia-quilt-column-12 .lia-quilt-column-left .lia-quilt-column-footer-left}
::: {.lia-quilt-column-alley .lia-quilt-column-alley-left}
::: {#kudosButtonV2 .KudosButton .lia-button-image-kudos-wrapper .lia-component-kudos-widget-button-version-3 .lia-component-kudos-widget-button-horizontal .lia-component-kudos-widget-button .lia-component-kudos-action .lia-component-message-view-widget-kudos-action lia-kudos-id="2628047"}
::: {.lia-button-image-kudos .lia-button-image-kudos-horizontal .lia-button-image-kudos-enabled .lia-button-image-kudos-not-kudoed .lia-button-image-kudos-has-kudoes .lia-button-image-kudos-has-kudos .lia-button aria-atomic="true" aria-live="assertive"}
::: lia-button-image-kudos-count
[[ 3 ]{#messageKudosCount_23165e9f3b42df .MessageKudosCount
.lia-component-kudos-widget-message-kudos-count itemprop="upvoteCount"}[
Likes ]{.lia-button-image-kudos-label
.lia-component-kudos-widget-kudos-count-label}](/t5/kudos/messagepage/board-id/Microsoft365PnPBlog/message-id/404/tab/all-users "Click here to see who gave likes to this post."){#link_7
.lia-link-navigation .kudos-count-link}
:::

::: lia-button-image-kudos-give
[Like](https://techcommunity.microsoft.com/t5/blogs/v2/blogarticlepage.kudosbuttonv2.kudoentity:kudoentity/kudosable-gid/2628047?t:ac=blog-id/Microsoft365PnPBlog/article-id/404&t:cp=kudos/contributions/tapletcontributionspage "Click here to give likes to this post."){#kudoEntity
.lia-link-navigation .kudos-link .lia-link-ticket-post-action}
:::
:::
:::
:::
:::

::: {.lia-quilt-column .lia-quilt-column-12 .lia-quilt-column-right .lia-quilt-column-footer-right}
::: {.lia-quilt-column-alley .lia-quilt-column-alley-right}
::: {.lia-button-group .lia-component-comment-button .lia-component-message-view-widget-comment-button}
:::
:::
:::
:::

::: {.lia-quilt-row .lia-quilt-row-mod-controls}
::: {.lia-quilt-column .lia-quilt-column-24 .lia-quilt-column-single .lia-quilt-column-mod-controls-main}
::: {.lia-quilt-column-alley .lia-quilt-column-alley-single .lia-mark-empty}
:::
:::
:::

::: {.lia-quilt-row .lia-quilt-row-sub-footer}
::: {.lia-quilt-column .lia-quilt-column-24 .lia-quilt-column-single .lia-quilt-column-sub-footer .lia-mark-empty}
:::
:::
:::
:::
:::

::: {#progressBar .lia-progress .lia-js-hidden}
::: lia-progress-indeterminate
:::
:::
:::
:::

::: {.lia-text .lia-blog-article-page-comment-count .lia-discussion-page-sub-section-header .lia-component-comment-count-conditional}
3 Comments
:::

[]{#comments}

::: {#lazyload .lia-component-blogs-page-comment-list-loader .lia-component-lazy-loader .lia-lazy-load .lia-component-comment-list}
:::

[]{#comment-on-this} [ ]{#feedback-successinformationbox_6}

::: {#informationbox_6 .InfoMessage .lia-panel-feedback-banner-note .lia-component-comment-editor}
::: {.lia-text role="alert"}
You must be a registered user to add a comment. If you\'ve already
registered, sign in. Otherwise, register and sign in.

-   [Comment](/plugins/common/feature/oauth2sso/sso_login_redirect?lang=en&redirectreason=permissiondenied&referer=https%3A%2F%2Ftechcommunity.microsoft.com%2Ft5%2Fmicrosoft-365-pnp-blog%2Fputting-some-more-fun-into-azure-functions-managed-identity-amp%2Fba-p%2F2628047%23comment-on-this){#link_8
    .lia-link-navigation .blog-link .lia-message-comment-post}
:::
:::
:::
:::

::: {.lia-quilt-column .lia-quilt-column-06 .lia-quilt-column-right .lia-quilt-column-side-content}
::: {.lia-quilt-column-alley .lia-quilt-column-alley-right}
%3CLINGO-SUB%20id%3D%22lingo-sub-2628949%22%20slang%3D%22en-US%22%3ERe%3A%20Putting%20some%20more%20FUN%20into%20Azure%20Functions%2C%20Managed%20Identity%20%26amp%3B%20Microsoft%20Graph%3C%2FLINGO-SUB%3E%3CLINGO-BODY%20id%3D%22lingo-body-2628949%22%20slang%3D%22en-US%22%3E%3CP%3EGreat%20article.%20Thanks%20for%20sharing%3CBR%20%2F%3EBelieve%20it%20or%20not%20but%20after%20checking%20this%20one%20I%20also%20moved%20the%20side%20menu%20on%20the%20right%20side%20(no%20jumping%20code%2C%20how%20could%20I%20noticed%20that%20before%20%3A)%3C%2Fimg%3E%26nbsp%3B)%3C%2FP%3E%3C%2FLINGO-BODY%3E%3CLINGO-SUB%20id%3D%22lingo-sub-2641168%22%20slang%3D%22en-US%22%3ERe%3A%20Putting%20some%20more%20FUN%20into%20Azure%20Functions%2C%20Managed%20Identity%20%26amp%3B%20Microsoft%20Graph%3C%2FLINGO-SUB%3E%3CLINGO-BODY%20id%3D%22lingo-body-2641168%22%20slang%3D%22en-US%22%3E%3CP%3EHey%26nbsp%3B%3CA%20href%3D%22https%3A%2F%2Ftechcommunity.microsoft.com%2Ft5%2Fuser%2Fviewprofilepage%2Fuser-id%2F972728%22%20target%3D%22_blank%22%3E%40AdamWoj%3C%2FA%3E%26nbsp%3B-%20thank%20you%20for%20your%20feedback!%20Do%20you%20have%20a%20scenario%20where%20you%20would%20use%20my%20approach%3F%26nbsp%3B%3CBR%20%2F%3EAlso%3A%20side%20menu%20on%20the%20right%20FTW!%20You%20can%20also%20do%20this%20with%20the%20new%20%60.%60%20feature%20on%20GitHub.%20-%20On%20any%20GitHub%20repo%20-%20press%20the%20Dot%20on%20your%20keyboard%20and%20get%20VisualStudio%20Code%20IN%20YOUR%20BROWSER%26nbsp%3B%20%3A)%3C%2Fimg%3E%26nbsp%3B%26nbsp%3B%3C%2FP%3E%3C%2FLINGO-BODY%3E%3CLINGO-SUB%20id%3D%22lingo-sub-2642664%22%20slang%3D%22en-US%22%3ERe%3A%20Putting%20some%20more%20FUN%20into%20Azure%20Functions%2C%20Managed%20Identity%20%26amp%3B%20Microsoft%20Graph%3C%2FLINGO-SUB%3E%3CLINGO-BODY%20id%3D%22lingo-body-2642664%22%20slang%3D%22en-US%22%3E%3CP%3E%3CA%20href%3D%22https%3A%2F%2Ftechcommunity.microsoft.com%2Ft5%2Fuser%2Fviewprofilepage%2Fuser-id%2F89985%22%20target%3D%22_blank%22%3E%40Luise%20Freese%3C%2FA%3E%26nbsp%3B%20currently%20no%2C%20not%20for%20production%20use%20at%20least%20%3B)%3C%2Fimg%3E%20but%20who%20knows%20what%20will%20be%20the%20future%20requirements%2C%20so%20I%20try%20to%20keep%20up%20to%20date%20with%20any%20\'tips%20and%20tricks\'%20%3AP.%3C%2FP%3E%3C%2FLINGO-BODY%3E%3CLINGO-SUB%20id%3D%22lingo-sub-2628047%22%20slang%3D%22en-US%22%3EPutting%20some%20more%20FUN%20into%20Azure%20Functions%2C%20Managed%20Identity%20%26amp%3B%20Microsoft%20Graph%3C%2FLINGO-SUB%3E%3CLINGO-BODY%20id%3D%22lingo-body-2628047%22%20slang%3D%22en-US%22%3E%3CH1%20id%3D%22toc-hId-1413219912%22%20id%3D%22toc-hId-1413225680%22%3EUsecase%20%26amp%3B%20purpose%20of%20this%20blog%20post%3C%2FH1%3E%0A%3CP%3EI%20want%20to%20show%2C%20how%20you%20can%20use%20a%20Managed%20Identity%20in%20Azure%20Functions%20to%20get%20an%20access%20token%20for%20Microsoft%20Graph%20API.%3C%2FP%3E%0A%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3CP%3E%3CSPAN%20class%3D%22lia-inline-image-display-wrapper%20lia-image-align-inline%22%20image-alt%3D%22image-8.png%22%20style%3D%22width%3A%20999px%3B%22%3E%3CIMG%20src%3D%22https%3A%2F%2Ftechcommunity.microsoft.com%2Ft5%2Fimage%2Fserverpage%2Fimage-id%2F304842i590EDC4B973AB05C%2Fimage-size%2Flarge%3Fv%3Dv2%26amp%3Bpx%3D999%22%20role%3D%22button%22%20title%3D%22image-8.png%22%20alt%3D%22image-8.png%22%20%2F%3E%3C%2FSPAN%3E%20%3CBR%20%2F%3E%3CBR%20%2F%3E%3C%2FP%3E%0A%3CH1%20id%3D%22toc-hId\--394234551%22%20id%3D%22toc-hId\--394228783%22%3EPrerequisites%20to%20benefit%20from%20this%20article%3A%3C%2FH1%3E%0A%3CP%3ETo%20get%20the%20most%20out%20of%20this%20post%2C%20you%20should%20understand%20the%20following%20concepts%20%E2%80%93%20I%20included%20some%20links%20that%20should%20help%20you%20getting%20started.%3C%2FP%3E%0A%3CH2%20id%3D%22toc-hId-296326923%22%20id%3D%22toc-hId-296332691%22%3EManaged%20Identity%20%E2%80%93%20What%20is%20that%20and%20why%20would%20I%20want%20one%3F%3C%2FH2%3E%0A%3CP%3EManaged%20Identities%20are%20the%20state-of-the-art%20way%20to%20get%20Azure%20Active%20Directory%20access%20tokens%2C%20because%20you%20won%E2%80%99t%20need%20to%20handle%20credentials%2C%20which%20is%20of%20course%20a%20security%20benefit%3C%2FP%3E%0A%3CP%3E%26gt%3B%E2%80%A6where%20there%20are%20credentials%2C%20there%20are%20leaks%20%C2%AF%5C\_(%E3%83%84)\_%2F%C2%AF%3C%2FP%3E%0A%3CP%3EIf%20you%20are%20unfamiliar%20with%20tokens%2C%20%3CA%20href%3D%22https%3A%2F%2Ftechcommunity.microsoft.com%2Ft5%2Fmicrosoft-365-pnp-blog%2Fintroduction-to-tokens%2Fba-p%2F2267853%22%20target%3D%22_blank%22%3Ethis%20article%20by%20Lee%20Ford%3C%2FA%3E%20will%20help.%20This%20is%20not%20a%20full%20tutorial%20on%20Managed%20Identities%2C%20for%20more%20information%20please%20start%20to%20read%20here.%20Also%2C%20%3CA%20href%3D%22https%3A%2F%2Ftwitter.com%2FYannickReekmans%22%20target%3D%22_blank%22%20rel%3D%22nofollow%20noopener%20noreferrer%22%3EYannick%20Reekmans%3C%2FA%3E%20posted%20an%20entire%20%3CA%20href%3D%22https%3A%2F%2Fblog.yannickreekmans.be%2Fsecretless-applications-managed-identities%2F%22%20target%3D%22_blank%22%20rel%3D%22nofollow%20noopener%20noreferrer%22%3Eseries%20on%20Managed%20Identities%3C%2FA%3E%2C%20highly%20recommended%20to%20read%20this%20%E2%80%93%20helped%20me%20a%20lot%20to%20understand.%3C%2FP%3E%0A%3CH2%20id%3D%22toc-hId\--1511127540%22%20id%3D%22toc-hId\--1511121772%22%3EAzure%20Functions%3C%2FH2%3E%0A%3CP%3EIf%20you%E2%80%99d%20like%20to%20deploy%20and%20execute%20code%20without%20needing%20to%20THINK%20about%20server%20infrastructure%20or%20VMs%2C%20you%20may%20like%20Azure%20Functions.%20Azure%20Functions%20can%20be%20written%20in%20a%20lot%20of%20languages%20and%20you%20can%20deploy%20and%20execute%20Azure%20Functions%20on%20any%20platform%20that%20can%20run%20.NET%20Core.%20Azure%20functions%20are%20scalable%2C%20as%20they%20use%20compute-on-demand%3A%20More%20resources%20are%20allocated%20automagically%2C%20when%20the%20demand%20of%20execution%20increases.%20If%20the%20demand%20decreases%20again%2C%20you%20don%E2%80%99t%20need%20to%20worry%20about%20the%20extra%20resources%20anymore%20as%20they%20drop%20off%20again.%20This%20way%2C%20you%20only%20pay%20what%20you%20need.%20For%20more%20info%20please%20start%20to%20read%20here%3A%20%3CA%20href%3D%22https%3A%2F%2Fdocs.microsoft.com%2Fen-us%2Fazure%2Fazure-functions%2Ffunctions-overview%22%20target%3D%22_blank%22%20rel%3D%22noopener%20noreferrer%22%3EAzure%20Functions%20Overview%20%7C%20Microsoft%20Docs%3C%2FA%3E%3C%2FP%3E%0A%3CP%3EI%20will%20use%20PowerShell%20for%20my%20Azure%20Functions%2C%20so%20that%20IT-Pros%20can%20benefit%20from%20this%20post%20as%20well.%20But%20please%20do%20choose%20%3CSPAN%20style%3D%22text-decoration%3A%20line-through%3B%22%3Eyour%20poison%20%3C%2FSPAN%3Eyour%20favourite%20language%2C%20the%20concept%20stays%20the%20same.%20Use%20whatever%20you%20are%20familiar%20with%20or%20what%20makes%20you%20happy.%3C%2FP%3E%0A%3CH2%20id%3D%22toc-hId-976385293%22%20id%3D%22toc-hId-976391061%22%3EMicrosoft%20Graph%3C%2FH2%3E%0A%3CP%3EMicrosoft%20Graph%20is%20THE%20API%20to%20access%20Microsoft%20365%20resources%2C%20in%20our%20case%20we%20will%20want%20to%20read%20all%20Microsoft%20365%20groups%20%E2%80%93%20for%20more%20information%20see%20also%20the%20%3CA%20href%3D%22https%3A%2F%2Fdocs.microsoft.com%2Fen-us%2Fgraph%2Fpermissions-reference%23group-permissions%22%20target%3D%22_blank%22%20rel%3D%22noopener%20noreferrer%22%3EMicrosoft%20Graph%20permissions%20reference%20%E2%80%93%20Microsoft%20Graph%20%7C%20Microsoft%20Docs.%3C%2FA%3E%3C%2FP%3E%0A%3CP%3EOur%20challenge%20will%20be%20to%20access%20the%20Graph%20API%20with%20a%20Managed%20Identity.%20I%20will%20show%20how%20to%20do%20this%20entirely%20in%20Azure%20CLI%20%26amp%3B%20%3CA%20href%3D%22https%3A%2F%2Fcode.visualstudio.com%2F%22%20target%3D%22_blank%22%20rel%3D%22noopener%20noreferrer%22%3EVS%20Code%3C%2FA%3E.%20Creating%20and%20assigning%20Managed%20Identities%20has%20been%20shown%20often%20before%20in%20the%20Azure%20portal%2C%20but%20a%20script%20would%20allow%20for%20automation%2C%20it%20is%20usually%20faster%20than%20working%20in%20a%20visual%20environment%20and%20you%20can%20use%20the%20tool%20of%20your%20choice.%20I%20highly%20recommend%20VS%20Code%20as%20editor%20(and%20I%20like%20the%20built-in%20terminal%20as%20well).%3C%2FP%3E%0A%3CH1%20id%3D%22toc-hId-965882189%22%20id%3D%22toc-hId-965887957%22%3ECreate%20your%20Azure%20Functions%20locally%3C%2FH1%3E%0A%3CP%3EYou%20still%20may%20create%20your%20first%20Azure%20Functions%20in%20the%20Azure%20Portal%20(I%20did%20as%20well)%2C%20which%20demoes%20really%20nicely%2C%20but%20as%20we%20want%20to%20go%20for%20real%20world%2C%20I%20will%20show%20how%20to%20develop%20your%20Azure%20Functions%20in%20Visual%20Studio%20code.%20This%20has%20some%20great%20advantages%3A%3C%2FP%3E%0A%3CUL%3E%0A%3CLI%3Eyou%20develop%20locally%20using%20the%20tools%20that%20you%20are%20already%20familiar%20with%3C%2FLI%3E%0A%3CLI%3Eyou%20don%E2%80%99t%20need%20to%20adjust%20to%20ever%20changing%20UI%20in%20Azure%20portal%3C%2FLI%3E%0A%3CLI%3Eyou%20can%20benefit%20from%20source%20control%3C%2FLI%3E%0A%3CLI%3Eyou%20can%20collaborate%20with%20others%3C%2FLI%3E%0A%3C%2FUL%3E%0A%3CP%3EI%20covered%20how%20to%20do%20this%20also%20in%20a%20previous%20post%2C%20but%20for%20the%20sake%20of%20a%20start-to-end%20scenario%2C%20here%20we%20go%20again%3A%3C%2FP%3E%0A%3CUL%3E%0A%3CLI%3EInstall%20the%20Core%20Tools%20package%20with%20npm%20install%20-g%20azure-functions-core-tools%403%20\--unsafe-perm%20true%3C%2FLI%3E%0A%3CLI%3EInstall%20the%20Azure%20Functions%20extension%20for%20VS%20Code%3C%2FLI%3E%0A%3CLI%3ESelect%20New%20Project%3C%2FLI%3E%0A%3CLI%3ESelect%20a%20folder%20for%20your%20project%3C%2FLI%3E%0A%3CLI%3ESelect%20a%20language%20%E2%80%93%20I%20will%20use%20PowerShell%3C%2FLI%3E%0A%3CLI%3ESelect%20HTTP%20trigger%20as%20a%20template%3C%2FLI%3E%0A%3CLI%3EType%20in%20a%20better%20name%20like%20GetGraphToken%3C%2FLI%3E%0A%3CLI%3ESelect%20Authorization%20level%20Function%3C%2FLI%3E%0A%3CLI%3ESelect%20how%20you%20want%20to%20open%20your%20project%20%E2%80%93%20I%20prefer%20Add%20to%20workspace%3C%2FLI%3E%0A%3CLI%3EYou%20will%20now%20see%20your%20Local%20Project%20in%20the%20pane.%3C%2FLI%3E%0A%3C%2FUL%3E%0A%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3CP%3E(yes%2C%20my%20pane%20is%20on%20the%20right%20hand%20side%20so%20that%20my%20code%20doesn%E2%80%99t%20%E2%80%9Cjump%E2%80%9D%20all%20the%20time%20when%20I%20am%20expanding%20or%20collapsing%20the%20pane)%3CBR%20%2F%3E%3CBR%20%2F%3E%3C%2FP%3E%0A%3CP%3EWe%20will%20now%20write%20the%20code%20for%20our%20Azure%20Functions.%20Replace%20the%20default%20code%20of%20run.ps1%20in%20VS%20Code%20by%20this%3A%3C%2FP%3E%0A%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3CPRE%20class%3D%22lia-code-sample%20language-bash%22%3E%3CCODE%3Eusing%20namespace%20System.Net%0A%0A%23%20Input%20bindings%20are%20passed%20in%20via%20param%20block%0Aparam(%24Request%2C%20%24TriggerMetadata)%0A%0A%23%20Write%20to%20the%20Azure%20Functions%20log%20stream.%0AWrite-Host%20%22PowerShell%20HTTP%20trigger%20function%20processed%20a%20request.%22%0A%0A%23%20Interact%20with%20query%20parameters%20or%20the%20body%20of%20the%20request%0A.%24Scope%20%3D%20%24Request.Query.Scope%0Aif%20(-not%20%24Scope)%20%7B%0A%24Scope%20%3D%20%24Request.Body.Scope%0A%7D%0A%23If%20parameter%20%22Scope%22%20has%20not%20been%20provided%2C%20we%20assume%20that%20graph.microsoft.com%20is%20the%20target%20resource%0AIf%20(!%24Scope)%20%7B%0A%24Scope%20%3D%20%22https%3A%2F%2Fgraph.microsoft.com%2F%22%0A%7D%0A%0A%24tokenAuthUri%20%3D%20%24env%3AIDENTITY_ENDPOINT%20%2B%20%22%3Fresource%3D%24Scope%26amp%3Bamp%3Bapi-version%3D2019-08-01%22%0A%24response%20%3D%20Invoke-RestMethod%20-Method%20Get%20-Headers%20%40%7B%22X-IDENTITY-HEADER%22%3D%22%24env%3AIDENTITY_HEADER%22%7D%20-Uri%20%24tokenAuthUri%20-UseBasicParsing%0A%0A%24accessToken%20%3D%20%24response.access_token%0A%0A%23Invoke%20REST%20call%20to%20Graph%20API%0A%24uri%20%3D%20\'https%3A%2F%2Fgraph.microsoft.com%2Fv1.0%2Fgroups\'%0A%24authHeader%20%3D%20%40%7B%0A\'Content-Type\'%3D\'application%2Fjson\'%0A\'Authorization\'%3D\'Bearer%20\'%20%2B%20%24accessToken%0A%7D%0A%0A%24result%20%3D%20(Invoke-RestMethod%20-Uri%20%24uri%20-Headers%20%24authHeader%20-Method%20Get%20-ResponseHeadersVariable%20RES).value%0A%0AIf%20(%24result)%20%7B%0A%24body%20%3D%20%24result%0A%24StatusCode%20%3D%20\'200\'%0A%7D%0AElse%20%7B%0A%24body%20%3D%20%24RES%0A%24StatusCode%20%3D%20\'400\'%7D%0A%0A%23%20Associate%20values%20to%20output%20bindings%20by%20calling%20\'Push-OutputBinding\'%0APush-OutputBinding%20-Name%20Response%20-Value%20(%5BHttpResponseContext%5D%40%7B%0AStatusCode%20%3D%20%24StatusCode%0ABody%20%3D%20%24body%0A%7D)%3C%2FCODE%3E%3C%2FPRE%3E%0A%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3CP%3ETake%20a%20moment%20to%20understand%20what%20the%20code%20does%3A%3C%2FP%3E%0A%3CUL%3E%0A%3CLI%3Elog%20that%20a%20request%20was%20received%3C%2FLI%3E%0A%3CLI%3Edefine%20the%20scope%20(if%20not%20stated%2C%20it%E2%80%99s%20Microsoft%20Graph)%3C%2FLI%3E%0A%3CLI%3Eobtain%20the%20token%20from%20the%20environment%20variables%20%60IDENTITY_ENDPOINT%60%20and%20%60IDENTITY_HEADER%60%20which%20come%20from%20the%20Managed%20Identity%20(thanks%20%3CA%20href%3D%22https%3A%2F%2Ftwitter.com%2Fyannickreekmans%22%20target%3D%22_blank%22%20rel%3D%22nofollow%20noopener%20noreferrer%22%3EYannick%20Reekmans%3C%2FA%3E%20for%20this%20hint)%20%E2%80%93%20learn%20more%20here%3A%20%3CA%20href%3D%22https%3A%2F%2Fdocs.microsoft.com%2Fen-us%2Fazure%2Fapp-service%2Foverview-managed-identity%3Ftabs%3Dpowershell%26amp%3BWT.mc_id%3DM365-MVP-5003400%23obtain-tokens-for-azure-resources%22%20target%3D%22_blank%22%20rel%3D%22noopener%20noreferrer%22%3EManaged%20identities%20%E2%80%93%20Azure%20App%20Service%20%7C%20Microsoft%20Docs%3C%2FA%3E%20%E2%80%93%20you%20can%20also%20see%20your%20environment%20variables%20here%2C%20the%20mentioned%20ones%20will%20show%20after%20you%20assigned%20the%20system%20assigned%20Managed%20Identity%3A%20%3CA%20href%3D%22https%3A%2F%2F%253cYOUR-FUNCTIONAPPNAME-HERE%253e.scm.azurewebsites.net%2FENV.cshtml%23envVariables%22%20target%3D%22_blank%22%20rel%3D%22nofollow%20noopener%20noreferrer%22%3Ehttps%3A%2F%2F%3CYOUR-FUNCTIONAPPNAME-HERE%3E.scm.azurewebsites.net%2FENV.cshtml%23envVariables%3C%2FYOUR-FUNCTIONAPPNAME-HERE%3E%3C%2FA%3E)%3C%2FLI%3E%0A%3CLI%3Epass%20that%20token%20in%20the%20header%20of%20the%20REST%20call%20towards%20the%20group%20endpoint%20of%20Microsoft%20Graph%3C%2FLI%3E%0A%3CLI%3Eget%20the%20status%20code%20(hopefully%20200)%3C%2FLI%3E%0A%3C%2FUL%3E%0A%3CP%3EWatch%20out%20%E2%80%93%20the%20Graph%20API%20will%20this%20way%20return%20up%20to%20100%20groups%20%E2%80%93%20Please%20adjust%20with%20%3CA%20href%3D%22https%3A%2F%2Fdocs.microsoft.com%2Fen-us%2Fgraph%2Fquery-parameters%22%20target%3D%22_blank%22%20rel%3D%22noopener%20noreferrer%22%3Equery%20parameters%3C%2FA%3E%20as%20needed%20like%20%3CA%20href%3D%22https%3A%2F%2Fgraph.microsoft.com%2Fv1.0%2Fgroups%3F%24top%3D42%26amp%3Bnbsp%3Bor%22%20target%3D%22_blank%22%20rel%3D%22noopener%20noreferrer%22%3Ehttps%3A%2F%2Fgraph.microsoft.com%2Fv1.0%2Fgroups%3F%24top%3D42%20or%3C%2FA%3E%20use%20paging%2C%20which%20is%20described%20here%3A%20%3CA%20href%3D%22https%3A%2F%2Fdocs.microsoft.com%2Fen-us%2Fgraph%2Fpaging%22%20target%3D%22_blank%22%20rel%3D%22noopener%20noreferrer%22%3EPaging%20Microsoft%20Graph%20data%20in%20your%20app%20%E2%80%93%20Microsoft%20Graph%20%7C%20Microsoft%20Docs%3C%2FA%3E%3C%2FP%3E%0A%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3CH1%20id%3D%22toc-hId\--841572274%22%20id%3D%22toc-hId\--841566506%22%3EResources%20in%20Azure%3C%2FH1%3E%0A%3CP%3EWe%20will%20now%20create%20the%20Functions%20App%20in%20Azure%20%E2%80%93%20You%20can%20either%20install%20the%20CLI%20or%20use%20Cloud%20shell%20(available%20on%20shell.azure.com%20%E2%80%93%20no%20installation%20is%20needed%20then%20and%20it%20works%20in%20any%20browser!)%3C%2FP%3E%0A%3CH2%20id%3D%22toc-hId\--151010800%22%20id%3D%22toc-hId\--151005032%22%3EVariables%20%26amp%3B%20names%3C%2FH2%3E%0A%3CP%3EFor%20testing%20purposes%2C%20I%20pseudo-randomized%20a%20number%20to%20not%20always%20need%20to%20come%20up%20with%20new%20names%3A%3C%2FP%3E%0A%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3CPRE%20class%3D%22lia-code-sample%20language-bash%22%3E%3CCODE%3E%23Get%20a%20random%20number%20between%20100%20and%20300%20to%20more%20easily%20be%20able%20to%20distinguish%20between%20several%20trials%0A%24rand%20%3D%20Get-Random%20-Minimum%20100%20-Maximum%20300%3C%2FCODE%3E%3C%2FPRE%3E%0A%3CP%3EWe%20will%20now%20set%20some%20variables%2C%20this%20reduces%20risk%20of%20typos%20and%20makes%20our%20code%20better%20readable%20%E2%80%93%20also%20we%20can%20reuse%20it%20better%20%E2%80%93%20this%20is%20a%20courtesy%20to%20future-self%3C%2FP%3E%0A%3CPRE%20class%3D%22lia-code-sample%20language-applescript%22%3E%3CCODE%3E%23Set%20values%0A%24resourceGroup%20%3D%20%22DemoPlay%24rand%22%0A%24location%20%3D%20%22westeurope%22%0A%24storage%20%3D%20%22luisedemostorage%24rand%22%0A%24functionapp%20%3D%20%22LuiseDemo-functionapp%24rand%22%0A%3C%2FCODE%3E%3C%2FPRE%3E%0A%3CH2%20id%3D%22toc-hId\--1958465263%22%20id%3D%22toc-hId\--1958459495%22%3E%3CSPAN%3EResource%20group%3C%2FSPAN%3E%3C%2FH2%3E%0A%3CP%3ELet%E2%80%99s%20create%20a%20resource-group%20that%20will%20later%20hold%20our%20Azure%20Functions%20App%3C%2FP%3E%0A%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3CPRE%20class%3D%22lia-code-sample%20language-bash%22%3E%3CCODE%3E%23create%20group%0Aaz%20group%20create%20-n%20%24resourceGroup%20-l%20%24location%0A%3C%2FCODE%3E%3C%2FPRE%3E%0A%3CH2%20id%3D%22toc-hId-529047570%22%20id%3D%22toc-hId-529053338%22%3EStorage%20Account%3C%2FH2%3E%0A%3CP%3EAs%20our%20Functions%20App%20will%20need%20a%20storage%20account%2C%20we%20will%20create%20this%20as%20well%3A%3C%2FP%3E%0A%3CPRE%20class%3D%22lia-code-sample%20language-bash%22%3E%3CCODE%3E%23create%20storage%20account%0Aaz%20storage%20account%20create%20%60%0A-n%20%24storage%20%60%0A-l%20%24location%20%60%0A-g%20%24resourceGroup%20%60%0A\--sku%20Standard_LRS%0A%3C%2FCODE%3E%3C%2FPRE%3E%0A%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3CH2%20id%3D%22toc-hId-395362846%22%20id%3D%22toc-hId-395368614%22%3EFunctions%20App%3C%2FH2%3E%0A%3CP%3ENow%20create%20the%20Azure%20Functions%20app%20which%20later%20holds%20our%20functions%20(remember%20we%20created%20that%20earlier%20locally%2C%20but%20will%20later%20deploy%20it%20to%20Azure)%3C%2FP%3E%0A%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3CPRE%20class%3D%22lia-code-sample%20language-bash%22%3E%3CCODE%3E%23create%20function%0Aaz%20functionapp%20create%20%60%0A-n%20%24functionapp%20%60%0A\--storage-account%20%24storage%20%60%0A\--consumption-plan-location%20%24location%20%60%0A\--runtime%20powershell%20%60%0A-g%20%24resourceGroup%20%60%0A\--functions-version%203%0A%3C%2FCODE%3E%3C%2FPRE%3E%0A%3CP%3EIt%20will%20take%20a%20few%20moments%20for%20everything%20to%20be%20set%2C%20once%20this%20step%20is%20completed%2C%20you%20will%20be%20prompted%20with%20a%20message%2C%20that%20you%20also%20can%20benefit%20from%20Application%20Insights.%3C%2FP%3E%0A%3CH2%20id%3D%22toc-hId\--1412091617%22%20id%3D%22toc-hId\--1412085849%22%3EManaged%20Identity%3C%2FH2%3E%0A%3CP%3EWe%20want%20things%20to%20be%20super%20secure%20%E2%80%93%20this%20is%20why%20we%20want%20to%20enable%20a%20system%20assigned%20Managed%20Identity%20for%20our%20new%20Functions%3A%3C%2FP%3E%0A%3CPRE%20class%3D%22lia-code-sample%20language-bash%22%3E%3CCODE%3Eaz%20functionapp%20identity%20assign%20-n%20%24functionapp%20-g%20%24resourceGroup%3C%2FCODE%3E%3C%2FPRE%3E%0A%3CP%3E%26nbsp%3BOur%20Managed%20Identity%20shall%20have%20the%20right%20permission%20scope%20to%20access%20Graph%20API%20for%20Group.Read.All%2C%20and%20to%20eventually%20be%20able%20to%20make%20the%20required%20REST%20call%2C%20we%20will%20need%3C%2FP%3E%0A%3CUL%3E%0A%3CLI%3Ethe%20Graph%20API%20service%20Provider%3C%2FLI%3E%0A%3CLI%3Epermission%20scope%2C%20expressed%20as%20App%20role%3CBR%20%2F%3ELet%E2%80%99s%20do%20this%3A%3C%2FLI%3E%0A%3C%2FUL%3E%0A%3CPRE%20class%3D%22lia-code-sample%20language-bash%22%3E%3CCODE%3E%23Get%20Graph%20Api%20service%20provider%20(that\'s%20later%20needed%20for%20\--api)%20%0Aaz%20ad%20sp%20list%20\--query%20%22%5B%3FappDisplayName%3D%3D\'Microsoft%20Graph\'%5D.%7BName%3AappDisplayName%2C%20Id%3AappId%7D%22%20\--output%20table%20\--all%0A%0A%23Save%20that%20service%20provider%20%0A%24graphId%20%3D%20az%20ad%20sp%20list%20\--query%20%22%5B%3FappDisplayName%3D%3D\'Microsoft%20Graph\'%5D.appId%20%7C%20%5B0%5D%22%20\--all%20%0A%0A%23%20Get%20permission%20scope%20for%20%22Group.Read.All%22%0A%24appRoleId%20%3D%20az%20ad%20sp%20show%20\--id%20%24graphId%20\--query%20%22appRoles%5B%3Fvalue%3D%3D\'Group.Read.All\'%5D.id%20%7C%20%5B0%5D%22%20%0A%3C%2FCODE%3E%3C%2FPRE%3E%0A%3CP%3ETime%20to%20make%20the%20REST%20call%20to%20assign%20the%20permissions%20as%20shown%20above%20to%20the%20Managed%20Identity%3A%3C%2FP%3E%0A%3CPRE%20class%3D%22lia-code-sample%20language-bash%22%3E%3CCODE%3E%23Set%20values%0A%24webAppName%3D%22LuiseDemo-functionapp%24rand%22%0A%24principalId%3D%24(az%20resource%20list%20-n%20%24webAppName%20\--query%20%5B\*%5D.identity.principalId%20\--out%20tsv)%0A%24graphResourceId%3D%24(az%20ad%20sp%20list%20\--display-name%20%22Microsoft%20Graph%22%20\--query%20%5B0%5D.objectId%20\--out%20tsv)%0A%24appRoleId%3D%24(az%20ad%20sp%20list%20\--display-name%20%22Microsoft%20Graph%22%20\--query%20%22%5B0%5D.appRoles%5B%3Fvalue%3D%3D\'Group.Read.All\'%20%26amp%3Bamp%3B%26amp%3Bamp%3B%20contains(allowedMemberTypes%2C%20\'Application\')%5D.id%22%20\--out%20tsv)%0A%24body%3D%22%7B\'principalId\'%3A\'%24principalId\'%2C\'resourceId\'%3A\'%24graphResourceId\'%2C\'appRoleId\'%3A\'%24appRoleId\'%7D%22%0A%0A%23the%20actual%20REST%20call%20%0Aaz%20rest%20\--method%20post%20\--uri%20https%3A%2F%2Fgraph.microsoft.com%2Fv1.0%2FservicePrincipals%2F%24principalId%2FappRoleAssignments%20\--body%20%24body%20\--headers%20Content-Type%3Dapplication%2Fjson%0A%3C%2FCODE%3E%3C%2FPRE%3E%0A%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3CP%3EIf%20you%20like%20to%2C%20you%20may%20now%20have%20a%20look%20at%20our%20Managed%20Identity%20permissions%20in%20the%20Azure%20portal%20%E2%80%93%20for%20everyone%20who%20loves%20to%20be%20assured%20in%20a%20UI%20that%20things%20have%20worked%3A%3CBR%20%2F%3E%3CBR%20%2F%3E%3C%2FP%3E%0A%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3CP%3E%3CSPAN%20class%3D%22lia-inline-image-display-wrapper%20lia-image-align-inline%22%20image-alt%3D%22image-10-2048x664.png%22%20style%3D%22width%3A%20999px%3B%22%3E%3CIMG%20src%3D%22https%3A%2F%2Ftechcommunity.microsoft.com%2Ft5%2Fimage%2Fserverpage%2Fimage-id%2F304844i72C17561D5475584%2Fimage-size%2Flarge%3Fv%3Dv2%26amp%3Bpx%3D999%22%20role%3D%22button%22%20title%3D%22image-10-2048x664.png%22%20alt%3D%22image-10-2048x664.png%22%20%2F%3E%3C%2FSPAN%3E%3C%2FP%3E%0A%3CUL%3E%0A%3CLI%3EOpen%20%3CA%20href%3D%22https%3A%2F%2Fportal.azure.com%2F%22%20target%3D%22_blank%22%20rel%3D%22nofollow%20noopener%20noreferrer%22%3Eportal.azure.com%3C%2FA%3E%3C%2FLI%3E%0A%3CLI%3ESelect%20Azure%20Active%20Directory%3C%2FLI%3E%0A%3CLI%3ESelect%20Enterprise%20applications%3C%2FLI%3E%0A%3CLI%3ESelect%20Managed%20Identity%20from%20the%20Applications%20dropdown%3C%2FLI%3E%0A%3CLI%3ENote%20the%20app%20level%20permission%20Read%20all%20groups%20for%20Microsoft%20Graph%3C%2FLI%3E%0A%3C%2FUL%3E%0A%3CH2%20id%3D%22toc-hId-1075421216%22%20id%3D%22toc-hId-1075426984%22%3EDeploy%20to%20Azure%3C%2FH2%3E%0A%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3CP%3ELet%E2%80%99s%20now%20deploy%20our%20Function%20to%20our%20Functions%20App.%20Go%20back%20to%20Visual%20Studio%20Code%3A%3CBR%20%2F%3E%3CBR%20%2F%3E%3C%2FP%3E%0A%3CUL%3E%0A%3CLI%3ESelect%20the%20Azure%20extension%3C%2FLI%3E%0A%3CLI%3ESelect%20deploy%20to%20Functions%20App%20%E2%80%93%20its%20that%20little%20cloud%20icon%3C%2FLI%3E%0A%3CLI%3ESelect%20the%20Functions%20App%20you%20already%20created%20in%20Azure%3C%2FLI%3E%0A%3CLI%3EConfirm%20the%20Pop%20up%20window%20by%20selecting%20Deploy%3C%2FLI%3E%0A%3CLI%3ECheck%20progress%20results%20in%20the%20output%20window%3C%2FLI%3E%0A%3C%2FUL%3E%0A%3CP%3ETime%20to%20test!%3CBR%20%2F%3EPlease%20note%2C%20that%20due%20to%20our%20Managed%20Identity%2C%20we%20can%E2%80%99t%20test%20locally.%20You%20can%20trigger%20your%20Functions%20with%20Postman%20or%20similar%20or%20run%20a%20test%20in%20the%20Azure%20portal%3C%2FP%3E%0A%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3CUL%3E%0A%3CLI%3EOpen%20portal.azure.com%3C%2FLI%3E%0A%3CLI%3ESelect%20%3CSTRONG%3EResource%20groups%3C%2FSTRONG%3E%3C%2FLI%3E%0A%3CLI%3ESelect%20the%20resource%20group%20you%20worked%20in%3C%2FLI%3E%0A%3CLI%3ESelect%20the%20Azure%20Functions%20App%20you%20worked%20in%3C%2FLI%3E%0A%3CLI%3ESelect%20%3CSTRONG%3EFunctions%3C%2FSTRONG%3E%3C%2FLI%3E%0A%3CLI%3ESelect%20%3CSTRONG%3ECode%20%2B%20Test%3C%2FSTRONG%3E%3C%2FLI%3E%0A%3CLI%3ESelect%20%3CSTRONG%3ETest%2FRun%3C%2FSTRONG%3E%3C%2FLI%3E%0A%3CLI%3ESelect%20%3CSTRONG%3ERun%3C%2FSTRONG%3E%3C%2FLI%3E%0A%3C%2FUL%3E%0A%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3CP%3EYou%20should%20see%20a%20status%20code%20200%20%E2%80%93%20and%20a%20list%20of%20all%20your%20Microsoft%20365%20groups.%20YAY!%3C%2FP%3E%0A%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3CP%3E%3CSPAN%20class%3D%22lia-inline-image-display-wrapper%20lia-image-align-inline%22%20image-alt%3D%22groups%20(1).png%22%20style%3D%22width%3A%20906px%3B%22%3E%3CIMG%20src%3D%22https%3A%2F%2Ftechcommunity.microsoft.com%2Ft5%2Fimage%2Fserverpage%2Fimage-id%2F304845i4E5F31051B73B9B8%2Fimage-size%2Flarge%3Fv%3Dv2%26amp%3Bpx%3D999%22%20role%3D%22button%22%20title%3D%22groups%20(1).png%22%20alt%3D%22groups%20(1).png%22%20%2F%3E%3C%2FSPAN%3E%3C%2FP%3E%0A%3CH2%20id%3D%22toc-hId\--732033247%22%20id%3D%22toc-hId\--732027479%22%3EConclusion%20and%20FusionDev%20scenario%3C%2FH2%3E%0A%3CP%3EAs%20developers%2C%20we%20could%20build%20a%20robust%2C%20scalable%20and%20secure%20solution%2C%20developed%20with%20familiar%20tools%20like%20VS%20Code%2C%20PowerShell%20or%20Azure%20CLI.%20But%20what%20if%20we%20want%20to%20make%20this%20available%20to%20makers%2Fcitizen%20developers%3F%20What%20if%20we%20want%20to%20make%20sure%2C%20that%20this%20could%20be%20used%20in%20Power%20Apps%20and%20Power%20Automate%3F%20One%20way%20to%20achieve%20this%2C%20is%20creating%20a%20Power%20Platform%20custom%20connector.%20This%20way%2C%20makers%20can%20use%20the%20connector%20which%20calls%20our%20Azure%20Functions%20in%20a%20canvas%20app%20and%20display%20for%20example%20the%20groups%20in%20a%20gallery%20or%20table.%3CBR%20%2F%3E%3CBR%20%2F%3EPlease%20note%2C%20that%20there%20are%20of%20course%20more%20fancy%20use%20cases%2C%20I%20will%20focus%20in%20this%20blog%20post%20on%20the%20code%20%E2%80%93%20If%20you%20have%20a%20good%20story%2C%20please%20reach%20out.%20%3CBR%20%2F%3E%3CBR%20%2F%3ESample%20script%20is%20available%20at%20%3CA%20href%3D%22https%3A%2F%2Fpnp.github.io%2Fscript-samples%2F%22%20target%3D%22_blank%22%20rel%3D%22nofollow%20noopener%20noreferrer%22%3EScript%20Samples%20%7C%20PnP%20Samples%3C%2FA%3E%3C%2FP%3E%0A%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3CH2%20id%3D%22toc-hId-1755479586%22%20id%3D%22toc-hId-1755485354%22%3EMore%20Resources%20to%20learn%3C%2FH2%3E%0A%3CP%3E%3CBR%20%2F%3EGet%20started%20with%20Microsoft%20365%20development%20by%20signing%20up%20for%20a%20%3CA%20href%3D%22https%3A%2F%2Fdeveloper.microsoft.com%2Fen-us%2Fmicrosoft-365%2Fdev-program%22%20target%3D%22_blank%22%20rel%3D%22noopener%20noreferrer%22%3Efree%20Developer%20tenant%3C%2FA%3E%3CBR%20%2F%3EJoin%20the%20%3CA%20href%3D%22https%3A%2F%2Fpnp.github.io%2F%22%20target%3D%22_blank%22%20rel%3D%22nofollow%20noopener%20noreferrer%22%3EMicrosoft%20365%20PnP%20Community%3C%2FA%3E%20%E2%80%93%20join%20our%20calls%20and%20benefit%20from%20guidance%2C%20tools%2C%20sample%3CBR%20%2F%3E%26nbsp%3B%3CBR%20%2F%3EOriginally%20published%20at%20%3CA%20href%3D%22https%3A%2F%2Fm365princess.com%2Fputting-some-fun-into-azure-functions-managed-identity-and-microsoft-graph%2F%22%20target%3D%22_blank%22%20rel%3D%22nofollow%20noopener%20noreferrer%22%3EPutting%20some%20more%20FUN%20into%20Azure%20Functions%2C%20Managed%20Identity%20%26amp%3B%20Microsoft%20Graph%20%E2%80%93%20M365%20Princess%3C%2FA%3E%3C%2FP%3E%3C%2FLINGO-BODY%3E%3CLINGO-TEASER%20id%3D%22lingo-teaser-2628047%22%20slang%3D%22en-US%22%3E%3CP%3ELearn%20how%20to%20use%20a%20system-assigned%20Managed%20Identity%20in%20Azure%20Functions%20to%20call%20Microsoft%20Graph%3C%2FP%3E%0A%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3CP%3E%3CSPAN%20class%3D%22lia-inline-image-display-wrapper%20lia-image-align-inline%22%20image-alt%3D%22mateusz-waclawek-t2b2svMf8ek-unsplash.jpg%22%20style%3D%22width%3A%20999px%3B%22%3E%3CIMG%20src%3D%22https%3A%2F%2Ftechcommunity.microsoft.com%2Ft5%2Fimage%2Fserverpage%2Fimage-id%2F301804iB245D51166D5DA22%2Fimage-size%2Flarge%3Fv%3Dv2%26amp%3Bpx%3D999%22%20role%3D%22button%22%20title%3D%22mateusz-waclawek-t2b2svMf8ek-unsplash.jpg%22%20alt%3D%22mateusz-waclawek-t2b2svMf8ek-unsplash.jpg%22%20%2F%3E%3C%2FSPAN%3E%3C%2FP%3E%3C%2FLINGO-TEASER%3E%3CLINGO-LABS%20id%3D%22lingo-labs-2628047%22%20slang%3D%22en-US%22%3E%3CLINGO-LABEL%3EHow%20to%3C%2FLINGO-LABEL%3E%3C%2FLINGO-LABS%3E

::: {#threadTranslationDashboard .Thread_Translation_Dashboard ng-controller="lingotekThreadTranslationCtrl" li-bindable=""}
::: lingotek-admin-dashboard
:::
:::

::: {style="clear:both"}
:::

::: {#contributorsTaplet .ContributorsTaplet .lia-component-tkb-widget-contributors-taplet}
::: {.lia-panel .lia-panel-standard}
::: lia-decoration-border
::: lia-decoration-border-top
<div>

</div>
:::

::: lia-decoration-border-content
<div>

::: lia-panel-heading-bar-wrapper
::: lia-panel-heading-bar
[ Co-Authors ]{.lia-panel-heading-bar-title aria-level="3"
role="heading"}
:::
:::

::: lia-panel-content-wrapper
::: lia-panel-content
::: {.UserProfileSummary .lia-user-item .lia-js-data-userId-89985 .lia-user-info-group}
::: UserAvatarWrapper
::: {.UserAvatar .lia-user-avatar .lia-component-common-widget-user-avatar .MVP}
[![Luise
Freese](https://techcommunity.microsoft.com/t5/image/serverpage/image-id/267080i7F999E88693CAB4E/image-dimensions/40x40/image-coordinates/0%2C0%2C576%2C576?v=v2 "Luise Freese"){.lia-user-avatar-message
.user-rank-ring .user-rank-ring style="border-color: #107C10"
onerror="replaceBrokenAvatars(this, '/html/assets/default-avatar.png')"}](/t5/user/viewprofilepage/user-id/89985){.UserAvatar
.lia-link-navigation}
:::

::: {.user-profile-card user-id="89985"}
::: contents
::: spinner
:::
:::
:::
:::

::: lia-user-attributes
::: lia-user-name
[ [Luise
Freese](https://techcommunity.microsoft.com/t5/user/viewprofilepage/user-id/89985){#link_9
.lia-link-navigation .lia-page-link .lia-user-name-link} ]{.UserName
.lia-user-name .lia-user-rank-MVP}
:::
:::
:::
:::
:::

</div>
:::

::: lia-decoration-border-bottom
<div>

</div>
:::
:::
:::
:::

::: {.lia-panel .lia-panel-standard .ArticleRevisionInfoTaplet .Chrome .lia-component-tkb-widget-article-revision-info-taplet}
::: lia-decoration-border
::: lia-decoration-border-top
<div>

</div>
:::

::: lia-decoration-border-content
<div>

::: lia-panel-heading-bar-wrapper
::: lia-panel-heading-bar
[Version history]{.lia-panel-heading-bar-title aria-level="3"
role="heading"}
:::
:::

::: lia-panel-content-wrapper
::: lia-panel-content
::: lia-revision-info-wrapper
::: lia-revision-info-content
::: {.lia-revision-info-row .lia-revision-last-update-row}
::: lia-revision-info-title-cell
Last update:
:::

::: lia-revision-info-data-cell
[ [‎Aug 21 2021]{.local-date} [12:17 AM]{.local-time} ]{.DateTime}
:::
:::

::: {.lia-revision-info-row .lia-revision-author-row}
::: lia-revision-info-title-cell
Updated by:
:::

::: lia-revision-info-data-cell
[ [Luise
Freese](https://techcommunity.microsoft.com/t5/user/viewprofilepage/user-id/89985){#link_10
.lia-link-navigation .lia-page-link .lia-user-name-link} ]{.UserName
.lia-user-name .lia-user-rank-MVP}
:::
:::

::: {.lia-revision-info-row .lia-revision-article-history-link-row .lia-revision-info-data-cell-workflow}
:::
:::
:::
:::
:::

</div>
:::

::: lia-decoration-border-bottom
<div>

</div>
:::
:::
:::

::: {.lia-panel .lia-panel-standard .LabelsTaplet .Chrome .lia-component-labels-widget-labels-list .custom-blog-article-label-widget}
::: lia-decoration-border
::: lia-decoration-border-top
<div>

</div>
:::

::: lia-decoration-border-content
::: lia-panel-heading-bar-wrapper
::: lia-panel-heading-bar
[Labels]{.lia-panel-heading-bar-title aria-level="4" role="heading"}
:::
:::

::: lia-panel-content-wrapper
::: lia-panel-content
::: BlogLabelsTaplet
::: LabelsList
::: {.spinner .labels-spinner}
:::

::: labels-container
:::
:::
:::
:::
:::
:::

::: lia-decoration-border-bottom
<div>

</div>
:::
:::
:::

::: blog-article-social-share-widget-wrapper
::: custom-social-share-component
::: custom-social-share-widget
::: {.lia-panel .lia-panel-standard .Chrome .custom-share-component style=""}
::: lia-decoration-border
::: lia-decoration-border-top
<div>

</div>
:::

::: lia-decoration-border-content
<div>

::: lia-panel-heading-bar-wrapper
::: lia-panel-heading-bar
## Share {#customShareWidget .lia-panel-heading-bar-title .hello}
:::
:::

::: lia-panel-content-wrapper
::: lia-panel-content
-   [[Share to
    LinkedIn]{.social-share-title}](http://www.linkedin.com/shareArticle?mini=true&url=https://techcommunity.microsoft.com/t5/microsoft-365-pnp-blog/putting-some-more-fun-into-azure-functions-managed-identity-amp/ba-p/2628047 "Share to LinkedIn"){.social-share-link
    .social-share-linkedin}
-   [[Share to
    Facebook]{.social-share-title}](http://www.facebook.com/share.php?u=https://techcommunity.microsoft.com/t5/microsoft-365-pnp-blog/putting-some-more-fun-into-azure-functions-managed-identity-amp/ba-p/2628047 "Share to FaceBook"){.social-share-link
    .social-share-facebook}
-   [[Share to
    Twitter]{.social-share-title}](http://twitter.com/share?text=Check%20out%20this%20post%20on%20the%20Microsoft%20Tech%20Community%20:%20Putting%20some%20more%20FUN%20into%20Azure%20Functions,%20Managed%20Identity%20&%20Microsoft%20Graph%20-%20Microsoft%20Tech%20Community&url=https://techcommunity.microsoft.com/t5/microsoft-365-pnp-blog/putting-some-more-fun-into-azure-functions-managed-identity-amp/ba-p/2628047 "Share to Twitter"){.social-share-link
    .social-share-twitter}
-   [[Share to
    Email]{.social-share-title}](mailto:?subject=Putting%20some%20more%20FUN%20into%20Azure%20Functions,%20Managed%20Identity%20&%20Microsoft%20Graph%20-%20Microsoft%20Tech%20Community&body=I%20found%20this%20on%20the%20Microsoft%20Tech%20Community%20and%20wanted%20to%20share%20it%20with%20you,%20check%20it%20out%20:%20https://techcommunity.microsoft.com/t5/microsoft-365-pnp-blog/putting-some-more-fun-into-azure-functions-managed-identity-amp/ba-p/2628047 "Share via email"){.social-share-link
    .social-share-email}
:::
:::

</div>
:::

::: lia-decoration-border-bottom
<div>

</div>
:::
:::
:::
:::
:::
:::
:::
:::
:::

::: {.lia-quilt-row .lia-quilt-row-footer}
::: {.lia-quilt-column .lia-quilt-column-24 .lia-quilt-column-single .lia-quilt-column-common-footer}
::: {.lia-quilt-column-alley .lia-quilt-column-alley-single}
::: {.lia-quilt .lia-quilt-footer .lia-quilt-layout-footer .lia-component-quilt-footer}
::: {.lia-quilt-row .lia-quilt-row-main}
::: {.lia-quilt-column .lia-quilt-column-24 .lia-quilt-column-single .lia-quilt-column-icons}
::: {.lia-quilt-column-alley .lia-quilt-column-alley-single .lia-mark-empty}
:::
:::
:::
:::
:::
:::
:::
:::
:::
:::
:::
:::

::: {.cse-46444-wa style="display: none"}
::: {.lia-slide-out-nav-menu .lia-component-common-widget-slide-out-nav-menu}
::: {.lia-slide-out-nav-menu-title ng-non-bindable=""}
Browse
:::

::: {.lia-quilt .lia-quilt-navigation-slide-out-menu .lia-quilt-layout-one-column .lia-top-quilt}
::: {.lia-quilt-row .lia-quilt-row-header}
::: {.lia-quilt-column .lia-quilt-column-24 .lia-quilt-column-single .lia-quilt-column-common-header .lia-mark-empty}
:::
:::

::: {.lia-quilt-row .lia-quilt-row-main}
::: {.lia-quilt-column .lia-quilt-column-24 .lia-quilt-column-single .lia-quilt-column-main-content}
::: {.lia-quilt-column-alley .lia-quilt-column-alley-single}
:::
:::
:::

::: {.lia-quilt-row .lia-quilt-row-footer}
::: {.lia-quilt-column .lia-quilt-column-24 .lia-quilt-column-single .lia-quilt-column-common-footer .lia-mark-empty}
:::
:::
:::
:::
:::

::: {.shell-footer bi-view="5xLinks" bi-area="Footer" ms.pgarea="uhffooter" role="contentinfo"}
::: shell-footer-wrapper
::: {.shell-footer-menugroups ms.cmpgrp="footer nav"}
::: {.sfm-group ms.cmpnm="WhatsNew"}
###### What\'s new  {#whats-new .grp-title}

-   [Surface Pro
    X](https://www.microsoft.com/p/surface-pro-x/8vdnrp2m6hhc?activetab=overview)
-   [Surface Laptop
    3](https://www.microsoft.com/p/surface-laptop-3/8VFGGH1R94TM?activetab=overview)
-   [Surface Pro
    7](https://www.microsoft.com/p/surface-pro-7/8N17J0M5ZZQS?activetab=overview)
-   [Windows 10 Apps](https://www.microsoft.com/windows/windows-10-apps)
-   [Office apps](https://store.office.com/appshome.aspx)
:::

::: {.sfm-group ms.cmpnm="MicrosoftStore"}
###### Microsoft Store  {#microsoft-store .grp-title}

-   [Account profile](https://account.microsoft.com/)
-   [Download Center](https://www.microsoft.com/download)
-   [Microsoft Store
    support](https://go.microsoft.com/fwlink/p/?LinkID=824761&clcid=0x409)
-   [Returns](https://go.microsoft.com/fwlink/p/?LinkID=824764&clcid=0x409)
-   [Order tracking](https://account.microsoft.com/orders)
-   [Store
    locations](https://www.microsoft.com/en-us/store/locations/find-a-store?icid=en-us_UF_FAS)
-   [Buy online, pick up in
    store](https://www.microsoft.com/en-us/store/b/buy-online-pick-up-in-store?icid=uhf_footer_bopuis)
-   [In-store
    events](https://www.microsoft.com/en-us/store/locations/events?icid=en_us_store_uhf_events)
:::

::: {.sfm-group ms.cmpnm="Education"}
###### Education  {#education .grp-title}

-   [Microsoft in education](https://www.microsoft.com/education)
-   [Office for
    students](https://www.microsoft.com/education/products/office/default.aspx)
-   [Office for
    schools](https://products.office.com/academic/compare-office-365-education-plans)
-   [Deals for students and
    parents](https://www.microsoft.com/en-us/store/b/education?icid=CNavfooter_Studentsandeducation)
-   [Microsoft Azure in
    education](https://azure.microsoft.com/community/education/)
:::

::: {.sfm-group ms.cmpnm="Enterprise"}
###### Enterprise  {#enterprise .grp-title}

-   [Azure](https://azure.microsoft.com/)
-   [AppSource](https://go.microsoft.com/fwlink/?LinkID=808093)
-   [Automotive](https://www.microsoft.com/enterprise/automotive)
-   [Government](https://www.microsoft.com/enterprise/government)
-   [Healthcare](https://www.microsoft.com/enterprise/health)
-   [Manufacturing](https://www.microsoft.com/enterprise/manufacturing)
-   [Financial
    Services](https://www.microsoft.com/enterprise/financial-services/banking-and-capital-markets)
-   [Retail](https://www.microsoft.com/enterprise/retail-consumer-goods)
:::

::: {.sfm-group ms.cmpnm="Developer"}
###### Developer  {#developer .grp-title}

-   [Microsoft Visual Studio](https://visualstudio.microsoft.com/)
-   [Window Dev Center](https://developer.microsoft.com/windows)
-   [Developer Network](https://msdn.microsoft.com/)
-   [TechNet](https://technet.microsoft.com/)
-   [Microsoft developer
    program](https://developer.microsoft.com/store/register)
-   [Channel 9](https://channel9.msdn.com/)
-   [Office Dev Center](https://developer.microsoft.com/office)
-   [Microsoft Garage](https://www.microsoft.com/garage/)
:::

::: {.sfm-group ms.cmpnm="Company"}
###### Company  {#company .grp-title}

-   [Careers](https://careers.microsoft.com/)
-   [About Microsoft](https://www.microsoft.com/en-us/about)
-   [Company News](https://news.microsoft.com/)
-   [Privacy at Microsoft](https://privacy.microsoft.com/)
-   [Investors](https://www.microsoft.com/investor/default.aspx)
-   [Diversity and inclusion](https://www.microsoft.com/diversity/)
-   [Accessibility](https://www.microsoft.com/accessibility)
-   [Security](https://www.microsoft.com/security/default.aspx)
:::
:::

::: {.shell-footer-copyright ms.cmpnm="corp" ms.cmpgrp="corp links"}
-   [Sitemap](https://www.microsoft.com/en-us/sitemap1.aspx){#shellmenu_0
    .ctl_footerNavLink}
-   [Contact
    Microsoft](https://support.microsoft.com/contactus){#shellmenu_1
    .ctl_footerNavLink}
-   [Privacy](https://go.microsoft.com/fwlink/?LinkId=521839){#shellmenu_2
    .ctl_footerNavLink}
-   [Manage cookies](#){#shellmenu_2B .ctl_footerNavLink .hidden}
-   [Terms of
    use](http://go.microsoft.com/fwlink/?LinkID=206977){#shellmenu_3
    .ctl_footerNavLink}
-   [Trademarks](https://www.microsoft.com/trademarks){#shellmenu_4
    .ctl_footerNavLink}
-   [Safety and
    eco](https://www.microsoft.com/devices/safety-and-eco){#shellmenu_5
    .ctl_footerNavLink}
-   [About our ads](https://choice.microsoft.com/){#shellmenu_6
    .ctl_footerNavLink}
-   © []{#footerDate} Microsoft
:::
:::
:::
:::
