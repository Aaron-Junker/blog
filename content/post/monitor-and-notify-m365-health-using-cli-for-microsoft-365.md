::: {#F9B-001-2 .ServiceNodeInfoHeader}
:::

::: lia-page
::: MinimumWidthContainer
::: min-width-wrapper
::: min-width
::: lia-content
::: {.lia-quilt .lia-quilt-blog-article-page .lia-quilt-layout-two-column-main-side-18-6 .lia-top-quilt}
::: {.lia-quilt-row .lia-quilt-row-header}
::: {.lia-quilt-column .lia-quilt-column-24 .lia-quilt-column-single .lia-quilt-column-common-header}
::: {.lia-quilt-column-alley .lia-quilt-column-alley-single}
::: {.lia-quilt .lia-quilt-header .lia-quilt-layout-header .lia-component-quilt-header}
::: {.lia-quilt-row .lia-quilt-row-main-header}
::: {.lia-quilt-column .lia-quilt-column-24 .lia-quilt-column-single .lia-quilt-column-header}
::: {.lia-quilt-column-alley .lia-quilt-column-alley-single}
::: {#cookie-banner .cookie-markup}
:::

::: {#readerAssistMessages .section .live-region aria-live="assertive" role="alert"}
:::

::: community-header-blank
:::

::: community-header-component
::: community-header-wrapper
::: container
::: {#community-menu-wrapper-menu .menu-link}
[](javascript:void(0)){#community-menu-wrapper-menu-link}

::: {#community-menu-wrapper-menu-icon .menu-icon title=""}
:::
:::

[![](https://techcommunity.microsoft.com/html/@6005EEFEC6E5ECADBBFC249DFA7D38A8/assets/Content/Images/GlobalHeader/MicrosoftLogo.png){.c-image
itemprop="logo" role="presentation" aria-hidden="true"}
[Microsoft]{role="presentation"
aria-hidden="true"}](https://www.microsoft.com){#uhfLogo .c-logo
.c-sgl-stk-uhfLogo}

::: {.c-show-pipe aria-hidden="true"}
:::

[Tech Community](/){#uhfCatLogo .c-logo .c-cat-logo}

::: container-inner
::: {#community-menu-wrapper .community-menu-wrapper .community-menu-hidden-init}
::: {#community-menu-wrapper-header-bar .community-header-bar}
[](#){.community-header-button}

::: community-menu-item-icon
:::
:::

::: {#community-menu-wrapper-list .community-menu-list}
::: {.community-menu-item .tab-homepage}
[](/)

::: {.mdl2-glyph .community-menu-item-icon}

:::

::: community-menu-item-title
Home
:::
:::

::: {.community-menu-item .community-menu-dropdown}
[](#){.community-menu-item-desktop-view}

::: {.c-glyph .community-menu-item-icon}

:::

::: community-menu-item-title-with-dropdownicon
Community Hubs
:::

[](/t5/communities/ct-p/communities#category-filter-button-all){.community-menu-item-mobile-view
.community-menu-item-allow-link}

::: {.c-glyph .community-menu-item-icon}

:::

::: community-menu-item-title-with-dropdownicon
Community Hubs
:::

::: {.dropdown .dropdown-communities .dropdown-events .dropdown-primary-nav}
-   [Community Hubs
    Home](/t5/communities/ct-p/communities#category-filter-button-all){#communities_home}
-   [Products](/t5/communities/ct-p/communities#category-filter-button-products-services){#communities_products}
-   [Special
    Topics](/t5/communities/ct-p/communities#category-filter-button-solutions){#communities_special}
-   [Video Hub](/t5/video-hub/ct-p/VideoHub){#communities_videohub}

::: custom-community-hubs-menu-wrapper
::: custom-community-hubs-menu-close
Close
:::

::: custom-community-hubs-menu-content
::: menu
## [ Products]{#menu-link-prod title="Products"} [(72)]{.small} {#menu-products .active}

## [ Special Topics ]{#menu-link-serv title="Special Topics"} [(41)]{.small} {#menu-services}

## [ Video Hub ]{#menu-link-videohub title="VideoHub"} [(834)]{.small} {#menu-videohub}
:::

::: {#products-data .dataBlock .visible key="products"}
::: {.hubs style="width: 600px"}
### Most Active Hubs

::: {.data style="flex-direction: column; height:310px"}
<div>

[Microsoft
Teams](/t5/microsoft-teams/ct-p/MicrosoftTeams "Microsoft Teams")

</div>

<div>

[Excel](/t5/excel/ct-p/Excel_Cat "Excel")

</div>

<div>

[Exchange](/t5/exchange/ct-p/Exchange "Exchange")

</div>

<div>

[SharePoint](/t5/sharepoint/ct-p/SharePoint "SharePoint")

</div>

<div>

[Windows](/t5/windows-10/ct-p/Windows10 "Windows")

</div>

<div>

[Office 365](/t5/office-365/ct-p/Office365 "Office 365")

</div>

<div>

[Security, Compliance and
Identity](/t5/security-compliance-and-identity/ct-p/MicrosoftSecurityandCompliance "Security, Compliance and Identity")

</div>

<div>

[Windows
Server](/t5/windows-server/ct-p/Windows-Server "Windows Server")

</div>

<div>

[Microsoft Edge
Insider](/t5/microsoft-edge-insider/ct-p/MicrosoftEdgeInsider "Microsoft Edge Insider")

</div>

<div>

[Azure](/t5/azure-community/ct-p/Azure "Azure")

</div>

<div>

[Microsoft 365](/t5/microsoft-365/ct-p/microsoft365 "Microsoft 365")

</div>
:::
:::

::: boxes
[](/t5/azure-databases/ct-p/AzureDatabases "Azure Databases")

::: {.box style="background-image: url('https://techcommunity.microsoft.com/html/@D05C7AA27EF9EB31779410FCB608734A/assets/bg-pink.png')"}
::: title
Azure Databases
:::

::: description
Fully managed intelligent database services.
:::
:::

[](/t5/project-bonsai/ct-p/ProjectBonsai "Autonomous Systems")

::: {.box style="background-image: url('https://techcommunity.microsoft.com/html/@FC8AD6AC9A7EBDA58D7E6304E799EA40/assets/bg-orange.png')"}
::: title
Autonomous Systems
:::

::: description
Create and optimise intelligence for industrial control systems.
:::
:::

[](/t5/yammer/ct-p/Yammer "Yammer")

::: {.box style="background-image: url('https://techcommunity.microsoft.com/html/@CF0293463F27444B05A952A3C4B6BF88/assets/bg-light-blue.png')"}
::: title
Yammer
:::

::: description
Connect and engage across your organization.
:::
:::
:::
:::

::: {#services-data .dataBlock key="services"}
::: {.hubs style="width: 600px"}
### Most Active Hubs

::: {.data style="flex-direction: column; height:310px"}
<div>

[ITOps Talk](/t5/itops-talk/ct-p/ITOpsTalk "ITOps Talk")

</div>

<div>

[Education
Sector](/t5/education-sector/ct-p/EducationSector "Education Sector")

</div>

<div>

[Microsoft
Learn](/t5/microsoft-learn/ct-p/MicrosoftLearn "Microsoft Learn")

</div>

<div>

[Microsoft
Localization](/t5/microsoft-localization/ct-p/MicrosoftTranslation "Microsoft Localization")

</div>

<div>

[Microsoft 365
PnP](/t5/microsoft-365-pnp/ct-p/Microsoft365PnP "Microsoft 365 PnP")

</div>

<div>

[Healthcare and Life
Sciences](/t5/healthcare-and-life-sciences/ct-p/HealthcareAndLifeSciences "Healthcare and Life Sciences")

</div>

<div>

[Public Sector](/t5/public-sector/ct-p/PublicSector "Public Sector")

</div>

<div>

[Internet of Things
(IoT)](/t5/internet-of-things-iot/ct-p/IoT "Internet of Things (IoT)")

</div>

<div>

[Mixed
Reality](/t5/mixed-reality/ct-p/MicrosoftMixedReality "Mixed Reality")

</div>

<div>

[Enabling Remote
Work](/t5/enabling-remote-work/ct-p/RemoteWork "Enabling Remote Work")

</div>

<div>

[Small and Medium
Business](/t5/small-and-medium-businesses/ct-p/SMB "Small and Medium Business")

</div>
:::
:::

::: boxes
[](/t5/humans-of-it/ct-p/HumansofIT "Humans of IT")

::: {.box style="background-image: url('https://techcommunity.microsoft.com/html/@A5C0BDB1059C6D1F73B8097424B50ED0/assets/bg-purple.png')"}
::: title
Humans of IT
:::

::: description
Empowering technologists to achieve more by humanizing tech.
:::
:::

[](/t5/green-tech/ct-p/GreenTech "Green Tech")

::: {.box style="background-image: url('https://cdn.techcommunity.microsoft.com/lithium/MicrosoftLearn/Learn-Blue.png')"}
::: title
Green Tech
:::

::: description
Raise awareness about sustainability in the tech sector
:::
:::

[](/t5/mvp-award-program/ct-p/MVPAwardProgram "MVP Award Program")

::: {.box style="background-image: url('https://techcommunity.microsoft.com/html/@02C247197A08F2DB06040AC786E1BF01/assets/bg-green.png')"}
::: title
MVP Award Program
:::

::: description
Find out more about the Microsoft MVP Award Program.
:::
:::
:::
:::

::: {#VideoHub-Data .dataBlock key="VideoHub"}
::: {.hubs style="width: 838px"}
### Video Hub

::: {.data style="flex-direction: row; height:fit-content"}
<div>

[Azure](https://aka.ms/VideoHub/Azure "Azure")

</div>

<div>

[Exchange](https://aka.ms/VideoHub/Exchange "Exchange")

</div>

<div>

[Microsoft 365](https://aka.ms/VideoHub/Microsoft365 "Microsoft 365")

</div>

<div>

[Microsoft 365
Business](https://aka.ms/VideoHub/Microsoft365Business "Microsoft 365 Business")

</div>

<div>

[Microsoft 365
Enterprise](https://aka.ms/VideoHub/Microsoft365Business "Microsoft 365 Enterprise")

</div>

<div>

[Microsoft Edge](https://aka.ms/VideoHub/MicrosoftEdge "Microsoft Edge")

</div>

<div>

[Microsoft Outlook](https://aka.ms/VideoHub/Outlook "Microsoft Outlook")

</div>

<div>

[Microsoft
Teams](https://aka.ms/VideoHub/MicrosoftTeams "Microsoft Teams")

</div>

<div>

[Security](https://aka.ms/VideoHub/Security "Security")

</div>

<div>

[SharePoint](https://aka.ms/VideoHub/SharePoint "SharePoint")

</div>

<div>

[Windows](https://aka.ms/VideoHub/Windows "Windows")

</div>
:::
:::
:::
:::

::: custom-community-hubs-menu-footer
[Browse All Community
Hubs](/t5/Communities/ct-p/communities){#browse-all-communities}
:::
:::
:::
:::

::: {.community-menu-item .my-favorites}
[](/t5/custom/page/page-id/Blogs){.community-menu-item-desktop-view}

::: {.mdl2-glyph .community-menu-item-icon}

:::

::: community-menu-item-title
Blogs
:::

[](/t5/custom/page/page-id/Blogs){.community-menu-item-mobile-view}

::: {.mdl2-glyph .community-menu-item-icon}

:::

::: community-menu-item-title
Blogs
:::
:::

::: {.community-menu-item .tab-events .community-menu-dropdown}
[](#){.community-menu-item-desktop-view}

::: {.c-glyph .community-menu-item-icon}

:::

::: community-menu-item-title-with-dropdownicon
Events
:::

[](#){.community-menu-item-mobile-view}

::: {.c-glyph .community-menu-item-icon}

:::

::: community-menu-item-title-with-dropdownicon
Events
:::

::: {.dropdown .dropdown-events .dropdown-primary-nav}
-   [Events Home](/t5/Events/ct-p/Events)
-   [Microsoft Ignite](https://myignite.microsoft.com/)
-   [Microsoft Build](https://mybuild.microsoft.com/)
-   [Community Events](/t5/Community-Events/ct-p/CommunityEvents)
:::
:::

::: {.community-menu-item .tab-microsoft-learning .community-menu-dropdown}
[](#){.community-menu-item-desktop-view}

::: {.grad .community-menu-item-icon}
:::

::: community-menu-item-title-with-dropdownicon
Microsoft Learn
:::

[](#){.community-menu-item-mobile-view}

::: {.grad .community-menu-item-icon}
:::

::: community-menu-item-title-with-dropdownicon
Microsoft Learn
:::

::: {.dropdown .dropdown-events .dropdown-primary-nav}
-   [Home](%20https://docs.microsoft.com/learn/){.ms-learning-home-link
    .community-menu-item-title}
-   [Community](/t5/microsoft-learn/bd-p/MicrosoftLearn)
-   [Blog](/t5/microsoft-learn-blog/bg-p/MicrosoftLearnBlog)
-   [Azure](https://docs.microsoft.com/learn/azure/?WT.mc_id=techcom_header-webpage-m365)
-   [Dynamics
    365](https://docs.microsoft.com/learn/dynamics365/?WT.mc_id=techcom_header-webpage-m365)
-   [Microsoft
    365](https://docs.microsoft.com/learn/m365/?wt.mc_id=techcom_header-webpage-m365)
-   [Security, Compliance &
    Identity](https://docs.microsoft.com/learn/topics/sci/?wt.mc_id=techcom_header-webpage-m365)
-   [Power
    Platform](https://docs.microsoft.com/learn/powerplatform/?wt.mc_id=techcom_header-webpage-powerplatform)
-   [Github](https://docs.microsoft.com/learn/github/?wt.mc_id=techcom_header-webpage-github)
-   [Teams](https://docs.microsoft.com/learn/teams/?wt.mc_id=techcom_header-webpage-teams)
-   [.NET](https://docs.microsoft.com/learn/dotnet/?wt.mc_id=techcom_header-webpage-dotnet)
:::
:::

::: {.community-menu-item .tab-info-center}
[](/t5/Community-Info-Center/ct-p/Community-Info-Center){.community-menu-item-desktop-view}

::: {.c-glyph .community-menu-item-icon}

:::

::: community-menu-item-title
Lounge
:::

[](/t5/Community-Info-Center/ct-p/Community-Info-Center){.community-menu-item-mobile-view}

::: {.c-glyph .community-menu-item-icon}

:::

::: community-menu-item-title
Lounge
:::
:::
:::

-   [[776K]{#community-menu-wrapper-vitality-stat-count-1
    .community-menu-vitality-stat-count} [
    Members]{#community-menu-wrapper-vitality-stat-title-1
    .community-menu-vitality-stat-title}]{#community-menu-wrapper-vitality-stat-item-1}
-   [[7,232]{#community-menu-wrapper-vitality-stat-count-2
    .community-menu-vitality-stat-count} [
    Online]{#community-menu-wrapper-vitality-stat-title-2
    .community-menu-vitality-stat-title}]{#community-menu-wrapper-vitality-stat-item-2}
-   [[2M]{#community-menu-wrapper-vitality-stat-count-3
    .community-menu-vitality-stat-count} [
    Discussions]{#community-menu-wrapper-vitality-stat-title-3
    .community-menu-vitality-stat-title}]{#community-menu-wrapper-vitality-stat-item-3}
:::

::: nav-right
::: {#search_container}
::: {#search_btn}
Search []{.btn-search}
:::

::: {#search_slider .hidden}
::: custom-lia-search
::: {#lia-searchformV32_2316c9349eda86 .SearchForm .lia-search-form-wrapper .lia-mode-default .lia-component-common-widget-search-form}
::: lia-inline-ajax-feedback
::: {#ajaxfeedback_2316c9349eda86 .AjaxFeedback}
:::
:::

::: {#searchautocompletetoggle_2316c9349eda86}
::: lia-inline-ajax-feedback
::: {#ajaxfeedback_2316c9349eda86_0 .AjaxFeedback}
:::
:::

::: t-invisible
:::

::: lia-inline-ajax-feedback
::: {#feedback_2316c9349eda86 .AjaxFeedback}
:::
:::

[ [ []{.lia-button-wrapper .lia-button-wrapper-secondary
.lia-button-wrapper-searchForm-action} ]{.lia-search-input-field}
]{.lia-search-input-wrapper} [cancel]{.lia-cancel-search}

::: {.search-autocomplete-toggle-link .lia-js-hidden}
[Turn on
suggestions](https://techcommunity.microsoft.com/t5/blogs/v2/blogarticlepage.enableautocomplete:enableautocomplete?t:ac=blog-id/Microsoft365PnPBlog/article-id/602&t:cp=action/contributions/searchactions){#enableAutoComplete_2316c9349eda86
.lia-link-navigation .auto-complete-toggle-on
.lia-link-ticket-post-action
.lia-component-search-action-enable-auto-complete} [
[[]{#display_2316c9349eda86 .lia-img-icon-help .lia-fa-icon .lia-fa-help
.lia-fa
alt="Auto-suggest helps you quickly narrow down your search results by suggesting possible matches as you type."
aria-label="Help Icon" role="img"}](#){#link_2316c9349eda86
.lia-link-navigation .help-icon .lia-tooltip-trigger}]{.HelpIcon}

::: {#link_2316c9349eda86_0-tooltip-element .lia-content .lia-tooltip-pos-bottom-left .lia-panel-tooltip-wrapper role="alertdialog"}
::: lia-tooltip-arrow
:::

::: lia-panel-tooltip
::: content
Auto-suggest helps you quickly narrow down your search results by
suggesting possible matches as you type.
:::
:::
:::
:::
:::

::: spell-check-showing-result
Showing results for []{#showingResult_2316c9349eda86
.lia-link-navigation .show-results-for-link .lia-link-disabled}
[](#){#showingMoreResult_2316c9349eda86 .lia-link-navigation
.more-synonym-search-results-for-link} [
]{.all-results-for-synonym-search}
:::

<div>

[ Show [](#){#synonymSearchInstead_2316c9349eda86 .lia-link-navigation
.synonym-search-instead-for-link} only  ]{.synonym-search-instead
.lia-js-hidden} [ \| ]{.spell-check-and-synonym-search-instead
.lia-js-hidden} [ Search instead for [](#){#searchInstead_2316c9349eda86
.lia-link-navigation .search-instead-for-link}
]{.spell-check-search-instead}

</div>

::: {.spell-check-do-you-mean .lia-component-search-widget-spellcheck}
Did you mean: [](#){#doYouMean_2316c9349eda86 .lia-link-navigation
.do-you-mean-link}
:::
:::
:::
:::
:::

::: sign-in-wrapper
[Sign
In](/plugins/common/feature/oauth2sso/sso_login_redirect?lang=en&referer=https%3A%2F%2Ftechcommunity.microsoft.com%2Ft5%2Fmicrosoft-365-pnp-blog%2Fmonitor-and-notify-m365-health-using-cli-for-microsoft-365%2Fba-p%2F3000703)
:::

::: notifications
::: notify-icon
[](/t5/notificationfeed/page)

::: lia-notifications-messages-aggregate
:::
:::

::: email-icon
[](/t5/notes/privatenotespage)

::: lia-notifications-messages-aggregate
:::
:::
:::

::: lia-component-common-widget-slide-out-user-menu
::: {.lia-user-navigation-sign-in .lia-component-users-action-login-with-avatar}
::: user-navigation-user-profile
[Sign
In](/plugins/common/feature/oauth2sso/sso_login_redirect?lang=en&referer=https%3A%2F%2Ftechcommunity.microsoft.com%2Ft5%2Fmicrosoft-365-pnp-blog%2Fmonitor-and-notify-m365-health-using-cli-for-microsoft-365%2Fba-p%2F3000703){#link_1_2316c93614af48
.lia-link-navigation .login-link .lia-authentication-link}
:::

::: {.UserAvatar .lia-user-avatar}
[](/plugins/common/feature/oauth2sso/sso_login_redirect?lang=en&referer=https%3A%2F%2Ftechcommunity.microsoft.com%2Ft5%2Fmicrosoft-365-pnp-blog%2Fmonitor-and-notify-m365-health-using-cli-for-microsoft-365%2Fba-p%2F3000703){#link_2_2316c93614af48
.lia-link-navigation .login-link .lia-authentication-link}

::: lia-anonymous-profile-icon
:::
:::
:::
:::
:::
:::
:::
:::
:::

::: notifications-overlay-notif
:::

::: notifications-overlay-mail
:::

::: notifications-overlay-favorites
:::
:::
:::
:::

::: {.lia-quilt-row .lia-quilt-row-sub-header}
::: {.lia-quilt-column .lia-quilt-column-18 .lia-quilt-column-left .lia-quilt-column-breadcrumb .lia-mark-empty}
:::

::: {.lia-quilt-column .lia-quilt-column-06 .lia-quilt-column-right .lia-quilt-column-search-content}
::: {.lia-quilt-column-alley .lia-quilt-column-alley-right}
::: custom-lia-search
::: {#lia-searchformV32 .SearchForm .lia-search-form-wrapper .lia-mode-default .lia-component-common-widget-search-form}
::: lia-inline-ajax-feedback
::: {#ajaxfeedback .AjaxFeedback}
:::
:::

::: {#searchautocompletetoggle}
::: lia-inline-ajax-feedback
::: {#ajaxfeedback_0 .AjaxFeedback}
:::
:::

::: t-invisible
:::

::: lia-inline-ajax-feedback
::: {#feedback .AjaxFeedback}
:::
:::

[ [ []{.lia-button-wrapper .lia-button-wrapper-secondary
.lia-button-wrapper-searchForm-action} ]{.lia-search-input-field}
]{.lia-search-input-wrapper} [cancel]{.lia-cancel-search}

::: {.search-autocomplete-toggle-link .lia-js-hidden}
[Turn on
suggestions](https://techcommunity.microsoft.com/t5/blogs/v2/blogarticlepage.enableautocomplete:enableautocomplete?t:ac=blog-id/Microsoft365PnPBlog/article-id/602&t:cp=action/contributions/searchactions){#enableAutoComplete
.lia-link-navigation .auto-complete-toggle-on
.lia-link-ticket-post-action
.lia-component-search-action-enable-auto-complete} [ [[]{#display
.lia-img-icon-help .lia-fa-icon .lia-fa-help .lia-fa
alt="Auto-suggest helps you quickly narrow down your search results by suggesting possible matches as you type."
aria-label="Help Icon" role="img"}](#){#link_0 .lia-link-navigation
.help-icon .lia-tooltip-trigger}]{.HelpIcon}

::: {#link_1-tooltip-element .lia-content .lia-tooltip-pos-bottom-left .lia-panel-tooltip-wrapper role="alertdialog"}
::: lia-tooltip-arrow
:::

::: lia-panel-tooltip
::: content
Auto-suggest helps you quickly narrow down your search results by
suggesting possible matches as you type.
:::
:::
:::
:::
:::

::: spell-check-showing-result
Showing results for []{#showingResult .lia-link-navigation
.show-results-for-link .lia-link-disabled} [](#){#showingMoreResult
.lia-link-navigation .more-synonym-search-results-for-link} [
]{.all-results-for-synonym-search}
:::

<div>

[ Show [](#){#synonymSearchInstead .lia-link-navigation
.synonym-search-instead-for-link} only  ]{.synonym-search-instead
.lia-js-hidden} [ \| ]{.spell-check-and-synonym-search-instead
.lia-js-hidden} [ Search instead for [](#){#searchInstead
.lia-link-navigation .search-instead-for-link}
]{.spell-check-search-instead}

</div>

::: {.spell-check-do-you-mean .lia-component-search-widget-spellcheck}
Did you mean: [](#){#doYouMean .lia-link-navigation .do-you-mean-link}
:::
:::
:::
:::
:::
:::

::: {.lia-quilt-row .lia-quilt-row-feedback}
::: {.lia-quilt-column .lia-quilt-column-24 .lia-quilt-column-single .lia-quilt-column-feedback}
::: {.lia-quilt-column-alley .lia-quilt-column-alley-single}
:::
:::
:::
:::

::: {.custom-nda-blog-article-page-header-banner .lia-mark-empty}
:::

::: {.community-live-events-banner-blog-article-page-wrapper .lia-mark-empty}
:::

::: custom-blog-article-page-header-wrapper
::: custom-common-widget-breadcrumb
::: {.custom-common-widget-breadcrumb-wrapper .hidden}
[Home](/){.BreadCrumb .home-nav-link}

::: {.BreadCrumb .crumb-line .lia-breadcrumb .lia-component-common-widget-breadcrumb aria-label="breadcrumbs" role="navigation"}
-   [Home](/){#link_2316c9394d3f3e .lia-link-navigation .crumb-community
    .lia-breadcrumb-community .lia-breadcrumb-forum}
-    []{#display_2316c9394d3f3e .lia-img-icon-list-separator-breadcrumb
    .lia-fa-icon .lia-fa-list .lia-fa-separator .lia-fa-breadcrumb
    .lia-fa alt="" aria-label="" role="img"}
-   [Microsoft 365
    PnP](/t5/microsoft-365-pnp/ct-p/Microsoft365PnP){#link_2316c9394d3f3e_0
    .lia-link-navigation .crumb-category .lia-breadcrumb-category
    .lia-breadcrumb-forum}
-    []{#display_2316c9394d3f3e_0
    .lia-img-icon-list-separator-breadcrumb .lia-fa-icon .lia-fa-list
    .lia-fa-separator .lia-fa-breadcrumb .lia-fa alt="" aria-label=""
    role="img"}
-   [Microsoft 365 PnP
    Blog](/t5/microsoft-365-pnp-blog/bg-p/Microsoft365PnPBlog){#link_2316c9394d3f3e_1
    .lia-link-navigation .crumb-board .lia-breadcrumb-board
    .lia-breadcrumb-forum}
-    []{#display_2316c9394d3f3e_1
    .lia-img-icon-list-separator-breadcrumb .lia-fa-icon .lia-fa-list
    .lia-fa-separator .lia-fa-breadcrumb .lia-fa alt="" aria-label=""
    role="img"}
-   [Monitor and Notify M365 health using CLI for Microsoft
    365]{#link_2316c9394d3f3e_2 .lia-link-navigation .child-thread
    .lia-link-disabled aria-disabled="true" disabled="true" role="link"
    aria-label="Monitor and Notify M365 health using CLI for Microsoft 365"}
:::
:::
:::

::: {.lia-menu-bar .lia-discussion-page-discussion-navigator .lia-component-article-navigator}
::: lia-decoration-border-menu-bar
::: lia-decoration-border-menu-bar-top
<div>

</div>
:::

::: lia-decoration-border-menu-bar-content
<div>

::: lia-menu-bar-buttons
:::

::: {#threadnavigator .lia-paging-full-wrapper}
-   [[]{.lia-paging-page-arrow} [Back to
    Blog]{.lia-paging-page-link}](/t5/microsoft-365-pnp-blog/bg-p/Microsoft365PnPBlog "Microsoft 365 PnP Blog"){#link_2
    .lia-link-navigation}
-   [[]{.lia-paging-page-arrow} [Newer
    Article]{.lia-paging-page-link}](/t5/microsoft-365-pnp-blog/microsoft-365-developer-community-call-recording-25th-of/ba-p/3006235 "Microsoft 365 Developer Community Call recording – 25th of November, 2021"){#link_3
    .lia-link-navigation}
-   [[Older Article]{.lia-paging-page-link}
    []{.lia-paging-page-arrow}](/t5/microsoft-365-pnp-blog/microsoft-365-platform-call-23rd-of-november-2021/ba-p/2998248 "Microsoft 365 Platform Call – 23rd of November, 2021"){#link_4
    .lia-link-navigation}
:::

</div>
:::

::: lia-decoration-border-menu-bar-bottom
<div>

</div>
:::
:::
:::
:::
:::
:::
:::

::: {.lia-quilt-row .lia-quilt-row-main}
::: {.lia-quilt-column .lia-quilt-column-18 .lia-quilt-column-left .lia-quilt-column-main-content}
::: {.lia-quilt-column-alley .lia-quilt-column-alley-left}
::: ba-subject-header-wrapper
::: ba-subject-wrapper
::: ba-title
# Monitor and Notify M365 health using CLI for Microsoft 365
:::

::: ba-option-wrapper
::: {.lia-menu-bar .top-block .lia-component-menu-bar-without-options}
::: lia-decoration-border-menu-bar
::: lia-decoration-border-menu-bar-top
<div>

</div>
:::

::: lia-decoration-border-menu-bar-content
<div>

::: lia-menu-bar-buttons
:::

</div>
:::

::: lia-decoration-border-menu-bar-bottom
<div>

</div>
:::
:::
:::
:::
:::

::: ba-author-and-metrics-wrapper
::: ba-author-wrapper
By

::: ba-author-info
[ ]{.UserName .lia-user-name}

::: UserAvatarWrapper
::: {.UserAvatar .lia-user-avatar .lia-component-common-widget-user-avatar .New .Contributor}
{{< image alt="ArjunMenon" src="images/blog/monitor-and-notify-m365-health-using-cli-for-microsoft-365/ArjunMenon.png" >}}{.lia-user-avatar-message
.user-rank-ring style=""
onerror="replaceBrokenAvatars(this, '/html/assets/default-avatar.png')"}](/t5/user/viewprofilepage/user-id/1082346){.UserAvatar
.lia-link-navigation}
:::

::: {.user-profile-card user-id="1082346"}
::: contents
::: spinner
:::
:::
:::
:::

::: user-login
[Arjun Menon](/t5/user/viewprofilepage/user-id/1082346)
:::
:::
:::

::: ba-metrics-info
[Published]{.ba-published-title} [Nov 24 2021 05:38
AM]{.ba-published-date} [ 1,596 Views ]{.ba-view-count}
:::
:::
:::

::: custom-blog-article-wrapper
::: {#messageview .lia-panel-message .message-uid-3000703 .lia-component-article lia-message-uid="3000703"}
::: {#messageView2_1 .lia-message-view-wrapper .lia-js-data-messageUid-3000703 .lia-component-forums-widget-message-view-two lia-message-uid="3000703"}
[ ]{#U3000703} [ ]{#M602}

::: lia-inline-ajax-feedback
::: {#ajaxfeedback_1 .AjaxFeedback}
:::
:::

::: {.MessageView .lia-message-view-blog-topic-message .lia-message-view-display .lia-row-standard-unread .lia-thread-topic}
[]{.lia-message-state-indicator}

::: {.lia-quilt .lia-quilt-blog-topic-message .lia-quilt-layout-one-column-message}
::: {.lia-quilt-row .lia-quilt-row-header}
::: {.lia-quilt-column .lia-quilt-column-16 .lia-quilt-column-left .lia-quilt-column-header-left}
::: {.lia-quilt-column-alley .lia-quilt-column-alley-left}
::: {.lia-message-author-avatar .lia-component-author-avatar .lia-component-message-view-widget-author-avatar}
::: UserAvatarWrapper
::: {.UserAvatar .lia-user-avatar .lia-component-common-widget-user-avatar .New .Contributor}
{{< image alt="ArjunMenon" src="images/blog/monitor-and-notify-m365-health-using-cli-for-microsoft-365/ArjunMenon.png" >}}{.lia-user-avatar-message
.user-rank-ring style=""
onerror="replaceBrokenAvatars(this, '/html/assets/default-avatar.png')"}](/t5/user/viewprofilepage/user-id/1082346){.UserAvatar
.lia-link-navigation}
:::

::: {.user-profile-card user-id="1082346"}
::: contents
::: spinner
:::
:::
:::
:::
:::

::: lia-message-author-with-avatar
[
[ArjunMenon](https://techcommunity.microsoft.com/t5/user/viewprofilepage/user-id/1082346){#link_5
.lia-link-navigation .lia-page-link .lia-user-name-link} ]{.UserName
.lia-user-name .lia-user-rank-New-Contributor
.lia-component-message-view-widget-author-username}
:::

::: {.lia-message-author-rank .lia-component-author-rank .lia-component-message-view-widget-author-rank}
New Contributor
:::
:::
:::

::: {.lia-quilt-column .lia-quilt-column-08 .lia-quilt-column-right .lia-quilt-column-header-right}
::: {.lia-quilt-column-alley .lia-quilt-column-alley-right}
::: {.lia-message-post-date .lia-component-post-date .lia-component-message-view-widget-post-date title="Posted on"}
[ [‎Nov 24 2021]{.local-date} [05:38 AM]{.local-time} ]{.DateTime}
:::

::: {#actionMenuDropDown .lia-menu-navigation-wrapper .lia-js-hidden .lia-menu-action .lia-component-message-view-widget-action-menu}
::: lia-menu-navigation
::: dropdown-default-item
[](# "Show option menu"){#dropDownLink .lia-js-menu-opener
.default-menu-option .lia-js-mouseover-menu .lia-link-navigation}

::: dropdown-positioning
::: dropdown-positioning-static
-   [Subscribe to RSS
    Feed](/gxcuf89792/rss/message?board.id=Microsoft365PnPBlog&message.id=602){#rssThread
    .lia-link-navigation .rss-thread-link
    .lia-component-rss-action-thread}
-   [ []{.lia-separator-post} []{.lia-separator-pre} ]{.lia-separator
    .lia-component-common-widget-link-separator}
-   [Mark as New]{#markThreadUnread .lia-link-navigation
    .mark-thread-unread .lia-link-disabled
    .lia-component-forums-action-mark-thread-unread}
-   [Mark as Read]{#markThreadRead .lia-link-navigation
    .mark-thread-read .lia-link-disabled
    .lia-component-forums-action-mark-thread-read}
-   [ []{.lia-separator-post} []{.lia-separator-pre} ]{.lia-separator
    .lia-component-common-widget-link-separator}
-   [Bookmark]{#addThreadUserBookmark .lia-link-navigation
    .addThreadUserBookmark .lia-link-disabled
    .lia-component-subscriptions-action-add-thread-user-bookmark}
-   [Subscribe]{#addThreadUserEmailSubscription .lia-link-navigation
    .addThreadUserEmailSubscription .lia-link-disabled
    .lia-component-subscriptions-action-add-thread-user-email}
-   [ []{.lia-separator-post} []{.lia-separator-pre} ]{.lia-separator
    .lia-component-common-widget-link-separator}
-   [Email to a Friend]{#emailMessageToFriend .lia-link-navigation
    .email_friend .lia-link-disabled
    .lia-component-forums-action-email-message-to-friend}
-   [ []{.lia-separator-post} []{.lia-separator-pre} ]{.lia-separator
    .lia-component-common-widget-link-separator}
-   [Printer Friendly
    Page](/t5/blogs/blogarticleprintpage/blog-id/Microsoft365PnPBlog/article-id/602){#printThread
    .lia-link-navigation .print-article
    .lia-component-forums-action-print-thread}
-   [Report Inappropriate
    Content](/t5/notifications/notifymoderatorpage/message-uid/3000703){#reportAbuse
    .lia-link-navigation .report-abuse-link
    .lia-component-forums-action-report-abuse}
:::
:::
:::
:::
:::
:::
:::
:::

::: {.lia-quilt-row .lia-quilt-row-main}
::: {.lia-quilt-column .lia-quilt-column-24 .lia-quilt-column-single .lia-quilt-column-main}
::: {.lia-quilt-column-alley .lia-quilt-column-alley-single}
::: {.lia-message-subject-wrapper .lia-component-subject .lia-component-message-view-widget-subject-with-options}
::: MessageSubject
::: MessageSubjectIcons
# [ [Monitor and Notify M365 health using CLI for Microsoft 365](/t5/microsoft-365-pnp-blog/monitor-and-notify-m365-health-using-cli-for-microsoft-365/ba-p/3000703){#link_6 .page-link .lia-link-navigation .lia-custom-event} ]{.lia-message-unread} {#monitor-and-notify-m365-health-using-cli-for-microsoft-365-1 .message-subject itemprop="name"}

[]{#display_2 .lia-img-message-has-url .lia-fa-message .lia-fa-has
.lia-fa-url .lia-fa title="Contains a hyperlink"
alt="Message contains a hyperlink" aria-label="Contains a hyperlink"
role="img"} []{#display_3 .lia-img-message-has-image .lia-fa-message
.lia-fa-has .lia-fa-image .lia-fa title="Contains an image"
alt="Message contains an image" aria-label="Contains an image"
role="img"} []{#display_5 .lia-img-message-has-attachment
.lia-fa-message .lia-fa-has .lia-fa-attachment .lia-fa
title="Contains an attachment" alt="Message contains an attachment"
aria-label="Contains an attachment" role="img"}
:::
:::
:::

::: {.lia-message-post-date .lia-component-post-date .lia-component-message-view-widget-post-date title="Posted on"}
[ [‎Nov 24 2021]{.local-date} [05:38 AM]{.local-time} ]{.DateTime}
:::

::: {.lia-message-body-wrapper .lia-component-message-view-widget-body}
::: {#bodyDisplay .lia-message-body itemprop="text"}
::: lia-message-body-content
Are you an IT Pro who wants to have a solution that checks the status of
your Microsoft 365 Tenant.

How about if you get notified when something goes wrong with your tenant
and you get that information before your users complain. Awesome, right?

 

**Fair** Warning : This blog post is a lengthy one since it talks about
how I created the solution. If you are only interested in script sample,
head directly to the [Complete Script Section](#powershell-scripts)

##   {#toc-hId-329918557}

## Solution {#toc-hId--1477535906}

In this blog, I am showing a way where you can schedule a script that
will check the status of your tenant. If something is not right with the
tenant, it will save the information to a SharePoint List and will
notify the user. I am also giving a bonus solution where I have created
a simple Power Automate which will identify the changes and will
complete some of the processes which are designed for notification.

[CLI for Microsoft
365](https://pnp.github.io/cli-microsoft365/) provides some powerful and
lightweight commands via which you can get the health status of your
Office 365 Tenant. With the combination of multiple commands, you can
create a full-fledged and powerful solution through which you can get
updates, notified if some of the services are not working as expected.

In this blog, I am using Windows for showing the use case. You as a user
are not restricted to use PowerShell since [CLI for Microsoft 365 is a
cross-platform
CLI](https://pnp.github.io/cli-microsoft365/about/why-cli/) and is
independent of the OS platform which you use.

## Index {#toc-hId-1009976927}

-   [Solution](#solution)
-   [Index](#index)
-   [Implementation](#implementation)
    -   [Authentication and Login](#authentication-and-login)
    -   [Get status of Tenant](#get-status-of-tenant)
    -   [Pushing to SharePoint list when Services are not
        normal](#pushing-to-sharepoint-list-when-services-are-not-normal)
        -   [SharePoint List](#sharepoint-list)
        -   [Adding to SharePoint List if a Service is not
            Normal](#adding-to-sharepoint-list-if-a-service-is-not-normal)
    -   [Send email to any users using CLI for Microsoft
        365](#send-email-to-any-users-using-cli-for-microsoft-365)
        -   [Send email when the service is NOT
            Operational](#send-email-when-the-service-is-not-operational)
        -   [Send email when the service is back to
            Operational](#send-email-when-the-service-is-back-to-operational)
-   [Bonus Solution - Configure Power Automate for doing any Business
    Process](#bonus-solution---configure-power-automate-for-doing-any-business-process)
    -   [Power Automate - Creation
        Trigger](#power-automate---creation-trigger)
    -   [Power Automate - On Modified](#power-automate---on-modified)
-   [PowerShell Scripts](#powershell-scripts)
    -   [Complete Script - Easily
        understandable](#complete-script---easily-understandable)
    -   [Simple Script - Production Ready (Lines of Code :
        4)](#simple-script---production-ready-lines-of-code--4)
-   [Schedule the script](#schedule-the-script)
-   [Complete Scripts](#complete-scripts)
-   [Need to know more on how to use CLI for Microsoft
    365](#need-to-know-more-on-how-to-use-cli-for-microsoft-365)

##   {#toc-hId--797477536}

## Implementation {#toc-hId-1690035297}

###   {#toc-hId--1914370525}

### Authentication and Login {#toc-hId-573142308}

The biggest advantage CLI for Microsoft 365 has is its ability
to [Persist Connection
Information](https://pnp.github.io/cli-microsoft365/concepts/persisting-connection/).

After logging in to Microsoft 365, the CLI for Microsoft 365 will
persist the information about the connection until you explicitly log
out from Microsoft 365. Once you have authenticated to the tenant, your
scripts will be executed without the need for authentication every time.
Since the solution is not a confidential or had complex business
process, it is safe to go ahead with this approach. CLI for Microsoft
365 also provides [logging in using a
certificate](https://pnp.github.io/cli-microsoft365/user-guide/connecting-office-365/#log-in-using-a-certificate) if
you prefer that approach.

###   {#toc-hId--1234312155}

### Get status of Tenant {#toc-hId-1253200678}

The first step for the script is to get the current status using [tenant
status
list](https://pnp.github.io/cli-microsoft365/cmd/tenant/status/status-list/) command.
In our case, we just want to get the services which are not normal.
Here, we use the tenant status list command and would pass [JMESPath
Query](https://jmespath.org/) since CLI for Microsoft 365 supports that.
This query is supported in cross-platform as well. We will retrieve all
the services which are not running normally and hence we would the
JMESPath query would be something
like `?Status != 'ServiceOperational'`{.language-plaintext
.highlighter-rouge}.

Based on that, our command may look something like below

::: {.language-shell .highlighter-rouge}
::: highlight
``` highlight
m365 tenant status list --query "value[?Status != 'ServiceOperational']"  --output json
```
:::
:::

> > **Another biggest advantage of CLI for Microsoft 365 is that all the
> > command provides an option for you to [return the values in a JSON
> > string](https://pnp.github.io/cli-microsoft365/user-guide/cli-output-mode/#json-output-mode).
> > With JSON, it is super powerful and flexible and you can easily
> > manipulate the data in your scripts.**

###   {#toc-hId--554253785}

### Pushing to SharePoint list when Services are not normal {#toc-hId-1238095569}

####   {#toc-hId--440276175}

#### SharePoint List {#toc-hId-2047236658}

Here we are using a SharePoint List in one of the SharePoint sites. The
advantage of that is, you can have the information kept and you can tag
it to a Power Automate if you want to build some logics (I have created
a [Power Automate
solution](https://arjunumenon.com/tenant-status-solution-m365cli/#bonus-solution---configure-power-automate-for-doing-any-business-process) so
that can you can have a look into that and design your requirements
accordingly). In my case, SharePoint List look something like below

{{< image alt="ArjunMenon_0-1637745741073.jpeg" src="images/blog/monitor-and-notify-m365-health-using-cli-for-microsoft-365/ArjunMenon_0-1637745741073.jpeg" >}}{.lia-media-image
role="button"
li-image-url="https://techcommunity.microsoft.com/t5/image/serverpage/image-id/329103iE1C98C8A8FE47A73?v=v2"
li-image-display-id="'329103iE1C98C8A8FE47A73'"
li-message-uid="'3000703'" li-messages-message-image="true"
li-bindable="" tabindex="0" li-bypass-lightbox-when-linked="true"
li-use-hover-links="false"}]{.lia-inline-image-display-wrapper
.lia-image-align-inline image-alt="ArjunMenon_0-1637745741073.jpeg"
style="width: 400px;"}

 

####   {#toc-hId-239782195}

####   {#toc-hId--1567672268}

#### Adding to SharePoint List if a Service is not Normal {#toc-hId-919840565}

We will be using [spo listitem
add](https://pnp.github.io/cli-microsoft365/cmd/spo/listitem/listitem-add/) which
will add the item to SharePoint List. Since we are already authenticated
to your tenant, all we need to do is to use the command directly. Before
we do that, we will just check the current SharePoint list whether the
outage is already added. We plan to have the script running in a fixed
interval, say every **15 minutes** or **30 minutes**. In that case,
there is a chance that the outage is still there and we do not need the
entry to be duplicated. So we would get the items from the current
SharePoint List using the command [spo listitem
get](https://pnp.github.io/cli-microsoft365/cmd/spo/listitem/listitem-get/) and
will check whether the current outage is already there in the List.

-   If it is there,
    -   Then we will not do anything.
-   If the entry is not there,
    -   we will use the command `spo listitem add`{.language-plaintext
        .highlighter-rouge} and add the status information to SharePoint
        List

The complete command may look something like below,

::: {.language-shell .highlighter-rouge}
::: highlight
``` highlight
$workLoads = m365 tenant status list --query "value[?Status != 'ServiceOperational']"  --output json  | ConvertFrom-Json
$currentOutageServices = (m365 spo listitem list --webUrl $webURL --title $listName --fields "Title, Workload, Id"  --output json).Replace("ID", "_ID") | ConvertFrom-Json

#Adding items if any of the workload is not available
$workLoads | ?{$_.Workload -notin $currentOutageServices.Workload} | %{ $addedWorkLoad = m365 spo listitem add --webUrl $webURL --listTitle $listName --contentType Item --Title $_.WorkloadDisplayName --Workload $_.Workload --FirstIdentifiedDate (Get-Date -Date $_.StatusTime -Format "MM/dd/yyyy HH:mm") --WorkflowJSONData (Out-String -InputObject $_ -Width 100) }
```
:::
:::

 

 

You can see that, we are even pushing the JSON Data of the complete
status information so that you as an IT Pro will have detailed logs
without going to the Admin Center. Once you have the data pushed, your
status information for a particular outage may look something like
below. 

{{< image alt="ArjunMenon_1-1637745741149.jpeg" src="images/blog/monitor-and-notify-m365-health-using-cli-for-microsoft-365/ArjunMenon_1-1637745741149.jpeg" >}}{.lia-media-image
role="button"
li-image-url="https://techcommunity.microsoft.com/t5/image/serverpage/image-id/329105i80FC21C572CA5DF8?v=v2"
li-image-display-id="'329105i80FC21C572CA5DF8'"
li-message-uid="'3000703'" li-messages-message-image="true"
li-bindable="" tabindex="0" li-bypass-lightbox-when-linked="true"
li-use-hover-links="false"}]{.lia-inline-image-display-wrapper
.lia-image-align-inline image-alt="ArjunMenon_1-1637745741149.jpeg"
style="width: 400px;"}

###   {#toc-hId--1016696617}

### Send email to any users using CLI for Microsoft 365 {#toc-hId-1470816216}

####   {#toc-hId--207555528}

#### Send email when the service is NOT Operational {#toc-hId--2015009991}

CLI for Microsoft 365 gives us the power of sending an email using the
command [outlook
sendmail](https://pnp.github.io/cli-microsoft365/cmd/outlook/mail/mail-send/).
With this command, it uses the logged in user's outlook to send an
email.

*Super Tip : You can also use a
flag `saveToSentItems`{.language-plaintext .highlighter-rouge} using
which you can disable to have the email saved in your sent folder.
Awesome, isn't it?*

Command may look something like below,

::: {.language-shell .highlighter-rouge}
::: highlight
``` highlight
#Send notification using CLI Commands
m365 outlook mail send --to "recipient@yourtenant.onmicrosoft.com" --subject "Outage Reported in $($workload.WorkloadDisplayName)" --bodyContents "Any outage has been reported for the Service : $($workload.WorkloadDisplayName) <a href='https://yourtenant.sharepoint.com/sites/M365CLI/Lists/O365%20Health%20Status'>Access the Health Status List</a>" --bodyContentType HTML
```
:::
:::

####   {#toc-hId-1170664783}

#### Send email when the service is back to Operational {#toc-hId--636789680}

Getting notification when the service is back to normal is equally
important compared to the [notification when a Service is not
Operational](https://arjunumenon.com/tenant-status-solution-m365cli/#send-email-when-the-service-is-not-operational).
This would enable you as an IT Pro to notify the concerned team and your
organization on that.

In the above steps, we had saved the data to a [SharePoint
list](https://arjunumenon.com/tenant-status-solution-m365cli/#sharepoint-list) when
service are not operational. When our script checks the status and
identifies that the service which was there in SharePoint List is no
more there in the non-operational list of Tenant Workloads, we can
assume that the tenant Service was **NOT Operational** is back
to **Operational**

Code which handles that is given below,

::: {.language-powershell .highlighter-rouge}
::: highlight
``` highlight
Foreach ($currentOutageService in $currentOutageServices){
    if($currentOutageService.Workload -notin $workLoads.Workload){
        $RemovedRecord = m365 spo listitem remove --webUrl $webURL --listTitle $listName --id  $currentOutageService.Id

        #Send notification using CLI Commands
        m365 outlook mail send --to "arjun@yourtenant.onmicrosoft.com" --subject "Outage RESOLVED for $($currentOutageService.WorkloadDisplayName)" --bodyContents "Outage which was reported for the Service : $($workload.WorkloadDisplayName) is RESOLVED." --bodyContentType HTML
    }
}
```
:::
:::

What we do in the above code is,

-   If the item in SharePoint list is not there in list of Service which
    is NOT Operational
-   Remove the Item from the SharePoint list using the
    command [`spo listitem remove`{.language-plaintext
    .highlighter-rouge}](https://pnp.github.io/cli-microsoft365/cmd/spo/listitem/listitem-remove/)
    -   IF you want you can also copy item to another list for any
        historical purpose if needed
-   Send email to recipients informing that the Service is back to
    Normal

##   {#toc-hId-1592557715}

## Bonus Solution - Configure Power Automate for doing any Business Process {#toc-hId--214896748}

As we may know [Power
Automate](https://flow.microsoft.com/en-us/) provides rich features
which we can leverage if you want to do any action based on the
available triggers. Say e.g., when your SharePoint service is not
Operational, need to initiate a Service Request in your Help Desk
support system automatically, we can always define the logic in Power
Automate and once an outage is identified, Power Automate will initiate
a Service Request in your help-desk system along with notifying
concerned team. In our case, we are using SharePoint list item Creation
/ Modification as the trigger for initiating Process. Since we are
adding list item using CLI for Microsoft 365, we can easily take that as
the triggering point

In my case, what I have done is that,

1.  Create 1 Flow which will get triggered when an item is created and
    another flow which will get triggered if an item is modified

2.  If the `Still in Outage`{.language-plaintext
    .highlighter-rouge} flag in [SharePoint
    List](https://arjunumenon.com/tenant-status-solution-m365cli/#sharepoint-list) is **YES** (Creation
    Triggered Flow)
    1.  Send notification via email informing about Outage
    2.  Send a Push Notification to the configured user

3.  If the `Still in Outage`{.language-plaintext
    .highlighter-rouge} flag in [SharePoint
    List](https://arjunumenon.com/tenant-status-solution-m365cli/#sharepoint-list) is **No** (Modified
    Trigger Flow)
    1.  Send notification via email about Service becoming Operational

As I said, mine is a super simple implementation just to demonstrate the
Power of Power Automate which goes hand in hand with scripting tools. If
you have some business logic which needs to be in place with this, it
always gives you the flexibility for the same. Just giving a glimpse of
my simple Power Automate screen below,

###   {#toc-hId--1893268492}

### Power Automate - Creation Trigger {#toc-hId-594244341}

Below Power Automate will do the process when a new outage is reported
by the script 

{{< image alt="ArjunMenon_2-1637745741136.jpeg" src="images/blog/monitor-and-notify-m365-health-using-cli-for-microsoft-365/ArjunMenon_2-1637745741136.jpeg" >}}{.lia-media-image
role="button"
li-image-url="https://techcommunity.microsoft.com/t5/image/serverpage/image-id/329104i7B050DBE4262D573?v=v2"
li-image-display-id="'329104i7B050DBE4262D573'"
li-message-uid="'3000703'" li-messages-message-image="true"
li-bindable="" tabindex="0" li-bypass-lightbox-when-linked="true"
li-use-hover-links="false"}]{.lia-inline-image-display-wrapper
.lia-image-align-inline image-alt="ArjunMenon_2-1637745741136.jpeg"
style="width: 400px;"}

###   {#toc-hId--1213210122}

### Power Automate - On Modified {#toc-hId-1274302711}

Below is the Power Automate which is created when existing outage is
modified, which means one of the current Service which was **NOT
OPERATIONAL** is changed to **OPERATIONAL**

{{< image alt="ArjunMenon_3-1637745741115.jpeg" src="images/blog/monitor-and-notify-m365-health-using-cli-for-microsoft-365/ArjunMenon_3-1637745741115.jpeg" >}}{.lia-media-image
role="button"
li-image-url="https://techcommunity.microsoft.com/t5/image/serverpage/image-id/329106i08AAB9ED71AC9A56?v=v2"
li-image-display-id="'329106i08AAB9ED71AC9A56'"
li-message-uid="'3000703'" li-messages-message-image="true"
li-bindable="" tabindex="0" li-bypass-lightbox-when-linked="true"
li-use-hover-links="false"}]{.lia-inline-image-display-wrapper
.lia-image-align-inline image-alt="ArjunMenon_3-1637745741115.jpeg"
style="width: 400px;"}

 

 

{{< image alt="ArjunMenon_4-1637745741165.jpeg" src="images/blog/monitor-and-notify-m365-health-using-cli-for-microsoft-365/ArjunMenon_4-1637745741165.jpeg" >}}{.lia-media-image
role="button"
li-image-url="https://techcommunity.microsoft.com/t5/image/serverpage/image-id/329107i91CA57B14B093B7D?v=v2"
li-image-display-id="'329107i91CA57B14B093B7D'"
li-message-uid="'3000703'" li-messages-message-image="true"
li-bindable="" tabindex="0" li-bypass-lightbox-when-linked="true"
li-use-hover-links="false"}]{.lia-inline-image-display-wrapper
.lia-image-align-inline image-alt="ArjunMenon_4-1637745741165.jpeg"
style="width: 400px;"}

 

 

## PowerShell Scripts {#toc-hId--662234471}

As mentioned above, in my case, I have used PowerShell for scripting the
requirement. You can access the scripts which I have used from below.

###   {#toc-hId-1954361081}

### Complete Script - Easily understandable {#toc-hId-845068559}

Below script is the similar implementation of the [Production Read
Script](https://arjunumenon.com/tenant-status-solution-m365cli/#simple-script---production-ready-lines-of-code--4).
Rather than using PowerShell piping, we are using conventional For-Each
so that script is easily readable.

 

 

 

``` {.lia-code-sample .language-bash}
#Check the Login Status
$LoginStatus = m365 status

if($LoginStatus -Match "Logged out"){
    #Exiting the execution
    exit;    
}

$webURL = "https://contoso.sharepoint.com/sites/HealthStatusSite"
$listName = "O365 Health Status"
$workLoads = m365 tenant status list --query "value[?Status != 'ServiceOperational']"  --output json  | ConvertFrom-Json
$currentOutageServices = (m365 spo listitem list --webUrl $webURL --title $listName --fields "Title, Workload, Id"  --output json).Replace("ID", "_ID") | ConvertFrom-Json

Foreach ($workload in $workLoads){
    if($workload.Workload -notin $currentOutageServices.Workload){
        $addedWorkLoad = m365 spo listitem add --webUrl $webURL --listTitle $listName --contentType Item --Title $workload.WorkloadDisplayName --Workload $workload.Workload --FirstIdentifiedDate (Get-Date -Date $workload.StatusTime -Format "MM/dd/yyyy HH:mm") --WorkflowJSONData (Out-String -InputObject $workload -Width 100)

        #Send notification using CLI Commands
        m365 outlook mail send --to "arjun@contoso.onmicrosoft.com" --subject "Outage Reported in $($workload.WorkloadDisplayName)" --bodyContents "Any outage has been reported for the Service : $($workload.WorkloadDisplayName) <a href='https://contoso.sharepoint.com/sites/HealthStatusSite/Lists/O365%20Health%20Status'>Access the Health Status List</a>" --bodyContentType HTML
    }
}

#Updating the status to IsInOutage to NO the list item if the service is back to normal
Foreach ($currentOutageService in $currentOutageServices){
    if($currentOutageService.Workload -notin $workLoads.Workload){
        $RemovedRecord = m365 spo listitem remove --webUrl $webURL --listTitle $listName --id  $currentOutageService.Id

        #Send notification using CLI Commands
        m365 outlook mail send --to "arjun@contoso.onmicrosoft.com" --subject "Outage RESOLVED for $($currentOutageService.WorkloadDisplayName)" --bodyContents "Outage which was reported for the Service : $($workload.WorkloadDisplayName) is RESOLVED." --bodyContentType HTML
    }
}
```

 

 

 

 

 

 

###   {#toc-hId--962385904}

### Simple Script - Production Ready (Lines of Code : 4) {#toc-hId-1525126929}

In the below script, I have used PowerShell piping and hence the script
may look complicated. But it hardly has 3 lines of code which does the
complete operation and these kind of scripts will be ideal for your
production like environment. If you need to understand the script, you
can view [easily understandable
script](https://arjunumenon.com/tenant-status-solution-m365cli/#complete-script---easily-understandable).

 

 

 

 

 

``` {.lia-code-sample .language-bash}
$webURL = "https://contoso.sharepoint.com/sites/M365HealthStatus"
$listName = "O365 Health Status"
$workLoads = m365 tenant status list --query "value[?Status != 'ServiceOperational']"  --output json  | ConvertFrom-Json
$currentOutageServices = (m365 spo listitem list --webUrl $webURL --title $listName --fields "Title, Workload, Id"  --output json).Replace("ID", "_ID") | ConvertFrom-Json
$workLoads | ?{$_.Workload -notin $currentOutageServices.Workload} | %{ $addedWorkLoad = m365 spo listitem add --webUrl $webURL --listTitle $listName --contentType Item --Title $_.WorkloadDisplayName --Workload $_.Workload --FirstIdentifiedDate (Get-Date -Date $_.StatusTime -Format "MM/dd/yyyy HH:mm") --WorkflowJSONData (Out-String -InputObject $_ -Width 100)}
$currentOutageServices | ?{$_.Workload -notin $workLoads.Workload} | %{ $UpdatedWorkflod = m365 spo listitem set --webUrl $webURL --listTitle $listName --contentType Item --id  $_.Id --StillinOutage "false" }
```

 

 

 

 

 

## Schedule the script {#toc-hId--411410253}

The last part of the solution is to schedule the script which we have
created. In my case, I have scheduled the script to run every half an
hour. Schedule could be decided depending on your business case.

In my case, since I am using a Windows machine and hence I would be
using PowerShell as my scripting tool. Since CLI for Microsoft 365 is OS
agnostic, you are free to use script based on your Operating System, be
it on Windows or Mac OS or Linux.

In this blog, we will not be covering about scheduling the scripts in
PowerShell since it is a straight forward activity. You can view [this
blog](https://o365reports.com/2019/08/02/schedule-powershell-script-task-scheduler/) where
it has explained how to configure PowerShell

##   {#toc-hId-2076102580}

## Complete Scripts {#toc-hId-268648117}

Too lazy to build scripts. Don't worry. We got your back. Now the
complete script package is available in the CLI for Microsoft
365 [sample scripts
section](https://pnp.github.io/cli-microsoft365/sample-scripts/tenant/tenant-monitor-notify-healthstatus/).

 

Photo by [Austin
Distel](https://unsplash.com/@austindistel?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText) on
Unsplash

::: {#attachments .Attachments .lia-attachments-message .preview-attachments}
::: {.lia-attachment .lia-attachment-preview-container .attachment-1 .lia-attachment-row}
::: {.lia-attachment-row-element .lia-attachment-icon-container}
[]{#display_0 .lia-img-icon-attachment .lia-fa-icon .lia-fa-attachment
.lia-fa title="Attachment" alt="Attachment" aria-label="Attachment"
role="img"}
:::

::: {.lia-attachment-row-element .lia-attachment-link-row-element}
[[]{li-download-url="/gxcuf89792/attachments/gxcuf89792/Microsoft365PnPBlog/602/1/2021-01-19-tenant-status-solution-m365cli.jpg"
li-attachment-name="2021-01-19-tenant-status-solution-m365cli.jpg"
ng-non-bindable=""}](https://techcommunity.microsoft.com/t5/microsoft-365-pnp-blog/monitor-and-notify-m365-health-using-cli-for-microsoft-365/ba-p/3000703?attachment-id=47062){#link_7
.lia-link-navigation .attachment-link}
:::

::: {.lia-attachment-row-element .lia-media-document}
[[]{#display_1 .lia-img-icon-download .lia-fa-icon .lia-fa-download
.lia-fa title="Download attachment" alt="Download this attachment"
aria-label="Download attachment"
role="img"}](/gxcuf89792/attachments/gxcuf89792/Microsoft365PnPBlog/602/1/2021-01-19-tenant-status-solution-m365cli.jpg){#link_8
.lia-link-navigation}
:::
:::
:::
:::
:::
:::
:::
:::
:::

::: {.lia-quilt-row .lia-quilt-row-footer}
::: {.lia-quilt-column .lia-quilt-column-12 .lia-quilt-column-left .lia-quilt-column-footer-left}
::: {.lia-quilt-column-alley .lia-quilt-column-alley-left}
::: {#kudosButtonV2 .KudosButton .lia-button-image-kudos-wrapper .lia-component-kudos-widget-button-version-3 .lia-component-kudos-widget-button-horizontal .lia-component-kudos-widget-button .lia-component-kudos-action .lia-component-message-view-widget-kudos-action lia-kudos-id="3000703"}
::: {.lia-button-image-kudos .lia-button-image-kudos-horizontal .lia-button-image-kudos-enabled .lia-button-image-kudos-not-kudoed .lia-button-image-kudos-has-kudoes .lia-button-image-kudos-has-kudos .lia-button aria-atomic="true" aria-live="assertive"}
::: lia-button-image-kudos-count
[[ 1 ]{#messageKudosCount_2316c940f474f3 .MessageKudosCount
.lia-component-kudos-widget-message-kudos-count itemprop="upvoteCount"}[
Like ]{.lia-button-image-kudos-label
.lia-component-kudos-widget-kudos-count-label}](/t5/kudos/messagepage/board-id/Microsoft365PnPBlog/message-id/602/tab/all-users "Click here to see who gave likes to this post."){#link_9
.lia-link-navigation .kudos-count-link}
:::

::: lia-button-image-kudos-give
[Like](https://techcommunity.microsoft.com/t5/blogs/v2/blogarticlepage.kudosbuttonv2.kudoentity:kudoentity/kudosable-gid/3000703?t:ac=blog-id/Microsoft365PnPBlog/article-id/602&t:cp=kudos/contributions/tapletcontributionspage "Click here to give likes to this post."){#kudoEntity
.lia-link-navigation .kudos-link .lia-link-ticket-post-action}
:::
:::
:::
:::
:::

::: {.lia-quilt-column .lia-quilt-column-12 .lia-quilt-column-right .lia-quilt-column-footer-right}
::: {.lia-quilt-column-alley .lia-quilt-column-alley-right}
::: {.lia-button-group .lia-component-comment-button .lia-component-message-view-widget-comment-button}
:::
:::
:::
:::

::: {.lia-quilt-row .lia-quilt-row-mod-controls}
::: {.lia-quilt-column .lia-quilt-column-24 .lia-quilt-column-single .lia-quilt-column-mod-controls-main}
::: {.lia-quilt-column-alley .lia-quilt-column-alley-single .lia-mark-empty}
:::
:::
:::

::: {.lia-quilt-row .lia-quilt-row-sub-footer}
::: {.lia-quilt-column .lia-quilt-column-24 .lia-quilt-column-single .lia-quilt-column-sub-footer .lia-mark-empty}
:::
:::
:::
:::
:::

::: {#progressBar .lia-progress .lia-js-hidden}
::: lia-progress-indeterminate
:::
:::
:::
:::

[]{#comment-on-this} [ ]{#feedback-successinformationbox_6}

::: {#informationbox_6 .InfoMessage .lia-panel-feedback-banner-note .lia-component-comment-editor}
::: {.lia-text role="alert"}
You must be a registered user to add a comment. If you\'ve already
registered, sign in. Otherwise, register and sign in.

-   [Comment](/plugins/common/feature/oauth2sso/sso_login_redirect?lang=en&redirectreason=permissiondenied&referer=https%3A%2F%2Ftechcommunity.microsoft.com%2Ft5%2Fmicrosoft-365-pnp-blog%2Fmonitor-and-notify-m365-health-using-cli-for-microsoft-365%2Fba-p%2F3000703%23comment-on-this){#link_10
    .lia-link-navigation .blog-link .lia-message-comment-post}
:::
:::
:::
:::

::: {.lia-quilt-column .lia-quilt-column-06 .lia-quilt-column-right .lia-quilt-column-side-content}
::: {.lia-quilt-column-alley .lia-quilt-column-alley-right}
%3CLINGO-SUB%20id%3D%22lingo-sub-3000703%22%20slang%3D%22en-US%22%3EMonitor%20and%20Notify%20M365%20health%20using%20CLI%20for%20Microsoft%20365%3C%2FLINGO-SUB%3E%3CLINGO-BODY%20id%3D%22lingo-body-3000703%22%20slang%3D%22en-US%22%3E%3CP%3EAre%20you%20an%20IT%20Pro%20who%20wants%20to%20have%20a%20solution%20that%20checks%20the%20status%20of%20your%20Microsoft%20365%20Tenant.%3C%2FP%3E%0A%3CP%3EHow%20about%20if%20you%20get%20notified%20when%20something%20goes%20wrong%20with%20your%20tenant%20and%20you%20get%20that%20information%20before%20your%20users%20complain.%20Awesome%2C%20right%3F%3C%2FP%3E%0A%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3CP%3E%3CSTRONG%3EFair%3C%2FSTRONG%3E%20Warning%20%3A%20This%20blog%20post%20is%20a%20lengthy%20one%20since%20it%20talks%20about%20how%20I%20created%20the%20solution.%20If%20you%20are%20only%20interested%20in%20script%20sample%2C%20head%20directly%20to%20the%3CSPAN%3E%26nbsp%3B%3C%2FSPAN%3E%3CA%20href%3D%22%23powershell-scripts%22%20target%3D%22_self%22%20rel%3D%22nofollow%20noopener%20noreferrer%22%3EComplete%20Script%20Section%3C%2FA%3E%3C%2FP%3E%0A%3CH2%20id%3D%22toc-hId-329918557%22%20id%3D%22toc-hId-329918593%22%3E%26nbsp%3B%3C%2FH2%3E%0A%3CH2%20id%3D%22solution%22%20id%3D%22toc-hId\--1477535906%22%20id%3D%22toc-hId\--1477535870%22%3ESolution%3C%2FH2%3E%0A%3CP%3EIn%20this%20blog%2C%20I%20am%20showing%20a%20way%20where%20you%20can%20schedule%20a%20script%20that%20will%20check%20the%20status%20of%20your%20tenant.%20If%20something%20is%20not%20right%20with%20the%20tenant%2C%20it%20will%20save%20the%20information%20to%20a%20SharePoint%20List%20and%20will%20notify%20the%20user.%20I%20am%20also%20giving%20a%20bonus%20solution%20where%20I%20have%20created%20a%20simple%20Power%20Automate%20which%20will%20identify%20the%20changes%20and%20will%20complete%20some%20of%20the%20processes%20which%20are%20designed%20for%20notification.%3C%2FP%3E%0A%3CP%3E%3CA%20href%3D%22https%3A%2F%2Fpnp.github.io%2Fcli-microsoft365%2F%22%20target%3D%22_blank%22%20rel%3D%22noopener%20nofollow%20noreferrer%22%3ECLI%20for%20Microsoft%20365%3C%2FA%3E%3CSPAN%3E%26nbsp%3B%3C%2FSPAN%3Eprovides%20some%20powerful%20and%20lightweight%20commands%20via%20which%20you%20can%20get%20the%20health%20status%20of%20your%20Office%20365%20Tenant.%20With%20the%20combination%20of%20multiple%20commands%2C%20you%20can%20create%20a%20full-fledged%20and%20powerful%20solution%20through%20which%20you%20can%20get%20updates%2C%20notified%20if%20some%20of%20the%20services%20are%20not%20working%20as%20expected.%3C%2FP%3E%0A%3CP%3EIn%20this%20blog%2C%20I%20am%20using%20Windows%20for%20showing%20the%20use%20case.%20You%20as%20a%20user%20are%20not%20restricted%20to%20use%20PowerShell%20since%3CSPAN%3E%26nbsp%3B%3C%2FSPAN%3E%3CA%20href%3D%22https%3A%2F%2Fpnp.github.io%2Fcli-microsoft365%2Fabout%2Fwhy-cli%2F%22%20target%3D%22_blank%22%20rel%3D%22noopener%20nofollow%20noreferrer%22%3ECLI%20for%20Microsoft%20365%20is%20a%20cross-platform%20CLI%3C%2FA%3E%3CSPAN%3E%26nbsp%3B%3C%2FSPAN%3Eand%20is%20independent%20of%20the%20OS%20platform%20which%20you%20use.%3C%2FP%3E%0A%3CH2%20id%3D%22index%22%20id%3D%22toc-hId-1009976927%22%20id%3D%22toc-hId-1009976963%22%3EIndex%3C%2FH2%3E%0A%3CUL%3E%0A%3CLI%3E%3CA%20href%3D%22%23solution%22%20target%3D%22_self%22%20rel%3D%22nofollow%20noopener%20noreferrer%22%3ESolution%3C%2FA%3E%3C%2FLI%3E%0A%3CLI%3E%3CA%20href%3D%22%23index%22%20target%3D%22_self%22%20rel%3D%22nofollow%20noopener%20noreferrer%22%3EIndex%3C%2FA%3E%3C%2FLI%3E%0A%3CLI%3E%3CA%20href%3D%22%23implementation%22%20target%3D%22_self%22%20rel%3D%22nofollow%20noopener%20noreferrer%22%3EImplementation%3C%2FA%3E%3CUL%3E%0A%3CLI%3E%3CA%20href%3D%22%23authentication-and-login%22%20target%3D%22_self%22%20rel%3D%22nofollow%20noopener%20noreferrer%22%3EAuthentication%20and%20Login%3C%2FA%3E%3C%2FLI%3E%0A%3CLI%3E%3CA%20href%3D%22%23get-status-of-tenant%22%20target%3D%22_self%22%20rel%3D%22nofollow%20noopener%20noreferrer%22%3EGet%20status%20of%20Tenant%3C%2FA%3E%3C%2FLI%3E%0A%3CLI%3E%3CA%20href%3D%22%23pushing-to-sharepoint-list-when-services-are-not-normal%22%20target%3D%22_self%22%20rel%3D%22nofollow%20noopener%20noreferrer%22%3EPushing%20to%20SharePoint%20list%20when%20Services%20are%20not%20normal%3C%2FA%3E%3CUL%3E%0A%3CLI%3E%3CA%20href%3D%22%23sharepoint-list%22%20target%3D%22_self%22%20rel%3D%22nofollow%20noopener%20noreferrer%22%3ESharePoint%20List%3C%2FA%3E%3C%2FLI%3E%0A%3CLI%3E%3CA%20href%3D%22%23adding-to-sharepoint-list-if-a-service-is-not-normal%22%20target%3D%22_self%22%20rel%3D%22nofollow%20noopener%20noreferrer%22%3EAdding%20to%20SharePoint%20List%20if%20a%20Service%20is%20not%20Normal%3C%2FA%3E%3C%2FLI%3E%0A%3C%2FUL%3E%0A%3C%2FLI%3E%0A%3CLI%3E%3CA%20href%3D%22%23send-email-to-any-users-using-cli-for-microsoft-365%22%20target%3D%22_self%22%20rel%3D%22nofollow%20noopener%20noreferrer%22%3ESend%20email%20to%20any%20users%20using%20CLI%20for%20Microsoft%20365%3C%2FA%3E%3CUL%3E%0A%3CLI%3E%3CA%20href%3D%22%23send-email-when-the-service-is-not-operational%22%20target%3D%22_self%22%20rel%3D%22nofollow%20noopener%20noreferrer%22%3ESend%20email%20when%20the%20service%20is%20NOT%20Operational%3C%2FA%3E%3C%2FLI%3E%0A%3CLI%3E%3CA%20href%3D%22%23send-email-when-the-service-is-back-to-operational%22%20target%3D%22_self%22%20rel%3D%22nofollow%20noopener%20noreferrer%22%3ESend%20email%20when%20the%20service%20is%20back%20to%20Operational%3C%2FA%3E%3C%2FLI%3E%0A%3C%2FUL%3E%0A%3C%2FLI%3E%0A%3C%2FUL%3E%0A%3C%2FLI%3E%0A%3CLI%3E%3CA%20href%3D%22%23bonus-solution\-\--configure-power-automate-for-doing-any-business-process%22%20target%3D%22_self%22%20rel%3D%22nofollow%20noopener%20noreferrer%22%3EBonus%20Solution%20-%20Configure%20Power%20Automate%20for%20doing%20any%20Business%20Process%3C%2FA%3E%3CUL%3E%0A%3CLI%3E%3CA%20href%3D%22%23power-automate\-\--creation-trigger%22%20target%3D%22_self%22%20rel%3D%22nofollow%20noopener%20noreferrer%22%3EPower%20Automate%20-%20Creation%20Trigger%3C%2FA%3E%3C%2FLI%3E%0A%3CLI%3E%3CA%20href%3D%22%23power-automate\-\--on-modified%22%20target%3D%22_self%22%20rel%3D%22nofollow%20noopener%20noreferrer%22%3EPower%20Automate%20-%20On%20Modified%3C%2FA%3E%3C%2FLI%3E%0A%3C%2FUL%3E%0A%3C%2FLI%3E%0A%3CLI%3E%3CA%20href%3D%22%23powershell-scripts%22%20target%3D%22_self%22%20rel%3D%22nofollow%20noopener%20noreferrer%22%3EPowerShell%20Scripts%3C%2FA%3E%3CUL%3E%0A%3CLI%3E%3CA%20href%3D%22%23complete-script\-\--easily-understandable%22%20target%3D%22_self%22%20rel%3D%22nofollow%20noopener%20noreferrer%22%3EComplete%20Script%20-%20Easily%20understandable%3C%2FA%3E%3C%2FLI%3E%0A%3CLI%3E%3CA%20href%3D%22%23simple-script\-\--production-ready-lines-of-code\--4%22%20target%3D%22_self%22%20rel%3D%22nofollow%20noopener%20noreferrer%22%3ESimple%20Script%20-%20Production%20Ready%20(Lines%20of%20Code%20%3A%204)%3C%2FA%3E%3C%2FLI%3E%0A%3C%2FUL%3E%0A%3C%2FLI%3E%0A%3CLI%3E%3CA%20href%3D%22%23schedule-the-script%22%20target%3D%22_self%22%20rel%3D%22nofollow%20noopener%20noreferrer%22%3ESchedule%20the%20script%3C%2FA%3E%3C%2FLI%3E%0A%3CLI%3E%3CA%20href%3D%22%23complete-scripts%22%20target%3D%22_self%22%20rel%3D%22nofollow%20noopener%20noreferrer%22%3EComplete%20Scripts%3C%2FA%3E%3C%2FLI%3E%0A%3CLI%3E%3CA%20href%3D%22%23need-to-know-more-on-how-to-use-cli-for-microsoft-365%22%20target%3D%22_self%22%20rel%3D%22nofollow%20noopener%20noreferrer%22%3ENeed%20to%20know%20more%20on%20how%20to%20use%20CLI%20for%20Microsoft%20365%3C%2FA%3E%3C%2FLI%3E%0A%3C%2FUL%3E%0A%3CH2%20id%3D%22toc-hId\--797477536%22%20id%3D%22toc-hId\--797477500%22%3E%26nbsp%3B%3C%2FH2%3E%0A%3CH2%20id%3D%22implementation%22%20id%3D%22toc-hId-1690035297%22%20id%3D%22toc-hId-1690035333%22%3EImplementation%3C%2FH2%3E%0A%3CH3%20id%3D%22toc-hId\--1914370525%22%20id%3D%22toc-hId\--1914370489%22%3E%26nbsp%3B%3C%2FH3%3E%0A%3CH3%20id%3D%22authentication-and-login%22%20id%3D%22toc-hId-573142308%22%20id%3D%22toc-hId-573142344%22%3EAuthentication%20and%20Login%3C%2FH3%3E%0A%3CP%3EThe%20biggest%20advantage%20CLI%20for%20Microsoft%20365%20has%20is%20its%20ability%20to%3CSPAN%3E%26nbsp%3B%3C%2FSPAN%3E%3CA%20href%3D%22https%3A%2F%2Fpnp.github.io%2Fcli-microsoft365%2Fconcepts%2Fpersisting-connection%2F%22%20target%3D%22_blank%22%20rel%3D%22noopener%20nofollow%20noreferrer%22%3EPersist%20Connection%20Information%3C%2FA%3E.%3C%2FP%3E%0A%3CP%3EAfter%20logging%20in%20to%20Microsoft%20365%2C%20the%20CLI%20for%20Microsoft%20365%20will%20persist%20the%20information%20about%20the%20connection%20until%20you%20explicitly%20log%20out%20from%20Microsoft%20365.%20Once%20you%20have%20authenticated%20to%20the%20tenant%2C%20your%20scripts%20will%20be%20executed%20without%20the%20need%20for%20authentication%20every%20time.%20Since%20the%20solution%20is%20not%20a%20confidential%20or%20had%20complex%20business%20process%2C%20it%20is%20safe%20to%20go%20ahead%20with%20this%20approach.%20CLI%20for%20Microsoft%20365%20also%20provides%3CSPAN%3E%26nbsp%3B%3C%2FSPAN%3E%3CA%20href%3D%22https%3A%2F%2Fpnp.github.io%2Fcli-microsoft365%2Fuser-guide%2Fconnecting-office-365%2F%23log-in-using-a-certificate%22%20target%3D%22_blank%22%20rel%3D%22noopener%20nofollow%20noreferrer%22%3Elogging%20in%20using%20a%20certificate%3C%2FA%3E%3CSPAN%3E%26nbsp%3B%3C%2FSPAN%3Eif%20you%20prefer%20that%20approach.%3C%2FP%3E%0A%3CH3%20id%3D%22toc-hId\--1234312155%22%20id%3D%22toc-hId\--1234312119%22%3E%26nbsp%3B%3C%2FH3%3E%0A%3CH3%20id%3D%22get-status-of-tenant%22%20id%3D%22toc-hId-1253200678%22%20id%3D%22toc-hId-1253200714%22%3EGet%20status%20of%20Tenant%3C%2FH3%3E%0A%3CP%3EThe%20first%20step%20for%20the%20script%20is%20to%20get%20the%20current%20status%20using%3CSPAN%3E%26nbsp%3B%3C%2FSPAN%3E%3CA%20href%3D%22https%3A%2F%2Fpnp.github.io%2Fcli-microsoft365%2Fcmd%2Ftenant%2Fstatus%2Fstatus-list%2F%22%20target%3D%22_blank%22%20rel%3D%22noopener%20nofollow%20noreferrer%22%3Etenant%20status%20list%3C%2FA%3E%3CSPAN%3E%26nbsp%3B%3C%2FSPAN%3Ecommand.%20In%20our%20case%2C%20we%20just%20want%20to%20get%20the%20services%20which%20are%20not%20normal.%20Here%2C%20we%20use%20the%20tenant%20status%20list%20command%20and%20would%20pass%3CSPAN%3E%26nbsp%3B%3C%2FSPAN%3E%3CA%20href%3D%22https%3A%2F%2Fjmespath.org%2F%22%20target%3D%22_blank%22%20rel%3D%22noopener%20nofollow%20noreferrer%22%3EJMESPath%20Query%3C%2FA%3E%3CSPAN%3E%26nbsp%3B%3C%2FSPAN%3Esince%20CLI%20for%20Microsoft%20365%20supports%20that.%20This%20query%20is%20supported%20in%20cross-platform%20as%20well.%20We%20will%20retrieve%20all%20the%20services%20which%20are%20not%20running%20normally%20and%20hence%20we%20would%20the%20JMESPath%20query%20would%20be%20something%20like%3CSPAN%3E%26nbsp%3B%3C%2FSPAN%3E%3CCODE%20class%3D%22language-plaintext%20highlighter-rouge%22%3E%3FStatus%20!%3D%20\'ServiceOperational\'%3C%2FCODE%3E.%3C%2FP%3E%0A%3CP%3EBased%20on%20that%2C%20our%20command%20may%20look%20something%20like%20below%3C%2FP%3E%0A%3CDIV%20class%3D%22language-shell%20highlighter-rouge%22%3E%0A%3CDIV%20class%3D%22highlight%22%3E%0A%3CPRE%20class%3D%22highlight%22%3E%3CCODE%3Em365%20tenant%20status%20list%20%3CSPAN%20class%3D%22nt%22%3E\--query%3C%2FSPAN%3E%20%3CSPAN%20class%3D%22s2%22%3E%22value%5B%3FStatus%20!%3D%20\'ServiceOperational\'%5D%22%3C%2FSPAN%3E%20%20%3CSPAN%20class%3D%22nt%22%3E\--output%3C%2FSPAN%3E%20json%0A%3C%2FCODE%3E%3C%2FPRE%3E%0A%3C%2FDIV%3E%0A%3C%2FDIV%3E%0A%3CBLOCKQUOTE%3E%0A%3CBLOCKQUOTE%3E%0A%3CP%3E%3CSTRONG%3EAnother%20biggest%20advantage%20of%20CLI%20for%20Microsoft%20365%20is%20that%20all%20the%20command%20provides%20an%20option%20for%20you%20to%26nbsp%3B%3CA%20href%3D%22https%3A%2F%2Fpnp.github.io%2Fcli-microsoft365%2Fuser-guide%2Fcli-output-mode%2F%23json-output-mode%22%20target%3D%22_blank%22%20rel%3D%22noopener%20nofollow%20noreferrer%22%3Ereturn%20the%20values%20in%20a%20JSON%20string%3C%2FA%3E.%20With%20JSON%2C%20it%20is%20super%20powerful%20and%20flexible%20and%20you%20can%20easily%20manipulate%20the%20data%20in%20your%20scripts.%3C%2FSTRONG%3E%3C%2FP%3E%0A%3C%2FBLOCKQUOTE%3E%0A%3C%2FBLOCKQUOTE%3E%0A%3CH3%20id%3D%22toc-hId\--554253785%22%20id%3D%22toc-hId\--554253749%22%3E%26nbsp%3B%3C%2FH3%3E%0A%3CH3%20id%3D%22pushing-to-sharepoint-list-when-services-are-not-normal%22%20id%3D%22toc-hId-1238095569%22%20id%3D%22toc-hId-1238095605%22%3EPushing%20to%20SharePoint%20list%20when%20Services%20are%20not%20normal%3C%2FH3%3E%0A%3CH4%20id%3D%22toc-hId\--440276175%22%20id%3D%22toc-hId\--440276139%22%3E%26nbsp%3B%3C%2FH4%3E%0A%3CH4%20id%3D%22sharepoint-list%22%20id%3D%22toc-hId-2047236658%22%20id%3D%22toc-hId-2047236694%22%3ESharePoint%20List%3C%2FH4%3E%0A%3CP%3EHere%20we%20are%20using%20a%20SharePoint%20List%20in%20one%20of%20the%20SharePoint%20sites.%20The%20advantage%20of%20that%20is%2C%20you%20can%20have%20the%20information%20kept%20and%20you%20can%20tag%20it%20to%20a%20Power%20Automate%20if%20you%20want%20to%20build%20some%20logics%20(I%20have%20created%20a%3CSPAN%3E%26nbsp%3B%3C%2FSPAN%3E%3CA%20href%3D%22https%3A%2F%2Farjunumenon.com%2Ftenant-status-solution-m365cli%2F%23bonus-solution\-\--configure-power-automate-for-doing-any-business-process%22%20target%3D%22_blank%22%20rel%3D%22noopener%20nofollow%20noreferrer%22%3EPower%20Automate%20solution%3C%2FA%3E%3CSPAN%3E%26nbsp%3B%3C%2FSPAN%3Eso%20that%20can%20you%20can%20have%20a%20look%20into%20that%20and%20design%20your%20requirements%20accordingly).%20In%20my%20case%2C%20SharePoint%20List%20look%20something%20like%20below%3C%2FP%3E%0A%3CP%3E%3CSPAN%20class%3D%22lia-inline-image-display-wrapper%20lia-image-align-inline%22%20image-alt%3D%22ArjunMenon_0-1637745741073.jpeg%22%20style%3D%22width%3A%20400px%3B%22%3E%3CIMG%20src%3D%22https%3A%2F%2Ftechcommunity.microsoft.com%2Ft5%2Fimage%2Fserverpage%2Fimage-id%2F329103iE1C98C8A8FE47A73%2Fimage-size%2Fmedium%3Fv%3Dv2%26amp%3Bpx%3D400%22%20role%3D%22button%22%20title%3D%22ArjunMenon_0-1637745741073.jpeg%22%20alt%3D%22ArjunMenon_0-1637745741073.jpeg%22%20%2F%3E%3C%2FSPAN%3E%3C%2FP%3E%0A%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3CH4%20id%3D%22toc-hId-239782195%22%20id%3D%22toc-hId-239782231%22%3E%26nbsp%3B%3C%2FH4%3E%0A%3CH4%20id%3D%22toc-hId\--1567672268%22%20id%3D%22toc-hId\--1567672232%22%3E%26nbsp%3B%3C%2FH4%3E%0A%3CH4%20id%3D%22adding-to-sharepoint-list-if-a-service-is-not-normal%22%20id%3D%22toc-hId-919840565%22%20id%3D%22toc-hId-919840601%22%3EAdding%20to%20SharePoint%20List%20if%20a%20Service%20is%20not%20Normal%3C%2FH4%3E%0A%3CP%3EWe%20will%20be%20using%3CSPAN%3E%26nbsp%3B%3C%2FSPAN%3E%3CA%20href%3D%22https%3A%2F%2Fpnp.github.io%2Fcli-microsoft365%2Fcmd%2Fspo%2Flistitem%2Flistitem-add%2F%22%20target%3D%22_blank%22%20rel%3D%22noopener%20nofollow%20noreferrer%22%3Espo%20listitem%20add%3C%2FA%3E%3CSPAN%3E%26nbsp%3B%3C%2FSPAN%3Ewhich%20will%20add%20the%20item%20to%20SharePoint%20List.%20Since%20we%20are%20already%20authenticated%20to%20your%20tenant%2C%20all%20we%20need%20to%20do%20is%20to%20use%20the%20command%20directly.%20Before%20we%20do%20that%2C%20we%20will%20just%20check%20the%20current%20SharePoint%20list%20whether%20the%20outage%20is%20already%20added.%20We%20plan%20to%20have%20the%20script%20running%20in%20a%20fixed%20interval%2C%20say%20every%3CSPAN%3E%26nbsp%3B%3C%2FSPAN%3E%3CSTRONG%3E15%20minutes%3C%2FSTRONG%3E%3CSPAN%3E%26nbsp%3B%3C%2FSPAN%3Eor%3CSPAN%3E%26nbsp%3B%3C%2FSPAN%3E%3CSTRONG%3E30%20minutes%3C%2FSTRONG%3E.%20In%20that%20case%2C%20there%20is%20a%20chance%20that%20the%20outage%20is%20still%20there%20and%20we%20do%20not%20need%20the%20entry%20to%20be%20duplicated.%20So%20we%20would%20get%20the%20items%20from%20the%20current%20SharePoint%20List%20using%20the%20command%3CSPAN%3E%26nbsp%3B%3C%2FSPAN%3E%3CA%20href%3D%22https%3A%2F%2Fpnp.github.io%2Fcli-microsoft365%2Fcmd%2Fspo%2Flistitem%2Flistitem-get%2F%22%20target%3D%22_blank%22%20rel%3D%22noopener%20nofollow%20noreferrer%22%3Espo%20listitem%20get%3C%2FA%3E%3CSPAN%3E%26nbsp%3B%3C%2FSPAN%3Eand%20will%20check%20whether%20the%20current%20outage%20is%20already%20there%20in%20the%20List.%3C%2FP%3E%0A%3CUL%3E%0A%3CLI%3EIf%20it%20is%20there%2C%3CUL%3E%0A%3CLI%3EThen%20we%20will%20not%20do%20anything.%3C%2FLI%3E%0A%3C%2FUL%3E%0A%3C%2FLI%3E%0A%3CLI%3EIf%20the%20entry%20is%20not%20there%2C%3CUL%3E%0A%3CLI%3Ewe%20will%20use%20the%20command%3CSPAN%3E%26nbsp%3B%3C%2FSPAN%3E%3CCODE%20class%3D%22language-plaintext%20highlighter-rouge%22%3Espo%20listitem%20add%3C%2FCODE%3E%3CSPAN%3E%26nbsp%3B%3C%2FSPAN%3Eand%20add%20the%20status%20information%20to%20SharePoint%20List%3C%2FLI%3E%0A%3C%2FUL%3E%0A%3C%2FLI%3E%0A%3C%2FUL%3E%0A%3CP%3EThe%20complete%20command%20may%20look%20something%20like%20below%2C%3C%2FP%3E%0A%3CDIV%20class%3D%22language-shell%20highlighter-rouge%22%3E%0A%3CDIV%20class%3D%22highlight%22%3E%0A%3CPRE%20class%3D%22highlight%22%3E%3CCODE%3E%3CSPAN%20class%3D%22nv%22%3E%24workLoads%3C%2FSPAN%3E%20%3CSPAN%20class%3D%22o%22%3E%3D%3C%2FSPAN%3E%20m365%20tenant%20status%20list%20%3CSPAN%20class%3D%22nt%22%3E\--query%3C%2FSPAN%3E%20%3CSPAN%20class%3D%22s2%22%3E%22value%5B%3FStatus%20!%3D%20\'ServiceOperational\'%5D%22%3C%2FSPAN%3E%20%20%3CSPAN%20class%3D%22nt%22%3E\--output%3C%2FSPAN%3E%20json%20%20%7C%20ConvertFrom-Json%0A%3CSPAN%20class%3D%22nv%22%3E%24currentOutageServices%3C%2FSPAN%3E%20%3CSPAN%20class%3D%22o%22%3E%3D%3C%2FSPAN%3E%20%3CSPAN%20class%3D%22o%22%3E(%3C%2FSPAN%3Em365%20spo%20listitem%20list%20%3CSPAN%20class%3D%22nt%22%3E\--webUrl%3C%2FSPAN%3E%20%3CSPAN%20class%3D%22nv%22%3E%24webURL%3C%2FSPAN%3E%20%3CSPAN%20class%3D%22nt%22%3E\--title%3C%2FSPAN%3E%20%3CSPAN%20class%3D%22nv%22%3E%24listName%3C%2FSPAN%3E%20%3CSPAN%20class%3D%22nt%22%3E\--fields%3C%2FSPAN%3E%20%3CSPAN%20class%3D%22s2%22%3E%22Title%2C%20Workload%2C%20Id%22%3C%2FSPAN%3E%20%20%3CSPAN%20class%3D%22nt%22%3E\--output%3C%2FSPAN%3E%20json%3CSPAN%20class%3D%22o%22%3E)%3C%2FSPAN%3E.Replace%3CSPAN%20class%3D%22o%22%3E(%3C%2FSPAN%3E%3CSPAN%20class%3D%22s2%22%3E%22ID%22%3C%2FSPAN%3E%2C%20%3CSPAN%20class%3D%22s2%22%3E%22_ID%22%3C%2FSPAN%3E%3CSPAN%20class%3D%22o%22%3E)%3C%2FSPAN%3E%20%7C%20ConvertFrom-Json%0A%0A%3CSPAN%20class%3D%22c%22%3E%23Adding%20items%20if%20any%20of%20the%20workload%20is%20not%20available%3C%2FSPAN%3E%0A%3CSPAN%20class%3D%22nv%22%3E%24workLoads%3C%2FSPAN%3E%20%7C%20%3F%3CSPAN%20class%3D%22o%22%3E%7B%3C%2FSPAN%3E%3CSPAN%20class%3D%22nv%22%3E%24\_%3C%2FSPAN%3E.Workload%20%3CSPAN%20class%3D%22nt%22%3E-notin%3C%2FSPAN%3E%20%3CSPAN%20class%3D%22nv%22%3E%24currentOutageServices%3C%2FSPAN%3E.Workload%3CSPAN%20class%3D%22o%22%3E%7D%3C%2FSPAN%3E%20%7C%20%25%3CSPAN%20class%3D%22o%22%3E%7B%3C%2FSPAN%3E%20%3CSPAN%20class%3D%22nv%22%3E%24addedWorkLoad%3C%2FSPAN%3E%20%3CSPAN%20class%3D%22o%22%3E%3D%3C%2FSPAN%3E%20m365%20spo%20listitem%20add%20%3CSPAN%20class%3D%22nt%22%3E\--webUrl%3C%2FSPAN%3E%20%3CSPAN%20class%3D%22nv%22%3E%24webURL%3C%2FSPAN%3E%20%3CSPAN%20class%3D%22nt%22%3E\--listTitle%3C%2FSPAN%3E%20%3CSPAN%20class%3D%22nv%22%3E%24listName%3C%2FSPAN%3E%20%3CSPAN%20class%3D%22nt%22%3E\--contentType%3C%2FSPAN%3E%20Item%20%3CSPAN%20class%3D%22nt%22%3E\--Title%3C%2FSPAN%3E%20%3CSPAN%20class%3D%22nv%22%3E%24\_%3C%2FSPAN%3E.WorkloadDisplayName%20%3CSPAN%20class%3D%22nt%22%3E\--Workload%3C%2FSPAN%3E%20%3CSPAN%20class%3D%22nv%22%3E%24\_%3C%2FSPAN%3E.Workload%20%3CSPAN%20class%3D%22nt%22%3E\--FirstIdentifiedDate%3C%2FSPAN%3E%20%3CSPAN%20class%3D%22o%22%3E(%3C%2FSPAN%3EGet-Date%20%3CSPAN%20class%3D%22nt%22%3E-Date%3C%2FSPAN%3E%20%3CSPAN%20class%3D%22nv%22%3E%24\_%3C%2FSPAN%3E.StatusTime%20%3CSPAN%20class%3D%22nt%22%3E-Format%3C%2FSPAN%3E%20%3CSPAN%20class%3D%22s2%22%3E%22MM%2Fdd%2Fyyyy%20HH%3Amm%22%3C%2FSPAN%3E%3CSPAN%20class%3D%22o%22%3E)%3C%2FSPAN%3E%20%3CSPAN%20class%3D%22nt%22%3E\--WorkflowJSONData%3C%2FSPAN%3E%20%3CSPAN%20class%3D%22o%22%3E(%3C%2FSPAN%3EOut-String%20%3CSPAN%20class%3D%22nt%22%3E-InputObject%3C%2FSPAN%3E%20%3CSPAN%20class%3D%22nv%22%3E%24\_%3C%2FSPAN%3E%20%3CSPAN%20class%3D%22nt%22%3E-Width%3C%2FSPAN%3E%20100%3CSPAN%20class%3D%22o%22%3E)%3C%2FSPAN%3E%20%3CSPAN%20class%3D%22o%22%3E%7D%3C%2FSPAN%3E%0A%3C%2FCODE%3E%3C%2FPRE%3E%0A%3C%2FDIV%3E%0A%3C%2FDIV%3E%0A%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3CP%3EYou%20can%20see%20that%2C%20we%20are%20even%20pushing%20the%20JSON%20Data%20of%20the%20complete%20status%20information%20so%20that%20you%20as%20an%20IT%20Pro%20will%20have%20detailed%20logs%20without%20going%20to%20the%20Admin%20Center.%20Once%20you%20have%20the%20data%20pushed%2C%20your%20status%20information%20for%20a%20particular%20outage%20may%20look%20something%20like%20below.%3CSPAN%3E%26nbsp%3B%3C%2FSPAN%3E%3C%2FP%3E%0A%3CP%3E%3CSPAN%20class%3D%22lia-inline-image-display-wrapper%20lia-image-align-inline%22%20image-alt%3D%22ArjunMenon_1-1637745741149.jpeg%22%20style%3D%22width%3A%20400px%3B%22%3E%3CIMG%20src%3D%22https%3A%2F%2Ftechcommunity.microsoft.com%2Ft5%2Fimage%2Fserverpage%2Fimage-id%2F329105i80FC21C572CA5DF8%2Fimage-size%2Fmedium%3Fv%3Dv2%26amp%3Bpx%3D400%22%20role%3D%22button%22%20title%3D%22ArjunMenon_1-1637745741149.jpeg%22%20alt%3D%22ArjunMenon_1-1637745741149.jpeg%22%20%2F%3E%3C%2FSPAN%3E%3C%2FP%3E%0A%3CH3%20id%3D%22toc-hId\--1016696617%22%20id%3D%22toc-hId\--1016696581%22%3E%26nbsp%3B%3C%2FH3%3E%0A%3CH3%20id%3D%22send-email-to-any-users-using-cli-for-microsoft-365%22%20id%3D%22toc-hId-1470816216%22%20id%3D%22toc-hId-1470816252%22%3ESend%20email%20to%20any%20users%20using%20CLI%20for%20Microsoft%20365%3C%2FH3%3E%0A%3CH4%20id%3D%22toc-hId\--207555528%22%20id%3D%22toc-hId\--207555492%22%3E%26nbsp%3B%3C%2FH4%3E%0A%3CH4%20id%3D%22send-email-when-the-service-is-not-operational%22%20id%3D%22toc-hId\--2015009991%22%20id%3D%22toc-hId\--2015009955%22%3ESend%20email%20when%20the%20service%20is%20NOT%20Operational%3C%2FH4%3E%0A%3CP%3ECLI%20for%20Microsoft%20365%20gives%20us%20the%20power%20of%20sending%20an%20email%20using%20the%20command%3CSPAN%3E%26nbsp%3B%3C%2FSPAN%3E%3CA%20href%3D%22https%3A%2F%2Fpnp.github.io%2Fcli-microsoft365%2Fcmd%2Foutlook%2Fmail%2Fmail-send%2F%22%20target%3D%22_blank%22%20rel%3D%22noopener%20nofollow%20noreferrer%22%3Eoutlook%20sendmail%3C%2FA%3E.%20With%20this%20command%2C%20it%20uses%20the%20logged%20in%20user%E2%80%99s%20outlook%20to%20send%20an%20email.%3C%2FP%3E%0A%3CP%3E%3CEM%3ESuper%20Tip%20%3A%20You%20can%20also%20use%20a%20flag%3CSPAN%3E%26nbsp%3B%3C%2FSPAN%3E%3CCODE%20class%3D%22language-plaintext%20highlighter-rouge%22%3EsaveToSentItems%3C%2FCODE%3E%3CSPAN%3E%26nbsp%3B%3C%2FSPAN%3Eusing%20which%20you%20can%20disable%20to%20have%20the%20email%20saved%20in%20your%20sent%20folder.%20Awesome%2C%20isn%E2%80%99t%20it%3F%3C%2FEM%3E%3C%2FP%3E%0A%3CP%3ECommand%20may%20look%20something%20like%20below%2C%3C%2FP%3E%0A%3CDIV%20class%3D%22language-shell%20highlighter-rouge%22%3E%0A%3CDIV%20class%3D%22highlight%22%3E%0A%3CPRE%20class%3D%22highlight%22%3E%3CCODE%3E%3CSPAN%20class%3D%22c%22%3E%23Send%20notification%20using%20CLI%20Commands%3C%2FSPAN%3E%0Am365%20outlook%20mail%20send%20%3CSPAN%20class%3D%22nt%22%3E\--to%3C%2FSPAN%3E%20%3CSPAN%20class%3D%22s2%22%3E%22recipient%40yourtenant.onmicrosoft.com%22%3C%2FSPAN%3E%20%3CSPAN%20class%3D%22nt%22%3E\--subject%3C%2FSPAN%3E%20%3CSPAN%20class%3D%22s2%22%3E%22Outage%20Reported%20in%20%3C%2FSPAN%3E%3CSPAN%20class%3D%22si%22%3E%24(%3C%2FSPAN%3E%3CSPAN%20class%3D%22nv%22%3E%24workload%3C%2FSPAN%3E.WorkloadDisplayName%3CSPAN%20class%3D%22si%22%3E)%3C%2FSPAN%3E%3CSPAN%20class%3D%22s2%22%3E%22%3C%2FSPAN%3E%20%3CSPAN%20class%3D%22nt%22%3E\--bodyContents%3C%2FSPAN%3E%20%3CSPAN%20class%3D%22s2%22%3E%22Any%20outage%20has%20been%20reported%20for%20the%20Service%20%3A%20%3C%2FSPAN%3E%3CSPAN%20class%3D%22si%22%3E%24(%3C%2FSPAN%3E%3CSPAN%20class%3D%22nv%22%3E%24workload%3C%2FSPAN%3E.WorkloadDisplayName%3CSPAN%20class%3D%22si%22%3E)%3C%2FSPAN%3E%3CSPAN%20class%3D%22s2%22%3E%20%3CA%20href%3D%22https%3A%2F%2Fyourtenant.sharepoint.com%2Fsites%2FM365CLI%2FLists%2FO365%2520Health%2520Status%22%20target%3D%22_blank%22%20rel%3D%22nofollow%20noopener%20noreferrer%22%3EAccess%20the%20Health%20Status%20List%3C%2FA%3E%22%3C%2FSPAN%3E%20%3CSPAN%20class%3D%22nt%22%3E\--bodyContentType%3C%2FSPAN%3E%20HTML%0A%3C%2FCODE%3E%3C%2FPRE%3E%0A%3C%2FDIV%3E%0A%3C%2FDIV%3E%0A%3CH4%20id%3D%22toc-hId-1170664783%22%20id%3D%22toc-hId-1170664819%22%3E%26nbsp%3B%3C%2FH4%3E%0A%3CH4%20id%3D%22send-email-when-the-service-is-back-to-operational%22%20id%3D%22toc-hId\--636789680%22%20id%3D%22toc-hId\--636789644%22%3ESend%20email%20when%20the%20service%20is%20back%20to%20Operational%3C%2FH4%3E%0A%3CP%3EGetting%20notification%20when%20the%20service%20is%20back%20to%20normal%20is%20equally%20important%20compared%20to%20the%3CSPAN%3E%26nbsp%3B%3C%2FSPAN%3E%3CA%20href%3D%22https%3A%2F%2Farjunumenon.com%2Ftenant-status-solution-m365cli%2F%23send-email-when-the-service-is-not-operational%22%20target%3D%22_blank%22%20rel%3D%22noopener%20nofollow%20noreferrer%22%3Enotification%20when%20a%20Service%20is%20not%20Operational%3C%2FA%3E.%20This%20would%20enable%20you%20as%20an%20IT%20Pro%20to%20notify%20the%20concerned%20team%20and%20your%20organization%20on%20that.%3C%2FP%3E%0A%3CP%3EIn%20the%20above%20steps%2C%20we%20had%20saved%20the%20data%20to%20a%3CSPAN%3E%26nbsp%3B%3C%2FSPAN%3E%3CA%20href%3D%22https%3A%2F%2Farjunumenon.com%2Ftenant-status-solution-m365cli%2F%23sharepoint-list%22%20target%3D%22_blank%22%20rel%3D%22noopener%20nofollow%20noreferrer%22%3ESharePoint%20list%3C%2FA%3E%3CSPAN%3E%26nbsp%3B%3C%2FSPAN%3Ewhen%20service%20are%20not%20operational.%20When%20our%20script%20checks%20the%20status%20and%20identifies%20that%20the%20service%20which%20was%20there%20in%20SharePoint%20List%20is%20no%20more%20there%20in%20the%20non-operational%20list%20of%20Tenant%20Workloads%2C%20we%20can%20assume%20that%20the%20tenant%20Service%20was%3CSPAN%3E%26nbsp%3B%3C%2FSPAN%3E%3CSTRONG%3ENOT%20Operational%3C%2FSTRONG%3E%3CSPAN%3E%26nbsp%3B%3C%2FSPAN%3Eis%20back%20to%3CSPAN%3E%26nbsp%3B%3C%2FSPAN%3E%3CSTRONG%3EOperational%3C%2FSTRONG%3E%3C%2FP%3E%0A%3CP%3ECode%20which%20handles%20that%20is%20given%20below%2C%3C%2FP%3E%0A%3CDIV%20class%3D%22language-powershell%20highlighter-rouge%22%3E%0A%3CDIV%20class%3D%22highlight%22%3E%0A%3CPRE%20class%3D%22highlight%22%3E%3CCODE%3E%3CSPAN%20class%3D%22kr%22%3EForeach%3C%2FSPAN%3E%20%3CSPAN%20class%3D%22p%22%3E(%3C%2FSPAN%3E%3CSPAN%20class%3D%22nv%22%3E%24currentOutageService%3C%2FSPAN%3E%20%3CSPAN%20class%3D%22kr%22%3Ein%3C%2FSPAN%3E%20%3CSPAN%20class%3D%22nv%22%3E%24currentOutageServices%3C%2FSPAN%3E%3CSPAN%20class%3D%22p%22%3E)%7B%3C%2FSPAN%3E%0A%20%20%20%20%3CSPAN%20class%3D%22kr%22%3Eif%3C%2FSPAN%3E%3CSPAN%20class%3D%22p%22%3E(%3C%2FSPAN%3E%3CSPAN%20class%3D%22nv%22%3E%24currentOutageService%3C%2FSPAN%3E%3CSPAN%20class%3D%22o%22%3E.%3C%2FSPAN%3E%3CSPAN%20class%3D%22nf%22%3EWorkload%3C%2FSPAN%3E%20%3CSPAN%20class%3D%22nt%22%3E-notin%3C%2FSPAN%3E%20%3CSPAN%20class%3D%22nv%22%3E%24workLoads%3C%2FSPAN%3E%3CSPAN%20class%3D%22o%22%3E.%3C%2FSPAN%3E%3CSPAN%20class%3D%22nf%22%3EWorkload%3C%2FSPAN%3E%3CSPAN%20class%3D%22p%22%3E)%7B%3C%2FSPAN%3E%0A%20%20%20%20%20%20%20%20%3CSPAN%20class%3D%22nv%22%3E%24RemovedRecord%3C%2FSPAN%3E%20%3CSPAN%20class%3D%22o%22%3E%3D%3C%2FSPAN%3E%20%3CSPAN%20class%3D%22n%22%3Em365%3C%2FSPAN%3E%20%3CSPAN%20class%3D%22nx%22%3Espo%3C%2FSPAN%3E%20%3CSPAN%20class%3D%22nx%22%3Elistitem%3C%2FSPAN%3E%20%3CSPAN%20class%3D%22nx%22%3Eremove%3C%2FSPAN%3E%20%3CSPAN%20class%3D%22nt%22%3E\--webUrl%3C%2FSPAN%3E%20%3CSPAN%20class%3D%22nv%22%3E%24webURL%3C%2FSPAN%3E%20%3CSPAN%20class%3D%22nt%22%3E\--listTitle%3C%2FSPAN%3E%20%3CSPAN%20class%3D%22nv%22%3E%24listName%3C%2FSPAN%3E%20%3CSPAN%20class%3D%22nt%22%3E\--id%3C%2FSPAN%3E%20%20%3CSPAN%20class%3D%22nv%22%3E%24currentOutageService%3C%2FSPAN%3E%3CSPAN%20class%3D%22o%22%3E.%3C%2FSPAN%3E%3CSPAN%20class%3D%22nf%22%3EId%3C%2FSPAN%3E%0A%0A%20%20%20%20%20%20%20%20%3CSPAN%20class%3D%22c%22%3E%23Send%20notification%20using%20CLI%20Commands%3C%2FSPAN%3E%0A%20%20%20%20%20%20%20%20%3CSPAN%20class%3D%22n%22%3Em365%3C%2FSPAN%3E%20%3CSPAN%20class%3D%22nx%22%3Eoutlook%3C%2FSPAN%3E%20%3CSPAN%20class%3D%22nx%22%3Email%3C%2FSPAN%3E%20%3CSPAN%20class%3D%22nx%22%3Esend%3C%2FSPAN%3E%20%3CSPAN%20class%3D%22nt%22%3E\--to%3C%2FSPAN%3E%20%3CSPAN%20class%3D%22s2%22%3E%22arjun%40yourtenant.onmicrosoft.com%22%3C%2FSPAN%3E%20%3CSPAN%20class%3D%22nt%22%3E\--subject%3C%2FSPAN%3E%20%3CSPAN%20class%3D%22s2%22%3E%22Outage%20RESOLVED%20for%20%3C%2FSPAN%3E%3CSPAN%20class%3D%22si%22%3E%24(%3C%2FSPAN%3E%3CSPAN%20class%3D%22nv%22%3E%24currentOutageService%3C%2FSPAN%3E%3CSPAN%20class%3D%22o%22%3E.%3C%2FSPAN%3E%3CSPAN%20class%3D%22nf%22%3EWorkloadDisplayName%3C%2FSPAN%3E%3CSPAN%20class%3D%22si%22%3E)%3C%2FSPAN%3E%3CSPAN%20class%3D%22s2%22%3E%22%3C%2FSPAN%3E%20%3CSPAN%20class%3D%22nt%22%3E\--bodyContents%3C%2FSPAN%3E%20%3CSPAN%20class%3D%22s2%22%3E%22Outage%20which%20was%20reported%20for%20the%20Service%20%3A%20%3C%2FSPAN%3E%3CSPAN%20class%3D%22si%22%3E%24(%3C%2FSPAN%3E%3CSPAN%20class%3D%22nv%22%3E%24workload%3C%2FSPAN%3E%3CSPAN%20class%3D%22o%22%3E.%3C%2FSPAN%3E%3CSPAN%20class%3D%22nf%22%3EWorkloadDisplayName%3C%2FSPAN%3E%3CSPAN%20class%3D%22si%22%3E)%3C%2FSPAN%3E%3CSPAN%20class%3D%22s2%22%3E%20is%20RESOLVED.%22%3C%2FSPAN%3E%20%3CSPAN%20class%3D%22nt%22%3E\--bodyContentType%3C%2FSPAN%3E%20%3CSPAN%20class%3D%22nx%22%3EHTML%3C%2FSPAN%3E%0A%20%20%20%20%3CSPAN%20class%3D%22p%22%3E%7D%3C%2FSPAN%3E%0A%3CSPAN%20class%3D%22p%22%3E%7D%3C%2FSPAN%3E%0A%3C%2FCODE%3E%3C%2FPRE%3E%0A%3C%2FDIV%3E%0A%3C%2FDIV%3E%0A%3CP%3EWhat%20we%20do%20in%20the%20above%20code%20is%2C%3C%2FP%3E%0A%3CUL%3E%0A%3CLI%3EIf%20the%20item%20in%20SharePoint%20list%20is%20not%20there%20in%20list%20of%20Service%20which%20is%20NOT%20Operational%3C%2FLI%3E%0A%3CLI%3ERemove%20the%20Item%20from%20the%20SharePoint%20list%20using%20the%20command%3CSPAN%3E%26nbsp%3B%3C%2FSPAN%3E%3CA%20href%3D%22https%3A%2F%2Fpnp.github.io%2Fcli-microsoft365%2Fcmd%2Fspo%2Flistitem%2Flistitem-remove%2F%22%20target%3D%22_blank%22%20rel%3D%22noopener%20nofollow%20noreferrer%22%3E%3CCODE%20class%3D%22language-plaintext%20highlighter-rouge%22%3Espo%20listitem%20remove%3C%2FCODE%3E%3C%2FA%3E%3CUL%3E%0A%3CLI%3EIF%20you%20want%20you%20can%20also%20copy%20item%20to%20another%20list%20for%20any%20historical%20purpose%20if%20needed%3C%2FLI%3E%0A%3C%2FUL%3E%0A%3C%2FLI%3E%0A%3CLI%3ESend%20email%20to%20recipients%20informing%20that%20the%20Service%20is%20back%20to%20Normal%3C%2FLI%3E%0A%3C%2FUL%3E%0A%3CH2%20id%3D%22toc-hId-1592557715%22%20id%3D%22toc-hId-1592557751%22%3E%26nbsp%3B%3C%2FH2%3E%0A%3CH2%20id%3D%22bonus-solution\-\--configure-power-automate-for-doing-any-business-process%22%20id%3D%22toc-hId\--214896748%22%20id%3D%22toc-hId\--214896712%22%3EBonus%20Solution%20-%20Configure%20Power%20Automate%20for%20doing%20any%20Business%20Process%3C%2FH2%3E%0A%3CP%3EAs%20we%20may%20know%3CSPAN%3E%26nbsp%3B%3C%2FSPAN%3E%3CA%20href%3D%22https%3A%2F%2Fflow.microsoft.com%2Fen-us%2F%22%20target%3D%22_blank%22%20rel%3D%22noopener%20noreferrer%22%3EPower%20Automate%3C%2FA%3E%3CSPAN%3E%26nbsp%3B%3C%2FSPAN%3Eprovides%20rich%20features%20which%20we%20can%20leverage%20if%20you%20want%20to%20do%20any%20action%20based%20on%20the%20available%20triggers.%20Say%20e.g.%2C%20when%20your%20SharePoint%20service%20is%20not%20Operational%2C%20need%20to%20initiate%20a%20Service%20Request%20in%20your%20Help%20Desk%20support%20system%20automatically%2C%20we%20can%20always%20define%20the%20logic%20in%20Power%20Automate%20and%20once%20an%20outage%20is%20identified%2C%20Power%20Automate%20will%20initiate%20a%20Service%20Request%20in%20your%20help-desk%20system%20along%20with%20notifying%20concerned%20team.%20In%20our%20case%2C%20we%20are%20using%20SharePoint%20list%20item%20Creation%20%2F%20Modification%20as%20the%20trigger%20for%20initiating%20Process.%20Since%20we%20are%20adding%20list%20item%20using%20CLI%20for%20Microsoft%20365%2C%20we%20can%20easily%20take%20that%20as%20the%20triggering%20point%3C%2FP%3E%0A%3CP%3EIn%20my%20case%2C%20what%20I%20have%20done%20is%20that%2C%3C%2FP%3E%0A%3COL%3E%0A%3CLI%3E%3CP%3ECreate%201%20Flow%20which%20will%20get%20triggered%20when%20an%20item%20is%20created%20and%20another%20flow%20which%20will%20get%20triggered%20if%20an%20item%20is%20modified%3C%2FP%3E%0A%3C%2FLI%3E%0A%3CLI%3EIf%20the%3CSPAN%3E%26nbsp%3B%3C%2FSPAN%3E%3CCODE%20class%3D%22language-plaintext%20highlighter-rouge%22%3EStill%20in%20Outage%3C%2FCODE%3E%3CSPAN%3E%26nbsp%3B%3C%2FSPAN%3Eflag%20in%3CSPAN%3E%26nbsp%3B%3C%2FSPAN%3E%3CA%20href%3D%22https%3A%2F%2Farjunumenon.com%2Ftenant-status-solution-m365cli%2F%23sharepoint-list%22%20target%3D%22_blank%22%20rel%3D%22noopener%20nofollow%20noreferrer%22%3ESharePoint%20List%3C%2FA%3E%3CSPAN%3E%26nbsp%3B%3C%2FSPAN%3Eis%3CSPAN%3E%26nbsp%3B%3C%2FSPAN%3E%3CSTRONG%3EYES%3C%2FSTRONG%3E%3CSPAN%3E%26nbsp%3B%3C%2FSPAN%3E(Creation%20Triggered%20Flow)%3COL%3E%0A%3CLI%3ESend%20notification%20via%20email%20informing%20about%20Outage%3C%2FLI%3E%0A%3CLI%3ESend%20a%20Push%20Notification%20to%20the%20configured%20user%3C%2FLI%3E%0A%3C%2FOL%3E%0A%3C%2FLI%3E%0A%3CLI%3EIf%20the%3CSPAN%3E%26nbsp%3B%3C%2FSPAN%3E%3CCODE%20class%3D%22language-plaintext%20highlighter-rouge%22%3EStill%20in%20Outage%3C%2FCODE%3E%3CSPAN%3E%26nbsp%3B%3C%2FSPAN%3Eflag%20in%3CSPAN%3E%26nbsp%3B%3C%2FSPAN%3E%3CA%20href%3D%22https%3A%2F%2Farjunumenon.com%2Ftenant-status-solution-m365cli%2F%23sharepoint-list%22%20target%3D%22_blank%22%20rel%3D%22noopener%20nofollow%20noreferrer%22%3ESharePoint%20List%3C%2FA%3E%3CSPAN%3E%26nbsp%3B%3C%2FSPAN%3Eis%3CSPAN%3E%26nbsp%3B%3C%2FSPAN%3E%3CSTRONG%3ENo%3C%2FSTRONG%3E%3CSPAN%3E%26nbsp%3B%3C%2FSPAN%3E(Modified%20Trigger%20Flow)%3COL%3E%0A%3CLI%3ESend%20notification%20via%20email%20about%20Service%20becoming%20Operational%3C%2FLI%3E%0A%3C%2FOL%3E%0A%3C%2FLI%3E%0A%3C%2FOL%3E%0A%3CP%3EAs%20I%20said%2C%20mine%20is%20a%20super%20simple%20implementation%20just%20to%20demonstrate%20the%20Power%20of%20Power%20Automate%20which%20goes%20hand%20in%20hand%20with%20scripting%20tools.%20If%20you%20have%20some%20business%20logic%20which%20needs%20to%20be%20in%20place%20with%20this%2C%20it%20always%20gives%20you%20the%20flexibility%20for%20the%20same.%20Just%20giving%20a%20glimpse%20of%20my%20simple%20Power%20Automate%20screen%20below%2C%3C%2FP%3E%0A%3CH3%20id%3D%22toc-hId\--1893268492%22%20id%3D%22toc-hId\--1893268456%22%3E%26nbsp%3B%3C%2FH3%3E%0A%3CH3%20id%3D%22power-automate\-\--creation-trigger%22%20id%3D%22toc-hId-594244341%22%20id%3D%22toc-hId-594244377%22%3EPower%20Automate%20-%20Creation%20Trigger%3C%2FH3%3E%0A%3CP%3EBelow%20Power%20Automate%20will%20do%20the%20process%20when%20a%20new%20outage%20is%20reported%20by%20the%20script%3CSPAN%3E%26nbsp%3B%3C%2FSPAN%3E%3C%2FP%3E%0A%3CP%3E%3CSPAN%20class%3D%22lia-inline-image-display-wrapper%20lia-image-align-inline%22%20image-alt%3D%22ArjunMenon_2-1637745741136.jpeg%22%20style%3D%22width%3A%20400px%3B%22%3E%3CIMG%20src%3D%22https%3A%2F%2Ftechcommunity.microsoft.com%2Ft5%2Fimage%2Fserverpage%2Fimage-id%2F329104i7B050DBE4262D573%2Fimage-size%2Fmedium%3Fv%3Dv2%26amp%3Bpx%3D400%22%20role%3D%22button%22%20title%3D%22ArjunMenon_2-1637745741136.jpeg%22%20alt%3D%22ArjunMenon_2-1637745741136.jpeg%22%20%2F%3E%3C%2FSPAN%3E%3C%2FP%3E%0A%3CH3%20id%3D%22toc-hId\--1213210122%22%20id%3D%22toc-hId\--1213210086%22%3E%26nbsp%3B%3C%2FH3%3E%0A%3CH3%20id%3D%22power-automate\-\--on-modified%22%20id%3D%22toc-hId-1274302711%22%20id%3D%22toc-hId-1274302747%22%3EPower%20Automate%20-%20On%20Modified%3C%2FH3%3E%0A%3CP%3EBelow%20is%20the%20Power%20Automate%20which%20is%20created%20when%20existing%20outage%20is%20modified%2C%20which%20means%20one%20of%20the%20current%20Service%20which%20was%3CSPAN%3E%26nbsp%3B%3C%2FSPAN%3E%3CSTRONG%3ENOT%20OPERATIONAL%3C%2FSTRONG%3E%3CSPAN%3E%26nbsp%3B%3C%2FSPAN%3Eis%20changed%20to%3CSPAN%3E%26nbsp%3B%3C%2FSPAN%3E%3CSTRONG%3EOPERATIONAL%3C%2FSTRONG%3E%3C%2FP%3E%0A%3CP%3E%3CSPAN%20class%3D%22lia-inline-image-display-wrapper%20lia-image-align-inline%22%20image-alt%3D%22ArjunMenon_3-1637745741115.jpeg%22%20style%3D%22width%3A%20400px%3B%22%3E%3CIMG%20src%3D%22https%3A%2F%2Ftechcommunity.microsoft.com%2Ft5%2Fimage%2Fserverpage%2Fimage-id%2F329106i08AAB9ED71AC9A56%2Fimage-size%2Fmedium%3Fv%3Dv2%26amp%3Bpx%3D400%22%20role%3D%22button%22%20title%3D%22ArjunMenon_3-1637745741115.jpeg%22%20alt%3D%22ArjunMenon_3-1637745741115.jpeg%22%20%2F%3E%3C%2FSPAN%3E%3C%2FP%3E%0A%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3CP%3E%3CSPAN%3E%26nbsp%3B%3C%2FSPAN%3E%3C%2FP%3E%0A%3CP%3E%3CSPAN%20class%3D%22lia-inline-image-display-wrapper%20lia-image-align-inline%22%20image-alt%3D%22ArjunMenon_4-1637745741165.jpeg%22%20style%3D%22width%3A%20400px%3B%22%3E%3CIMG%20src%3D%22https%3A%2F%2Ftechcommunity.microsoft.com%2Ft5%2Fimage%2Fserverpage%2Fimage-id%2F329107i91CA57B14B093B7D%2Fimage-size%2Fmedium%3Fv%3Dv2%26amp%3Bpx%3D400%22%20role%3D%22button%22%20title%3D%22ArjunMenon_4-1637745741165.jpeg%22%20alt%3D%22ArjunMenon_4-1637745741165.jpeg%22%20%2F%3E%3C%2FSPAN%3E%3C%2FP%3E%0A%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3CH2%20id%3D%22powershell-scripts%22%20id%3D%22toc-hId\--662234471%22%20id%3D%22toc-hId\--662234435%22%3EPowerShell%20Scripts%3C%2FH2%3E%0A%3CP%3EAs%20mentioned%20above%2C%20in%20my%20case%2C%20I%20have%20used%20PowerShell%20for%20scripting%20the%20requirement.%20You%20can%20access%20the%20scripts%20which%20I%20have%20used%20from%20below.%3C%2FP%3E%0A%3CH3%20id%3D%22toc-hId-1954361081%22%20id%3D%22toc-hId-1954361117%22%3E%26nbsp%3B%3C%2FH3%3E%0A%3CH3%20id%3D%22complete-script\-\--easily-understandable%22%20id%3D%22toc-hId-845068559%22%20id%3D%22toc-hId-845068595%22%3EComplete%20Script%20-%20Easily%20understandable%3C%2FH3%3E%0A%3CP%3EBelow%20script%20is%20the%20similar%20implementation%20of%20the%3CSPAN%3E%26nbsp%3B%3C%2FSPAN%3E%3CA%20href%3D%22https%3A%2F%2Farjunumenon.com%2Ftenant-status-solution-m365cli%2F%23simple-script\-\--production-ready-lines-of-code\--4%22%20target%3D%22_blank%22%20rel%3D%22noopener%20nofollow%20noreferrer%22%3EProduction%20Read%20Script%3C%2FA%3E.%20Rather%20than%20using%20PowerShell%20piping%2C%20we%20are%20using%20conventional%20For-Each%20so%20that%20script%20is%20easily%20readable.%3C%2FP%3E%0A%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3CPRE%20class%3D%22lia-code-sample%20language-bash%22%3E%3CCODE%3E%0A%23Check%20the%20Login%20Status%0A%24LoginStatus%20%3D%20m365%20status%0A%0Aif(%24LoginStatus%20-Match%20%22Logged%20out%22)%7B%0A%20%20%20%20%23Exiting%20the%20execution%0A%20%20%20%20exit%3B%20%20%20%20%0A%7D%0A%0A%24webURL%20%3D%20%22https%3A%2F%2Fcontoso.sharepoint.com%2Fsites%2FHealthStatusSite%22%0A%24listName%20%3D%20%22O365%20Health%20Status%22%0A%24workLoads%20%3D%20m365%20tenant%20status%20list%20\--query%20%22value%5B%3FStatus%20!%3D%20\'ServiceOperational\'%5D%22%20%20\--output%20json%20%20%7C%20ConvertFrom-Json%0A%24currentOutageServices%20%3D%20(m365%20spo%20listitem%20list%20\--webUrl%20%24webURL%20\--title%20%24listName%20\--fields%20%22Title%2C%20Workload%2C%20Id%22%20%20\--output%20json).Replace(%22ID%22%2C%20%22_ID%22)%20%7C%20ConvertFrom-Json%0A%0AForeach%20(%24workload%20in%20%24workLoads)%7B%0A%20%20%20%20if(%24workload.Workload%20-notin%20%24currentOutageServices.Workload)%7B%0A%20%20%20%20%20%20%20%20%24addedWorkLoad%20%3D%20m365%20spo%20listitem%20add%20\--webUrl%20%24webURL%20\--listTitle%20%24listName%20\--contentType%20Item%20\--Title%20%24workload.WorkloadDisplayName%20\--Workload%20%24workload.Workload%20\--FirstIdentifiedDate%20(Get-Date%20-Date%20%24workload.StatusTime%20-Format%20%22MM%2Fdd%2Fyyyy%20HH%3Amm%22)%20\--WorkflowJSONData%20(Out-String%20-InputObject%20%24workload%20-Width%20100)%0A%0A%20%20%20%20%20%20%20%20%23Send%20notification%20using%20CLI%20Commands%0A%20%20%20%20%20%20%20%20m365%20outlook%20mail%20send%20\--to%20%22arjun%40contoso.onmicrosoft.com%22%20\--subject%20%22Outage%20Reported%20in%20%24(%24workload.WorkloadDisplayName)%22%20\--bodyContents%20%22Any%20outage%20has%20been%20reported%20for%20the%20Service%20%3A%20%24(%24workload.WorkloadDisplayName)%20%3CA%20href%3D%22https%3A%2F%2Fcontoso.sharepoint.com%2Fsites%2FHealthStatusSite%2FLists%2FO365%2520Health%2520Status%22%20target%3D%22_blank%22%20rel%3D%22nofollow%20noopener%20noreferrer%22%3EAccess%20the%20Health%20Status%20List%3C%2FA%3E%22%20\--bodyContentType%20HTML%0A%20%20%20%20%7D%0A%7D%0A%0A%23Updating%20the%20status%20to%20IsInOutage%20to%20NO%20the%20list%20item%20if%20the%20service%20is%20back%20to%20normal%0AForeach%20(%24currentOutageService%20in%20%24currentOutageServices)%7B%0A%20%20%20%20if(%24currentOutageService.Workload%20-notin%20%24workLoads.Workload)%7B%0A%20%20%20%20%20%20%20%20%24RemovedRecord%20%3D%20m365%20spo%20listitem%20remove%20\--webUrl%20%24webURL%20\--listTitle%20%24listName%20\--id%20%20%24currentOutageService.Id%0A%0A%20%20%20%20%20%20%20%20%23Send%20notification%20using%20CLI%20Commands%0A%20%20%20%20%20%20%20%20m365%20outlook%20mail%20send%20\--to%20%22arjun%40contoso.onmicrosoft.com%22%20\--subject%20%22Outage%20RESOLVED%20for%20%24(%24currentOutageService.WorkloadDisplayName)%22%20\--bodyContents%20%22Outage%20which%20was%20reported%20for%20the%20Service%20%3A%20%24(%24workload.WorkloadDisplayName)%20is%20RESOLVED.%22%20\--bodyContentType%20HTML%0A%20%20%20%20%7D%0A%7D%3C%2FCODE%3E%3C%2FPRE%3E%0A%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3CH3%20id%3D%22toc-hId\--962385904%22%20id%3D%22toc-hId\--962385868%22%3E%26nbsp%3B%3C%2FH3%3E%0A%3CH3%20id%3D%22simple-script\-\--production-ready-lines-of-code\--4%22%20id%3D%22toc-hId-1525126929%22%20id%3D%22toc-hId-1525126965%22%3ESimple%20Script%20-%20Production%20Ready%20(Lines%20of%20Code%20%3A%204)%3C%2FH3%3E%0A%3CP%3EIn%20the%20below%20script%2C%20I%20have%20used%20PowerShell%20piping%20and%20hence%20the%20script%20may%20look%20complicated.%20But%20it%20hardly%20has%203%20lines%20of%20code%20which%20does%20the%20complete%20operation%20and%20these%20kind%20of%20scripts%20will%20be%20ideal%20for%20your%20production%20like%20environment.%20If%20you%20need%20to%20understand%20the%20script%2C%20you%20can%20view%3CSPAN%3E%26nbsp%3B%3C%2FSPAN%3E%3CA%20href%3D%22https%3A%2F%2Farjunumenon.com%2Ftenant-status-solution-m365cli%2F%23complete-script\-\--easily-understandable%22%20target%3D%22_blank%22%20rel%3D%22noopener%20nofollow%20noreferrer%22%3Eeasily%20understandable%20script%3C%2FA%3E.%3C%2FP%3E%0A%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3CPRE%20class%3D%22lia-code-sample%20language-bash%22%3E%3CCODE%3E%24webURL%20%3D%20%22https%3A%2F%2Fcontoso.sharepoint.com%2Fsites%2FM365HealthStatus%22%0A%24listName%20%3D%20%22O365%20Health%20Status%22%0A%24workLoads%20%3D%20m365%20tenant%20status%20list%20\--query%20%22value%5B%3FStatus%20!%3D%20\'ServiceOperational\'%5D%22%20%20\--output%20json%20%20%7C%20ConvertFrom-Json%0A%24currentOutageServices%20%3D%20(m365%20spo%20listitem%20list%20\--webUrl%20%24webURL%20\--title%20%24listName%20\--fields%20%22Title%2C%20Workload%2C%20Id%22%20%20\--output%20json).Replace(%22ID%22%2C%20%22_ID%22)%20%7C%20ConvertFrom-Json%0A%24workLoads%20%7C%20%3F%7B%24\_.Workload%20-notin%20%24currentOutageServices.Workload%7D%20%7C%20%25%7B%20%24addedWorkLoad%20%3D%20m365%20spo%20listitem%20add%20\--webUrl%20%24webURL%20\--listTitle%20%24listName%20\--contentType%20Item%20\--Title%20%24\_.WorkloadDisplayName%20\--Workload%20%24\_.Workload%20\--FirstIdentifiedDate%20(Get-Date%20-Date%20%24\_.StatusTime%20-Format%20%22MM%2Fdd%2Fyyyy%20HH%3Amm%22)%20\--WorkflowJSONData%20(Out-String%20-InputObject%20%24\_%20-Width%20100)%7D%0A%24currentOutageServices%20%7C%20%3F%7B%24\_.Workload%20-notin%20%24workLoads.Workload%7D%20%7C%20%25%7B%20%24UpdatedWorkflod%20%3D%20m365%20spo%20listitem%20set%20\--webUrl%20%24webURL%20\--listTitle%20%24listName%20\--contentType%20Item%20\--id%20%20%24\_.Id%20\--StillinOutage%20%22false%22%20%7D%3C%2FCODE%3E%3C%2FPRE%3E%0A%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3CH2%20id%3D%22schedule-the-script%22%20id%3D%22toc-hId\--411410253%22%20id%3D%22toc-hId\--411410217%22%3ESchedule%20the%20script%3C%2FH2%3E%0A%3CP%3EThe%20last%20part%20of%20the%20solution%20is%20to%20schedule%20the%20script%20which%20we%20have%20created.%20In%20my%20case%2C%20I%20have%20scheduled%20the%20script%20to%20run%20every%20half%20an%20hour.%20Schedule%20could%20be%20decided%20depending%20on%20your%20business%20case.%3C%2FP%3E%0A%3CP%3EIn%20my%20case%2C%20since%20I%20am%20using%20a%20Windows%20machine%20and%20hence%20I%20would%20be%20using%20PowerShell%20as%20my%20scripting%20tool.%20Since%20CLI%20for%20Microsoft%20365%20is%20OS%20agnostic%2C%20you%20are%20free%20to%20use%20script%20based%20on%20your%20Operating%20System%2C%20be%20it%20on%20Windows%20or%20Mac%20OS%20or%20Linux.%3C%2FP%3E%0A%3CP%3EIn%20this%20blog%2C%20we%20will%20not%20be%20covering%20about%20scheduling%20the%20scripts%20in%20PowerShell%20since%20it%20is%20a%20straight%20forward%20activity.%20You%20can%20view%3CSPAN%3E%26nbsp%3B%3C%2FSPAN%3E%3CA%20href%3D%22https%3A%2F%2Fo365reports.com%2F2019%2F08%2F02%2Fschedule-powershell-script-task-scheduler%2F%22%20target%3D%22_blank%22%20rel%3D%22noopener%20nofollow%20noreferrer%22%3Ethis%20blog%3C%2FA%3E%3CSPAN%3E%26nbsp%3B%3C%2FSPAN%3Ewhere%20it%20has%20explained%20how%20to%20configure%20PowerShell%3C%2FP%3E%0A%3CH2%20id%3D%22toc-hId-2076102580%22%20id%3D%22toc-hId-2076102616%22%3E%26nbsp%3B%3C%2FH2%3E%0A%3CH2%20id%3D%22complete-scripts%22%20id%3D%22toc-hId-268648117%22%20id%3D%22toc-hId-268648153%22%3EComplete%20Scripts%3C%2FH2%3E%0A%3CP%3EToo%20lazy%20to%20build%20scripts.%20Don%E2%80%99t%20worry.%20We%20got%20your%20back.%20Now%20the%20complete%20script%20package%20is%20available%20in%20the%20CLI%20for%20Microsoft%20365%3CSPAN%3E%26nbsp%3B%3C%2FSPAN%3E%3CA%20href%3D%22https%3A%2F%2Fpnp.github.io%2Fcli-microsoft365%2Fsample-scripts%2Ftenant%2Ftenant-monitor-notify-healthstatus%2F%22%20target%3D%22_blank%22%20rel%3D%22noopener%20nofollow%20noreferrer%22%3Esample%20scripts%20section%3C%2FA%3E.%3C%2FP%3E%0A%3CP%3E%26nbsp%3B%3C%2FP%3E%0A%3CP%3EPhoto%20by%3CSPAN%3E%26nbsp%3B%3C%2FSPAN%3E%3CA%20href%3D%22https%3A%2F%2Funsplash.com%2F%40austindistel%3Futm_source%3Dunsplash%26amp%3Butm_medium%3Dreferral%26amp%3Butm_content%3DcreditCopyText%22%20target%3D%22_blank%22%20rel%3D%22noopener%20nofollow%20noreferrer%22%3EAustin%20Distel%3C%2FA%3E%3CSPAN%3E%26nbsp%3B%3C%2FSPAN%3Eon%20Unsplash%3C%2FP%3E%3C%2FLINGO-BODY%3E%3CLINGO-TEASER%20id%3D%22lingo-teaser-3000703%22%20slang%3D%22en-US%22%3E%3CP%3EAre%20you%20an%20IT%20Pro%20who%20wants%20to%20have%20a%20solution%20that%20checks%20the%20status%20of%20your%20Microsoft%20365%20Tenant.%3C%2FP%3E%0A%3CP%3EHow%20about%20if%20you%20get%20notified%20when%20something%20goes%20wrong%20with%20your%20tenant%20and%20you%20get%20that%20information%20before%20your%20users%20complain.%20This%20blog%20post%20talk%20about%20that%3C%2FP%3E%3C%2FLINGO-TEASER%3E%3CLINGO-LABS%20id%3D%22lingo-labs-3000703%22%20slang%3D%22en-US%22%3E%3CLINGO-LABEL%3EHow%20to%3C%2FLINGO-LABEL%3E%3C%2FLINGO-LABS%3E

::: {#threadTranslationDashboard .Thread_Translation_Dashboard ng-controller="lingotekThreadTranslationCtrl" li-bindable=""}
::: lingotek-admin-dashboard
:::
:::

::: {style="clear:both"}
:::

::: {#contributorsTaplet .ContributorsTaplet .lia-component-tkb-widget-contributors-taplet}
::: {.lia-panel .lia-panel-standard}
::: lia-decoration-border
::: lia-decoration-border-top
<div>

</div>
:::

::: lia-decoration-border-content
<div>

::: lia-panel-heading-bar-wrapper
::: lia-panel-heading-bar
[ Co-Authors ]{.lia-panel-heading-bar-title aria-level="3"
role="heading"}
:::
:::

::: lia-panel-content-wrapper
::: lia-panel-content
::: {.UserProfileSummary .lia-user-item .lia-js-data-userId-1082346 .lia-user-info-group}
::: UserAvatarWrapper
::: {.UserAvatar .lia-user-avatar .lia-component-common-widget-user-avatar .New .Contributor}
{{< image alt="ArjunMenon" src="images/blog/monitor-and-notify-m365-health-using-cli-for-microsoft-365/ArjunMenon.png" >}}{.lia-user-avatar-message
.user-rank-ring style=""
onerror="replaceBrokenAvatars(this, '/html/assets/default-avatar.png')"}](/t5/user/viewprofilepage/user-id/1082346){.UserAvatar
.lia-link-navigation}
:::

::: {.user-profile-card user-id="1082346"}
::: contents
::: spinner
:::
:::
:::
:::

::: lia-user-attributes
::: lia-user-name
[
[ArjunMenon](https://techcommunity.microsoft.com/t5/user/viewprofilepage/user-id/1082346){#link_11
.lia-link-navigation .lia-page-link .lia-user-name-link} ]{.UserName
.lia-user-name .lia-user-rank-New-Contributor}
:::
:::
:::
:::
:::

</div>
:::

::: lia-decoration-border-bottom
<div>

</div>
:::
:::
:::
:::

::: {.lia-panel .lia-panel-standard .ArticleRevisionInfoTaplet .Chrome .lia-component-tkb-widget-article-revision-info-taplet}
::: lia-decoration-border
::: lia-decoration-border-top
<div>

</div>
:::

::: lia-decoration-border-content
<div>

::: lia-panel-heading-bar-wrapper
::: lia-panel-heading-bar
[Version history]{.lia-panel-heading-bar-title aria-level="3"
role="heading"}
:::
:::

::: lia-panel-content-wrapper
::: lia-panel-content
::: lia-revision-info-wrapper
::: lia-revision-info-content
::: {.lia-revision-info-row .lia-revision-last-update-row}
::: lia-revision-info-title-cell
Last update:
:::

::: lia-revision-info-data-cell
[ [‎Nov 24 2021]{.local-date} [05:19 AM]{.local-time} ]{.DateTime}
:::
:::

::: {.lia-revision-info-row .lia-revision-author-row}
::: lia-revision-info-title-cell
Updated by:
:::

::: lia-revision-info-data-cell
[
[ArjunMenon](https://techcommunity.microsoft.com/t5/user/viewprofilepage/user-id/1082346){#link_12
.lia-link-navigation .lia-page-link .lia-user-name-link} ]{.UserName
.lia-user-name .lia-user-rank-New-Contributor}
:::
:::

::: {.lia-revision-info-row .lia-revision-article-history-link-row .lia-revision-info-data-cell-workflow}
:::
:::
:::
:::
:::

</div>
:::

::: lia-decoration-border-bottom
<div>

</div>
:::
:::
:::

::: {.lia-panel .lia-panel-standard .LabelsTaplet .Chrome .lia-component-labels-widget-labels-list .custom-blog-article-label-widget}
::: lia-decoration-border
::: lia-decoration-border-top
<div>

</div>
:::

::: lia-decoration-border-content
::: lia-panel-heading-bar-wrapper
::: lia-panel-heading-bar
[Labels]{.lia-panel-heading-bar-title aria-level="4" role="heading"}
:::
:::

::: lia-panel-content-wrapper
::: lia-panel-content
::: BlogLabelsTaplet
::: LabelsList
::: {.spinner .labels-spinner}
:::

::: labels-container
:::
:::
:::
:::
:::
:::

::: lia-decoration-border-bottom
<div>

</div>
:::
:::
:::

::: blog-article-social-share-widget-wrapper
::: custom-social-share-component
::: custom-social-share-widget
::: {.lia-panel .lia-panel-standard .Chrome .custom-share-component style=""}
::: lia-decoration-border
::: lia-decoration-border-top
<div>

</div>
:::

::: lia-decoration-border-content
<div>

::: lia-panel-heading-bar-wrapper
::: lia-panel-heading-bar
## Share {#customShareWidget .lia-panel-heading-bar-title .hello}
:::
:::

::: lia-panel-content-wrapper
::: lia-panel-content
-   [[Share to
    LinkedIn]{.social-share-title}](http://www.linkedin.com/shareArticle?mini=true&url=https://techcommunity.microsoft.com/t5/microsoft-365-pnp-blog/monitor-and-notify-m365-health-using-cli-for-microsoft-365/ba-p/3000703 "Share to LinkedIn"){.social-share-link
    .social-share-linkedin}
-   [[Share to
    Facebook]{.social-share-title}](http://www.facebook.com/share.php?u=https://techcommunity.microsoft.com/t5/microsoft-365-pnp-blog/monitor-and-notify-m365-health-using-cli-for-microsoft-365/ba-p/3000703 "Share to FaceBook"){.social-share-link
    .social-share-facebook}
-   [[Share to
    Twitter]{.social-share-title}](http://twitter.com/share?text=Check%20out%20this%20post%20on%20the%20Microsoft%20Tech%20Community%20:%20Monitor%20and%20Notify%20M365%20health%20using%20CLI%20for%20Microsoft%20365%20-%20Microsoft%20Tech%20Community&url=https://techcommunity.microsoft.com/t5/microsoft-365-pnp-blog/monitor-and-notify-m365-health-using-cli-for-microsoft-365/ba-p/3000703 "Share to Twitter"){.social-share-link
    .social-share-twitter}
-   [[Share to
    Email]{.social-share-title}](mailto:?subject=Monitor%20and%20Notify%20M365%20health%20using%20CLI%20for%20Microsoft%20365%20-%20Microsoft%20Tech%20Community&body=I%20found%20this%20on%20the%20Microsoft%20Tech%20Community%20and%20wanted%20to%20share%20it%20with%20you,%20check%20it%20out%20:%20https://techcommunity.microsoft.com/t5/microsoft-365-pnp-blog/monitor-and-notify-m365-health-using-cli-for-microsoft-365/ba-p/3000703 "Share via email"){.social-share-link
    .social-share-email}
:::
:::

</div>
:::

::: lia-decoration-border-bottom
<div>

</div>
:::
:::
:::
:::
:::
:::
:::
:::
:::

::: {.lia-quilt-row .lia-quilt-row-footer}
::: {.lia-quilt-column .lia-quilt-column-24 .lia-quilt-column-single .lia-quilt-column-common-footer}
::: {.lia-quilt-column-alley .lia-quilt-column-alley-single}
::: {.lia-quilt .lia-quilt-footer .lia-quilt-layout-footer .lia-component-quilt-footer}
::: {.lia-quilt-row .lia-quilt-row-main}
::: {.lia-quilt-column .lia-quilt-column-24 .lia-quilt-column-single .lia-quilt-column-icons}
::: {.lia-quilt-column-alley .lia-quilt-column-alley-single .lia-mark-empty}
:::
:::
:::
:::
:::
:::
:::
:::
:::
:::
:::
:::

::: {.cse-46444-wa style="display: none"}
::: {.lia-slide-out-nav-menu .lia-component-common-widget-slide-out-nav-menu}
::: {.lia-slide-out-nav-menu-title ng-non-bindable=""}
Browse
:::

::: {.lia-quilt .lia-quilt-navigation-slide-out-menu .lia-quilt-layout-one-column .lia-top-quilt}
::: {.lia-quilt-row .lia-quilt-row-header}
::: {.lia-quilt-column .lia-quilt-column-24 .lia-quilt-column-single .lia-quilt-column-common-header .lia-mark-empty}
:::
:::

::: {.lia-quilt-row .lia-quilt-row-main}
::: {.lia-quilt-column .lia-quilt-column-24 .lia-quilt-column-single .lia-quilt-column-main-content}
::: {.lia-quilt-column-alley .lia-quilt-column-alley-single}
:::
:::
:::

::: {.lia-quilt-row .lia-quilt-row-footer}
::: {.lia-quilt-column .lia-quilt-column-24 .lia-quilt-column-single .lia-quilt-column-common-footer .lia-mark-empty}
:::
:::
:::
:::
:::

::: {.shell-footer bi-view="5xLinks" bi-area="Footer" ms.pgarea="uhffooter" role="contentinfo"}
::: shell-footer-wrapper
::: {.shell-footer-menugroups ms.cmpgrp="footer nav"}
::: {.sfm-group ms.cmpnm="WhatsNew"}
###### What\'s new  {#whats-new .grp-title}

-   [Surface Pro
    X](https://www.microsoft.com/p/surface-pro-x/8vdnrp2m6hhc?activetab=overview)
-   [Surface Laptop
    3](https://www.microsoft.com/p/surface-laptop-3/8VFGGH1R94TM?activetab=overview)
-   [Surface Pro
    7](https://www.microsoft.com/p/surface-pro-7/8N17J0M5ZZQS?activetab=overview)
-   [Windows 10 Apps](https://www.microsoft.com/windows/windows-10-apps)
-   [Office apps](https://store.office.com/appshome.aspx)
:::

::: {.sfm-group ms.cmpnm="MicrosoftStore"}
###### Microsoft Store  {#microsoft-store .grp-title}

-   [Account profile](https://account.microsoft.com/)
-   [Download Center](https://www.microsoft.com/download)
-   [Microsoft Store
    support](https://go.microsoft.com/fwlink/p/?LinkID=824761&clcid=0x409)
-   [Returns](https://go.microsoft.com/fwlink/p/?LinkID=824764&clcid=0x409)
-   [Order tracking](https://account.microsoft.com/orders)
-   [Store
    locations](https://www.microsoft.com/en-us/store/locations/find-a-store?icid=en-us_UF_FAS)
-   [Buy online, pick up in
    store](https://www.microsoft.com/en-us/store/b/buy-online-pick-up-in-store?icid=uhf_footer_bopuis)
-   [In-store
    events](https://www.microsoft.com/en-us/store/locations/events?icid=en_us_store_uhf_events)
:::

::: {.sfm-group ms.cmpnm="Education"}
###### Education  {#education .grp-title}

-   [Microsoft in education](https://www.microsoft.com/education)
-   [Office for
    students](https://www.microsoft.com/education/products/office/default.aspx)
-   [Office for
    schools](https://products.office.com/academic/compare-office-365-education-plans)
-   [Deals for students and
    parents](https://www.microsoft.com/en-us/store/b/education?icid=CNavfooter_Studentsandeducation)
-   [Microsoft Azure in
    education](https://azure.microsoft.com/community/education/)
:::

::: {.sfm-group ms.cmpnm="Enterprise"}
###### Enterprise  {#enterprise .grp-title}

-   [Azure](https://azure.microsoft.com/)
-   [AppSource](https://go.microsoft.com/fwlink/?LinkID=808093)
-   [Automotive](https://www.microsoft.com/enterprise/automotive)
-   [Government](https://www.microsoft.com/enterprise/government)
-   [Healthcare](https://www.microsoft.com/enterprise/health)
-   [Manufacturing](https://www.microsoft.com/enterprise/manufacturing)
-   [Financial
    Services](https://www.microsoft.com/enterprise/financial-services/banking-and-capital-markets)
-   [Retail](https://www.microsoft.com/enterprise/retail-consumer-goods)
:::

::: {.sfm-group ms.cmpnm="Developer"}
###### Developer  {#developer .grp-title}

-   [Microsoft Visual Studio](https://visualstudio.microsoft.com/)
-   [Window Dev Center](https://developer.microsoft.com/windows)
-   [Developer Network](https://msdn.microsoft.com/)
-   [TechNet](https://technet.microsoft.com/)
-   [Microsoft developer
    program](https://developer.microsoft.com/store/register)
-   [Channel 9](https://channel9.msdn.com/)
-   [Office Dev Center](https://developer.microsoft.com/office)
-   [Microsoft Garage](https://www.microsoft.com/garage/)
:::

::: {.sfm-group ms.cmpnm="Company"}
###### Company  {#company .grp-title}

-   [Careers](https://careers.microsoft.com/)
-   [About Microsoft](https://www.microsoft.com/en-us/about)
-   [Company News](https://news.microsoft.com/)
-   [Privacy at Microsoft](https://privacy.microsoft.com/)
-   [Investors](https://www.microsoft.com/investor/default.aspx)
-   [Diversity and inclusion](https://www.microsoft.com/diversity/)
-   [Accessibility](https://www.microsoft.com/accessibility)
-   [Security](https://www.microsoft.com/security/default.aspx)
:::
:::

::: {.shell-footer-copyright ms.cmpnm="corp" ms.cmpgrp="corp links"}
-   [Sitemap](https://www.microsoft.com/en-us/sitemap1.aspx){#shellmenu_0
    .ctl_footerNavLink}
-   [Contact
    Microsoft](https://support.microsoft.com/contactus){#shellmenu_1
    .ctl_footerNavLink}
-   [Privacy](https://go.microsoft.com/fwlink/?LinkId=521839){#shellmenu_2
    .ctl_footerNavLink}
-   [Manage cookies](#){#shellmenu_2B .ctl_footerNavLink .hidden}
-   [Terms of
    use](http://go.microsoft.com/fwlink/?LinkID=206977){#shellmenu_3
    .ctl_footerNavLink}
-   [Trademarks](https://www.microsoft.com/trademarks){#shellmenu_4
    .ctl_footerNavLink}
-   [Safety and
    eco](https://www.microsoft.com/devices/safety-and-eco){#shellmenu_5
    .ctl_footerNavLink}
-   [About our ads](https://choice.microsoft.com/){#shellmenu_6
    .ctl_footerNavLink}
-   © []{#footerDate} Microsoft
:::
:::
:::
:::
